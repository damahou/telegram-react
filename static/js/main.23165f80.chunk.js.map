{"version":3,"sources":["Controllers/TdLibController.js","Utils/Localization.js","Localization/Cache.js","Stores/LocalizationStore.js","Stores/FileStore.js","Constants.js","Utils/InputTypingManager.js","Stores/ChatStore.js","Utils/File.js","Utils/Common.js","Utils/ActionScheduler.js","Stores/ApplicationStore.js","Stores/PlayerStore.js","Stores/MessageStore.js","Stores/UserStore.js","Components/InstantView/RichText/RichText.js","Utils/Chat.js","Utils/BasicGroup.js","Utils/Channel.js","Utils/User.js","Actions/Client.js","Components/Message/MessageAuthor.js","Stores/EventEmitter.js","Utils/Player.js","Components/Additional/MentionLink.js","Components/Additional/Latex.js","Utils/Message.js","Utils/Currency.js","Utils/ServiceMessage.js","Components/Message/Media/Call.js","Components/Message/Media/Contact.js","Components/Message/Media/Game.js","Components/Message/Media/Venue.js","Components/Player/Steaming/Utils/Common.js","Components/Player/Steaming/Utils/Token.js","Components/Player/Steaming/MP3/ID3v1/ID3v1Token.js","Components/Player/Steaming/MP3/ID3v1/ID3v1Parser.js","Components/Player/Steaming/MP3/ID3v2/ID3v2Token.js","Components/Player/Steaming/MP3/ID3v2/FrameParser.js","Components/Player/Steaming/MP3/ID3v2/ID3v2Parser.js","Components/Player/Steaming/MP3/ID3Parser.js","Components/Message/Media/Invoice.js","Utils/Media.js","Stores/SupergroupStore.js","Stores/InstantViewStore.js","Components/InstantView/Blocks/Caption.js","Components/InstantView/Blocks/Anchor.js","Components/InstantView/Blocks/Animation.js","Components/InstantView/Blocks/AuthorDate.js","Components/InstantView/Blocks/Blockquote.js","Components/InstantView/Blocks/Collage.js","Components/InstantView/Blocks/Cover.js","Components/InstantView/Blocks/Details.js","Components/InstantView/Blocks/Divider.js","Components/Additional/IframeResizer.js","Components/InstantView/Blocks/Embedded.js","Components/InstantView/Blocks/EmbeddedPost.js","Components/InstantView/Blocks/ErrorHandler.js","Components/InstantView/Blocks/Footer.js","Components/InstantView/Blocks/Header.js","Components/InstantView/Blocks/Kicker.js","Components/InstantView/Blocks/ListItem.js","Components/InstantView/Blocks/List.js","Components/InstantView/Blocks/Paragraph.js","Components/InstantView/Blocks/Photo.js","Components/InstantView/Blocks/Preformatted.js","Components/InstantView/Blocks/PullQuote.js","Components/InstantView/Blocks/RelatedArticle.js","Components/InstantView/Blocks/RelatedArticles.js","Components/InstantView/Blocks/Slideshow.js","Components/InstantView/Blocks/Subheader.js","Components/InstantView/Blocks/Subtitle.js","Components/InstantView/Blocks/Title.js","Components/InstantView/RichText/Bold.js","Components/InstantView/RichText/EmailAddress.js","Components/InstantView/RichText/Fixed.js","Components/InstantView/RichText/Icon.js","Components/InstantView/RichText/Italic.js","Components/InstantView/RichText/Marked.js","Components/InstantView/RichText/PhoneNumber.js","Components/InstantView/RichText/Plain.js","Components/InstantView/RichText/Strikethrough.js","Components/InstantView/RichText/Subscript.js","Components/InstantView/RichText/Superscript.js","Components/InstantView/RichText/Anchor.js","Components/InstantView/RichText/Texts.js","Components/InstantView/RichText/Underline.js","Components/InstantView/RichText/Url.js","Components/InstantView/Blocks/Table.js","Components/InstantView/Blocks/TableCell.js","Components/InstantView/Blocks/Map.js","Components/InstantView/Blocks/Audio.js","Components/InstantView/Blocks/ChatLink.js","Components/InstantView/Blocks/Video.js","Components/InstantView/Blocks/VoiceNote.js","Utils/InstantView.js","Utils/Date.js","Calls/Utils.js","Components/InstantView/IVContext.js","Utils/HOC.js","Stores/BasicGroupStore.js","Utils/Modal.js","Calls/SdpBuilder.js","Calls/LocalConferenceDescription.js","Calls/StreamManager.js","Stores/CallStore.js","Stores/OptionStore.js","Components/Viewer/FileProgress.js","Components/Message/Media/Photo.js","Assets/Icons/Download.js","Assets/Icons/PlayArrow.js","Utils/Phone.js","Components/Additional/SafeLink.js","Components/ColumnMiddle/HeaderProgress.js","Utils/Url.js","Components/Tile/UserTile.js","Stores/StickerStore.js","registerServiceWorker.js","Stores/WebpManager.js","Components/Message/Media/Animation.js","Assets/Icons/Pause.js","Utils/Store.js","Stores/NotificationStore.js","Components/Tile/DocumentTile.js","Components/Message/Media/Location.js","Components/Message/Media/MediaStatus.js","Assets/Icons/Close.js","Components/Additional/KeyboardManager.js","Components/Message/Media/Audio.js","Components/Message/Media/Video.js","Components/Message/Media/VoiceNote.js","Components/Message/Media/AudioAction.js","Assets/Icons/DeletedAccount.js","Components/Message/Media/Waveform.js","Components/Message/Media/VoiceNoteSlider.js","Actions/Chat.js","Components/Message/Media/Sticker.js","Stores/AnimationStore.js","Utils/Poll.js","Actions/Poll.js","Components/Tile/UserStatus.js","Stores/PollStore.js","Components/Message/Media/FireworksControl.js","Components/Message/Media/PollRadio.js","Components/Message/Media/PollPercentage.js","Components/Message/Media/PollOption.js","Components/Tile/UserPlaceholder.js","Components/Popup/PollOptionResult.js","Components/Popup/PollOptionResults.js","Components/Popup/PollResultsDialog.js","Components/Message/Media/Poll.js","Actions/Message.js","Components/Tile/UserTitle.js","Components/Tile/User.js","Actions/Call.js","Stores/FilterStore.js","Components/Player/Player.js","Assets/Icons/Document.js","Components/Message/Media/DocumentAction.js","Components/Message/Media/Document.js","Language.js","Utils/Supergroup.js","Assets/Icons/Saved.js","Assets/Icons/Check.js","Utils/Punycode.js","Components/Tile/VoiceNoteTile.js","Assets/Icons/FullScreen.js","Components/Player/Hint.js","Components/Player/Progress.js","Components/Message/Media/VideoNote.js","../public/tdweb.js","Components/Tile/OnlineStatus.js","Components/Calls/GroupCallStatus.js","Components/Tile/ChatTile.js","Utils/Color.js","Theme.js","Components/Auth/AuthErrorDialog.js","Assets/telegram-logo.svg","Stores/AuthorizationStore.js","Components/Auth/Caption.js","Components/Auth/Country.js","Components/Auth/Phone.js","Components/Auth/Code.js","Components/Footer.js","Components/Auth/QRCode.js","Components/Auth/Password.js","Components/Auth/AuthForm.js","Components/Additional/AppInactive.js","Components/InactivePage.js","Components/Additional/NativeApp.js","Components/NativeAppPage.js","TelegramApp.js","index.js"],"names":["controller","init","parameters","verbosity","jsVerbosity","useTestDC","readOnly","fastUpdating","useDatabase","mode","instanceName","DATABASE_TEST_NAME","DATABASE_NAME","dbname","callback","req","indexedDB","open","existed","onsuccess","result","close","deleteDatabase","onupgradeneeded","databaseExists","exists","clientUpdate","options","logVerbosityLevel","jsLogVerbosityLevel","isBackground","wasmUrl","WASM_FILE_NAME","WASM_FILE_HASH","console","log","JSON","stringify","client","TdClient","onUpdate","update","disableLog","file","id","emit","setParameters","location","search","params","URLSearchParams","toLowerCase","has","stringToBoolean","get","parseInt","VERBOSITY_MIN","VERBOSITY_MAX","VERBOSITY_JS_MIN","VERBOSITY_JS_MAX","tag","replace","split","tagVerbosity","length","streaming","send","request","then","catch","error","Promise","reject","sendTdParameters","a","process","apiHash","version","packageJson","use_test_dc","api_id","api_hash","system_language_code","navigator","language","device_model","getBrowser","system_version","getOSName","application_version","use_secret_chats","use_message_database","use_file_database","database_directory","files_directory","name","value","i","new_verbosity_level","setChatId","chatId","messageId","window","this","content","EventEmitter","QuantityEnum","Object","freeze","QUANTITY_OTHER","QUANTITY_ZERO","QUANTITY_ONE","QUANTITY_TWO","QUANTITY_FEW","QUANTITY_MANY","PluralRules_Zero","count","PluralRules_Welsh","PluralRules_Two","PluralRules_Tachelhit","PluralRules_Slovenian","rem100","PluralRules_Romanian","PluralRules_Polish","rem10","PluralRules_One","PluralRules_None","PluralRules_Maltese","PluralRules_Macedonian","PluralRules_Lithuanian","PluralRules_Latvian","PluralRules_Langi","PluralRules_French","PluralRules_Czech","PluralRules_Breton","PluralRules_Balkan","PluralRules_Serbian","PluralRules_Arabic","re","not_string","number","json","not_json","text","modulo","placeholder","key","key_access","index_access","sign","sprintf","arguments","cache","hasOwnProperty","parse","format","call","get_type","variable","prototype","toString","slice","parse_tree","argv","arg","k","match","pad","pad_character","pad_length","input","cursor","tree_length","node_type","output","is_positive","Error","test","isNaN","TypeError","String","fromCharCode","toExponential","parseFloat","toFixed","toPrecision","substring","toUpperCase","charAt","Array","join","fmt","_fmt","arg_names","exec","SyntaxError","field_list","replacement_field","field_match","sprintfPostprocessor","type","apply","_argv","splice","overloadTranslationOptionHandler","args","values","push","postProcess","Storage","store","setItem","e","getItem","getDefaults","prefix","expirationTime","Infinity","versions","localStorage","Cache","services","storage","namespace","nowMS","Date","getTime","local","i18nStamp","i18nVersion","data","fallbackLng","defaultNS","lng","i18n","use","initReactI18next","ns","fallbackNS","resources","en","ru","it","es","pl","interpolation","escapeValue","react","wait","LocalizationCache","enabled","defaultResources","read","err","currentResources","addResourceBundle","formatShortNumber","rounded","addTdLibListener","TdLibController","on","onClientUpdate","removeTdLibListener","off","authorization_state","only_local","info","langCode","countryCodeIndex","indexOf","substr","loadLanguage","changeLanguage","processStrings","languagePackStrings","strings","zero_value","one_value","two_value","few_value","many_value","other_value","formatCallDuration","duration","formatPluralString","Math","floor","minutes","formatDistance","distance","formatString","max","language_pack_id","keys","save","allRules","Map","addRules","set24HourFormat","updatePluralRules","recreateFormatters","is24HourFormat","Intl","DateTimeFormat","hour","resolvedOptions","hour12","index","currentPluralRules","formatterDay","getString","formatterDayMonth","formatterYear","languages","rules","forEach","x","set","quantity","plural","pluralKey","stringForQuantity","quantityForNumber","t","str","obj","key1","obj1","key2","obj2","first","second","temp","entities","getSimpleMarkupEntities","localization","useReadFile","reset","callbacks","db","urls","WeakMap","dataUrls","items","blobItems","pngBlobItems","locationItems","downloads","uploads","onUpdateAuthorizationState","onUpdateFile","suppressUpdateFile","fileId","source","is_animated","WebpManager","decode","blob","setPngBlob","thumbnail","initDB","handleDownloads","handleUploads","arr","idb_key","is_downloading_completed","delete","getStore","item","handleAnimation","handleAudio","handleChat","handleDocument","handleGame","handleLocation","handleMessage","handlePageBlockMap","handlePhoto","handleSticker","handleVideo","handleVideoNote","handleVoiceNote","handleUser","remote","is_uploading_completed","chat","getLocalFile","updateChatPhotoBlob","getRemoteFile","FILE_PRIORITY","user","updateUserPhotoBlob","message","animation","audio","photo","document","game","sticker","web_page","video","video_note","voice_note","venue","chat_id","updateAnimationThumbnailBlob","THUMBNAIL_PRIORITY","updateAnimationBlob","album_cover_thumbnail","updateAudioThumbnailBlob","updateAudioBlob","updateDocumentThumbnailBlob","updateDocumentBlob","locationId","getLocationId","getLocationFile","updateLocationBlob","pageBlockMap","IV_LOCATION_WIDTH","IV_LOCATION_HEIGHT","sizes","photoSize","updatePhotoBlob","updateStickerThumbnailBlob","updateStickerBlob","voiceNote","voice","updateVoiceNoteBlob","videoNote","updateVideoNoteThumbnailBlob","updateVideoNoteBlob","updateVideoThumbnailBlob","updateVideoBlob","deleteLocalFile","getBlob","setBlob","getPngBlob","deleteBlob","setLocationFile","getDataUrl","setDataUrl","dataUrl","deleteDataUrl","getBlobUrl","url","URL","createObjectURL","deleteBlobUrl","updateFileBlob","initiatingDB","openDB","resolve","onerror","transaction","objectStore","faultCallback","file_id","response","Blob","event","target","priority","some","filter","only_if_pending","message_ids","revoke","userId","ALBUM_MESSAGES_LIMIT","ANIMATION_DURATION_200MS","ANIMATION_DURATION_300MS","AUDIO_MIN_BUFFERED_TIME_S","APP_NAME","CHAT_SLICE_LIMIT","EMOJI_PICKER_TIMEOUT_MS","FILTER_COUNT_MAX","FILTER_TITLE_MAX_LENGTH","GROUP_CALL_AMPLITUDE_ANALYSE_COUNT_MAX","GROUP_CALL_AMPLITUDE_ANALYSE_INTERVAL_MS","GROUP_CALL_PARTICIPANTS_LOAD_LIMIT","IV_PHOTO_SIZE","IV_PHOTO_DISPLAY_SIZE","KEY_SUGGESTED_LANGUAGE_PACK_ID","LOCATION_HEIGHT","LOCATION_SCALE","LOCATION_WIDTH","LOCATION_ZOOM","MAX_SNACK","MEDIA_SLICE_LIMIT","MEDIA_VIEWER_VIDEO_MAX_SIZE","MESSAGE_SLICE_LIMIT","MESSAGE_SPLIT_MAX_TIME_S","MUTED_VALUE_MAX","MUTED_VALUE_MIN","NOTIFICATION_AUDIO_DELAY_MS","NOTIFICATION_AUTO_HIDE_DURATION_MS","NOTIFICATION_DEBOUNCE_DELAY_MS","OPTIMIZATIONS_FIRST_START","PAGE_WIDTH_SMALL","PHOTO_BIG_SIZE","PHOTO_DISPLAY_SIZE","PHOTO_DISPLAY_SMALL_SIZE","PHOTO_DISPLAY_EXTRA_SMALL_SIZE","PHOTO_SIZE","PHOTO_THUMBNAIL_SIZE","PIP_PLAYER_BORDER_PRECISION","PLAYER_AUDIO_2X_MIN_DURATION","PLAYER_LOOP_MAX_DURATION","PLAYER_VOLUME_NORMAL","PLAYER_VOLUME_MIN","PLAYER_VOLUME_MAX","PLAYER_VOLUME_STEP","PLAYER_PLAYBACKRATE_MIN","PLAYER_PLAYBACKRATE_MAX","PLAYER_PLAYBACKRATE_STEP","PLAYER_PLAYBACKRATE_NORMAL","PLAYER_PLAYBACKRATE_FAST","PLAYER_PROGRESS_TIMEOUT_MS","PLAYER_SEEK_STEP_SMALL","PLAYER_SEEK_STEP_BIG","PLAYER_STREAMING_PRIORITY","PLAYER_PRELOAD_PRIORITY","PLAYER_PRELOAD_MAX_SIZE","POLL_QUESTION_LENGTH","POLL_QUESTION_HINT_LENGTH","POLL_QUESTION_MAX_LENGTH","POLL_OPTION_LENGTH","POLL_OPTION_HINT_LENGTH","POLL_OPTION_MAX_LENGTH","POLL_OPTIONS_MAX_COUNT","POLL_RESULTS_FIRST_SLICE_LENGTH","POLL_RESULTS_LEAVE_LENGTH","POLL_RESULTS_SLICE_LENGTH","PRELOAD_AUDIO_SIZE","PRELOAD_ANIMATION_SIZE","PRELOAD_DOCUMENT_SIZE","PRELOAD_STICKER_SIZE","PRELOAD_VOICENOTE_SIZE","PRELOAD_VIDEO_SIZE","PRELOAD_VIDEONOTE_SIZE","PROFILE_PHOTO_BIG_SIZE","PROFILE_PHOTO_PRELOAD_TIME_MS","PROFILE_PHOTO_SMALL_SIZE","SCROLL_PRECISION","SCROLL_CHATS_PRECISION","SEARCH_GLOBAL_TEXT_MIN","SEND_BY_CTRL_ENTER_KEY","SERVICE_NOTIFICATIONS_USER_IDS","SHARED_MESSAGE_SLICE_LIMIT","STICKER_DISPLAY_SIZE","STICKER_HINT_DISPLAY_SIZE","STICKER_PREVIEW_DISPLAY_SIZE","STICKER_SMALL_DISPLAY_SIZE","STORAGE_AUTH_KEY","STORAGE_AUTH_TEST_KEY","STORAGE_CACHE_KEY","STORAGE_CACHE_TEST_KEY","STORAGE_CONTACTS_KEY","STORAGE_CONTACTS_TEST_KEY","STORAGE_FILES_KEY","STORAGE_FILES_TEST_KEY","STORAGE_FILTERS_KEY","STORAGE_FILTERS_TEST_KEY","STORAGE_REGISTER_KEY","STORAGE_REGISTER_TEST_KEY","THUMBNAIL_BLURRED_SIZE_90","THUMBNAIL_BLURRED_SIZE_40","TYPING_INPUT_INTERVAL_S","TYPING_OUTPUT_INTERVAL_S","VOICENOTE_MIN_RECORD_DURATION","USERNAME_LENGTH_MIN","InputTypingManager","timeoutCallback","actions","timerId","handleTimer","bind","addAction","clearAction","setActionsTimeout","now","expiredActions","expire","action","setSeconds","getSeconds","clearTimeout","timeout","actionTimeout","setTimeout","scrollPositions","typingManagers","onlineMemberCount","counters","skippedUpdates","chatList","wallpaper","loadClientData","clientData","Number","saveClientData","from","entries","reduce","state","updating","emitUpdate","updates","action_bar","assign","emitFastUpdate","setOnlineMemberCount","online_member_count","positions","draft_message","updateChatChatLists","is_blocked","is_marked_as_unread","last_message","MessageStore","notification_settings","UserStore","user_id","profile_photo","position","positionListEquals","last_read_inbox_message_id","unread_count","last_read_outbox_message_id","reply_markup_message_id","title","unread_mention_count","voice_chat_group_call_id","is_voice_chat_empty","typingManager","getTypingManager","setTypingManager","client_data","setClientData","list","filter_id","idMap","source1","source2","supportsStreaming","serviceWorker","hasServiceWorker","getArrayBuffer","fr","FileReader","onload","readAsArrayBuffer","getSizeString","size","getFileSize","saveBlob","filename","msSaveBlob","blobURL","tempLink","createElement","style","display","href","setAttribute","download","body","appendChild","click","removeChild","revokeObjectURL","loadReplies","messageIds","messages","ids","reply","map","sender","concat","setItems","loadReplyContents","FileStore","loadAnimationThumbnailContent","loadAudioThumbnailContent","loadPhotoContent","loadDocumentThumbnailContent","loadGameThumbnailContent","loadStickerThumbnailContent","loadVideoThumbnailContent","loadVideoNoteThumbnailContent","loadAudioContent","useFileSize","cancelLoadAnimationContent","cancelGetRemoteFile","loadAnimationContent","cancelLoadAnimationThumbnailContent","loadContactContent","contact","loadUserContent","loadDocumentContent","loadGameContent","width","height","zoom","scale","loadLocationContent","cancelLoadBigPhotoContent","getSize","loadBigPhotoContent","displaySize","getPhotoSize","loadPhotoThumbnailContent","thumbSize","getPhotoThumbnailSize","loadStickerContent","cancelLoadVideoContent","loadVideoContent","supports_streaming","cancelLoadVideoThumbnailContent","loadVideoNoteContent","loadVoiceNoteContent","loadMessageContents","users","chats","replies","reply_to_message_id","forward_info","origin","sender_user_id","loadPhoto","loadUsersContent","loadChatsContent","saveMedia","media","file_name","saveOrDownload","saveAnimation","saveDocument","savePhoto","saveVideo","fileName","mime","saveData","can_be_downloaded","getViewerMinithumbnail","minithumbnail","getViewerThumbnail","getViewerFile","getMediaMinithumbnail","getMediaThumbnail","getMediaFile","mime_type","cancelLoadIVMediaViewerContent","blocks","cancelLoadMediaViewerContent","loadIVMediaViewerContent","useSizeLimit","loadMediaViewerContent","cancelPreloadIVMediaViewerContent","preload","cancelPreloadMediaViewerContent","history","preloadMediaViewerContent","preloadIVMediaViewerContent","loadUserFileContent","loadChatFileContent","ChatStore","loadProfileMediaViewerContent","photos","getProfilePhoto","getChatUserId","small","big","preloadProfileMediaViewerContent","loadChatContent","full","loadChatPhotoContent","loadDraftContent","loadRecentStickersContent","recent","loadStickersContent","stickers","loadStickerSetContent","stickerSet","loadBackgroundsContent","backgrounds","background","loadBackgroundContent","isGifMimeType","mimeType","getSrc","getPngSrc","getDownloadedSize","is_downloading_active","downloaded_size","getUploadedSize","is_uploading_active","uploaded_size","getExtension","parts","pop","loadInstantViewContent","instantView","page_blocks","pageBlock","loadPageBlockContent","b","caption","author","loadRichTextContent","credit","cover","header","poster_photo","author_photo","footer","kicker","loadPageBlockMapContent","articles","subheader","subtitle","cells","row","texts","webpSupported","undefined","isWebpSupported","promise","image","Image","src","mapEquals","map1","map2","testVal","val","isMacOS","platform","isIOS","userAgent","MSStream","isWindowsPhone","isAppleDevice","OSName","isEdge","documentMode","StyleMedia","string","trim","Boolean","orderCompare","order1","order2","diff","dimension","iSize","find","useWidth","abs","currDiff","getFitSize","stretch","itemsInView","scrollContainerRef","itemsContainerRef","scrollContainer","current","itemsContainer","children","child","offsetTop","offsetHeight","scrollTop","getScrollMessage","snapshot","offset","throttle","func","context","previous","later","leading","remaining","trailing","debounce","lastArgs","lastThis","maxWait","lastCallTime","lastInvokeTime","maxing","useRAF","requestAnimationFrame","invokeFunc","time","thisArg","startTimer","pendingFunc","cancelAnimationFrame","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeSinceLastInvoke","timeWaiting","min","remainingWait","debounced","isInvoking","leadingEdge","isObject","cancel","cancelTimer","flush","pending","getFirstLetter","char","getLetters","readImageSize","reader","addEventListener","readAsDataURL","arrayBufferToBase64","buffer","binary","bytes","Uint8Array","len","byteLength","btoa","isAuthorizationReady","between","last","clamp","getDurationString","secondsTotal","reverse","hours","seconds","getRandomInt","ceil","random","historyEquals","albumHistoryEquals","insertByOrder","array","element","comparator","ActionScheduler","actionCallback","cancelCallback","add","setMilliseconds","getMilliseconds","invoke","remove","expired","onWindowResize","isSmallWidth","nextIsSmallWidth","innerWidth","dialogsReady","cacheLoaded","setPhoneNumberRequest","dialogChatId","statistics","authorizationState","defaultPhone","connectionState","isChatDetailsVisible","mediaViewerContent","profileMediaViewerContent","dragParams","actionScheduler","handleScheduledAction","handleCancelScheduledAction","addScheduledAction","invokeScheduledAction","removeScheduledAction","loggingOut","subscribeNotifications","closeChat","confirm","logOut","showAlert","LStore","ok","visibility","recording","extendedUpdate","nextChatId","nextMessageId","previousChatId","previousMessageId","dragging","dataTransfer","focused","inProgress","phone","setPhoneNumber","chatSelectOptions","phone_number","onUpdateStatistics","addStatistics","app","RepeatEnum","NONE","REPEAT","REPEAT_ONE","playbackRate","audioPlaybackRate","volume","repeat","shuffle","pipParams","left","documentElement","clientWidth","top","clientHeight","times","closeInternal","playlist","videoStream","block","getPlaylist","savePlayerSettings","playing","moveToNextMedia","moveToPrevMedia","moveNext","currentTime","buffered","timestamp","isCurrentSource","start","end","preloadNextMedia","videoWidth","videoHeight","stream","findIndex","playlistItemEquals","nextIndex","nextItem","expected_size","limit","download_offset","downloaded_prefix_size","synchronous","openPlaylistItem","useRepeatShuffle","getCurrentTime","uniqueId","setCurrentTime","clearCurrentTime","currentPlaylist","totalCount","getSearchMessagesFilter","query","from_message_id","total_count","getValidBlocks","isValidAudioBlock","isValidVoiceNoteBlock","loadPlayerSettings","player","openMedia","openInstantViewMedia","selectedItems","addMediaMessage","is_permanent","removeMediaMessages","message_id","newMessage","reply_markup","edit_date","is_pinned","updateMediaMessage","getClientData","unpinned","interaction_info","new_content","old_content","oldPhoto","newPhoto","oldSize","newSize","oldBlob","is_listened","is_viewed","old_message_id","sending_state","updateMediaMessageSend","error_code","error_message","clear","setMedia","selected","insertMessage","returnValue","deletedMessage","photoAndVideo","pinned","getMedia","hasUrl","oldMessageId","fullInfoItems","setFullInfo","user_full_info","status","myId","OptionStore","fullInfo","RichText","props","getRichText","propTypes","PropTypes","object","isRequired","canBeReported","can_be_reported","canManageVoiceChats","basicGroup","BasicGroupStore","basic_group_id","getBasicGroupId","isChannelChat","supergroup","SupergroupStore","getSupergroupId","can_manage_voice_chats","is_member","getChatSender","getChatLocation","supergoupId","getFullInfo","canSwitchBlocked","getDeleteChatTitle","supergroup_id","is_channel","getViewInfoTitle","getChatPosition","chat_filter_id","isChatPinned","hasChatList","getChatOrder","order","chatListEquals","list1","list2","p1","p2","hasOnePinnedMessage","isChatArchived","archivePosition","canAddChatToList","is_sponsored","isMeChat","draftEquals","draft1","draft2","inputMessageText1","input_message_text","replyToMessageId1","inputMessageText2","formattedText1","formattedText2","text1","entities1","text2","entities2","every","entitiesEquals","getChatTypingString","typingString","inputTypingManager","next","getPrivateChatTypingString","firstUser","secondUser","first_name","second_name","getGroupChatTypingString","getMessageSenderFullName","isServiceMessage","getUserFullName","getChatTitle","getMessageSenderName","isMeUser","getUserShortName","getLastMessageSenderName","getLastMessageContent","getContent","showChatUnreadMentionCount","showChatUnreadCount","isChatUnread","isChatMuted","use_default_mute_for","mute_for","settings","NotificationStore","getScopeNotificationSettings","getChatMuteFor","getMessageDate","date","dayStart","setHours","dateFormat","day","getDay","weekStart","getDate","setDate","toLocaleString","weekday","getLastMessageDate","showChatDraft","getChatSubtitleWithoutTyping","member_count","onlineCount","getOnlineMemberCount","getBasicGroupStatus","getUserStatus","username","getChannelStatus","getSupergroupStatus","getChatSubtitle","showSavedMessages","chatTypingString","getChatLetters","letters","isAccentChatSubtitleWithoutTyping","isUserOnline","isAccentChatSubtitle","getChatUsername","getChatPhoneNumber","formatPhoneNumber","getChatBio","description","bio","isPrivateChat","isGroupChat","isChatMember","isBotChat","getChatType","is_contact","is_mutual_contact","isContactChat","isDeletedPrivateChat","getMyId","getGroupChatMembers","fallbackValue","members","hasChatGroupCall","getChatMedia","promises","getChatFullInfoRequest","offset_chat_id","CallStore","group_call_id","isSupergroup","all","groupsInCommon","groupCall","supergroupMembers","chat_ids","getChatFullInfo","hasBasicGroupId","basicGroupId","hasSupergroupId","supergroupId","getPhotoFromChat","canSendMediaMessages","globalPermissions","permissions","can_send_media_messages","getChatShortTitle","canClearHistory","can_be_deleted_only_for_self","can_be_deleted_for_all_users","canDeleteChat","canSendPolls","can_send_polls","canSendMessages","can_send_messages","getChatDraft","getChatDraftReplyToMessageId","replyToMessageId","canPinMessages","can_pin_messages","isChatVerified","is_verified","isChatSecret","isCreator","getChatTypeId","isBotUser","is_support","was_online","wasOnline","today","yesterday","last_name","getUserLetters","firstName","lastName","firstNameSymbol","lastNameSymbol","getUserStatusOrder","expires","getProfilePhotoDateHint","userProfilePhoto","added_date","isDeletedUser","showLeaveVoiceChatAlert","showInputPasswordAlert","onPassword","setText","showOpenGameAlert","showOpenUrlAlert","showRequestUrlAlert","showSnackbar","openArchive","editMessage","deleteMessages","replyMessage","forward","forwardMessages","openUser","popup","openChat","AppStore","switchInline","botStartMessage","rejected","botUserId","closeChatSelect","clearOpenChatOptions","openReply","highlightMessage","selectMessage","clearSelection","closePinned","setInstantViewViewerContent","setMediaViewerContent","setProfileMediaViewerContent","setInstantViewContent","searchChat","requestUnpinMessage","requestPinMessage","MessageAuthor","onUpdateUser","fullName","getFullName","setState","onUpdateChatTitle","handleSelect","forwardInfo","stopPropagation","openUserCommand","openChatCommand","nextProps","nextState","nextContext","sender_name","tileColor","charCodeAt","className","classNames","onClick","senderEquals","prevSender","React","Component","defaultProps","withTranslation","observers","events","listener","l","cloned","observer","item1","item2","getMediaTitle","getAudioTitle","getAuthor","getMessageAudio","getBlockAudio","unique_id","PlayerStore","getMediaMimeType","getMediaSrc","MentionLink","handleClick","preventDefault","handleClose","handleDialogClick","Dialog","manager","modalManager","transitionDuration","onClose","aria-labelledby","DialogTitle","DialogContent","classes","root","DialogContentText","DialogActions","Button","prevUserId","prevUsername","Latex","node","useRef","useLayoutEffect","MathJax","typeset","typesetClear","ref","class","isEmptySelection","selection","lhs","rhs","forwardInfoEquals","isMetaBubble","isMessageUnread","is_outgoing","isMe","getTitle","searchCurrentChat","latexFormat","getFormattedText","formattedText","isValidEntity","deleteLineBreakAfterPre","entity","textBefore","textBeforeLength","entityKey","entityText","command","getChatId","via_bot_user_id","bot","SafeLink","rel","textAfter","getText","meta","getWebPage","getViews","views","trunc","d","getDateHint","isForwardOriginHidden","getForwardTitle","author_signature","filterDuplicateMessages","accumulator","getCallContent","is_video","discard_reason","isMissed","isBusy","ttl","getServiceMessageContent","poll","question","emoji","isMediaContent","longitude","latitude","isVideoMessage","isEmbedMessage","embed_url","site_name","isAnimationMessage","isContentOpened","hasVoice","useAudioPlaybackRate","hasAudio","hasVideoNote","openAnimation","fileCancel","cancelUploadFile","openAudio","openDocument","openPhoto","openSticker","set_id","openVideo","openVideoNote","openVoiceNote","openChatPhoto","openContact","openGame","isDeletedMessage","getReplyMinithumbnail","getReplyThumbnail","getEmojiMatches","messageComparatorDesc","right","checkInclusion","checkIntersection","startIndex","endIndex","checkEntity","removeOffsetAfter","countToRemove","addOffsetAfter","countToAdd","removeEntities","entityStart","entityEnd","addTextNode","nodes","createTextNode","getNodes","sort","prevEntity","innerText","dataset","getDecodedUrl","getEntities","isPre","lastIndex","textContent","lastChar","firstChar","getMonoPreEntities","DOMParser","parseFromString","finalText","childNodes","nodeName","getHTMLEntities","compareEntities","offsetA","offsetB","getUrlMentionHashtagEntities","regExp","urlRegExp","getUrlEntities","mentionHashtagRegExp","ch","getMentionHashtagEntities","twitterInstagramEntities","getTwitterInstagramEntities","patternType","foundText","checkChar","checkString","prevChar","canMessageBeEdited","can_be_edited","showMessageForward","isTextMessage","isMessagePinned","canMessageBeUnvoted","is_closed","is_chosen","is_being_chosen","canMessageBeClosed","canMessageBeForwarded","can_be_forwarded","canMessageBeDeleted","getMessageStyle","maxWidth","fitSize","currency","symbol","includes","totalAmount","amount","pow","getPow","serviceMap","isOutgoing","isChannel","member_user_ids","memberUserId","replaceTwo","getMessageAuthor","pinnedMessage","live_period","ttlString","days","getTTLString","score","game_message_id","messageGame","messageGameContent","messageInvoice","invoice_message_id","invoice","total_amount","Currency","domain_name","documents","types","getPassportElementTypeString","approacher","getCallDuration","user_ids","Call","callTitle","durationString","IconButton","color","aria-label","fontSize","Contact","UserTile","Game","Animation","fitPhotoSize","Photo","Venue","venueTitle","address","Location","strtokBITSET","buf","bit","decodeString","encoding","label","TextDecoder","readUTF16String","readUTF8String","readWindows1292String","UINT32SYNCSAFE","UINT8","UINT32_BE","UINT24_BE","UINT16_BE","ASCII_TEXT","Id3v1StringType","pos0","trimRightNull","ID3v1Header","artist","album","year","comment","zeroByte","track","genre","ID3v1Parser","hasID3v1Header","ID3v2Header","fileIdentifier","major","revision","flags","raw","unsynchronisation","isExtendedHeader","expIndicator","ExtendedHeader","extendedFlags","sizeOfPadding","crcDataPresent","crcData","TextEncodingToken","bom","FrameParser","debug","splitValue","trimArray","ID3v2Parser","tags","frameHeaderLength","getFrameHeaderLength","id3Header","frameHeaderBytes","frameHeader","readFrameHeader","frameDataBytes","readFrameData","extendedHeader","parseId3Data","dataLen","parseMetadata","parseExtendedHeader","readI","writeI","majorVer","includeCovers","warningCollector","frameParser","readData","removeUnsyncBytes","data_length_indicator","tag_alter_preservation","file_alter_preservation","read_only","grouping_identity","compression","encryption","v","readFrameFlags","hasID3v2Header","ID3Parser","arrayBuffer","id3Tags","artistTag","titleTag","Invoice","is_test","waveformCache","getNormalizedWaveform","atob","waveform","barsCount","byteIndex","barPadding","bits","getThumb","thumb","miniSrc","thumbnailSrc","isBlurred","isBlurredThumbnail","alt","autoPlay","loop","playsInline","isEditedMedia","isValidAnimatedSticker","blurredSize","performer","trimmedTitle","trimmedPerformer","getAudioShortTitle","getAudioSubtitle","getStickers","sets","getNeighborStickersFromSets","stickersPerRow","setIndex","stickerIndex","prevRows","toRowColumn","column","prevPrevRow","prevRow","nextRow","nextNextRow","prevColumn","nextColumn","skipPrevRow","skipPrePrevRow","toIndex","totalRows","skipNextRow","skipNextNextRow","setRow","setColumn","getInputMediaThumbnail","getInputMediaCaption","getInputMediaContent","added_sticker_file_ids","hasTitle","hasCaption","inlineMeta","Audio","Document","Poll","Sticker","StickerSourceEnum","MESSAGE","Video","VideoNote","VoiceNote","getMediaTags","getMediaDocumentFromFile","album_cover_minithumbnail","getMediaPhotoFromFile","startsWith","has_stickers","prevSupergroup","supergroup_full_info","viewerContent","prevInstantView","Caption","hasText","isEmptyText","hastCredit","Anchor","need_autoplay","AuthorDate","publishDate","hasAuthor","hasDate","dateTime","toISOString","Blockquote","withIV","pageBlocks","iv","getPageBlock","Cover","isOpen","Divider","IframeResizer","updateIframe","frame","frameRef","doc","contentDocument","write","ReactDOM","render","getElementById","injectIframeResizerUrl","iframeResizerUrl","injectTarget","tagName","found","getElementsByTagName","resizerScriptElement","onLoad","resizeIframe","iframeResizerEnable","iframeResizerLib","iframeResizerOptions","createRef","iframeResizer","removeListeners","frameBorder","minHeight","Embedded","setIframeSource","prevProps","prevState","html","isFullWidth","allowScrolling","scrolling","hasWidthHeight","hasSource","srcDoc","allowFullScreen","prevUrl","prevHtml","authorPhoto","ErrorHandler","errorInfo","componentStack","Footer","Header","Kicker","data-before","List","Paragraph","Preformatted","PullQuote","RelatedArticle","hasAuthorDateSeparator","hasAuthorDate","RelatedArticles","publish_date","Subheader","Subtitle","Title","Bold","EmailAddress","emailAddress","Fixed","Icon","onClientUpdateDocumentThumbnailBlob","forceUpdate","onClientUpdateDocumentBlob","emptyPlaceholderSrc","draggable","Italic","Marked","PhoneNumber","phoneNumber","Plain","Strikethrough","Subscript","Superscript","Texts","Underline","Url","isBordered","isStriped","striped","border","rowIndex","TableCell","isHeader","colspan","rowspan","align","valign","attributes","colSpan","rowSpan","getHorizontalAlignment","getVerticalAlignment","ChatLink","needAutoplay","isLooped","is_open","posterPhoto","is_full_width","allow_scrolling","is_bordered","is_striped","is_header","is_looped","richText","email_address","getInnerBlocks","innerBlocks","getBlockMedia","getBlockCaption","getBlockUrl","isValidMediaBlock","token","timezone","timezoneClip","mask","utc","gmt","kindOf","maskSlice","masks","_","D","M","y","H","m","s","L","o","getTimezoneOffset","W","getWeek","N","getDayOfWeek","dd","ddd","dayNames","dddd","MM","MMM","monthNames","MMMM","yy","yyyy","h","hh","HH","mm","ss","round","timeNames","aa","A","AA","Z","S","targetThursday","getFullYear","getMonth","firstThursday","ds","getHours","weekDiff","dow","isArray","default","shortDate","mediumDate","longDate","fullDate","shortTime","mediumTime","longTime","isoDate","isoTime","isoDateTime","isoUtcDateTime","expiresHeaderFormat","getTransport","joinResponse","payload","candidates","ufrag","pwd","fingerprints","mergeSsrcs","ssrcs","newSsrcs","res","needle","ssrc","isRemoved","isMain","parseSdp","sdp","lines","lookup","force","line","fingerprint","hash","setup","rawSource","getStream","constraints","muted","mediaDevices","getUserMedia","getTracks","onmute","LOG_CALL","onunmute","toTelegramSource","fromTelegramSource","getCallStatus","connected","groupCallId","connection","can_unmute_self","isMuted","iceConnectionState","getAmplitude","total","rms","sqrt","IVContext","createContext","IVComponent","Consumer","displayName","getDisplayName","compose","funcs","withSaveRef","forwardRef","forwardedRef","withRestoreRef","rest","WrappedComponent","basic_group","basic_group_full_info","groupId","group","basicgroup","ModalManager","toAudioSsrc","SdpBuilder","word","separator","c","foundation","component","protocol","ip","port","generation","addJoined","sessionId","transport","candidate","addCandidate","entry","isAnswer","addTransport","conference","addHeader","addSsrcEntry","addConference","finalize","LocalConferenceDescription","onSsrcs","fromConference","StreamManager","interval","AudioContext","webkitAudioContext","timer","outputStream","MediaStream","inputStream","counter","tracks","getAudioTracks","streamSource","createMediaStreamSource","analyser","createAnalyser","gain","createGain","createMediaStreamDestination","onended","removeTrack","minDecibels","maxDecibels","smoothingTimeConstant","fftSize","connect","addTrack","changeTimer","handled","oldTrack","clearInterval","setInterval","analyse","frequencyBinCount","getByteFrequencyData","amplitudes","kind","ERROR_CALL","currentGroupCall","participants","panelOpened","animated","is_joined","hangUp","group_call","prevGroupCall","need_rejoin","rejoinGroupCall","participant","is_muted_for_all_users","is_muted_for_current_user","prevParticipant","streamManager","audioTracks","updateGroupCallParticipants","closeGroupCallPanel","isSpeakingMap","meSignSource","isSpeaking","speakingTimer","cancelSpeakingTimer","is_speaking","opened","startNegotiation","rejoin","offerOptions","offerToReceiveAudio","offerToReceiveVideo","createOffer","offer","setLocalDescription","clientInfo","startConnectingSound","is_muted","closeConnectionAndStream","meParticipant","can_be_muted","can_be_unmuted","data1","updateFromServer","sdp1","generateSdp","signalingState","iceGatheringState","setRemoteDescription","handleUpdateGroupCallParticipants","callId","sound","play","stopConnectingSound","connectionAudio","pause","updatingSdp","ts","createAnswer","answer","oldChatId","replaceTags","onResult","startGroupCallInternal","joinGroupCallInternal","joinGroupCall","RTCPeerConnection","ontrack","onTrack","onsignalingstatechange","onnegotiationneeded","onicecandidate","oniceconnectionstatechange","joined","playSound","restartIce","ondatachannel","setCurrentGroupCall","discard","innerHTML","stop","forceDiscard","endpoint","srcObject","streams","autoplay","sinkId","outputDeviceId","setSinkId","deviceId","replaceOutputDevice","audioTrack","sender2","getSenders","replaceTrack","replaceInputAudio","replaceInputAudioDevice","getSettings","tryAddTrack","mute","mute_new_participants","volume_level","option","FileProgress","currentFile","nextFile","fileEquals","prevFile","isDownloading","wasActive","isActive","isUploading","upload","getProgressParams","isCompleted","progressSize","completeAnimation","prevPropsFile","icon","nextLocal","nextIdbKey","prevLocal","prevIdbKey","isDownloadingCompleted","receiveIdbKey","mount","file1","file2","local1","remote1","local2","remote2","can_be_deleted","path","cancelButton","zIndex","completeIcon","progress","circle","variant","thickness","onClientUpdatePhotoBlob","showProgress","thumbSrc","photoStyle","minWidth","hasSrc","pointer","thumbnailSize","prevPhoto","createSvgIcon","transform","loadData","fetch","data2","code","pattern","clearPhone","getCountryFromPhone","isPhoneWithOptionCode","country","formatByPattern","decodedUrl","punycode","ask","tryTelegraph","handleSafeClick","isTelegramLink","pathname","handleAddStickersLink","handlePrivatePost","searchParams","handleBotStart","handleOpenUsername","handleOpenMessageLinkInfo","handleBotCommand","handleUnknownDeepLink","newWindow","opener","message_thread_id","input_message_content","disable_web_page_preview","clear_draft","parameter","isGroup","openChatSelect","is_public","for_album","for_comment","link","need_update_application","safe","displayText","mail","prevDisplayText","isUrlSafe","getHref","HeaderProgress","tMeUrl","telegramUrls","lowerCaseUrl","getTelegramUrls","regExpRTLO","hasRTLOSymbol","decodedHref","decodeURI","domain","ToUnicode","regExpDomainExplicit","RegExp","regExpDomain","regExpProtocol","validateUrl","trimmed","domainMatch","protocolMatch","isGoodProtocol","onClientUpdateUserBlob","loaded","onSelect","handleLoad","dialog","tileLoaded","prevFirstName","prevLastName","hint","animationData","sticker_set_ids","is_installed","foundStickers","isLocalhost","hostname","register","registerKey","swUrl","registerValidSW","checkValidServiceWorker","registration","onupdatefound","installingWorker","installing","onstatechange","reload","ready","pushManager","getSubscription","pushSubscription","unsubscribe","subscribe","userVisibleOnly","p256dh_base64url","getKey","auth_base64url","deviceToken","device_token","other_user_ids","enableSound","headers","unregister","requests","processRequest","filePart","getFilePart","onmessage","postMessage","canvas","createPng","img","ImageData","getContext","putImageData","toBlob","isSupported","decodeInternal","worker","w","Worker","wasmReady","wasmRequests","onLibWebpMessage","getDecodePromise","webp","webpManager","startStopPlayer","videoRef","windowFocused","inView","openMediaViewer","openProfileMediaViewer","openIV","ivInView","openIVMedia","pickerInView","onClientUpdateInstantViewContent","InstantViewStore","getCurrent","onClientUpdateProfileMediaViewerContent","onClientUpdateMediaViewerContent","onClientUpdateInstantViewViewerContent","onClientUpdateFocusWindow","onClientUpdateMessagesInView","onClientUpdateBlocksInView","onClientUpdateAnimationsInView","animations","onClientUpdateAnimationBlob","onClientUpdateAnimationThumbnailBlob","handlePlay","handleTimeUpdate","setPlayerParams","hasFocus","load","AnimationStore","animationStyle","isVideoThumbnail","isGif","onPlay","onTimeUpdate","enhance","isMessageMuted","contains_unread_mention","hasMention","use_default_disable_mention_notifications","disable_mention_notifications","getChatDisableMentionNotifications","hasPinnedMessage","use_default_disable_pinned_message_notifications","disable_pinned_message_notifications","getChatDisablePinnedMessageNotifications","chatStore","messageStore","appInactive","newMessages","timerHandler","nextSoundAt","onTimer","unreadCount","getUnreadCount","chatMap","newChatMap","updateTimer","filterMap","scope","notifications","DocumentTile","onClientUpdateLocationBlob","locationStyle","MediaStatus","onUpdateMessageContentOpened","isOpened","openedIcon","KeyboardHandler","onKeyDown","handleKeyDown","handlers","handler","onClientUpdateMediaEnd","active","onClientUpdateMediaPlay","onClientUpdateMediaPause","onClientUpdateMediaActive","isCurrentAudio","playerBlock","audioTitle","audioSubtitle","opacity","onClientUpdateVideoThumbnailBlob","videoStyle","AudioAction","onClientUpdateMediaSeeking","playerDuration","seekProgress","seeking","timeString","getTimeString","onClientUpdateMediaSeek","onClientUpdateMediaTime","audioDuration","isDownloadingActive","isUploadingActive","sizeString","currentTimeString","stroke","strokeWidth","strokeLinejoin","fill","cx","cy","r","Waveform","transition","svg","viewBox","VoiceNoteSlider","onClientUpdateMediaLoadedMetadata","onClientUpdateMediaProgress","getValue","prevCurrentTime","handleMouseDown","handleChange","handleChangeCommitted","bufferedTime","Player","getBufferedTime","bufferedValue","Slider","rail","step","onChange","onChangeCommitted","onMouseDown","prevChatId","prevMessageId","prevBlock","currentBlock","openReportChat","openSupportChat","openChatList","reportChat","reason","messageids","clearHistory","leaveChat","changeChatDetailsVisibility","openPinnedChat","chat_list","offset_order","pinnedIndex","addChatToList","toggleChatIsPinned","isPinned","toggleChatIsMarkedAsUnread","isMarkedAsUnread","toggleChatNotificationSettings","muteFor","newNotificationSettings","getChatCounters","photoCounter","return_local","videoCounter","documentCounter","audioCounter","urlCounter","voiceAndVideoNoteCounter","RLottie","lazy","HINTS","PICKER_HEADER","PICKER","PREVIEW","STICKER_SET","UNKNOWN","ivOpened","startStopAnimation","onClientUpdateDialogChatId","chatPopupOpened","mediaViewerOpened","profileMediaViewerOpened","onClientUpdateStickerPreview","stickerPreviewOpened","messageInView","onClientUpdateStickerSet","stickerSetOpened","onClientUpdateStickerBlob","loadContent","onClientUpdateStickerPngBlob","onClientUpdateStickerThumbnailBlob","onClientUpdateStickerThumbnailPngBlob","isAnimated","removeContent","handleMouseEnter","handleAnimationMouseEnter","lottieRef","loopCount","mouseEntered","completeLoop","handleAnimationLoopComplete","handleMouseOut","StickerStore","stickerPreview","hasError","blur","pngUrl","preview","inViewportFunc","Suspense","fallback","eventListeners","eventName","stickerStyle","onMouseEnter","onMouseOut","prevSticker","savedAnimations","animationsInView","isValidPoll","isValidQuestion","noneEmptyOptions","isValidOption","hasPollData","setPollAnswer","optionIds","option_ids","cancelPollAnswer","stopPoll","UserStatus","onUpdateUserStatus","isAccent","allow_multiple_answers","is_anonymous","isAnonymous","newType","correct_option_id","Particle","fireworks","colorType","side","typeSize","xFinished","finishedStart","rotation","moveX","moveY","ctx","fillStyle","beginPath","arc","PI","translate","rotate","radius","tl","tr","br","bl","defaultRadius","moveTo","lineTo","quadraticCurveTo","closePath","roundRect","restore","dt","moveCoef","wasNegative","speedCoef","fallingDownCount","getMeasuredHeight","Fireworks","particlesCount","fallParticlesCount","particles","fall","particle","colors","getMeasuredWidth","xOffset","yOffset","started","startedFall","lastUpdateTime","createParticle","draw","newTime","clearRect","p","startFall","FireworksComponent","onResize","canvasRef","parentNode","attachToParent","detachFromParent","removeEventListener","pointerEvents","PollRadio","chosen","beingChosen","hidden","Radio","colorPrimary","disabled","TouchRippleProps","checked","checkedIcon","CircularProgress","PollPercentage","updateAnimation","stopAnimation","handle","onAnimationFrame","startTime","to","timePassed","prevPropsValue","closed","theme","PollOption","getTitleString","canBeSelected","onVote","maxVoterCount","isCorrect","voter_count","vote_percentage","isMultiChoosen","Close","Check","LinearProgress","bar","UserPlaceholder","showStatus","titleWidth","sin","contentWidth","cos","marginLeft","PollOptionResult","User","ListItem","button","PollOptionResults","handleShowMore","newOffset","newCount","updateVoters","handleCollapse","voters","loadMore","optionId","option_id","offset2","isQuiz","results","voterCount","showMoreButton","showMoreCount","showMore","fullWidth","showCollapse","PollResultsDialog","onClientUpdateClosePollResults","handleContextMenu","PollStore","container","paper","onContextMenu","getTotalVoterCountString","handleSubmit","viewResults","handleVote","handleOpenResults","viewResultsPoll","handleCloseResults","fireworksRef","total_voter_count","recent_voter_user_ids","isSelected","showViewResults","showButton","buttonEnabled","recentVoters","marginRight","getOptionType","getOptionIsCorrect","textPrimary","sendBotStartMessage","bot_user_id","requestBlockSender","blockSender","toggleMessageSenderIsBlocked","unblockSender","isBlocked","startMessageEditing","stopMessageEditing","viewMessages","forceRead","force_read","pinMessage","disableNotification","onlyForSelf","disable_notification","only_for_self","unpinMessage","unpinAllMessages","UserTitle","showUsername","openGroupCallPanel","filters","chat_filters","altKey","ctrlKey","metaKey","shiftKey","handleSeek","handleVolume","handleMute","handleFullScreen","handlePictureInPicture","handleSeekProgress","handlePlaybackRate","showMediaHint","rate","onClientUpdateMediaShortcut","waiting","paused","handlePause","onPause","handleEnded","onEnded","handleLoadedData","handleLoadedMetadata","draggingTime","isFinite","contentRef","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","exitFullscreen","requestFullscreen","handleClickRoot","mouseDownRoot","handleMouseDownRoot","handleVolumeChange","onVolumeChange","handleVolumeSliderChange","handleVolumeSliderChangeCommitted","activeElement","prevVolume","handleProgress","handleWaiting","handleCanPlay","videoInfo","pictureInPictureElement","mozPictureInPictureElement","webkitPictureInPictureElement","exitPictureInPicture","requestPictureInPicture","onpause","handleLeavePictureInPicture","handleDoubleClick","handleVideoKeyDown","handlePanelDoubleClick","handlePanelEnter","panelEnter","handlePanelLeave","handleMouseOver","mouseOverTimeout","rootRef","noPoster","method","mozRequestFullScreen","webkitRequestFullscreen","mozCancelFullScreen","webkitExitFullscreen","mozRequestPictureInPicture","webkitRequestPictureInPicture","mozExitPictureInPicture","webkitExitPictureInPicture","poster","rootStyle","fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled","onDoubleClick","onMouseMove","controls","onLoadedMetadata","onLoadedData","onCanPlay","onProgress","onWaiting","onMouseLeave","getVolumeIcon","fillRule","mixBlendMode","DocumentAction","Download","data-name","data-ext","withLanguage","LanguageWrapper","LocalizationStore","has_location","isPublicSupergroup","utf16","extra","RangeError","encode","base","damp","tmin","tmax","skew","maxint","encode_digit","flag","adapt","delta","numpoints","firsttime","preserveCase","n","out","bias","basic","j","ic","oldi","digit","cp","case_flags","input_length","lastIndexOf","q","ijv","bcp","ToASCII","domain_array","VoiceNoteTile","Hint","onClientUpdateMediaHint","checkTimeout","handleAnimationEnd","onAnimationEnd","Progress","strokeDasharray","strokeDashoffset","strokeLinecap","circleStyle","ApplicationStore","onClientUpdateMediaCaptureStream","updateVideoSrc","videoDuration","onClientUpdateVideoNoteBlob","onClientUpdateVideoNoteThumbnailBlob","sourceRef","progressTime","factory","modules","installedModules","__webpack_require__","moduleId","exports","module","getter","defineProperty","enumerable","Symbol","toStringTag","__esModule","create","property","asyncGeneratorStep","gen","_next","_throw","done","fn","self","instance","Constructor","_defineProperties","descriptor","configurable","writable","protoProps","staticProps","_typeof2","iterator","constructor","_typeof","arrayWithHoles","iterableToArrayLimit","nonIterableRest","rng","bytesToUuid","rnds","ii","_arr","_n","_d","_e","_s","_i","runtime","Op","hasOwn","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","Context","_invoke","GenStateSuspendedStart","GenStateExecuting","GenStateCompleted","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","GenStateSuspendedYield","makeInvokeMethod","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","Gp","defineIteratorMethods","AsyncIterator","previousPromise","callInvokeWithMethodAndArg","__await","unwrapped","resultName","nextLoc","pushTryEntry","locs","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","iterable","iteratorMethod","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","iter","skipTempReset","prev","rootRecord","rval","exception","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","Function","getRandomValues","crypto","msCrypto","rnds8","byteToHex","bth","__webpack_exports__","helpers_typeof","typeof_default","slicedToArray","slicedToArray_default","regenerator","regenerator_default","asyncToGenerator","asyncToGenerator_default","classCallCheck","classCallCheck_default","createClass","createClass_default","worker_default","sleep","randomToken","possible","lastMs","additional","microSeconds","ms","browser","browser_default","methods_native","channelName","messagesCallback","bc","BroadcastChannel","subFns","msg","channelState","onMessage","messagesCallbackTime","messageJson","canBeUsed","_pubkey","averageResponseTime","ObliviousSet","Set","timeMap","oblivious_set_now","obliviousSet","olderThen","_removeTooOldValues","oblivious_set","fillOptionsWithDefaults","webWorkerSupport","idb","fallbackInterval","localstorage","removeTimeout","useFastPath","DB_PREFIX","OBJECT_STORE_ID","getIdb","mozIndexedDB","webkitIndexedDB","msIndexedDB","cleanOldMessages","ret","openCursor","ev","msgObk","getOldMessages","tooOld","msgObj","removeMessageById","readNewMessages","lastCursorId","keyRangeValue","IDBKeyRange","bound","getMessagesHigherThen","newerMessages","uuid","eMIs","_filterMessage","msgObjA","msgObjB","KEY_PREFIX","storageKey","localstorage_canBeUsed","getLocalStorage","METHODS","IndexedDB","dbName","openRequest","createObjectStore","keyPath","autoIncrement","rej","createDatabase","writeBlockPromise","readQueuePromises","_readLoop","readerUuid","writeObject","oncomplete","writeMessage","newValue","addStorageEventListener","writeObj","createEvent","initEvent","dispatchEvent","NodeMethod","chooseMethod","chooseMethods","useMethod","es_BroadcastChannel","_iL","_onML","_addEL","internal","_befC","_prepP","channel","maybePromise","_state","_prepareChannel","_post","broadcastChannel","_hasMessageListeners","_addListenerObject","listenerFn","_startListening","_removeListenerObject","_stopListening","clearNodeFolder","postInternal","listenObj","_this","awaitPrepare","v4","v4_default","logger","Logger","setVerbosity","_console","checkVerbosity","_console2","_console3","_console4","warn","_console5","level","default_level","ERROR","WARNING","INFO","LOG","DEBUG","src_sleep","src_TdClient","onResponse","query_id","query_callbacks","fileManager","src_FileManager","closeOtherClients","doSend","isExternal","_this2","externalPostMessage","deleteFile","readFile","_readFile","_callee","_context","_x","_deleteFile","_callee2","_context2","sendInternal","t0","_x2","prepareResponse","_this$query_callbacks","_this$query_callbacks2","onInited","onFsInited","onClosed","registerFile","prepareFile","field","uid","waitSet","onWaitSetEmpty","postState","isInited","doSendStart","wantSendStart","isClosing","terminate","_closeOtherClients","_callee4","_this4","_context4","onBroadcastMessage","sendStart","_x3","src_ListNode","ListNode","other","usedAt","erase","FileManager","transaction_id","totalSize","lru","_this5","cached_info","getLru","lru_info","unload","onUsed","_flushLoad","_callee5","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_loop","_iterator","_step","_context5","_this6","flushLoad","_doLoadFull","_callee6","_this7","_context6","_x4","_doLoad","_callee7","_res","data_size","_context7","doLoadFull","_x5","_x6","_x7","_readFile2","_callee8","_context8","doLoad","_x8","doDelete","OnlineStatus","online","borderSize","padding","GroupCallStatus","isEmpty","hasGroupCall","onUpdateChatVoiceChat","ChatTile","onFastUpdatingComplete","onClientUpdateChatBlob","onUpdateChatPhoto","showOnline","showGroupCall","DeletedAccount","typeId","getBadgeSelectedColor","rgb","primaryHLS","g","cmin","cmax","RGBToHSL","createTheme","primary","matchMedia","matches","MuiTouchRipple","rippleVisible","hover","hoverOpacity","createMuiTheme","palette","secondary","main","typography","useNextVariants","shape","borderRadius","overrides","MuiOutlinedInput","MuiAutocomplete","paddingLeft","paddingTop","paddingRight","paddingBottom","maxHeight","MuiButton","lineHeight","MuiMenuList","MuiList","MuiListItemIcon","alignItemsFlexStart","marginTop","MuiMenuItem","MuiSnackbarContent","flexWrap","setProperty","modal","dark","light","grey","divider","updateDarkTheme","updateLightTheme","withTheme","ThemeWrapper","onSystemThemeChange","themeOptions","onClientUpdateThemeChanging","StylesProvider","injectFirst","AuthErrorDialog","handleAuthError","errorString","_extends","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref","svgRef","ForwardRef","setCountryCode","authKey","removeItem","authorization","closeData","idleData","peekData","trackingData","lastUpdate","onClientUpdateMonkeyIdle","onClientUpdateMonkeyTracking","onClientUpdateMonkeyClose","onClientUpdateMonkeyPeek","playSegments","segments","forceFlag","getFrame","paddingFrames","letterFrames","framesCount","frames","prevCode","peek","AuthStore","control","stringData","queueLength","Country","cleanProgressStatus","isConnecting","isWhitelistKey","Phone","onClientUpdateCountryCode","getPhoneCountry","onUpdateConnectionState","connecting","onClientUpdateSetPhoneCanceled","loading","onClientUpdateSetPhoneError","onClientUpdateSetPhoneResult","onUpdateOption","setSuggestedLanguagePackId","handleKeyPress","handleDone","isBad","isValidPhoneNumber","handleChangeLanguage","suggestedLanguage","nextLanguage","handleFilterOptions","inputValue","names","handleCountryChange","nextCountry","prevPhone","nextPhone","trimStart","phoneInputRef","focus","handleKeepChange","keep","handlePhoneChange","phone1","phone2","handlePaste","plainText","clipboardData","getData","execCommand","handleQRCode","onRequestQRCode","getCountryFromCode","languagePackId","autoComplete","Typography","Autocomplete","noOptionsText","autoHighlight","getOptionLabel","renderOption","renderInput","TextField","inputProps","filterOptions","inputRef","helperText","autoFocus","onKeyPress","onPaste","Checkbox","disableElevation","Link","Code","handleNext","isValid","finally","handleBack","onChangePhone","codeLength","codeInfo","getPhoneNumber","getCodeLength","getSubtitle","maxLength","PureComponent","QRCode","showConnecting","qrCode","QRCodeStyling","dotsOptions","backgroundOptions","append","Password","password","handleMouseDownPassword","handleClickShowPassword","showPassword","sendMonkeyPeek","passwordHint","FormControl","InputLabel","htmlFor","OutlinedInput","endAdornment","InputAdornment","edge","labelWidth","FormHelperText","AuthForm","terms_of_service","code_info","termsOfService","password_hint","has_recovery_email_address","recovery_email_address_pattern","hasRecoveryEmailAddress","recoveryEmailAddressPattern","AppInactive","handleReload","InactivePage","NativeApp","handleInstall","NativeAppPage","MainPage","TelegramApp","keyCode","isComposing","keyMap","FilterStore","modals","editMessageId","replyMessageId","onClientUpdateEditMessage","onClientUpdateReply","onClientUpdateTdLibDatabaseExists","tdlibDatabaseExists","checkServiceWorker","registerServiceWorker","onUpdateFatalError","fatalError","prevAuthorizationState","onClientUpdateAppInactive","inactive","handleChangePhone","changePhone","handleRequestQRCode","handleDragOver","handleDrop","handleRefresh","handleDestroy","AuthorizationStore","nativeMobile","isSmall","keyboardHandler","KeyboardManager","page","onDragOver","onDrop","aria-describedby","onblur","onfocus","pushState","onpopstate","go","withTelegramTheme"],"mappings":"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","file":"static/js/main.23165f80.chunk.js","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from '../Stores/EventEmitter';\nimport packageJson from '../../package.json';\nimport { stringToBoolean, getBrowser, getOSName } from '../Utils/Common';\nimport {\n    DATABASE_NAME, DATABASE_TEST_NAME,\n    VERBOSITY_JS_MAX,\n    VERBOSITY_JS_MIN,\n    VERBOSITY_MAX,\n    VERBOSITY_MIN,\n    WASM_FILE_HASH,\n    WASM_FILE_NAME\n} from '../Constants';\n// import TdClient from 'tdweb/dist/tdweb';\nimport TdClient from '@arseny30/tdweb/dist/tdweb';\n\nfunction databaseExists(dbname, callback) {\n    var req = indexedDB.open(dbname);\n    var existed = true;\n    req.onsuccess = function() {\n        req.result.close();\n        if (!existed) indexedDB.deleteDatabase(dbname);\n        callback(existed);\n    };\n    req.onupgradeneeded = function() {\n        existed = false;\n    };\n}\n\nclass TdLibController extends EventEmitter {\n    constructor() {\n        super();\n\n        this.parameters = {\n            useTestDC: false,\n            readOnly: false,\n            verbosity: 1,\n            jsVerbosity: 3,\n            fastUpdating: true,\n            useDatabase: false,\n            mode: 'wasm'\n        };\n\n        this.disableLog = true;\n        this.streaming = true;\n\n        this.setParameters(window.location);\n    }\n\n    init = () => {\n        const { verbosity, jsVerbosity, useTestDC, readOnly, fastUpdating, useDatabase, mode } = this.parameters;\n        const instanceName = useTestDC ? DATABASE_TEST_NAME : DATABASE_NAME;\n\n        databaseExists(instanceName, exists => {\n            this.clientUpdate({ '@type': 'clientUpdateTdLibDatabaseExists', exists });\n\n            let options = {\n                logVerbosityLevel: verbosity,\n                jsLogVerbosityLevel: jsVerbosity,\n                mode, // 'wasm-streaming', 'wasm', 'asmjs'\n                instanceName,\n                readOnly,\n                isBackground: false,\n                useDatabase,\n                wasmUrl: `${WASM_FILE_NAME}?_sw-precache=${WASM_FILE_HASH}`\n                // onUpdate: update => this.emit('update', update)\n            };\n\n            console.log(\n                `[TdLibController] (fast_updating=${fastUpdating}) Start client with params=${JSON.stringify(options)}`\n            );\n\n            this.client = new TdClient(options);\n            this.client.onUpdate = update => {\n                if (!this.disableLog) {\n                    if (update['@type'] === 'updateFile') {\n                        console.log('receive updateFile file_id=' + update.file.id, update);\n                    } else {\n                        console.log('receive update', update);\n                    }\n                }\n                this.emit('update', update);\n            };\n        });\n    };\n\n    clientUpdate = update => {\n        if (!this.disableLog) {\n            console.log('clientUpdate', update);\n        }\n        this.emit('clientUpdate', update);\n    };\n\n    setParameters = location => {\n        if (!location) return;\n\n        const { search } = location;\n        if (!search) return;\n\n        const params = new URLSearchParams(search.toLowerCase());\n\n        if (params.has('test')) {\n            this.parameters.useTestDC = stringToBoolean(params.get('test'));\n        }\n\n        if (params.has('verbosity')) {\n            const verbosity = parseInt(params.get('verbosity'), 10);\n            if (verbosity >= VERBOSITY_MIN && verbosity <= VERBOSITY_MAX) {\n                this.parameters.verbosity = verbosity;\n            }\n        }\n\n        if (params.has('jsverbosity')) {\n            const jsVerbosity = parseInt(params.get('jsverbosity'), 10);\n            if (jsVerbosity >= VERBOSITY_JS_MIN && jsVerbosity <= VERBOSITY_JS_MAX) {\n                this.parameters.jsVerbosity = jsVerbosity;\n            }\n        }\n\n        if (params.has('tag') && params.has('tagverbosity')) {\n            const tag = params\n                .get('tag')\n                .replace('[', '')\n                .replace(']', '')\n                .split(',');\n            const tagVerbosity = params\n                .get('tagverbosity')\n                .replace('[', '')\n                .replace(']', '')\n                .split(',');\n            if (tag && tagVerbosity && tag.length === tagVerbosity.length) {\n                this.parameters.tag = tag;\n                this.parameters.tagVerbosity = tagVerbosity;\n            }\n        }\n\n        if (params.has('readonly')) {\n            this.parameters.readOnly = stringToBoolean(params.get('readonly'));\n        }\n\n        if (params.has('fastupdating')) {\n            this.parameters.fastUpdating = stringToBoolean(params.get('fastupdating'));\n        }\n\n        if (params.has('db')) {\n            this.parameters.useDatabase = stringToBoolean(params.get('db'));\n        }\n        if (params.has('mode')) {\n            this.parameters.mode = params.get('mode');\n        }\n        if (params.has('clientlog')) {\n            this.disableLog = !stringToBoolean(params.get('clientlog'));\n        }\n        if (params.has('streaming')) {\n            this.streaming = stringToBoolean(params.get('streaming'));\n        }\n    };\n\n    send = request => {\n        if (!this.client) {\n            console.log('send (none init)', request);\n            return Promise.reject('tdweb client is not ready yet');\n        }\n\n        if (!this.disableLog) {\n            console.log('send', request);\n\n            return this.client\n                .send(request)\n                .then(result => {\n                    console.log('send result', result);\n                    return result;\n                })\n                .catch(error => {\n                    console.error('send error', error);\n\n                    throw error;\n                });\n        } else {\n            return this.client.send(request);\n        }\n    };\n\n    sendTdParameters = async () => {\n        const apiId = process.env.REACT_APP_TELEGRAM_API_ID;\n        const apiHash = process.env.REACT_APP_TELEGRAM_API_HASH;\n\n        // console.log('[td] sendTdParameters', apiHash, apiId);\n        if (!apiId || !apiHash) {\n            if (\n                window.confirm(\n                    'API id is missing!\\n' +\n                        'In order to obtain an API id and develop your own application ' +\n                        'using the Telegram API please visit https://core.telegram.org/api/obtaining_api_id'\n                )\n            ) {\n                window.location.href = 'https://core.telegram.org/api/obtaining_api_id';\n            }\n        }\n\n        const { useTestDC } = this.parameters;\n        const { version } = packageJson;\n\n        this.send({\n            '@type': 'setTdlibParameters',\n            parameters: {\n                '@type': 'tdParameters',\n                use_test_dc: useTestDC,\n                api_id: apiId,\n                api_hash: apiHash,\n                system_language_code: navigator.language || 'en',\n                device_model: getBrowser(),\n                system_version: getOSName(),\n                application_version: version,\n                use_secret_chats: false,\n                use_message_database: true,\n                use_file_database: false,\n                database_directory: '/db',\n                files_directory: '/'\n            }\n            // ,\n            // extra: {\n            //     a: ['a', 'b'],\n            //     b: 123\n            // }\n        });\n\n        this.send({\n            '@type': 'setOption',\n            name: 'use_quick_ack',\n            value: {\n                '@type': 'optionValueBoolean',\n                value: true\n            }\n        });\n\n        if (this.parameters.tag && this.parameters.tagVerbosity) {\n            for (let i = 0; i < this.parameters.tag.length; i++) {\n                let tag = this.parameters.tag[i];\n                let tagVerbosity = this.parameters.tagVerbosity[i];\n\n                this.send({\n                    '@type': 'setLogTagVerbosityLevel',\n                    tag: tag,\n                    new_verbosity_level: tagVerbosity\n                });\n            }\n        }\n    };\n\n    logOut() {\n        this.send({ '@type': 'logOut' }).catch(error => {\n            this.emit('tdlib_auth_error', error);\n        });\n    }\n\n    setChatId = (chatId, messageId = null, options = { }) => {\n        const update = {\n            '@type': 'clientUpdateChatId',\n            chatId,\n            messageId,\n            options\n        };\n\n        this.clientUpdate(update);\n    };\n\n    setMediaViewerContent(content) {\n        this.clientUpdate({\n            '@type': 'clientUpdateMediaViewerContent',\n            content: content\n        });\n    }\n}\n\nconst controller = new TdLibController();\nwindow.controller = controller;\nexport default controller;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/// This file based on https://github.com/DrKLO/Telegram/blob/master/TMessagesProj/src/main/java/org/telegram/messenger/LocaleController.java\n\nexport const QuantityEnum = Object.freeze({\n    QUANTITY_OTHER: 0x0000,\n    QUANTITY_ZERO: 0x0001,\n    QUANTITY_ONE: 0x0002,\n    QUANTITY_TWO: 0x0004,\n    QUANTITY_FEW: 0x0008,\n    QUANTITY_MANY: 0x0010\n});\n\nexport class PluralRules {\n    quantityForNumber(count) {\n        return undefined;\n    }\n}\n\nexport class PluralRules_Zero {\n    quantityForNumber(count) {\n        if (count === 0 || count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Welsh {\n    quantityForNumber(count) {\n        if (count === 0) {\n            return QuantityEnum.QUANTITY_ZERO;\n        } else if (count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (count === 2) {\n            return QuantityEnum.QUANTITY_TWO;\n        } else if (count === 3) {\n            return QuantityEnum.QUANTITY_FEW;\n        } else if (count === 6) {\n            return QuantityEnum.QUANTITY_MANY;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Two {\n    quantityForNumber(count) {\n        if (count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (count === 2) {\n            return QuantityEnum.QUANTITY_TWO;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Tachelhit {\n    quantityForNumber(count) {\n        if (count >= 0 && count <= 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (count >= 2 && count <= 10) {\n            return QuantityEnum.QUANTITY_FEW;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Slovenian {\n    quantityForNumber(count) {\n        const rem100 = count % 100;\n        if (rem100 === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (rem100 === 2) {\n            return QuantityEnum.QUANTITY_TWO;\n        } else if (rem100 >= 3 && rem100 <= 4) {\n            return QuantityEnum.QUANTITY_FEW;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Romanian {\n    quantityForNumber(count) {\n        const rem100 = count % 100;\n        if (count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if ((count === 0 || (rem100 >= 1 && rem100 <= 19))) {\n            return QuantityEnum.QUANTITY_FEW;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Polish {\n    quantityForNumber(count) {\n        const rem100 = count % 100;\n        const rem10 = count % 10;\n        if (count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (rem10 >= 2 && rem10 <= 4 && !(rem100 >= 12 && rem100 <= 14)) {\n            return QuantityEnum.QUANTITY_FEW;\n        } else if (rem10 >= 0 && rem10 <= 1 || rem10 >= 5 && rem10 <= 9 || rem100 >= 12 && rem100 <= 14) {\n            return QuantityEnum.QUANTITY_MANY;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_One {\n    quantityForNumber(count) {\n        return count === 1 ? QuantityEnum.QUANTITY_ONE : QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_None {\n    quantityForNumber(count) {\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Maltese {\n    quantityForNumber(count) {\n        const rem100 = count % 100;\n        if (count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (count === 0 || (rem100 >= 2 && rem100 <= 10)) {\n            return QuantityEnum.QUANTITY_FEW;\n        } else if (rem100 >= 11 && rem100 <= 19) {\n            return QuantityEnum.QUANTITY_MANY;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Macedonian {\n    quantityForNumber(count) {\n        if (count % 10 === 1 && count !== 11) {\n            return QuantityEnum.QUANTITY_ONE;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Lithuanian {\n    quantityForNumber(count) {\n        const rem100 = count % 100;\n        const rem10 = count % 10;\n        if (rem10 === 1 && !(rem100 >= 11 && rem100 <= 19)) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (rem10 >= 2 && rem10 <= 9 && !(rem100 >= 11 && rem100 <= 19)) {\n            return QuantityEnum.QUANTITY_FEW;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Latvian {\n    quantityForNumber(count) {\n        if (count === 0) {\n            return QuantityEnum.QUANTITY_ZERO;\n        } else if (count % 10 === 1 && count % 100 !== 11) {\n            return QuantityEnum.QUANTITY_ONE;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Langi {\n    quantityForNumber(count) {\n        if (count === 0) {\n            return QuantityEnum.QUANTITY_ZERO;\n        } else if (count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_French {\n    quantityForNumber(count) {\n        if (count >= 0 && count < 2) {\n            return QuantityEnum.QUANTITY_ONE;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Czech {\n    quantityForNumber(count) {\n        if (count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (count >= 2 && count <= 4) {\n            return QuantityEnum.QUANTITY_FEW;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Breton {\n    quantityForNumber(count) {\n        if (count === 0) {\n            return QuantityEnum.QUANTITY_ZERO;\n        } else if (count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (count === 2) {\n            return QuantityEnum.QUANTITY_TWO;\n        } else if (count === 3) {\n            return QuantityEnum.QUANTITY_FEW;\n        } else if (count === 6) {\n            return QuantityEnum.QUANTITY_MANY;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Balkan {\n    quantityForNumber(count) {\n        const rem100 = count % 100;\n        const rem10 = count % 10;\n        if (rem10 === 1 && rem100 !== 11) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (rem10 >= 2 && rem10 <= 4 && !(rem100 >= 12 && rem100 <= 14)) {\n            return QuantityEnum.QUANTITY_FEW;\n        } else if ((rem10 === 0 || (rem10 >= 5 && rem10 <= 9) || (rem100 >= 11 && rem100 <= 14))) {\n            return QuantityEnum.QUANTITY_MANY;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Serbian {\n    quantityForNumber(count) {\n        const rem100 = count % 100;\n        const rem10 = count % 10;\n        if (rem10 === 1 && rem100 !== 11) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (rem10 >= 2 && rem10 <= 4 && !(rem100 >= 12 && rem100 <= 14)) {\n            return QuantityEnum.QUANTITY_FEW;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nexport class PluralRules_Arabic {\n    quantityForNumber(count) {\n        const rem100 = count % 100;\n        if (count === 0) {\n            return QuantityEnum.QUANTITY_ZERO;\n        } else if (count === 1) {\n            return QuantityEnum.QUANTITY_ONE;\n        } else if (count === 2) {\n            return QuantityEnum.QUANTITY_TWO;\n        } else if (rem100 >= 3 && rem100 <= 10) {\n            return QuantityEnum.QUANTITY_FEW;\n        } else if (rem100 >= 11 && rem100 <= 99) {\n            return QuantityEnum.QUANTITY_MANY;\n        }\n\n        return QuantityEnum.QUANTITY_OTHER;\n    }\n}\n\nconst re = {\n    not_string: /[^s]/,\n    number: /[diefg]/,\n    json: /[j]/,\n    not_json: /[^j]/,\n    text: /^[^\\x25]+/,\n    modulo: /^\\x25{2}/,\n    placeholder: /^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-gijosuxX])/,\n    key: /^([a-z_][a-z_\\d]*)/i,\n    key_access: /^\\.([a-z_][a-z_\\d]*)/i,\n    index_access: /^\\[(\\d+)\\]/,\n    sign: /^[\\+\\-]/\n}\n\nexport function sprintf() {\n    const key = arguments[0], cache = sprintf.cache\n    if (!(cache[key] && cache.hasOwnProperty(key))) {\n        cache[key] = sprintf.parse(key)\n    }\n    return sprintf.format.call(null, cache[key], arguments)\n}\n\nsprintf.format = function(parse_tree, argv) {\n    var cursor = 1, tree_length = parse_tree.length, node_type = \"\", arg, output = [], i, k, match, pad, pad_character, pad_length, is_positive = true, sign = \"\"\n    for (i = 0; i < tree_length; i++) {\n        node_type = get_type(parse_tree[i])\n        if (node_type === \"string\") {\n            output[output.length] = parse_tree[i]\n        }\n        else if (node_type === \"array\") {\n            match = parse_tree[i] // convenience purposes only\n            if (match[2]) { // keyword argument\n                arg = argv[cursor]\n                for (k = 0; k < match[2].length; k++) {\n                    if (!arg.hasOwnProperty(match[2][k])) {\n                        throw new Error(sprintf(\"[sprintf] property '%s' does not exist\", match[2][k]))\n                    }\n                    arg = arg[match[2][k]]\n                }\n            }\n            else if (match[1]) { // positional argument (explicit)\n                arg = argv[match[1]]\n            }\n            else { // positional argument (implicit)\n                arg = argv[cursor++]\n            }\n\n            if (get_type(arg) == \"function\") {\n                arg = arg()\n            }\n\n            if (re.not_string.test(match[8]) && re.not_json.test(match[8]) && (get_type(arg) !== \"number\" && isNaN(arg))) {\n                throw new TypeError(sprintf(\"[sprintf] expecting number but found %s\", get_type(arg)))\n            }\n\n            if (re.number.test(match[8])) {\n                is_positive = arg >= 0\n            }\n\n            switch (match[8]) {\n                case \"b\":\n                    arg = arg.toString(2)\n                    break\n                case \"c\":\n                    arg = String.fromCharCode(arg)\n                    break\n                case \"d\":\n                case \"i\":\n                    arg = parseInt(arg, 10)\n                    break\n                case \"j\":\n                    arg = JSON.stringify(arg, null, match[6] ? parseInt(match[6]) : 0)\n                    break\n                case \"e\":\n                    arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential()\n                    break\n                case \"f\":\n                    arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg)\n                    break\n                case \"g\":\n                    arg = match[7] ? parseFloat(arg).toPrecision(match[7]) : parseFloat(arg)\n                    break\n                case \"o\":\n                    arg = arg.toString(8)\n                    break\n                case \"s\":\n                    arg = ((arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg)\n                    break\n                case \"u\":\n                    arg = arg >>> 0\n                    break\n                case \"x\":\n                    arg = arg.toString(16)\n                    break\n                case \"X\":\n                    arg = arg.toString(16).toUpperCase()\n                    break\n            }\n            if (re.json.test(match[8])) {\n                output[output.length] = arg\n            }\n            else {\n                if (re.number.test(match[8]) && (!is_positive || match[3])) {\n                    sign = is_positive ? \"+\" : \"-\"\n                    arg = arg.toString().replace(re.sign, \"\")\n                }\n                else {\n                    sign = \"\"\n                }\n                pad_character = match[4] ? match[4] === \"0\" ? \"0\" : match[4].charAt(1) : \" \"\n                pad_length = match[6] - (sign + arg).length\n                pad = match[6] ? (pad_length > 0 ? str_repeat(pad_character, pad_length) : \"\") : \"\"\n                output[output.length] = match[5] ? sign + arg + pad : (pad_character === \"0\" ? sign + pad + arg : pad + sign + arg)\n            }\n        }\n    }\n    return output.join(\"\")\n}\n\nsprintf.cache = {}\n\nsprintf.parse = function(fmt) {\n    let _fmt = fmt, match = [], parse_tree = [], arg_names = 0\n    while (_fmt) {\n        if ((match = re.text.exec(_fmt)) !== null) {\n            parse_tree[parse_tree.length] = match[0]\n        }\n        else if ((match = re.modulo.exec(_fmt)) !== null) {\n            parse_tree[parse_tree.length] = \"%\"\n        }\n        else if ((match = re.placeholder.exec(_fmt)) !== null) {\n            if (match[2]) {\n                arg_names |= 1\n                var field_list = [], replacement_field = match[2], field_match = []\n                if ((field_match = re.key.exec(replacement_field)) !== null) {\n                    field_list[field_list.length] = field_match[1]\n                    while ((replacement_field = replacement_field.substring(field_match[0].length)) !== \"\") {\n                        if ((field_match = re.key_access.exec(replacement_field)) !== null) {\n                            field_list[field_list.length] = field_match[1]\n                        }\n                        else if ((field_match = re.index_access.exec(replacement_field)) !== null) {\n                            field_list[field_list.length] = field_match[1]\n                        }\n                        else {\n                            throw new SyntaxError(\"[sprintf] failed to parse named argument key\")\n                        }\n                    }\n                }\n                else {\n                    throw new SyntaxError(\"[sprintf] failed to parse named argument key\")\n                }\n                match[2] = field_list\n            }\n            else {\n                arg_names |= 2\n            }\n            if (arg_names === 3) {\n                throw new Error(\"[sprintf] mixing positional and named placeholders is not (yet) supported\")\n            }\n            parse_tree[parse_tree.length] = match\n        }\n        else {\n            throw new SyntaxError(\"[sprintf] unexpected placeholder\")\n        }\n        _fmt = _fmt.substring(match[0].length)\n    }\n    return parse_tree\n}\n\nexport function vsprintf(fmt, argv, _argv) {\n    _argv = (argv || []).slice(0)\n    _argv.splice(0, 0, fmt)\n    return sprintf.apply(null, _argv)\n}\n\n/**\n * helpers\n */\nfunction get_type(variable) {\n    return Object.prototype.toString.call(variable).slice(8, -1).toLowerCase()\n}\n\nfunction str_repeat(input, multiplier) {\n    return Array(multiplier + 1).join(input)\n}\n\nexport const sprintfPostprocessor = {\n    name: 'sprintf',\n    type: 'postProcessor',\n\n    process(value, key, options) {\n        if (!options.sprintf) return value;\n\n        if (Object.prototype.toString.apply(options.sprintf) === '[object Array]') {\n            return vsprintf(value, options.sprintf);\n        } else if (typeof options.sprintf === 'object') {\n            return sprintf(value, options.sprintf);\n        }\n\n        return value;\n    },\n\n    overloadTranslationOptionHandler(args) {\n        let values = [];\n\n        for (var i = 1; i < args.length; i++) {\n            values.push(args[i]);\n        }\n\n        return {\n            postProcess: 'sprintf',\n            sprintf: values\n        };\n    }\n};","class Storage {\n    constructor(options) {\n        this.store = options.store;\n    }\n\n    setItem(key, value) {\n        if (!this.store) return;\n\n        try {\n            this.store.setItem(key, value);\n        } catch (e) {}\n    }\n\n    getItem(key, value) {\n        if (!this.store) return;\n\n        try {\n            return this.store.getItem(key, value);\n        } catch (e) {}\n\n        return undefined;\n    }\n}\n\nfunction getDefaults() {\n    return {\n        prefix: 'i18next_res_',\n        expirationTime: Infinity,\n        versions: {},\n        store: window.localStorage\n    };\n}\n\nclass Cache {\n    constructor(services, options = {}) {\n        this.init(services, options);\n\n        this.type = 'backend';\n    }\n\n    init(services, options = {}) {\n        this.services = services;\n        this.options = { ...getDefaults(), ...this.options, ...options };\n        this.storage = new Storage(this.options);\n    }\n\n    read(language, namespace, callback) {\n        const nowMS = new Date().getTime();\n\n        if (!this.storage.store) {\n            return callback(null, null);\n        }\n\n        let local = this.storage.getItem(`${this.options.prefix}${language}-${namespace}`);\n\n        if (local) {\n            local = JSON.parse(local);\n            if (\n                // expiration field is mandatory, and should not be expired\n                local.i18nStamp &&\n                local.i18nStamp + this.options.expirationTime > nowMS &&\n                // there should be no language version set, or if it is, it should match the one in translation\n                this.options.versions[language] === local.i18nVersion\n            ) {\n                delete local.i18nVersion;\n                delete local.i18nStamp;\n                return callback(null, local);\n            }\n        }\n\n        return callback(null, null);\n    }\n\n    save(language, namespace, data) {\n        if (this.storage.store) {\n            data.i18nStamp = new Date().getTime();\n\n            // language version (if set)\n            if (this.options.versions[language]) {\n                data.i18nVersion = this.options.versions[language];\n            }\n\n            // save\n            this.storage.setItem(`${this.options.prefix}${language}-${namespace}`, JSON.stringify(data));\n        }\n    }\n}\n\nCache.type = 'backend';\n\nexport default Cache;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport EventEmitter from './EventEmitter';\nimport i18n from 'i18next';\nimport { sprintfPostprocessor, sprintf } from '../Utils/Localization';\nimport LocalizationCache from '../Localization/Cache';\nimport { initReactI18next } from 'react-i18next';\nimport {\n    PluralRules_Arabic,\n    PluralRules_Balkan,\n    PluralRules_Breton,\n    PluralRules_Czech,\n    PluralRules_French,\n    PluralRules_Langi,\n    PluralRules_Latvian,\n    PluralRules_Lithuanian,\n    PluralRules_Macedonian,\n    PluralRules_Maltese,\n    PluralRules_None,\n    PluralRules_One,\n    PluralRules_Polish,\n    PluralRules_Romanian,\n    PluralRules_Serbian,\n    PluralRules_Slovenian,\n    PluralRules_Tachelhit,\n    PluralRules_Two,\n    PluralRules_Welsh,\n    PluralRules_Zero,\n    QuantityEnum\n} from '../Utils/Localization';\nimport en from '../Resources/en/translation.json';\nimport ru from '../Resources/ru/translation.json';\nimport it from '../Resources/it/translation.json';\nimport es from '../Resources/es/translation.json';\nimport pl from '../Resources/pl/translation.json';\nimport TdLibController from '../Controllers/TdLibController';\nimport { getSimpleMarkupEntities } from '../Utils/Message';\n\nconst fallbackLng = 'en';\nconst defaultNS = 'translation';\nconst lng = localStorage.getItem('i18next') || fallbackLng;\n\ni18n\n    .use(initReactI18next)\n    .use(sprintfPostprocessor)\n    .init({\n        ns: [defaultNS, 'local'],\n        defaultNS,\n        fallbackNS: ['local'],\n        resources: {\n            en: { local: en },\n            ru: { local: ru },\n            it: { local: it },\n            es: { local: es },\n            pl: { local: pl },\n        },\n        lng,\n        fallbackLng,\n        interpolation: {\n            escapeValue: false\n        },\n        react: {\n            wait: false\n        }\n    });\n\nconst cache = new LocalizationCache(null, {\n    enabled: true,\n    prefix: 'i18next_res_',\n    expirationTime: Infinity\n});\n\nconst defaultResources = cache.read(fallbackLng, defaultNS, (err, data) => data);\nconst currentResources = cache.read(lng, defaultNS, (err, data) => data);\n\ni18n.addResourceBundle(fallbackLng, defaultNS, defaultResources);\ni18n.addResourceBundle(lng, defaultNS, currentResources);\n\nclass LocalizationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.fallbackLng = fallbackLng;\n        this.i18n = i18n;\n        this.cache = cache;\n        this.allRules = new Map();\n\n        this.addRules([\"bem\", \"brx\", \"da\", \"de\", \"el\", \"en\", \"eo\", \"es\", \"et\", \"fi\", \"fo\", \"gl\", \"he\", \"iw\", \"it\", \"nb\",\n            \"nl\", \"nn\", \"no\", \"sv\", \"af\", \"bg\", \"bn\", \"ca\", \"eu\", \"fur\", \"fy\", \"gu\", \"ha\", \"is\", \"ku\",\n            \"lb\", \"ml\", \"mr\", \"nah\", \"ne\", \"om\", \"or\", \"pa\", \"pap\", \"ps\", \"so\", \"sq\", \"sw\", \"ta\", \"te\",\n            \"tk\", \"ur\", \"zu\", \"mn\", \"gsw\", \"chr\", \"rm\", \"pt\", \"an\", \"ast\"], new PluralRules_One())\n        this.addRules([\"cs\", \"sk\"], new PluralRules_Czech());\n        this.addRules([\"ff\", \"fr\", \"kab\"], new PluralRules_French());\n        this.addRules([\"ru\", \"uk\", \"be\", \"sh\"], new PluralRules_Balkan());\n        this.addRules([\"sr\", \"hr\", \"bs\"], new PluralRules_Serbian());\n        this.addRules([\"lv\"], new PluralRules_Latvian());\n        this.addRules([\"lt\"], new PluralRules_Lithuanian());\n        this.addRules([\"pl\"], new PluralRules_Polish());\n        this.addRules([\"ro\", \"mo\"], new PluralRules_Romanian());\n        this.addRules([\"sl\"], new PluralRules_Slovenian());\n        this.addRules([\"ar\"], new PluralRules_Arabic());\n        this.addRules([\"mk\"], new PluralRules_Macedonian());\n        this.addRules([\"cy\"], new PluralRules_Welsh());\n        this.addRules([\"br\"], new PluralRules_Breton());\n        this.addRules([\"lag\"], new PluralRules_Langi());\n        this.addRules([\"shi\"], new PluralRules_Tachelhit());\n        this.addRules([\"mt\"], new PluralRules_Maltese());\n        this.addRules([\"ga\", \"se\", \"sma\", \"smi\", \"smj\", \"smn\", \"sms\"], new PluralRules_Two());\n        this.addRules([\"ak\", \"am\", \"bh\", \"fil\", \"tl\", \"guw\", \"hi\", \"ln\", \"mg\", \"nso\", \"ti\", \"wa\"], new PluralRules_Zero());\n        this.addRules([\"az\", \"bm\", \"fa\", \"ig\", \"hu\", \"ja\", \"kde\", \"kea\", \"ko\", \"my\", \"ses\", \"sg\", \"to\",\n            \"tr\", \"vi\", \"wo\", \"yo\", \"zh\", \"bo\", \"dz\", \"id\", \"jv\", \"jw\", \"ka\", \"km\", \"kn\", \"ms\", \"th\", \"in\"], new PluralRules_None());\n\n        this.set24HourFormat();\n        this.updatePluralRules();\n        this.recreateFormatters();\n\n        i18n.on('languageChanged', () => {\n            this.updatePluralRules();\n            this.recreateFormatters();\n        });\n\n        this.addTdLibListener();\n    }\n\n    set24HourFormat() {\n        try {\n            this.is24HourFormat = !Intl.DateTimeFormat([], { hour: 'numeric' }).resolvedOptions().hour12;\n        } catch (e) {\n            this.is24HourFormat = false;\n        }\n    }\n\n    updatePluralRules() {\n        const index = i18n.language.indexOf('-');\n        const langCode = index !== -1 ? i18n.language.substring(0, index) : i18n.language;\n        this.currentPluralRules = this.allRules.get(langCode) || this.allRules.get(fallbackLng);\n    }\n\n    recreateFormatters() {\n        this.formatterDay = this.is24HourFormat ? (this.getString('formatterDay24H') || 'HH:mm') : (this.getString('formatterDay12H') || 'h:mm a');\n        this.formatterDayMonth = this.getString('formatterMonth') || 'd MMM';\n        this.formatterYear = this.getString('formatterYear') || 'dd.MM.yy';\n    }\n\n    addRules(languages, rules) {\n        languages.forEach(x => this.allRules.set(x, rules));\n    }\n\n    stringForQuantity(quantity) {\n        switch (quantity) {\n            case QuantityEnum.QUANTITY_ZERO:\n                return 'Z';\n            case QuantityEnum.QUANTITY_ONE:\n                return 'O';\n            case QuantityEnum.QUANTITY_TWO:\n                return 'T';\n            case QuantityEnum.QUANTITY_FEW:\n                return 'F';\n            case QuantityEnum.QUANTITY_MANY:\n                return 'M';\n            default:\n                return 'OT';\n        }\n    }\n\n    formatPluralString(key, plural) {\n        if (!key || !this.currentPluralRules) {\n            return 'LOC_ERR: ' + key;\n        }\n\n        const pluralKey = key + this.stringForQuantity(this.currentPluralRules.quantityForNumber(plural));\n\n        return this.formatString(pluralKey, plural);\n    }\n\n    formatString(key, ...args) {\n        return i18n.t(key, { postProcess: 'sprintf', sprintf: args });\n    }\n\n    format(str, ...args) {\n        return sprintf(str, ...args);\n    }\n\n    getString(key) {\n        return i18n.t(key);\n    }\n\n    replace(str, key, obj) {\n        const index = str.indexOf(key);\n        if (index === -1) return str;\n\n        return [str.substring(0, index), obj, str.substring(index + key.length)];\n    }\n\n    replaceTwo(str, key1, obj1, key2, obj2) {\n        let first = { index: str.indexOf(key1), key: key1, obj: obj1 };\n        let second = { index: str.indexOf(key2), key: key2, obj: obj2 };\n        if (first.index > second.index) {\n            const temp = first;\n            first = second;\n            second = temp;\n        }\n\n        if (first.index === -1 && second.index === -1) return str;\n\n        if (first.index === -1) {\n            return this.replace(str, second.key, second.obj);\n        } else if (second.index === -1) {\n            return this.replace(str, first.key, first.obj);\n        }\n\n        return [str.substring(0, first.index), first.obj, str.substring(first.index + first.key.length, second.index), second.obj, str.substring(second.index + second.key.length)];\n    }\n\n    formatShortNumber = (number, rounded) => {\n\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    onUpdate = async update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                switch (update.authorization_state['@type']) {\n                    case 'authorizationStateWaitTdlibParameters':\n                        TdLibController.send({\n                            '@type': 'setOption',\n                            name: 'localization_target',\n                            value: { '@type': 'optionValueString', value: 'android' }\n                        });\n\n                        TdLibController.send({\n                            '@type': 'setOption',\n                            name: 'language_pack_id',\n                            value: { '@type': 'optionValueString', value: lng }\n                        });\n\n                        this.info = await TdLibController.send({\n                            '@type': 'getLocalizationTargetInfo',\n                            only_local: false\n                        });\n\n                        TdLibController.clientUpdate({\n                            '@type': 'clientUpdateLanguageChange',\n                            language: lng\n                        });\n                        break;\n                }\n                break;\n            }\n            case 'updateLanguagePackStrings': {\n                // add/remove new strings\n\n                this.emit('updateLanguagePackStrings', update);\n                break;\n            }\n        }\n    };\n\n    onClientUpdate = async update => {\n        switch (update['@type']) {\n            case 'clientUpdateLanguageChange': {\n                let { language } = update;\n\n                let langCode = language;\n                const countryCodeIndex = language.indexOf('-');\n                if (countryCodeIndex !== -1) {\n                    langCode = language.substring(0, countryCodeIndex);\n                    language = langCode + language.substr(countryCodeIndex).toUpperCase();\n                }\n\n                await this.loadLanguage(language);\n\n                localStorage.setItem('i18next', language);\n\n                await i18n.changeLanguage(language);\n\n                TdLibController.send({\n                    '@type': 'setOption',\n                    name: 'language_pack_id',\n                    value: { '@type': 'optionValueString', value: language }\n                });\n\n                this.emit('clientUpdateLanguageChange', update);\n                break;\n            }\n        }\n    };\n\n    processStrings = (lng, languagePackStrings) => {\n        if (!languagePackStrings) return {};\n        const { strings } = languagePackStrings;\n        if (!strings) return {};\n\n        let result = {};\n        for (let i = 0; i < strings.length; i++) {\n            const { value } = strings[i];\n            switch (value['@type']) {\n                case 'languagePackStringValueOrdinary': {\n                    result[strings[i].key] = value.value;\n                    break;\n                }\n                case 'languagePackStringValuePluralized': {\n                    if (value.zero_value) {\n                        result[strings[i].key + 'Z'] = value.zero_value;\n                    }\n                    if (value.one_value) {\n                        result[strings[i].key + 'O'] = value.one_value;\n                    }\n                    if (value.two_value) {\n                        result[strings[i].key + 'T'] = value.two_value;\n                    }\n                    if (value.few_value) {\n                        result[strings[i].key + 'F'] = value.few_value;\n                    }\n                    if (value.many_value) {\n                        result[strings[i].key + 'M'] = value.many_value;\n                    }\n                    if (value.other_value) {\n                        result[strings[i].key + 'OT'] = value.other_value;\n                    }\n                    break;\n                }\n                case 'languagePackStringValueDeleted': {\n                    break;\n                }\n            }\n        }\n\n        return result;\n    };\n\n    formatCallDuration = duration => {\n        if (duration > 3600) {\n            let result = this.formatPluralString('Hours', Math.floor(duration / 3600));\n            const minutes = Math.floor(duration % 3600 / 3600);\n            if (minutes > 0) {\n                result += ', ' + this.formatPluralString('Minutes', minutes);\n            }\n\n            return result;\n        }\n\n        if (duration > 60) {\n            return this.formatPluralString('Minutes', Math.floor(duration / 60));\n        }\n\n        return this.formatPluralString('Seconds', Math.floor(duration));\n    };\n\n    formatDistance = (distance, type, useImperial = null) => {\n        if (distance < 1000) {\n            switch (type) {\n                case 0: {\n                    return this.formatString('MetersAway2', this.format('%d', Math.max(1, distance)));\n                }\n                case 1: {\n                    return this.formatString('MetersFromYou2', this.format('%d', Math.max(1, distance)));\n                }\n            }\n        } else {\n            let arg = null;\n            if (distance % 1000 === 0) {\n                arg = this.format('%d', Math.floor(distance / 1000));\n            } else {\n                arg = this.format('%.2f', distance / 1000.0);\n            }\n\n            switch (type) {\n                case 0: {\n                    return this.formatString('KMetersAway2', arg);\n                }\n                case 1: {\n                    return this.formatString('KMetersFromYou2', arg);\n                }\n            }\n        }\n\n        return distance;\n    };\n\n    replaceTags(text) {\n        const entities = [];\n        text = getSimpleMarkupEntities(text, entities);\n\n        return { '@type': 'formattedText', text, entities };\n    }\n\n    loadLanguage = async language => {\n        const result = await TdLibController.send({\n            '@type': 'getLanguagePackStrings',\n            language_pack_id: language.toLowerCase(),\n            keys: []\n        });\n\n        const resources = this.processStrings(language, result);\n        this.cache.save(language, defaultNS, resources);\n        i18n.addResourceBundle(language, defaultNS, resources);\n    };\n}\n\nconst store = new LocalizationStore();\nwindow.localization = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { getLocationId } from '../Utils/Message';\nimport { FILE_PRIORITY, IV_LOCATION_HEIGHT, IV_LOCATION_WIDTH, THUMBNAIL_PRIORITY } from '../Constants';\nimport WebpManager from './WebpManager';\nimport TdLibController from '../Controllers/TdLibController';\n\nconst useReadFile = true;\nconst useDownloadFile = true;\n\nclass FileStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n\n        WebpManager.init();\n        // this.suppressUpdateFile = true;\n    }\n\n    reset = () => {\n        this.callbacks = [];\n\n        //this.transactionCount = 0;\n        this.db = null;\n        this.urls = new WeakMap();\n        this.dataUrls = new Map();\n        this.items = new Map();\n        this.blobItems = new Map();\n        this.pngBlobItems = new Map();\n        this.locationItems = new Map();\n\n        this.downloads = new Map();\n        this.uploads = new Map();\n    };\n\n    onUpdate = async update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                await this.onUpdateAuthorizationState(update);\n\n                break;\n            }\n            case 'updateFile': {\n                this.set(update.file);\n\n                this.onUpdateFile(update);\n\n                if (!this.suppressUpdateFile) {\n                    this.emit(update['@type'], update);\n                }\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateAnimationBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateAnimationThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateAudioBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateAudioThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateChatBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateDocumentBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateDocumentThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateLocationBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdatePhotoBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateStickerBlob': {\n                const { fileId, source } = update;\n                if (source) {\n                    const { is_animated } = source;\n                    if (!is_animated) {\n                        WebpManager.decode(fileId, false);\n                    }\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateStickerPngBlob': {\n                const { fileId, blob } = update;\n\n                this.setPngBlob(fileId, blob);\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateStickerThumbnailBlob': {\n                const { fileId, source } = update;\n                if (source) {\n                    const { thumbnail } = source;\n                    if (thumbnail) {\n                        const { format } = thumbnail;\n                        if (format && format['@type'] === 'thumbnailFormatWebp') {\n                            WebpManager.decode(fileId, true);\n                        }\n                    }\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateStickerThumbnailPngBlob': {\n                const { fileId, blob } = update;\n\n                this.setPngBlob(fileId, blob);\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateUserBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVideoBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVideoThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVideoNoteBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVideoNoteThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVoiceNoteBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateSendFiles': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    onUpdateAuthorizationState = async update => {\n        if (!update) return;\n\n        const { authorization_state } = update;\n        if (!authorization_state) return;\n\n        switch (authorization_state['@type']) {\n            case 'authorizationStateWaitTdlibParameters': {\n                await this.initDB();\n                break;\n            }\n            case 'authorizationStateClosed': {\n                this.reset();\n                break;\n            }\n        }\n    };\n\n    onUpdateFile = update => {\n        if (!update) return;\n\n        const { file } = update;\n        if (!file) return;\n\n        this.handleDownloads(file);\n        this.handleUploads(file);\n    };\n\n    handleDownloads = file => {\n        const { arr, id, idb_key, local } = file;\n        delete file.arr;\n\n        if (!this.downloads.has(id)) return;\n        if (!local.is_downloading_completed) return;\n        if (!useReadFile && !idb_key && !arr) return;\n\n        const items = this.downloads.get(id);\n        if (!items) return;\n\n        this.downloads.delete(id);\n\n        const store = this.getStore();\n\n        items.forEach(item => {\n            switch (item['@type']) {\n                case 'animation': {\n                    this.handleAnimation(store, item, file, arr, null);\n                    break;\n                }\n                case 'audio': {\n                    this.handleAudio(store, item, file, arr, null);\n                    break;\n                }\n                case 'chat': {\n                    this.handleChat(store, item, file, arr);\n                    break;\n                }\n                case 'document': {\n                    this.handleDocument(store, item, file, arr, null);\n                    break;\n                }\n                case 'game': {\n                    this.handleGame(store, item, file, arr, null);\n                    break;\n                }\n                case 'location': {\n                    this.handleLocation(store, item, file, arr, null);\n                    break;\n                }\n                case 'message': {\n                    this.handleMessage(store, item, file, arr);\n                    break;\n                }\n                case 'pageBlockMap': {\n                    this.handlePageBlockMap(store, item, file, arr, null);\n                    break;\n                }\n                case 'photo': {\n                    this.handlePhoto(store, item, file, arr, null);\n                    break;\n                }\n                case 'sticker': {\n                    this.handleSticker(store, item, file, arr, null);\n                    break;\n                }\n                case 'video': {\n                    this.handleVideo(store, item, file, arr, null);\n                    break;\n                }\n                case 'videoNote': {\n                    this.handleVideoNote(store, item, file, arr, null);\n                    break;\n                }\n                case 'voiceNote': {\n                    this.handleVoiceNote(store, item, file, arr, null);\n                    break;\n                }\n                case 'user': {\n                    this.handleUser(store, item, file, arr);\n                    break;\n                }\n                default:\n                    console.error('FileStore.onUpdateFile unhandled item', item);\n                    break;\n            }\n        });\n    };\n\n    handleUploads = file => {\n        const { id, remote } = file;\n        delete file.arr;\n\n        if (!this.uploads.has(id)) return;\n        if (remote.is_uploading_completed) return;\n\n        this.uploads.delete(id);\n    };\n\n    handleChat = (store, chat, file, arr) => {\n        if (!chat) return;\n\n        this.getLocalFile(\n            store,\n            file,\n            arr,\n            () => this.updateChatPhotoBlob(chat.id, file.id),\n            () => this.getRemoteFile(file.id, FILE_PRIORITY, chat)\n        );\n    };\n\n    handleUser = (store, user, file, arr) => {\n        if (!user) return;\n\n        this.getLocalFile(\n            store,\n            file,\n            arr,\n            () => this.updateUserPhotoBlob(user.id, file.id),\n            () => this.getRemoteFile(file.id, FILE_PRIORITY, user)\n        );\n    };\n\n    handleMessage = (store, message, file, arr) => {\n        if (!message) return;\n\n        const { content } = message;\n        if (!content) return;\n\n        switch (content['@type']) {\n            case 'messageAnimation': {\n                const { animation } = content;\n\n                this.handleAnimation(store, animation, file, arr, message);\n                break;\n            }\n            case 'messageAudio': {\n                const { audio } = content;\n\n                this.handleAudio(store, audio, file, arr, message);\n                break;\n            }\n            case 'messageChatChangePhoto': {\n                const { photo } = content;\n\n                this.handlePhoto(store, photo, file, arr, message);\n                break;\n            }\n            case 'messageDocument': {\n                const { document } = content;\n\n                this.handleDocument(store, document, file, arr, message);\n                break;\n            }\n            case 'messageInvoice': {\n                const { photo } = content;\n\n                if (photo) {\n                    this.handlePhoto(store, photo, file, arr, message);\n                }\n                break;\n            }\n            case 'messageGame': {\n                const { game } = content;\n\n                this.handleGame(store, game, file, arr, message);\n                break;\n            }\n            case 'messageLocation': {\n                const { location } = content;\n\n                this.handleLocation(store, location, file, arr, message);\n                break;\n            }\n            case 'messagePhoto': {\n                const { photo } = content;\n\n                this.handlePhoto(store, photo, file, arr, message);\n                break;\n            }\n            case 'messageSticker': {\n                const { sticker } = content;\n\n                this.handleSticker(store, sticker, file, arr, message);\n                break;\n            }\n            case 'messageText': {\n                const { web_page } = content;\n                if (!web_page) break;\n\n                const { animation, audio, document, photo, sticker, video, video_note, voice_note } = web_page;\n\n                if (animation) {\n                    this.handleAnimation(store, animation, file, arr, message);\n                }\n\n                if (audio) {\n                    this.handleAudio(store, audio, file, arr, message);\n                }\n\n                if (document) {\n                    this.handleDocument(store, document, file, arr, message);\n                }\n\n                if (photo) {\n                    this.handlePhoto(store, photo, file, arr, message);\n                }\n\n                if (sticker) {\n                    this.handleSticker(store, sticker, file, arr, message);\n                }\n\n                if (video) {\n                    this.handleVideo(store, video, file, arr, message);\n                }\n\n                if (voice_note) {\n                    this.handleVoiceNote(store, voice_note, file, arr, message);\n                }\n\n                if (video_note) {\n                    this.handleVideoNote(store, video_note, file, arr, message);\n                }\n\n                break;\n            }\n            case 'messageVenue': {\n                const { venue } = content;\n                const { location } = venue;\n\n                this.handleLocation(store, location, file, arr, message);\n                break;\n            }\n            case 'messageVideo': {\n                const { video } = content;\n\n                this.handleVideo(store, video, file, arr, message);\n                break;\n            }\n            case 'messageVideoNote': {\n                const { video_note } = content;\n\n                this.handleVideoNote(store, video_note, file, arr, message);\n                break;\n            }\n            case 'messageVoiceNote': {\n                const { voice_note } = content;\n\n                this.handleVoiceNote(store, voice_note, file, arr, message);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    handleAnimation = (store, animation, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (animation.thumbnail) {\n            const source = animation.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateAnimationThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || animation)\n                );\n            }\n        }\n\n        if (animation.animation) {\n            const source = animation.animation;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateAnimationBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || animation)\n                );\n            }\n        }\n    };\n\n    handleAudio = (store, audio, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (audio.album_cover_thumbnail) {\n            const source = audio.album_cover_thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateAudioThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || audio)\n                );\n            }\n        }\n\n        if (audio.audio) {\n            const source = audio.audio;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateAudioBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || audio)\n                );\n            }\n        }\n    };\n\n    handleGame = (store, game, file, arr, message) => {\n        if (!game) return;\n\n        const { animation, photo } = game;\n        if (photo) {\n            this.handlePhoto(store, photo, file, arr, message);\n        }\n\n        if (animation) {\n            this.handleAnimation(store, animation, file, arr, message);\n        }\n    };\n\n    handleDocument = (store, document, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (document.thumbnail) {\n            const source = document.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateDocumentThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || document)\n                );\n            }\n        }\n\n        if (document.document) {\n            const { document: source } = document;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateDocumentBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || document)\n                );\n            }\n        }\n    };\n\n    handleLocation = (store, location, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        const locationId = getLocationId(location);\n        if (locationId) {\n            const source = this.getLocationFile(locationId);\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateLocationBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || location)\n                );\n            }\n        }\n    };\n\n    handlePageBlockMap = (store, pageBlockMap, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        const { location } = pageBlockMap;\n        const locationId = getLocationId(location, IV_LOCATION_WIDTH, IV_LOCATION_HEIGHT);\n        if (locationId) {\n            const source = this.getLocationFile(locationId);\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateLocationBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || pageBlockMap)\n                );\n            }\n        }\n    };\n\n    handlePhoto = (store, photo, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (photo) {\n            for (let i = 0; i < photo.sizes.length; i++) {\n                const photoSize = photo.sizes[i];\n                if (photoSize) {\n                    const source = photoSize.photo;\n                    if (source && source.id === file.id) {\n                        this.getLocalFile(\n                            store,\n                            source,\n                            arr,\n                            () => this.updatePhotoBlob(chatId, messageId, file.id),\n                            () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || photo)\n                        );\n                        break;\n                    }\n                }\n            }\n        }\n    };\n\n    handleSticker = (store, sticker, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (sticker.thumbnail) {\n            const source = sticker.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateStickerThumbnailBlob(chatId, messageId, file.id, sticker),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || sticker)\n                );\n            }\n        }\n\n        if (sticker.sticker) {\n            const source = sticker.sticker;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateStickerBlob(chatId, messageId, file.id, sticker),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || sticker)\n                );\n            }\n        }\n    };\n\n    handleVoiceNote = (store, voiceNote, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (voiceNote.voice) {\n            const source = voiceNote.voice;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVoiceNoteBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || voiceNote)\n                );\n            }\n        }\n    };\n\n    handleVideoNote = (store, videoNote, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (videoNote.thumbnail) {\n            const source = videoNote.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVideoNoteThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || videoNote)\n                );\n            }\n        }\n\n        if (videoNote.video) {\n            const source = videoNote.video;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVideoNoteBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || videoNote)\n                );\n            }\n        }\n    };\n\n    handleVideo = (store, video, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (video.thumbnail) {\n            const source = video.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVideoThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || video)\n                );\n            }\n        }\n\n        if (video.video) {\n            const source = video.video;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVideoBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || video)\n                );\n            }\n        }\n    };\n\n    async initDB(callback) {\n        /*if (this.store) return;\n            if (this.initiatingDB) return;\n\n            this.initiatingDB = true;\n            this.store = localForage.createInstance({\n                name: 'tdlib'\n            });\n            this.initiatingDB = false;\n\n            return;*/\n        if (this.db) {\n            // console.log('[FileStore] db exists');\n            if (callback) callback();\n            return;\n        }\n\n        if (this.initiatingDB) {\n            // console.log('[FileStore] add callback');\n            if (callback) this.callbacks.push(callback);\n            return;\n        }\n\n        // console.log('[FileStore] start initDB');\n        if (callback) this.callbacks.push(callback);\n\n        this.initiatingDB = true;\n        this.db = await this.openDB().catch(error => console.log('[FileStore] initDB error', error));\n        this.initiatingDB = false;\n\n        // console.log('[FileStore] stop initDB');\n\n        if (this.callbacks.length) {\n            // console.log('[FileStore] invoke callbacks count=' + this.callbacks.length);\n            for (let i = 0; i < this.callbacks.length; i++) {\n                this.callbacks[i]();\n            }\n            this.callbacks = [];\n        }\n    }\n\n    openDB() {\n        return new Promise((resolve, reject) => {\n            const request = window.indexedDB.open('tdlib');\n            request.onsuccess = () => resolve(request.result);\n            request.onerror = () => reject(request.error);\n        });\n    }\n\n    getStore() {\n        if (useReadFile) {\n            return undefined;\n        }\n\n        //console.log('FileStore.getStore ' + this.transactionCount++);\n        return this.db.transaction(['keyvaluepairs'], 'readonly').objectStore('keyvaluepairs');\n    }\n\n    getReadWriteStore() {\n        if (useReadFile) {\n            return undefined;\n        }\n\n        return this.db.transaction(['keyvaluepairs'], 'readwrite').objectStore('keyvaluepairs');\n    }\n\n    deleteLocalFile = (store, file) => {};\n\n    getLocalFile(store, file, arr, callback, faultCallback) {\n        if (!useDownloadFile) {\n            return;\n        }\n\n        if (useReadFile) {\n            file = this.get(file.id) || file;\n            if (file && file.local && !file.local.is_downloading_completed) {\n                faultCallback();\n                return;\n            }\n\n            (async file => {\n                // console.log('[fs] readFile file_id=' + file.id);\n                const response = await TdLibController.send({\n                    '@type': 'readFile',\n                    file_id: file.id\n                });\n\n                // console.log(`[fs] readFile result file_id=${file.id}`, file, response);\n                if (!this.getBlob(file.id)) {\n                    this.setBlob(file.id, response.data);\n                }\n            })(file).then(callback, faultCallback);\n\n            return;\n        }\n\n        let idb_key = file.idb_key;\n        if (!idb_key) {\n            file = this.get(file.id) || file;\n            idb_key = file.idb_key;\n        }\n\n        if (!idb_key && !arr) {\n            faultCallback();\n            return;\n        }\n\n        if (arr) {\n            file.blob = new Blob([arr]);\n            this.setBlob(file.id, file.blob);\n            callback();\n            return;\n        }\n\n        if (file.blob) {\n            //callback();\n            return;\n        }\n\n        // if (this.getBlob(file.id)){\n        //     return;\n        // }\n\n        const request = store.get(idb_key);\n        request.onsuccess = event => {\n            const blob = event.target.result;\n\n            if (blob) {\n                file.blob = blob;\n                this.setBlob(file.id, file.blob);\n                callback();\n            } else {\n                faultCallback();\n            }\n        };\n        request.onerror = () => {\n            faultCallback();\n        };\n    }\n\n    getRemoteFile(fileId, priority, obj) {\n        if (!useDownloadFile) {\n            return;\n        }\n\n        const items = this.downloads.get(fileId) || [];\n        if (items.some(x => x === obj)) return;\n\n        items.push(obj);\n        this.downloads.set(fileId, items);\n\n        TdLibController.send({\n            '@type': 'downloadFile',\n            file_id: fileId,\n            priority: priority\n        });\n    }\n\n    cancelGetRemoteFile(fileId, obj) {\n        if (!this.downloads.has(fileId)) return;\n\n        if (!obj) {\n            this.downloads.delete(fileId);\n        } else {\n            const items = this.downloads.get(fileId).filter(x => x !== obj);\n            this.downloads.set(fileId, items);\n        }\n\n        TdLibController.send({\n            '@type': 'cancelDownloadFile',\n            file_id: fileId,\n            only_if_pending: false\n        });\n    }\n\n    uploadFile(fileId, obj) {\n        if (this.uploads.has(fileId)) {\n            let items = this.uploads.get(fileId);\n            items.push(obj);\n        } else {\n            this.uploads.set(fileId, [obj]);\n        }\n\n        console.log('[perf] uploadFile file_id=' + fileId);\n    }\n\n    cancelUploadFile(fileId, obj) {\n        if (this.uploads.has(fileId)) {\n            this.uploads.delete(fileId);\n            console.log('cancel_upload_message id=' + obj.id);\n            TdLibController.send({\n                '@type': 'deleteMessages',\n                chat_id: obj.chat_id,\n                message_ids: [obj.id],\n                revoke: true\n            });\n        }\n    }\n\n    get = fileId => {\n        return this.items.get(fileId);\n    };\n\n    set = file => {\n        this.items.set(file.id, file);\n    };\n\n    getBlob = fileId => {\n        return this.blobItems.get(fileId);\n    };\n\n    setBlob = (fileId, blob) => {\n        this.blobItems.set(fileId, blob);\n    };\n\n    getPngBlob = fileId => {\n        return this.pngBlobItems.get(fileId);\n    };\n\n    setPngBlob = (fileId, blob) => {\n        this.pngBlobItems.set(fileId, blob);\n    }\n\n    deleteBlob = fileId => {\n        this.blobItems.delete(fileId);\n    };\n\n    getLocationFile = locationId => {\n        const fileId = this.locationItems.get(locationId);\n\n        return this.get(fileId);\n    };\n\n    setLocationFile = (locationId, file) => {\n        this.locationItems.set(locationId, file.id);\n\n        this.set(file);\n    };\n\n    getDataUrl = id => {\n        if (!id) {\n            return null;\n        }\n\n        if (this.dataUrls.has(id)) {\n            return this.dataUrls.get(id);\n        }\n\n        return null;\n    };\n\n    setDataUrl = (id, dataUrl) => {\n        // console.log('[f] setDataUrl', id);\n        this.dataUrls.set(id, dataUrl);\n    };\n\n    deleteDataUrl = id => {\n        // console.log('[f] deleteDataUrl', id);\n        this.dataUrls.delete(id);\n    };\n\n    getBlobUrl = blob => {\n        if (!blob) {\n            return null;\n        }\n\n        if (this.urls.has(blob)) {\n            return this.urls.get(blob);\n        }\n\n        const url = URL.createObjectURL(blob);\n        this.urls.set(blob, url);\n\n        return url;\n    };\n\n    deleteBlobUrl = blob => {\n        if (this.urls.has(blob)) {\n            this.urls.delete(blob);\n        }\n    };\n\n    updateFileBlob = (type, chatId, messageId, fileId, source) => {\n        TdLibController.clientUpdate({\n            '@type': type,\n            chatId,\n            messageId,\n            fileId,\n            source\n        });\n    }\n\n    updateAnimationBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateAnimationBlob', chatId, messageId, fileId);\n    };\n\n    updateAnimationThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateAnimationThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateAudioBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateAudioBlob', chatId, messageId, fileId);\n    };\n\n    updateAudioThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateAudioThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateChatPhotoBlob(chatId, fileId) {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateChatBlob',\n            chatId,\n            fileId\n        });\n    }\n\n    updateDocumentBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateDocumentBlob', chatId, messageId, fileId);\n    };\n\n    updateDocumentThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateDocumentThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateLocationBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateLocationBlob', chatId, messageId, fileId);\n    };\n\n    updatePhotoBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdatePhotoBlob', chatId, messageId, fileId);\n    };\n\n    updateStickerBlob = (chatId, messageId, fileId, source) => {\n        this.updateFileBlob('clientUpdateStickerBlob', chatId, messageId, fileId, source);\n    };\n\n    updateStickerThumbnailBlob = (chatId, messageId, fileId, source) => {\n        this.updateFileBlob('clientUpdateStickerThumbnailBlob', chatId, messageId, fileId, source);\n    };\n\n    updateUserPhotoBlob(userId, fileId) {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateUserBlob',\n            userId,\n            fileId\n        });\n    }\n\n    updateVideoBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVideoBlob', chatId, messageId, fileId);\n    };\n\n    updateVideoThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVideoThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateVideoNoteBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVideoNoteBlob', chatId, messageId, fileId);\n    };\n\n    updateVideoNoteThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVideoNoteThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateVoiceNoteBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVoiceNoteBlob', chatId, messageId, fileId);\n    };\n}\n\nconst store = new FileStore();\nwindow.file = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nexport const ALBUM_MESSAGES_LIMIT = 10;\nexport const ANIMATION_FRAME_DURATION_MS = 40;\nexport const ANIMATION_DURATION_100MS = 100;\nexport const ANIMATION_DURATION_200MS = 200;\nexport const ANIMATION_DURATION_300MS = 300;\nexport const ANIMATION_DURATION_500MS = 500;\nexport const ANIMATION_PREVIEW_DISPLAY_SIZE = 480;\nexport const AUDIO_MIN_BUFFERED_TIME_S = 30;\nexport const APP_NAME = 'Telegram Web';\nexport const CHAT_SLICE_LIMIT = 25;\nexport const DATABASE_NAME = 'tdlib';\nexport const DATABASE_TEST_NAME = 'tdlib_test';\nexport const EMOJI_PICKER_TIMEOUT_MS = 100;\nexport const FILE_PRIORITY = 1;\nexport const FILTER_COUNT_MAX = 10;\nexport const FILTER_TITLE_MAX_LENGTH = 12;\nexport const GROUP_CALL_AMPLITUDE_ANALYSE_COUNT_MAX = 50;\nexport const GROUP_CALL_AMPLITUDE_ANALYSE_INTERVAL_MS = 100;\nexport const GROUP_CALL_PARTICIPANTS_LOAD_LIMIT = 100;\nexport const IV_LOCATION_HEIGHT = 300;\nexport const IV_LOCATION_WIDTH = 600;\nexport const IV_PHOTO_SIZE = 800;\nexport const IV_PHOTO_DISPLAY_SIZE = 600;\nexport const KEY_SUGGESTED_LANGUAGE_PACK_ID = 'suggested_language_pack_id';\nexport const LOCATION_HEIGHT = 150;\nexport const LOCATION_SCALE = 2;\nexport const LOCATION_WIDTH = 300;\nexport const LOCATION_ZOOM = 16;\nexport const MAX_SNACK = 10;\nexport const MEDIA_SLICE_LIMIT = 20;\nexport const MEDIA_VIEWER_VIDEO_MAX_SIZE = 800;\nexport const MESSAGE_SLICE_LIMIT = 20;\nexport const MESSAGE_SPLIT_MAX_TIME_S = 600;\nexport const MUTED_VALUE_MAX = 2147483647; // int32.max = 2^32 - 1\nexport const MUTED_VALUE_MIN = 0;\nexport const NOTIFICATION_AUDIO_DELAY_MS = 5000;\nexport const NOTIFICATION_AUTO_HIDE_DURATION_MS = 5000;\nexport const NOTIFICATION_DEBOUNCE_DELAY_MS = 500;\nexport const OPTIMIZATIONS_FIRST_START = true;\nexport const PAGE_WIDTH_SMALL = 960;\nexport const PHOTO_BIG_SIZE = 1280;\nexport const PHOTO_DISPLAY_SIZE = 380;\nexport const PHOTO_DISPLAY_SMALL_SIZE = 90;\nexport const PHOTO_DISPLAY_EXTRA_SMALL_SIZE = 45;\nexport const PHOTO_SIZE = 320;\nexport const PHOTO_THUMBNAIL_SIZE = 90;\nexport const PIP_PLAYER_BORDER_PRECISION = 10;\nexport const PLAYER_AUDIO_2X_MIN_DURATION = 10 * 60;\nexport const PLAYER_LOOP_MAX_DURATION = 20;\nexport const PLAYER_VOLUME_NORMAL = 0.25;\nexport const PLAYER_VOLUME_MIN = 0.0;\nexport const PLAYER_VOLUME_MAX = 1.0;\nexport const PLAYER_VOLUME_STEP = 0.05;\nexport const PLAYER_PLAYBACKRATE_MIN = 0.25;\nexport const PLAYER_PLAYBACKRATE_MAX = 2.0;\nexport const PLAYER_PLAYBACKRATE_STEP = 0.25\nexport const PLAYER_PLAYBACKRATE_NORMAL = 1.0;\nexport const PLAYER_PLAYBACKRATE_FAST = 1.75;\nexport const PLAYER_PROGRESS_TIMEOUT_MS = 250;\nexport const PLAYER_SEEK_STEP_SMALL = 5.0;\nexport const PLAYER_SEEK_STEP_BIG = 10.0;\nexport const PLAYER_STREAMING_PRIORITY = 32;\nexport const PLAYER_PRELOAD_PRIORITY = 1;\nexport const PLAYER_PRELOAD_MAX_SIZE = 4 * 1024 * 1024;\nexport const POLL_QUESTION_LENGTH = 255;\nexport const POLL_QUESTION_HINT_LENGTH = POLL_QUESTION_LENGTH - 79;\nexport const POLL_QUESTION_MAX_LENGTH = POLL_QUESTION_LENGTH + 99;\nexport const POLL_OPTION_LENGTH = 100;\nexport const POLL_OPTION_HINT_LENGTH = POLL_OPTION_LENGTH - 29;\nexport const POLL_OPTION_MAX_LENGTH = POLL_OPTION_LENGTH + 99;\nexport const POLL_OPTIONS_MAX_COUNT = 10;\nexport const POLL_RESULTS_FIRST_SLICE_LENGTH = 15;\nexport const POLL_RESULTS_LEAVE_LENGTH = 5;\nexport const POLL_RESULTS_SLICE_LENGTH = 50;\nexport const PRELOAD_AUDIO_SIZE = 200 * 1024; //10 * 1024 * 1024;\nexport const PRELOAD_ANIMATION_SIZE = 200 * 1024; //10 * 1024 * 1024;\nexport const PRELOAD_DOCUMENT_SIZE = 200 * 1024;\nexport const PRELOAD_STICKER_SIZE = 10 * 200 * 1024;\nexport const PRELOAD_VOICENOTE_SIZE = 200 * 1024; //10 * 1024 * 1024;\nexport const PRELOAD_VIDEO_SIZE = 10 * 1024 * 1024;\nexport const PRELOAD_VIDEONOTE_SIZE = 200 * 1024; //10 * 1024 * 1024;\nexport const PROFILE_PHOTO_BIG_SIZE = 640;\nexport const PROFILE_PHOTO_PRELOAD_TIME_MS = 500;\nexport const PROFILE_PHOTO_SMALL_SIZE = 160;\nexport const SCROLL_PRECISION = 800;\nexport const SCROLL_CHATS_PRECISION = 400;\nexport const SEARCH_GLOBAL_TEXT_MIN = 4;\nexport const SEND_BY_CTRL_ENTER_KEY = 'x_send_by_ctrl_enter';\nexport const SERVICE_NOTIFICATIONS_USER_IDS = [42777, 333000, 777000];\nexport const SHARED_MESSAGE_SLICE_LIMIT = 42;\nexport const STICKER_DISPLAY_SIZE = 192;\nexport const STICKER_HINT_DISPLAY_SIZE = 76;\nexport const STICKER_PREVIEW_DISPLAY_SIZE = 192;\nexport const STICKER_SMALL_DISPLAY_SIZE = 64;\nexport const STORAGE_AUTH_KEY = 'auth';\nexport const STORAGE_AUTH_TEST_KEY = 'test_auth';\nexport const STORAGE_CACHE_KEY = 'cache';\nexport const STORAGE_CACHE_TEST_KEY = 'test_cache';\nexport const STORAGE_CONTACTS_KEY = 'contacts';\nexport const STORAGE_CONTACTS_TEST_KEY = 'test_contacts';\nexport const STORAGE_FILES_KEY = 'files';\nexport const STORAGE_FILES_TEST_KEY = 'test_files';\nexport const STORAGE_FILTERS_KEY = 'filters';\nexport const STORAGE_FILTERS_TEST_KEY = 'test_filters';\nexport const STORAGE_REGISTER_KEY = 'register';\nexport const STORAGE_REGISTER_TEST_KEY = 'test_register';\nexport const THUMBNAIL_BLURRED_SIZE_90 = 90;\nexport const THUMBNAIL_BLURRED_SIZE_40 = 40;\nexport const THUMBNAIL_PRIORITY = 32;\nexport const TYPING_INPUT_INTERVAL_S = 8;\nexport const TYPING_OUTPUT_INTERVAL_S = 8;\nexport const VERBOSITY_JS_MAX = 20;\nexport const VERBOSITY_JS_MIN = 0;\nexport const VERBOSITY_MAX = 20;\nexport const VERBOSITY_MIN = 0;\nexport const VOICENOTE_MIN_RECORD_DURATION = 1000;\nexport const USERNAME_LENGTH_MIN = 5;\nexport const REPLACE_PREFIX = '/telegram-react';\nexport const WASM_FILE_NAME = 'a4ff3d9d0e2ad771c306842ca53eae96.wasm';\nexport const WASM_FILE_HASH = WASM_FILE_NAME.replace('.wasm', '');\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { TYPING_INPUT_INTERVAL_S } from '../Constants';\n\nclass InputTypingManager {\n    constructor(chatId, timeoutCallback) {\n        this.actions = new Map();\n        this.timerId = null;\n        this.chatId = chatId;\n        this.timeoutCallback = timeoutCallback;\n\n        this.handleTimer = this.handleTimer.bind(this);\n        this.addAction = this.addAction.bind(this);\n        this.clearAction = this.clearAction.bind(this);\n        this.setActionsTimeout = this.setActionsTimeout.bind(this);\n    }\n\n    handleTimer() {\n        let now = new Date();\n        let expiredActions = [];\n        for (let [key, value] of this.actions) {\n            let actionTimeout = value.expire - now;\n            if (actionTimeout <= 0) expiredActions.push(key);\n        }\n\n        for (let key of expiredActions) {\n            this.actions.delete(key);\n        }\n\n        let update = {\n            '@type': 'updateUserChatAction',\n            chat_id: this.chatId,\n            action: { '@type': 'chatActionTimerUpdate' }\n        };\n\n        this.timeoutCallback(update);\n        // ChatStore.emit('updateUserChatAction', update);\n\n        this.setActionsTimeout();\n    }\n\n    addAction(userId, action) {\n        let expire = new Date();\n        expire.setSeconds(expire.getSeconds() + TYPING_INPUT_INTERVAL_S);\n\n        this.actions.set(userId, { expire: expire, action: action });\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setActionsTimeout();\n    }\n\n    setActionsTimeout() {\n        let now = new Date();\n        let timeout = 1000000;\n        for (let [key, value] of this.actions) {\n            let actionTimeout = value.expire - now;\n            if (actionTimeout < timeout) timeout = actionTimeout;\n            if (timeout < 0) timeout = 0;\n        }\n\n        if (timeout < 1000000) {\n            this.timerId = setTimeout(this.handleTimer, timeout);\n        }\n    }\n\n    clearAction(userId) {\n        this.actions.delete(userId);\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setActionsTimeout();\n    }\n}\n\nexport default InputTypingManager;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport InputTypingManager from '../Utils/InputTypingManager';\nimport { positionListEquals } from '../Utils/Chat';\nimport UserStore from './UserStore';\nimport MessageStore from './MessageStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass ChatStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n        this.loadClientData();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.scrollPositions = new Map();\n        this.items = new Map();\n        this.typingManagers = new Map();\n        this.onlineMemberCount = new Map();\n        this.counters = new Map();\n        this.skippedUpdates = [];\n        this.chatList = new Map();\n        this.wallpaper = null;\n    };\n\n    loadClientData = () => {\n        const clientData = new Map();\n        try {\n            let data = localStorage.get('clientData');\n            if (data) {\n                data = JSON.parse(data);\n                if (data) {\n                    Object.keys(data).forEach(key => {\n                        clientData.set(Number(key), data[key]);\n                    });\n                }\n            }\n        } catch {}\n\n        this.clientData = clientData;\n    };\n\n    saveClientData = () => {\n        const arr = Array.from(this.clientData.entries());\n        const obj = arr.reduce((obj, [key, value]) => {\n            if (value) {\n                obj[String(key)] = value;\n            }\n            return obj;\n        }, {});\n\n        localStorage.setItem('clientData', JSON.stringify(obj));\n    };\n\n    updateChatChatLists(chatId) {\n        const chat = this.get(chatId);\n        if (!chat) return;\n\n        const { positions } = chat;\n        if (!positions) return;\n\n        for (const key of this.chatList.keys()) {\n            this.chatList.get(key).delete(chatId);\n        }\n\n        if (!positions.length) return;\n\n        for (let i = 0; i < positions.length; i++) {\n            const position = positions[i];\n\n            const { list } = position;\n\n            const key = `${list['@type']}_filter_id=${list.filter_id}`;\n            let idMap = this.chatList.get(key);\n            if (!idMap) {\n                idMap = new Map();\n                this.chatList.set(key, idMap);\n            }\n\n            idMap.set(chatId, chatId);\n        }\n    }\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateConnectionState': {\n                if (update.state['@type'] === 'connectionStateUpdating') {\n                    this.updating = true;\n                    this.skippedUpdates = [];\n                } else {\n                    this.updating = false;\n                    if (this.skippedUpdates.length > 0) {\n                        TdLibController.parameters.fastUpdating = false;\n                        this.emitUpdate({\n                            '@type': 'clientUpdateFastUpdatingComplete',\n                            updates: this.skippedUpdates\n                        });\n                        this.skippedUpdates = [];\n                    }\n                }\n                break;\n            }\n            case 'updateChatActionBar': {\n                const { chat_id, action_bar } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { action_bar });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatDefaultDisableNotification': {\n                //TODO: handle updateChatDefaultDisableNotification\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatOnlineMemberCount': {\n                this.setOnlineMemberCount(update.chat_id, update.online_member_count);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatDraftMessage': {\n                const { chat_id, positions, draft_message } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, {\n                        positions: !positions.length ? chat.positions : positions,\n                        draft_message\n                    });\n                }\n\n                this.updateChatChatLists(chat_id);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatIsBlocked': {\n                const { chat_id, is_blocked } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { is_blocked });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatIsMarkedAsUnread': {\n                const { chat_id, is_marked_as_unread } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { is_marked_as_unread });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatLastMessage': {\n                const { chat_id, positions, last_message } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, {\n                        positions, // leave channel\n                        // positions: !positions.length ? chat.positions : positions,\n                        last_message,\n                    });\n                }\n\n                this.updateChatChatLists(chat_id);\n                MessageStore.set(last_message);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatNotificationSettings': {\n                const { chat_id, notification_settings } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { notification_settings });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatPhoto': {\n                const { chat_id, photo } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { photo });\n\n                    switch (chat.type['@type']) {\n                        case 'chatTypeBasicGroup': {\n                            break;\n                        }\n                        case 'chatTypeSupergroup': {\n                            break;\n                        }\n                        case 'chatTypePrivate':\n                        case 'chatTypeSecret': {\n                            const user = UserStore.get(chat.type.user_id);\n                            if (user) {\n                                UserStore.assign(user, { profile_photo: update.photo });\n                            }\n                            break;\n                        }\n                    }\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatPosition': {\n                const { chat_id, position } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { positions: [...chat.positions.filter(x => !positionListEquals(x, position)), position] });\n                }\n\n                this.updateChatChatLists(chat_id);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatReadInbox': {\n                const { chat_id, last_read_inbox_message_id, unread_count } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { last_read_inbox_message_id, unread_count });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatReadOutbox': {\n                const { chat_id, last_read_outbox_message_id } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { last_read_outbox_message_id });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatReplyMarkup': {\n                const { chat_id, reply_markup_message_id } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { reply_markup_message_id });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatTitle': {\n                const { chat_id, title } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { title });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatUnreadMentionCount': {\n                const { chat_id, unread_mention_count } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { unread_mention_count });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatVoiceChat': {\n                const { chat_id, voice_chat_group_call_id, is_voice_chat_empty } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { voice_chat_group_call_id, is_voice_chat_empty });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateNewChat': {\n                this.set(update.chat);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateSecretChat': {\n                //TODO: handle updateSecretChat\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateUnreadChatCount': {\n                //TODO: handle updateUnreadChatCount\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateUserChatAction': {\n                let typingManager = this.getTypingManager(update.chat_id);\n                if (!typingManager) {\n                    typingManager = new InputTypingManager(update.chat_id, update => this.emitUpdate(update));\n                    this.setTypingManager(update.chat_id, typingManager);\n                }\n\n                const key = update.user_id;\n                if (update.action['@type'] === 'chatActionCancel') {\n                    typingManager.clearAction(key);\n                } else {\n                    typingManager.addAction(key, update.action);\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateMessageMentionRead': {\n                const { chat_id, unread_mention_count } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { unread_mention_count });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateChatBackground': {\n                const { wallpaper } = update;\n                this.wallpaper = wallpaper;\n\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateHintsClose': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateHintsGlobal': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateHintsLocal': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateClearHistory': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateClearOpenChatOptions': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateLeaveChat': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateArchive': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateOpenChat': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateContacts': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateSettings': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateNewGroup': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateNewChannel': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateSetChatClientData': {\n                const { chatId, clientData } = update;\n\n                TdLibController.send({\n                    '@type': 'setChatClientData',\n                    chat_id: chatId,\n                    client_data: JSON.stringify(clientData)\n                });\n                this.setClientData(chatId, clientData);\n                this.saveClientData();\n\n                this.emitUpdate(update);\n                break;\n            }\n        }\n    };\n\n    emitUpdate = update => {\n        this.emit(update['@type'], update);\n    };\n\n    emitFastUpdate = update => {\n        if (this.updating && TdLibController.parameters.fastUpdating) {\n            this.skippedUpdates.push(update);\n            return;\n        }\n\n        this.emit(update['@type'], update);\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    assign(source1, source2) {\n        //Object.assign(source1, source2);\n        this.set(Object.assign({}, source1, source2));\n    }\n\n    get(chatId) {\n        return this.items.get(chatId);\n    }\n\n    set(chat) {\n        this.items.set(chat.id, chat);\n    }\n\n    getCounters(chatId) {\n        return this.counters.get(chatId);\n    }\n\n    setCounters(chatId, counters) {\n        this.counters.set(chatId, counters);\n    }\n\n    getClientData(chatId) {\n        return this.clientData.get(chatId) || {};\n    }\n\n    setClientData(chatId, data) {\n        this.clientData.set(chatId, data);\n    }\n\n    setOnlineMemberCount(chatId, onlineMemberCount) {\n        this.onlineMemberCount.set(chatId, onlineMemberCount);\n    }\n\n    getOnlineMemberCount(chatId) {\n        return this.onlineMemberCount.get(chatId) || 0;\n    }\n\n    getTypingManager(chatId) {\n        return this.typingManagers.get(chatId);\n    }\n\n    setTypingManager(chatId, typingManager) {\n        return this.typingManagers.set(chatId, typingManager);\n    }\n\n    setScrollPosition(chatId, position) {\n        this.scrollPositions.set(chatId, position);\n    }\n\n    getScrollPosition(chatId) {\n        return this.scrollPositions.get(chatId);\n    }\n}\n\nconst store = new ChatStore();\nwindow.chat = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { getPhotoSize, getPhotoThumbnailSize, getSize } from './Common';\nimport { getChatUserId } from './Chat';\nimport { getProfilePhoto } from './User';\nimport { getLocationId } from './Message';\nimport {\n    FILE_PRIORITY,\n    IV_LOCATION_HEIGHT,\n    IV_LOCATION_WIDTH,\n    IV_PHOTO_SIZE,\n    LOCATION_HEIGHT,\n    LOCATION_SCALE,\n    LOCATION_WIDTH,\n    LOCATION_ZOOM,\n    PHOTO_BIG_SIZE,\n    PHOTO_SIZE, PHOTO_THUMBNAIL_SIZE,\n    PRELOAD_ANIMATION_SIZE,\n    PRELOAD_AUDIO_SIZE,\n    PRELOAD_DOCUMENT_SIZE,\n    PRELOAD_STICKER_SIZE,\n    PRELOAD_VIDEO_SIZE,\n    PRELOAD_VIDEONOTE_SIZE,\n    PRELOAD_VOICENOTE_SIZE,\n    THUMBNAIL_PRIORITY\n} from '../Constants';\nimport ChatStore from '../Stores/ChatStore';\nimport FileStore from '../Stores/FileStore';\nimport MessageStore from '../Stores/MessageStore';\nimport UserStore from '../Stores/UserStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function supportsStreaming() {\n    const { streaming } = TdLibController;\n\n    return streaming && hasServiceWorker();\n}\n\nexport function hasServiceWorker() {\n    if ('serviceWorker' in navigator) {\n        const { controller } = navigator.serviceWorker;\n        if (!controller) console.log('[SW] no running SW');\n\n        return !!controller;\n    }\n\n    return false;\n}\n\nexport async function getArrayBuffer(blob) {\n    return new Promise((resolve) => {\n        let fr = new FileReader();\n        fr.onload = () => {\n            resolve(fr.result);\n        };\n        fr.readAsArrayBuffer(blob);\n    })\n}\n\nfunction getSizeString(size) {\n    if (!size) return `0 B`;\n\n    if (size < 1024) {\n        return `${size} B`;\n    }\n\n    if (size < 1024 * 1024) {\n        return `${(size / 1024).toFixed(1)} KB`;\n    }\n\n    if (size < 1024 * 1024 * 1024) {\n        return `${(size / 1024 / 1024).toFixed(1)} MB`;\n    }\n\n    return `${(size / 1024 / 1024 / 1024).toFixed(1)} GB`;\n}\n\nfunction getFileSize(file) {\n    if (!file) return '';\n\n    let size = file.size;\n    if (!size) return '';\n\n    return getSizeString(size);\n}\n\nfunction getBigPhoto(photo) {\n    if (!photo) return null;\n\n    return photo.big;\n}\n\nfunction saveData(data, filename, mime) {\n    let blob = new Blob([data], { type: mime || 'application/octet-stream' });\n    if (typeof window.navigator.msSaveBlob !== 'undefined') {\n        // IE workaround for \"HTML7007: One or more blob URLs were\n        // revoked by closing the blob for which they were created.\n        // These URLs will no longer resolve as the data backing\n        // the URL has been freed.\"\n        window.navigator.msSaveBlob(blob, filename);\n    } else {\n        let blobURL = window.URL.createObjectURL(blob);\n        let tempLink = document.createElement('a');\n        tempLink.style.display = 'none';\n        tempLink.href = blobURL;\n        tempLink.setAttribute('download', filename);\n\n        // Safari thinks _blank anchor are pop ups. We only want to set _blank\n        // target if the browser does not support the HTML5 download attribute.\n        // This allows you to download files in desktop safari if pop up blocking\n        // is enabled.\n        if (typeof tempLink.download === 'undefined') {\n            tempLink.setAttribute('target', '_blank');\n        }\n\n        document.body.appendChild(tempLink);\n        tempLink.click();\n        document.body.removeChild(tempLink);\n        window.URL.revokeObjectURL(blobURL);\n    }\n}\n\nfunction saveBlob(blob, filename) {\n    if (typeof window.navigator.msSaveBlob !== 'undefined') {\n        // IE workaround for \"HTML7007: One or more blob URLs were\n        // revoked by closing the blob for which they were created.\n        // These URLs will no longer resolve as the data backing\n        // the URL has been freed.\"\n        window.navigator.msSaveBlob(blob, filename);\n    } else {\n        let blobURL = window.URL.createObjectURL(blob);\n        let tempLink = document.createElement('a');\n        tempLink.style.display = 'none';\n        tempLink.href = blobURL;\n        tempLink.setAttribute('download', filename);\n\n        // Safari thinks _blank anchor are pop ups. We only want to set _blank\n        // target if the browser does not support the HTML5 download attribute.\n        // This allows you to download files in desktop safari if pop up blocking\n        // is enabled.\n        if (typeof tempLink.download === 'undefined') {\n            tempLink.setAttribute('target', '_blank');\n        }\n\n        document.body.appendChild(tempLink);\n        tempLink.click();\n        document.body.removeChild(tempLink);\n        window.URL.revokeObjectURL(blobURL);\n    }\n}\n\nasync function loadReplies(store, chatId, messageIds) {\n    if (!chatId) return;\n    if (!messageIds) return;\n    if (!messageIds.length) return;\n\n    let messages = [];\n    const ids = [];\n    for (let i = 0; i < messageIds.length; i++) {\n        const reply = MessageStore.get(chatId, messageIds[i]);\n        if (reply) {\n            messages.push(reply)\n        } else {\n            ids.push(messageIds[i]);\n        }\n    }\n\n    if (ids.length > 0) {\n        const result = await TdLibController.send({\n            '@type': 'getMessages',\n            chat_id: chatId,\n            message_ids: messageIds\n        });\n\n        result.messages = result.messages.map((message, i) => {\n            return (\n                message || {\n                    '@type': 'deletedMessage',\n                    chat_id: chatId,\n                    id: messageIds[i],\n                    sender: { },\n                    content: null\n                }\n            );\n        });\n\n        messages = messages.concat(result.messages);\n    }\n\n    MessageStore.setItems(messages);\n\n    for (let i = ids.length - 1; i >= 0; i--) {\n        MessageStore.emit('getMessageResult', MessageStore.get(chatId, ids[i]));\n    }\n\n    store = FileStore.getStore();\n\n    loadReplyContents(store, messages);\n}\n\nexport function loadReplyContents(store, messages) {\n    for (let i = messages.length - 1; i >= 0; i--) {\n        const message = messages[i];\n        if (!message) {\n            continue;\n        }\n\n        const { content } = message;\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationThumbnailContent(store, animation, message);\n                    break;\n                }\n                case 'messageAudio': {\n                    const { audio } = content;\n\n                    loadAudioThumbnailContent(store, audio, message);\n                    break;\n                }\n                case 'messageChatChangePhoto': {\n                    const { photo } = content;\n\n                    loadPhotoContent(store, photo, message, PHOTO_THUMBNAIL_SIZE);\n                    break;\n                }\n                case 'messageDocument': {\n                    const { document } = content;\n\n                    loadDocumentThumbnailContent(store, document, message);\n                    break;\n                }\n                case 'messageGame': {\n                    const { game } = content;\n\n                    loadGameThumbnailContent(store, game, message);\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n\n                    loadPhotoContent(store, photo, message, PHOTO_THUMBNAIL_SIZE);\n                    break;\n                }\n                case 'messageSticker': {\n                    const { sticker } = content;\n\n                    loadStickerThumbnailContent(store, sticker, message);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (!web_page) break;\n\n                    const { animation, audio, document, photo, sticker, video, video_note } = web_page;\n\n                    if (photo) {\n                        loadPhotoContent(store, photo, message, PHOTO_THUMBNAIL_SIZE);\n                        break;\n                    }\n\n                    if (animation) {\n                        loadAnimationThumbnailContent(store, animation, message);\n                        break;\n                    }\n\n                    if (audio) {\n                        loadAudioThumbnailContent(store, audio, message);\n                        break;\n                    }\n\n                    if (document) {\n                        loadDocumentThumbnailContent(store, document, message);\n                        break;\n                    }\n\n                    if (sticker) {\n                        loadStickerThumbnailContent(store, sticker, message);\n                        break;\n                    }\n\n                    if (video) {\n                        loadVideoThumbnailContent(store, video, message);\n                        break;\n                    }\n\n                    if (video_note) {\n                        loadVideoNoteThumbnailContent(store, video_note, message);\n                        break;\n                    }\n\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n\n                    loadVideoThumbnailContent(store, video, message);\n                    break;\n                }\n                case 'messageVideoNote': {\n                    const { video_note } = content;\n\n                    loadVideoNoteThumbnailContent(store, video_note, message);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nfunction loadAudioContent(store, audio, message, useFileSize = true) {\n    if (!audio) return;\n\n    let { audio: file } = audio;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAudioBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_AUDIO_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || audio);\n            }\n        }\n    );\n}\n\nfunction loadAudioThumbnailContent(store, audio, message) {\n    if (!audio) return false;\n\n    const { album_cover_thumbnail: thumbnail } = audio;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAudioThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || audio)\n    );\n\n    return true;\n}\n\nfunction cancelLoadAnimationContent(animation) {\n    const { animation: file } = animation;\n    if (!file) return;\n\n    const { id } = file;\n\n    const blob = file.blob || FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nexport function loadAnimationContent(store, animation, message, useFileSize = true) {\n    if (!animation) return;\n\n    let { animation: file } = animation;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAnimationBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_ANIMATION_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || animation);\n            }\n        }\n    );\n}\n\nfunction cancelLoadAnimationThumbnailContent(animation){\n    if (!animation) return;\n\n    const { thumbnail } = animation;\n    if (!thumbnail) return;\n\n    let { file } = thumbnail;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nexport function loadAnimationThumbnailContent(store, animation, message) {\n    if (!animation) return false;\n\n    const { thumbnail } = animation;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAnimationThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || animation)\n    );\n\n    return true;\n}\n\nfunction loadContactContent(store, contact, message) {\n    if (!contact) return;\n    if (!message) return;\n\n    const { user_id } = contact;\n    const user = UserStore.get(user_id);\n    if (!user) return;\n\n    loadUserContent(store, user);\n}\n\nfunction loadDocumentContent(store, document, message, useFileSize = true) {\n    if (!document) return;\n\n    let { document: file } = document;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateDocumentBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_DOCUMENT_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || document);\n            }\n        }\n    );\n}\n\nfunction loadDocumentThumbnailContent(store, document, message) {\n    if (!document) return false;\n\n    const { thumbnail } = document;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateDocumentThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || document)\n    );\n\n    return true;\n}\n\nfunction loadGameContent(store, game, message, useFileSize = true) {\n    if (!game) return;\n\n    const { animation } = game;\n\n    loadAnimationContent(store, animation, message, useFileSize);\n}\n\nfunction loadGameThumbnailContent(store, game, message) {\n    if (!game) return false;\n\n    const { photo, animation } = game;\n    if (loadAnimationThumbnailContent(store, animation, message)) {\n        return true;\n    }\n\n    loadPhotoContent(store, photo, message);\n    return true;\n}\n\nasync function loadPageBlockMapContent(store, pageBlockMap, message) {\n    if (!pageBlockMap) return;\n\n    const { location } = pageBlockMap;\n    const locationId = getLocationId(location, IV_LOCATION_WIDTH, IV_LOCATION_HEIGHT);\n    if (!locationId) return;\n\n    let file = FileStore.getLocationFile(locationId);\n    if (!file) {\n        file = await TdLibController.send({\n            '@type': 'getMapThumbnailFile',\n            location,\n            width: IV_LOCATION_WIDTH,\n            height: IV_LOCATION_HEIGHT,\n            zoom: LOCATION_ZOOM,\n            scale: LOCATION_SCALE,\n            chat_id: message ? message.chat_id : 0\n        });\n        FileStore.setLocationFile(locationId, file);\n\n        store = FileStore.getStore();\n    }\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateLocationBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || pageBlockMap)\n    );\n}\n\nasync function loadLocationContent(store, location, message) {\n    if (!location) return;\n\n    const locationId = getLocationId(location);\n    if (!locationId) return;\n\n    let file = FileStore.getLocationFile(locationId);\n    if (!file) {\n        file = await TdLibController.send({\n            '@type': 'getMapThumbnailFile',\n            location,\n            width: LOCATION_WIDTH,\n            height: LOCATION_HEIGHT,\n            zoom: LOCATION_ZOOM,\n            scale: LOCATION_SCALE,\n            chat_id: message ? message.chat_id : 0\n        });\n        FileStore.setLocationFile(locationId, file);\n\n        store = FileStore.getStore();\n    }\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateLocationBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || location)\n    );\n}\n\nfunction cancelLoadBigPhotoContent(photo) {\n    if (!photo) return;\n\n    const { sizes } = photo;\n    if (!sizes) return;\n\n    const photoSize = getSize(sizes, PHOTO_BIG_SIZE);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nfunction loadBigPhotoContent(store, photo, message) {\n    if (!photo) return;\n\n    const { sizes } = photo;\n    if (!sizes) return;\n\n    const photoSize = getSize(sizes, PHOTO_BIG_SIZE);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updatePhotoBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || photo)\n    );\n}\n\nfunction loadPhotoContent(store, photo, message, displaySize = PHOTO_SIZE) {\n    if (!photo) return;\n\n    const { sizes } = photo;\n    if (!sizes) return;\n\n    const photoSize = getPhotoSize(sizes, displaySize);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updatePhotoBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || photo)\n    );\n}\n\nfunction loadPhotoThumbnailContent(store, photo, message) {\n    if (!photo) return false;\n    if (!message) return false;\n\n    const thumbSize = getPhotoThumbnailSize(photo.sizes);\n    if (!thumbSize) return false;\n\n    const photoSize = getPhotoSize(photo.sizes);\n    if (photoSize === thumbSize) return;\n\n    let { photo: file } = thumbSize;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updatePhotoBlob(message.chat_id, message.id, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message)\n    );\n\n    return true;\n}\n\nfunction loadStickerContent(store, sticker, message, useFileSize = true) {\n    // console.log('[sp] loadStickerContent')\n    if (!sticker) return;\n\n    let { sticker: file } = sticker;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateStickerBlob(chatId, messageId, id, sticker),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_STICKER_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || sticker);\n            }\n        }\n    );\n}\n\nfunction loadStickerThumbnailContent(store, sticker, message) {\n    if (!sticker) return false;\n\n    const { thumbnail } = sticker;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateStickerThumbnailBlob(chatId, messageId, id, sticker),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || sticker)\n    );\n\n    return true;\n}\n\nfunction cancelLoadVideoContent(video) {\n    if (!video) return;\n\n    let { video: file } = video;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nfunction loadVideoContent(store, video, message, useFileSize = true) {\n    if (!video) return;\n\n    let { video: file, supports_streaming } = video;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    if (supports_streaming && supportsStreaming()) {\n        return;\n    }\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_VIDEO_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || video);\n            }\n        }\n    );\n}\n\nfunction cancelLoadVideoThumbnailContent(video) {\n    if (!video) return;\n\n    const { thumbnail } = video;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nfunction loadVideoThumbnailContent(store, video, message) {\n    if (!video) return false;\n\n    const { thumbnail } = video;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || video)\n    );\n\n    return true;\n}\n\nfunction loadVideoNoteContent(store, videoNote, message, useFileSize = true) {\n    if (!videoNote) return;\n\n    let { video: file } = videoNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoNoteBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_VIDEONOTE_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || videoNote);\n            }\n        }\n    );\n}\n\nfunction loadVideoNoteThumbnailContent(store, videoNote, message) {\n    if (!videoNote) return false;\n\n    const { thumbnail } = videoNote;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoNoteThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || videoNote)\n    );\n\n    return true;\n}\n\nfunction loadVoiceNoteContent(store, voiceNote, message, useFileSize = true) {\n    if (!voiceNote) return;\n\n    let { voice: file } = voiceNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVoiceNoteBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_VOICENOTE_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || voiceNote);\n            }\n        }\n    );\n}\n\nfunction loadMessageContents(store, messages) {\n    const users = new Map();\n    const chats = new Map();\n    let chatId = 0;\n    const replies = new Map();\n\n    for (let i = messages.length - 1; i >= 0; i--) {\n        const message = messages[i];\n        if (!message) {\n            continue;\n        }\n\n        const { chat_id, content, sender, reply_to_message_id, forward_info } = message;\n\n        if (sender.user_id) {\n            users.set(sender.user_id, sender.user_id);\n        } else if (sender.chat_id) {\n            chats.set(sender.chat_id, sender.chat_id);\n        }\n\n        if (forward_info) {\n            const { origin } = forward_info;\n            switch (origin['@type']) {\n                case 'messageForwardOriginChannel': {\n                    chats.set(origin.chat_id, origin.chat_id);\n                    break;\n                }\n                case 'messageForwardOriginHiddenUser': {\n                    break;\n                }\n                case 'messageForwardOriginUser': {\n                    users.set(origin.sender_user_id, origin.sender_user_id);\n                    break;\n                }\n            }\n        }\n\n        if (reply_to_message_id) {\n            chatId = chat_id;\n            replies.set(reply_to_message_id, reply_to_message_id);\n        }\n\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationContent(store, animation, message);\n                    loadAnimationThumbnailContent(store, animation, message);\n                    break;\n                }\n                case 'messageAudio': {\n                    const { audio } = content;\n\n                    loadAudioContent(store, audio, message);\n                    loadAudioThumbnailContent(store, audio, message);\n                    break;\n                }\n                case 'messageChatChangePhoto': {\n                    const { photo } = content;\n\n                    loadPhotoContent(store, photo, message);\n                    loadBigPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageContact': {\n                    const { contact } = content;\n\n                    loadContactContent(store, contact, message);\n                    break;\n                }\n                case 'messageDocument': {\n                    const { document } = content;\n\n                    loadDocumentContent(store, document, message);\n                    loadDocumentThumbnailContent(store, document, message);\n                    break;\n                }\n                case 'messageGame': {\n                    const { game } = content;\n\n                    loadGameContent(store, game, message);\n                    loadGameThumbnailContent(store, game, message);\n                    break;\n                }\n                case 'messageInvoice': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    loadPhotoContent(store, photo, message);\n                    loadPhotoThumbnailContent(store, photo, message);\n                    break;\n                }\n                case 'messageLocation': {\n                    const { location } = content;\n\n                    loadLocationContent(store, location, message);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (!web_page) {\n                        break;\n                    }\n\n                    const { animation, audio, document, photo, sticker, video, video_note, voice_note } = web_page;\n                    let loadPhoto = true;\n\n                    if (animation) {\n                        loadAnimationContent(store, animation, message);\n                        loadPhoto = !loadAnimationThumbnailContent(store, animation, message);\n                    }\n\n                    if (audio) {\n                        loadAudioContent(store, audio, message);\n                        loadPhoto = !loadAudioThumbnailContent(store, audio, message);\n                    }\n\n                    if (document) {\n                        loadDocumentContent(store, document, message);\n                        loadPhoto = !loadDocumentThumbnailContent(store, document, message);\n                    }\n\n                    if (sticker) {\n                        loadStickerContent(store, sticker, message);\n                        loadPhoto = !loadStickerThumbnailContent(store, sticker, message);\n                    }\n\n                    if (video) {\n                        // loadVideoContent(store, video, message); // start loading only on video click event\n                        loadPhoto = !loadVideoThumbnailContent(store, video, message);\n                    }\n\n                    if (video_note) {\n                        loadVideoNoteContent(store, video_note, message);\n                        loadPhoto = !loadVideoNoteThumbnailContent(store, video_note, message);\n                    }\n\n                    if (voice_note) {\n                        loadVoiceNoteContent(store, voice_note, message);\n                    }\n\n                    if (loadPhoto) {\n                        loadBigPhotoContent(store, photo, message);\n                        loadPhotoContent(store, photo, message);\n                        loadPhotoThumbnailContent(store, photo, message);\n                    }\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    loadPhotoContent(store, photo, message);\n                    loadPhotoThumbnailContent(store, photo, message);\n                    break;\n                }\n                case 'messageSticker': {\n                    const { sticker } = content;\n\n                    loadStickerContent(store, sticker, message);\n                    loadStickerThumbnailContent(store, sticker, message);\n                    break;\n                }\n                case 'messageVenue': {\n                    const { venue } = content;\n                    const { location } = venue;\n\n                    loadLocationContent(store, location, message);\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n\n                    // loadVideoContent(store, video, message); // start loading only on video click event\n                    loadVideoThumbnailContent(store, video, message);\n                    break;\n                }\n                case 'messageVideoNote': {\n                    const { video_note } = content;\n\n                    loadVideoNoteContent(store, video_note, message);\n                    loadVideoNoteThumbnailContent(store, video_note, message);\n                    break;\n                }\n                case 'messageVoiceNote': {\n                    const { voice_note } = content;\n\n                    loadVoiceNoteContent(store, voice_note, message);\n                    break;\n                }\n                default: {\n                    break;\n                }\n            }\n        }\n    }\n\n    loadUsersContent(store, [...users.keys()]);\n    loadChatsContent(store, [...chats.keys()]);\n    loadReplies(store, chatId, [...replies.keys()]);\n}\n\nexport function saveMedia(media, message) {\n    if (!media) return;\n\n    switch (media['@type']) {\n        case 'animation': {\n            saveAnimation(media, message);\n            break;\n        }\n        case 'document': {\n            saveDocument(media, message);\n            break;\n        }\n        case 'photo': {\n            savePhoto(media, message);\n            break;\n        }\n        case 'video': {\n            saveVideo(media, message);\n            break;\n        }\n    }\n}\n\nfunction saveAnimation(animation, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!animation) return;\n\n    const { animation: file, file_name } = animation;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, file_name || fileId + '.mp4', message || animation, () =>\n        FileStore.updateAnimationBlob(chatId, messageId, fileId)\n    );\n}\n\nfunction saveDocument(document, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!document) return;\n\n    const { document: file, file_name } = document;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, file_name || fileId, message || document, () =>\n        FileStore.updateDocumentBlob(chatId, messageId, fileId)\n    );\n}\n\nfunction saveVideo(video, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!video) return;\n\n    const { video: file, file_name } = video;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, file_name || fileId + '.mp4', message || video, () =>\n        FileStore.updateVideoBlob(chatId, messageId, fileId)\n    );\n}\n\nfunction savePhoto(photo, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!photo) return;\n\n    const photoSize = getSize(photo.sizes, PHOTO_BIG_SIZE);\n    if (!photoSize) return;\n\n    const { photo: file } = photoSize;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, fileId + '.jpg', message || photo, () => FileStore.updatePhotoBlob(chatId, messageId, fileId));\n}\n\nfunction saveOrDownload(file, fileName, obj, callback) {\n    if (!file) return;\n    if (!fileName) return;\n\n    if (file.arr) {\n        saveData(file.arr, fileName);\n        return;\n    }\n\n    let blob = FileStore.getBlob(file.id) || file.blob;\n    if (blob) {\n        saveBlob(blob, fileName);\n        return;\n    }\n\n    download(file, obj, () => {\n        if (callback) callback();\n\n        blob = FileStore.getBlob(file.id) || file.blob;\n        if (blob) {\n            saveBlob(blob, fileName);\n        }\n    });\n}\n\nfunction download(file, obj, callback) {\n    if (!file) return;\n    const { id, local } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) {\n        return;\n    }\n\n    if (local.is_downloading_completed) {\n        const store = FileStore.getStore();\n\n        FileStore.getLocalFile(store, file, null, callback, () => {\n            if (local.can_be_downloaded) {\n                FileStore.getRemoteFile(file.id, FILE_PRIORITY, obj);\n            }\n        });\n        return;\n    }\n\n    if (local.can_be_downloaded) {\n        FileStore.getRemoteFile(id, FILE_PRIORITY, obj);\n    }\n}\n\nexport function getViewerMinithumbnail(media) {\n    if (!media) return null;\n\n    switch (media['@type']) {\n        case 'animation': {\n            return media.minithumbnail;\n        }\n        case 'document': {\n            return media.minithumbnail;\n        }\n        case 'photo': {\n            return media.minithumbnail;\n        }\n        case 'video': {\n            return media.minithumbnail;\n        }\n        case 'videoNote': {\n            return media.minithumbnail;\n        }\n        default: {\n            return null;\n        }\n    }\n}\n\nfunction getViewerThumbnail(media) {\n    if (!media) return null;\n\n    switch (media['@type']) {\n        case 'animation': {\n            return media.thumbnail;\n        }\n        case 'audio': {\n            return media.album_cover_thumbnail;\n        }\n        case 'document': {\n            return media.thumbnail;\n        }\n        case 'photo': {\n            const [width, height, file] = getViewerFile(media, PHOTO_SIZE);\n\n            return { '@type': 'thumbnail', format: { '@type': 'thumbnailFormatJpeg' }, file, width, height };\n        }\n        case 'sticker': {\n            return media.thumbnail;\n        }\n        case 'video': {\n            return media.thumbnail;\n        }\n        case 'videoNote': {\n            return media.thumbnail;\n        }\n        default: {\n            return null;\n        }\n    }\n}\n\nexport function getMediaMinithumbnail(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return [0, 0, null];\n\n    const { content } = message;\n    if (!content) return [0, 0, null];\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation && animation.minithumbnail) {\n                return [animation.minithumbnail.width, animation.minithumbnail.height, animation.minithumbnail];\n            }\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (photo && photo.minithumbnail) {\n                return [photo.minithumbnail.width, photo.minithumbnail.height, photo.minithumbnail];\n            }\n            break;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document && document.minithumbnail) {\n                return [document.minithumbnail.width, document.minithumbnail.height, document.minithumbnail];\n            }\n            break;\n        }\n        case 'messageInvoice':\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (photo && photo.minithumbnail) {\n                return [photo.minithumbnail.width, photo.minithumbnail.height, photo.minithumbnail];\n            }\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, document, video, photo } = web_page;\n\n                if (animation && animation.minithumbnail) {\n                    return [animation.minithumbnail.width, animation.minithumbnail.height, animation.minithumbnail];\n                }\n\n                if (document && document.minithumbnail) {\n                    return [document.minithumbnail.width, document.minithumbnail.height, document.minithumbnail];\n                }\n\n                if (video && video.minithumbnail) {\n                    return [video.minithumbnail.width, video.minithumbnail.height, video.minithumbnail];\n                }\n\n                if (photo && photo.minithumbnail) {\n                    return [photo.minithumbnail.width, photo.minithumbnail.height, photo.minithumbnail];\n                }\n            }\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video && video.minithumbnail) {\n                return [video.minithumbnail.width, video.minithumbnail.height, video.minithumbnail];\n            }\n            break;\n        }\n        default: {\n            return [0, 0, null];\n        }\n    }\n\n    return [0, 0, null];\n}\n\nexport function getMediaThumbnail(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation && animation.thumbnail) {\n                return animation.thumbnail;\n            }\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            const [width, height, file] = getMediaFile(chatId, messageId, PHOTO_SIZE);\n\n            return { '@type': 'thumbnail', format: 'thumbnailFormatJpeg', file, width, height };\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document.thumbnail) {\n                return document.thumbnail;\n            }\n            break;\n        }\n        case 'messageInvoice':\n        case 'messagePhoto': {\n            const [width, height, file] = getMediaFile(chatId, messageId, PHOTO_SIZE);\n\n            return { '@type': 'thumbnail', format: 'thumbnailFormatJpeg', file, width, height };\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, document, video, photo } = web_page;\n\n                if (animation && animation.thumbnail) {\n                    return animation.thumbnail;\n                }\n\n                if (document && document.thumbnail) {\n                    return document.thumbnail;\n                }\n\n                if (video && video.thumbnail) {\n                    return video.thumbnail;\n                }\n\n                if (photo) {\n                    const [width, height, file] = getMediaFile(chatId, messageId, PHOTO_SIZE);\n\n                    return { '@type': 'thumbnail', format: 'thumbnailFormatJpeg', file, width, height };\n                }\n            }\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video && video.thumbnail) {\n                return video.thumbnail;\n            }\n            break;\n        }\n        default: {\n            return null;\n        }\n    }\n\n    return null;\n}\n\nfunction getViewerFile(media, size) {\n    if (!size) return [0, 0, null, '', false];\n\n    switch (media['@type']) {\n        case 'animation': {\n            return [media.width, media.height, media.animation, media.mime_type, false];\n        }\n        case 'photo': {\n            const photoSize = getSize(media.sizes, size);\n            if (photoSize) {\n                return [photoSize.width, photoSize.height, photoSize.photo, '', false];\n            }\n            break;\n        }\n        case 'document': {\n            return [50, 50, document.document, document.mime_type, false];\n        }\n        case 'video': {\n            return [media.width, media.height, media.video, media.mime_type, media.supports_streaming && supportsStreaming()];\n        }\n        default: {\n        }\n    }\n\n    return [0, 0, null, '', false];\n}\n\nfunction getMediaFile(chatId, messageId, size) {\n    if (!size) return [0, 0, null, '', false];\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return [0, 0, null, '', false];\n\n    const { content } = message;\n    if (!content) return [0, 0, null, '', false];\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation) {\n                const { width, height, animation: file, mime_type } = animation;\n                return [width, height, file, mime_type, false];\n            }\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (photo) {\n                const photoSize = getSize(photo.sizes, size);\n                if (photoSize) {\n                    const { width, height, photo: file } = photoSize;\n                    return [width, height, file, '', false];\n                }\n            }\n            break;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document) {\n                const { document: file, mime_type } = document;\n                return [50, 50, file, mime_type, false];\n            }\n            break;\n        }\n        case 'messageInvoice':\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (photo) {\n                const photoSize = getSize(photo.sizes, size);\n                if (photoSize) {\n                    const { width, height, photo: file } = photoSize;\n                    return [width, height, file, '', false];\n                }\n            }\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, document, photo, video } = web_page;\n                if (animation) {\n                    const { width, height, animation: file, mime_type } = animation;\n                    return [width, height, file, mime_type, false];\n                }\n\n                if (document) {\n                    const { document: file, mime_type } = document;\n                    return [50, 50, file, mime_type, false];\n                }\n\n                if (video) {\n                    const { width, height, video: file, mime_type, supports_streaming } = video;\n                    return [width, height, file, mime_type, supports_streaming && supportsStreaming()];\n                }\n\n                if (photo) {\n                    const photoSize = getSize(photo.sizes, size);\n                    if (photoSize) {\n                        const { width, height, photo: file } = photoSize;\n                        return [width, height, file, '', false];\n                    }\n                    break;\n                }\n            }\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video) {\n                const { width, height, video: file, mime_type, supports_streaming } = video;\n                return [width, height, file, mime_type, supports_streaming && supportsStreaming()];\n            }\n            break;\n        }\n        default: {\n        }\n    }\n\n    return [0, 0, null, '', false];\n}\n\nexport function cancelLoadIVMediaViewerContent(blocks) {\n    if (!blocks) return;\n    if (!blocks.length) return;\n\n    for (let i = 0; i < blocks.length; i++) {\n        const content = blocks[i];\n        if (content) {\n            switch (content['@type']) {\n                case 'pageBlockAnimation': {\n                    const { animation } = content;\n                    if (!animation) break;\n\n                    cancelLoadAnimationThumbnailContent(animation);\n                    cancelLoadAnimationContent(animation);\n                    break;\n                }\n                case 'pageBlockPhoto': {\n                    const { photo } = content;\n                    if (!photo) break;\n\n                    cancelLoadBigPhotoContent(photo);\n                    break;\n                }\n                case 'pageBlockVideo': {\n                    const { video } = content;\n                    if (!video) break;\n\n                    cancelLoadVideoThumbnailContent(video);\n                    cancelLoadVideoContent(video);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nfunction cancelLoadMediaViewerContent(messages) {\n    if (!messages) return;\n    if (!messages.length) return;\n\n    for (let i = 0; i < messages.length; i++) {\n        let message = messages[i];\n        const { content } = message;\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n                    if (!animation) break;\n\n                    cancelLoadAnimationThumbnailContent(animation);\n                    cancelLoadAnimationContent(animation);\n                    break;\n                }\n                case 'messageInvoice': {\n                    const { photo } = content;\n                    if (!photo) break;\n\n                    cancelLoadBigPhotoContent(photo);\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n                    if (!photo) break;\n\n                    cancelLoadBigPhotoContent(photo);\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n                    if (!video) break;\n\n                    cancelLoadVideoThumbnailContent(video);\n                    cancelLoadVideoContent(video);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = message.content;\n                    if (web_page) {\n                        const { animation, photo, video } = web_page;\n\n                        if (animation) {\n                            cancelLoadAnimationThumbnailContent(animation);\n                            cancelLoadAnimationContent(animation);\n                        }\n\n                        if (photo) {\n                            cancelLoadBigPhotoContent(photo);\n                        }\n\n                        if (video) {\n                            cancelLoadVideoThumbnailContent(video);\n                            cancelLoadVideoContent(video);\n                        }\n                    }\n\n                    break;\n                }\n            }\n        }\n    }\n}\n\nexport function loadIVMediaViewerContent(blocks, useSizeLimit = false) {\n    if (!blocks) return;\n    if (!blocks.length) return;\n\n    const store = FileStore.getStore();\n\n    for (let i = 0; i < blocks.length; i++) {\n        const content = blocks[i];\n        if (content) {\n            switch (content['@type']) {\n                case 'pageBlockAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationContent(store, animation, null, useSizeLimit);\n                    loadAnimationThumbnailContent(store, animation, null);\n                    break;\n                }\n                case 'pageBlockPhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, null);\n                    break;\n                }\n                case 'pageBlockVideo': {\n                    const { video } = content;\n\n                    loadVideoThumbnailContent(store, video, null);\n                    loadVideoContent(store, video, null, useSizeLimit);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nfunction loadMediaViewerContent(messages, useSizeLimit = false) {\n    if (!messages) return;\n    if (!messages.length) return;\n\n    const store = FileStore.getStore();\n\n    for (let i = 0; i < messages.length; i++) {\n        let message = messages[i];\n        const { content } = message;\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationContent(store, animation, message, useSizeLimit);\n                    loadAnimationThumbnailContent(store, animation, message);\n                    break;\n                }\n                case 'messageChatChangePhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageDocument': {\n                    const { document } = content;\n\n                    loadDocumentContent(store, document, message, useSizeLimit);\n                    break;\n                }\n                case 'messageInvoice': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = message.content;\n                    if (!web_page) {\n                        break;\n                    }\n\n                    const { animation, document, photo, video } = web_page;\n                    let loadPhoto = true;\n\n                    if (animation) {\n                        loadAnimationContent(store, animation, message, useSizeLimit);\n                        loadPhoto = !loadAnimationThumbnailContent(store, animation, message);\n                    }\n\n                    if (document) {\n                        loadDocumentContent(store, document, message, useSizeLimit);\n                        loadPhoto = false;\n                    }\n\n                    if (video) {\n                        loadVideoContent(store, video, message, useSizeLimit);\n                        loadPhoto = !loadVideoThumbnailContent(store, video, message);\n                    }\n\n                    if (loadPhoto) {\n                        loadBigPhotoContent(store, photo, message);\n                    }\n\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n\n                    loadVideoThumbnailContent(store, video, message);\n                    loadVideoContent(store, video, message, useSizeLimit);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nexport function cancelPreloadIVMediaViewerContent(index, blocks) {\n    if (!blocks.length) return;\n\n    const preload = [];\n    if (index > 0) {\n        preload.push(blocks[index - 1]);\n    }\n    if (index < blocks.length - 1) {\n        preload.push(blocks[index + 1]);\n    }\n\n    cancelLoadIVMediaViewerContent([blocks[index]]);\n    cancelLoadIVMediaViewerContent(blocks);\n}\n\nfunction cancelPreloadMediaViewerContent(index, history) {\n    if (!history.length) return;\n\n    const messages = [];\n    if (index > 0) {\n        messages.push(history[index - 1]);\n    }\n    if (index < history.length - 1) {\n        messages.push(history[index + 1]);\n    }\n\n    cancelLoadMediaViewerContent([history[index]]);\n    cancelLoadMediaViewerContent(messages);\n}\n\nfunction preloadMediaViewerContent(index, history) {\n    if (!history.length) return;\n\n    const messages = [];\n    if (index > 0) {\n        messages.push(history[index - 1]);\n    }\n    if (index < history.length - 1) {\n        messages.push(history[index + 1]);\n    }\n\n    loadMediaViewerContent([history[index]], false);\n    loadMediaViewerContent(messages, true);\n}\n\nexport function preloadIVMediaViewerContent(index, blocks) {\n    if (!blocks.length) return;\n\n    const preload = [];\n    if (index > 0) {\n        preload.push(blocks[index - 1]);\n    }\n    if (index < blocks.length - 1) {\n        preload.push(blocks[index + 1]);\n    }\n\n    loadIVMediaViewerContent([blocks[index]], false);\n    loadIVMediaViewerContent(preload, true);\n}\n\nfunction loadUserFileContent(store, file, userId) {\n    if (!file) return;\n\n    const { id } = file;\n    file = FileStore.get(id) || file;\n\n    const user = UserStore.get(userId);\n    if (!user) return;\n\n    const blob = file.blob || FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateUserPhotoBlob(userId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, user)\n    );\n}\n\nfunction loadChatFileContent(store, file, chatId) {\n    if (!file) return;\n\n    const { id } = file;\n    file = FileStore.get(id) || file;\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const dataUrl = FileStore.getDataUrl(id);\n    if (dataUrl) return;\n\n    const blob = file.blob || FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateChatPhotoBlob(chatId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, chat)\n    );\n}\n\nfunction loadProfileMediaViewerContent(chatId, photos) {\n    if (!photos) return;\n\n    const store = FileStore.getStore();\n\n    photos.forEach(photo => {\n        switch (photo['@type']) {\n            case 'chatPhoto': {\n                photo = getProfilePhoto(photo);\n                if (!photo) break;\n\n                const userId = getChatUserId(chatId);\n\n                const { small, big } = photo;\n\n                loadUserFileContent(store, small, userId);\n                loadUserFileContent(store, big, userId);\n                break;\n            }\n            case 'chatPhotoInfo': {\n                const { small, big } = photo;\n\n                loadChatFileContent(store, small, chatId);\n                loadChatFileContent(store, big, chatId);\n                break;\n            }\n            case 'profilePhoto': {\n                const userId = getChatUserId(chatId);\n\n                const { small, big } = photo;\n\n                loadUserFileContent(store, small, userId);\n                loadUserFileContent(store, big, userId);\n                break;\n            }\n        }\n    });\n}\n\nfunction preloadProfileMediaViewerContent(chatId, index, history) {\n    if (!history.length) return;\n\n    const items = [];\n    if (index > 0) {\n        items.push(history[index - 1]);\n    }\n    if (index < history.length - 1) {\n        items.push(history[index + 1]);\n    }\n    if (index >= 0 && index < history.length) {\n        items.push(history[index]);\n    }\n\n    loadProfileMediaViewerContent(chatId, items);\n}\n\nfunction loadUserContent(store, userId) {\n    const user = UserStore.get(userId);\n    if (!user) return;\n\n    const { profile_photo } = user;\n    if (!profile_photo) return;\n\n    const { small: file } = profile_photo;\n\n    loadUserFileContent(store, file, userId);\n}\n\nfunction loadUsersContent(store, ids) {\n    if (!ids) return;\n\n    ids.forEach(id => loadUserContent(store, id));\n}\n\nfunction loadChatContent(store, chatId, full = false) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const { photo } = chat;\n    loadChatPhotoContent(store, photo, chat.id, full);\n}\n\nfunction loadChatPhotoContent(store, photo, chatId, full) {\n    if (!photo) return;\n\n    const { small, big } = photo;\n\n    loadChatFileContent(store, small, chatId);\n    if (full) loadChatFileContent(store, big, chatId);\n}\n\nfunction loadChatsContent(store, ids) {\n    if (!ids) return;\n\n    ids.forEach(id => loadChatContent(store, id));\n}\n\nfunction loadDraftContent(store, chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const { draft_message } = chat;\n    if (!draft_message) return;\n\n    const { reply_to_message_id } = draft_message;\n    if (!reply_to_message_id) return;\n\n    loadReplies(store, chatId, [reply_to_message_id]);\n}\n\nexport function loadRecentStickersContent(store, recent) {\n    if (!recent) return;\n\n    const { stickers } = recent;\n    loadStickersContent(store, stickers);\n}\n\nfunction loadStickerSetContent(store, stickerSet) {\n    // console.log('[sp] loadStickerSetContent');\n    if (!stickerSet) return;\n\n    const { stickers } = stickerSet;\n    loadStickersContent(store, stickers);\n}\n\nexport function loadBackgroundsContent(store, backgrounds) {\n    if (!backgrounds) return;\n\n    backgrounds.forEach(background => {\n        loadBackgroundContent(store, background, false);\n    });\n}\n\nexport function loadBackgroundContent(store, background, full = false) {\n    if (!background) return;\n\n    switch (background.type['@type']) {\n        case 'backgroundTypeFill': {\n            break;\n        }\n        case 'backgroundTypePattern': {\n            const { document } = background;\n            if (document) {\n                loadDocumentThumbnailContent(store, document, null);\n                if (full) loadDocumentContent(store, document, null, false);\n            }\n            break;\n        }\n        case 'backgroundTypeWallpaper': {\n            const { document } = background;\n            if (document) {\n                loadDocumentThumbnailContent(store, document, null);\n                if (full) loadDocumentContent(store, document, null, false);\n            }\n            break;\n        }\n    }\n}\n\nfunction loadStickersContent(store, stickers) {\n    if (!stickers) return;\n\n    stickers.forEach(sticker => {\n        loadStickerThumbnailContent(store, sticker, null);\n        if (sticker.is_animated) {\n            loadStickerContent(store, sticker, null);\n        }\n    });\n}\n\nfunction isGifMimeType(mimeType) {\n    return mimeType && mimeType.toLowerCase() === 'image/gif';\n}\n\nfunction getSrc(file) {\n    const dataUrl = file && FileStore.getDataUrl(file.id);\n    if (dataUrl) return dataUrl;\n\n    const blob = getBlob(file);\n\n    return FileStore.getBlobUrl(blob) || '';\n}\n\nexport function getPngSrc(file) {\n    const blob = getPngBlob(file);\n\n    return FileStore.getBlobUrl(blob) || '';\n}\n\nfunction getBlob(file) {\n    return file ? FileStore.getBlob(file.id) || file.blob : null;\n}\n\nfunction getPngBlob(file) {\n    return file ? FileStore.getPngBlob(file.id) || file.blob : null;\n}\n\nfunction getDownloadedSize(file) {\n    if (!file) return '0';\n    if (!file.local) return '0';\n    if (!file.local.is_downloading_active) return '0';\n\n    return getSizeString(file.local.downloaded_size);\n}\n\nfunction getUploadedSize(file) {\n    if (!file) return '0';\n    if (!file.remote) return '0';\n    if (!file.remote.is_uploading_active) return '0';\n\n    return getSizeString(file.remote.uploaded_size);\n}\n\nfunction getExtension(fileName) {\n    if (!fileName) {\n        return '';\n    }\n\n    const parts = fileName.split('.');\n    if (parts.length === 1 || (parts[0] === '' && parts.length === 2)) {\n        return '';\n    }\n    return parts.pop().toLowerCase();\n}\n\nfunction loadInstantViewContent(instantView) {\n    if (!instantView) return;\n\n    const { page_blocks } = instantView;\n    if (!page_blocks) return;\n\n    const store = FileStore.getStore();\n\n    page_blocks.forEach(pageBlock => loadPageBlockContent(store, pageBlock));\n}\n\nfunction loadPageBlockContent(store, b) {\n    if (!b) return;\n\n    switch (b['@type']) {\n        case 'pageBlockAnchor': {\n            break;\n        }\n        case 'pageBlockAnimation': {\n            const { animation, caption } = b;\n\n            loadAnimationThumbnailContent(store, animation, null);\n            loadAnimationContent(store, animation, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockAudio': {\n            const { audio, caption } = b;\n\n            loadAudioThumbnailContent(store, audio, null);\n            loadAudioContent(store, audio, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockAuthorDate': {\n            const { author } = b;\n\n            loadRichTextContent(store, author);\n            break;\n        }\n        case 'pageBlockBlockQuote': {\n            const { text, credit } = b;\n\n            loadRichTextContent(store, text);\n            loadRichTextContent(store, credit);\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockCaption': {\n            const { text, credit } = b;\n\n            loadRichTextContent(store, text);\n            loadRichTextContent(store, credit);\n            break;\n        }\n        case 'pageBlockChatLink': {\n            const { photo } = b;\n\n            loadChatPhotoContent(store, photo, 0);\n            break;\n        }\n        case 'pageBlockCollage': {\n            const { page_blocks, caption } = b;\n\n            loadPageBlockContent(store, caption);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockCover': {\n            const { cover } = b;\n\n            loadPageBlockContent(store, cover);\n            break;\n        }\n        case 'pageBlockDetails': {\n            const { header, page_blocks } = b;\n\n            loadPageBlockContent(store, header);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockDivider': {\n            break;\n        }\n        case 'pageBlockEmbedded': {\n            const { poster_photo, caption } = b;\n\n            loadPhotoContent(store, poster_photo, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockEmbeddedPost': {\n            const { author_photo, page_blocks, caption } = b;\n\n            loadPhotoContent(store, author_photo, null);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockFooter': {\n            const { footer } = b;\n\n            loadRichTextContent(store, footer);\n            break;\n        }\n        case 'pageBlockHeader': {\n            const { header } = b;\n\n            loadRichTextContent(store, header);\n            break;\n        }\n        case 'pageBlockKicker': {\n            const { kicker } = b;\n\n            loadRichTextContent(store, kicker);\n            break;\n        }\n        case 'pageBlockList': {\n            const { items } = b;\n\n            items.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockListItem': {\n            const { page_blocks } = b;\n\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockMap': {\n            const { caption } = b;\n\n            loadPageBlockMapContent(store, b, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockParagraph': {\n            const { text } = b;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'pageBlockPhoto': {\n            const { photo, caption } = b;\n\n            loadPhotoContent(store, photo, null, IV_PHOTO_SIZE);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockPreformatted': {\n            const { text } = b;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'pageBlockPullQuote': {\n            const { text, credit } = b;\n\n            loadRichTextContent(store, text);\n            loadRichTextContent(store, credit);\n            break;\n        }\n        case 'pageBlockRelatedArticles': {\n            const { header, articles } = b;\n\n            loadRichTextContent(store, header);\n            articles.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockRelatedArticle': {\n            const { photo } = b;\n\n            loadPhotoContent(store, photo, null);\n            break;\n        }\n        case 'pageBlockSlideshow': {\n            const { page_blocks, caption } = b;\n\n            loadPageBlockContent(store, caption);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockSubheader': {\n            const { subheader } = b;\n\n            loadRichTextContent(store, subheader);\n            break;\n        }\n        case 'pageBlockSubtitle': {\n            const { subtitle } = b;\n\n            loadRichTextContent(store, subtitle);\n            break;\n        }\n        case 'pageBlockTable': {\n            const { caption, cells } = b;\n\n            loadRichTextContent(store, caption);\n            cells.forEach(row => row.forEach(x => loadPageBlockContent(store, x)));\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockTableCell': {\n            const { text } = b;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'pageBlockTitle': {\n            const { title } = b;\n\n            loadRichTextContent(store, title);\n            break;\n        }\n        case 'pageBlockVideo': {\n            const { video, caption } = b;\n\n            loadVideoThumbnailContent(store, video, null);\n            loadVideoContent(store, video, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockVoiceNote': {\n            const { voice_note, caption } = b;\n\n            loadVoiceNoteContent(store, voice_note, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n    }\n}\n\nfunction loadRichTextContent(store, t) {\n    if (!t) return;\n\n    switch (t['@type']) {\n        case 'richTextAnchor': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextBold': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextEmailAddress': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextFixed': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextIcon': {\n            const { document } = t;\n\n            loadDocumentThumbnailContent(store, document, null);\n            loadDocumentContent(store, document, null, false);\n            break;\n        }\n        case 'richTextItalic': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextMarked': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextPhoneNumber': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextPlain': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTexts': {\n            const { texts } = t;\n\n            texts.forEach(x => loadRichTextContent(store, x));\n            break;\n        }\n        case 'richTextStrikethrough': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextSubscript': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextSuperscript': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextUnderline': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextUrl': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n    }\n}\n\nfunction getAnimationData(file) {\n    return new Promise(resolve => {\n        if (!file) {\n            resolve(null);\n            return;\n        }\n\n        const blob = FileStore.getBlob(file.id);\n        if (!blob) {\n            resolve(null);\n            return;\n        }\n\n        const fileReader = new FileReader();\n        fileReader.onload = event => resolve(JSON.parse(event.target.result));\n        fileReader.onerror = () => resolve(null);\n        fileReader.onabort = () => resolve(null);\n        fileReader.readAsText(blob);\n    });\n}\n\nexport {\n    getFileSize,\n    getSizeString,\n    saveData,\n    saveBlob,\n    loadMessageContents,\n    loadMediaViewerContent,\n    preloadMediaViewerContent,\n    cancelLoadMediaViewerContent,\n    cancelPreloadMediaViewerContent,\n    loadProfileMediaViewerContent,\n    preloadProfileMediaViewerContent,\n    loadChatContent,\n    loadChatsContent,\n    loadDraftContent,\n    loadInstantViewContent,\n    loadStickerContent,\n    loadStickersContent,\n    loadStickerSetContent,\n    loadStickerThumbnailContent,\n    loadUserContent,\n    loadUsersContent,\n    saveOrDownload,\n    download,\n    getMediaFile,\n    isGifMimeType,\n    getSrc,\n    getBlob,\n    getDownloadedSize,\n    getUploadedSize,\n    getExtension,\n    getViewerFile,\n    getViewerThumbnail,\n    getAnimationData\n};\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { PHOTO_SIZE, PHOTO_THUMBNAIL_SIZE } from '../Constants';\n\nlet webpSupported = undefined;\n\nexport async function isWebpSupported() {\n    // return false;\n\n    if (webpSupported !== undefined) {\n        return webpSupported;\n    }\n\n    const promise = new Promise(resolve => {\n        const image = new Image();\n        image.onload = function () {\n            resolve(image.width === 2 && image.height === 1);\n        }\n        image.onerror = function () {\n            resolve(false);\n        }\n        image.src = 'data:image/webp;base64,UklGRjIAAABXRUJQVlA4ICYAAACyAgCdASoCAAEALmk0mk0iIiIiIgBoSygABc6zbAAA/v56QAAAAA==';\n    });\n\n    return webpSupported = await promise;\n}\n\nexport function isSafari() {\n    return /(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)\n        && !/Chrome/.test(navigator.userAgent)\n        && !/BlackBerry/.test(navigator.platform);\n}\n\nexport function mapEquals(map1, map2) {\n    if (!map1 || !map2) return false;\n\n    let testVal;\n    if (map1.size !== map2.size) {\n        return false;\n    }\n\n    for (let [key, val] of map1) {\n        testVal = map2.get(key);\n        // in cases of an undefined value, make sure the key\n        // actually exists on the object so there are no false positives\n        if (testVal !== val || (testVal === undefined && !map2.has(key))) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function isMobile() {\n    return isAndroid() || isIOS() || isWindowsPhone();\n}\n\nexport function isMacOS() {\n    return navigator.platform.toLowerCase().indexOf('mac') >= 0;\n}\n\nexport function isIOS() {\n    const iDevices = ['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod'];\n\n    if (!!navigator.platform && iDevices.indexOf(navigator.platform) > -1) {\n        return true;\n    }\n\n    return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n}\n\nexport function isAndroid() {\n    const ua = navigator.userAgent.toLowerCase();\n    return ua.indexOf('android') > -1;\n}\n\nexport function isWindowsPhone() {\n    if (navigator.userAgent.match(/Windows Phone/i)) {\n        return true;\n    }\n\n    if (navigator.userAgent.match(/iemobile/i)) {\n        return true;\n    }\n\n    if (navigator.userAgent.match(/WPDesktop/i)) {\n        return true;\n    }\n\n    return false;\n}\n\nfunction isAppleDevice() {\n    const iDevices = ['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod', 'MacIntel'];\n\n    if (!!navigator.platform) {\n        return iDevices.indexOf(navigator.platform) > -1;\n    }\n\n    return /iPad|iPhone|iPod|Mac\\sOS\\sX/.test(navigator.userAgent) && !window.MSStream;\n}\n\nfunction getOSName() {\n    const { userAgent } = window.navigator;\n\n    let OSName = 'Unknown';\n    if (userAgent.indexOf('Windows NT 10.0') !== -1) OSName = 'Windows 10';\n    if (userAgent.indexOf('Windows NT 6.2') !== -1) OSName = 'Windows 8';\n    if (userAgent.indexOf('Windows NT 6.1') !== -1) OSName = 'Windows 7';\n    if (userAgent.indexOf('Windows NT 6.0') !== -1) OSName = 'Windows Vista';\n    if (userAgent.indexOf('Windows NT 5.1') !== -1) OSName = 'Windows XP';\n    if (userAgent.indexOf('Windows NT 5.0') !== -1) OSName = 'Windows 2000';\n    if (userAgent.indexOf('Mac') !== -1) OSName = 'Mac/iOS';\n    if (userAgent.indexOf('X11') !== -1) OSName = 'UNIX';\n    if (userAgent.indexOf('Linux') !== -1) OSName = 'Linux';\n\n    return OSName;\n}\n\nfunction getBrowser() {\n    const { userAgent } = window.navigator;\n\n    let browser_name = '';\n    let isIE = /*@cc_on!@*/ false || !!document.documentMode;\n    let isEdge = !isIE && !!window.StyleMedia;\n    if (userAgent.indexOf('Chrome') !== -1 && !isEdge) {\n        browser_name = 'Chrome';\n    } else if (userAgent.indexOf('Safari') !== -1 && !isEdge) {\n        browser_name = 'Safari';\n    } else if (userAgent.indexOf('Firefox') !== -1) {\n        browser_name = 'Firefox';\n    } else if (userAgent.indexOf('MSIE') !== -1 || !!document.documentMode === true) {\n        //IF IE > 10\n        browser_name = 'IE';\n    } else if (isEdge) {\n        browser_name = 'Edge';\n    } else {\n        browser_name = 'Unknown';\n    }\n\n    return browser_name;\n}\n\nfunction stringToBoolean(string) {\n    switch (string.toLowerCase().trim()) {\n        case 'true':\n        case 'yes':\n        case '1':\n            return true;\n        case 'false':\n        case 'no':\n        case '0':\n        case null:\n            return false;\n        default:\n            return Boolean(string);\n    }\n}\n\nfunction orderCompare(order1, order2) {\n    let diff = order1.length - order2.length;\n    if (diff !== 0) return diff < 0 ? -1 : 1;\n    if (order1 === order2) return 0;\n\n    return order1 > order2 ? 1 : -1;\n}\n\nfunction getPhotoThumbnailSize(sizes) {\n    return getSize(sizes, PHOTO_THUMBNAIL_SIZE);\n}\n\nfunction getPhotoSize(sizes, displaySize = PHOTO_SIZE) {\n    return getSize(sizes, displaySize);\n}\n\nfunction getSize(sizes, dimension) {\n    if (!sizes) return null;\n    if (sizes.length === 0) return null;\n    if (dimension === 0) return null;\n\n    let iSize = sizes.find(x => x.type === 'i');\n    if (iSize){\n        return iSize;\n    }\n\n    let useWidth = sizes[0].width >= sizes[0].height;\n    let diff = Math.abs(dimension - (useWidth ? sizes[0].width : sizes[0].height));\n    let index = 0;\n    for (let i = 1; i < sizes.length; i++) {\n        if (!sizes[i]) {\n            continue;\n        }\n\n        if (sizes[i].type === 'i' && !sizes[i].photo.local.is_downloading_completed) {\n            continue;\n        }\n\n        let currDiff = Math.abs(dimension - (useWidth ? sizes[i].width : sizes[i].height));\n        if (currDiff < diff) {\n            index = i;\n            currDiff = diff;\n        }\n    }\n\n    return sizes[index];\n}\n\nfunction getFitSize(size, max, stretch = true) {\n    if (!size) return { width: 0, height: 0 };\n\n    if (!stretch) {\n        if (size.width < max && size.height < max) {\n            return size;\n        }\n    }\n\n    if (size.width > size.height) {\n        return { width: max, height: Math.floor((size.height * max) / size.width) };\n    }\n\n    return { width: Math.floor((size.width * max) / size.height), height: max };\n}\n\nfunction itemsInView(scrollContainerRef, itemsContainerRef) {\n    const scrollContainer = scrollContainerRef.current;\n    const itemsContainer = itemsContainerRef ? itemsContainerRef.current : scrollContainer;\n\n    const items = [];\n    for (let i = 0; i < itemsContainer.children.length; i++) {\n        const child = itemsContainer.children[i];\n        if (\n            child.offsetTop + child.offsetHeight >= scrollContainer.scrollTop &&\n            child.offsetTop <= scrollContainer.scrollTop + scrollContainer.offsetHeight\n        ) {\n            items.push(i);\n        }\n    }\n\n    return items;\n}\n\nexport function getScrollMessage(snapshot, itemsContainerRef) {\n    if (!snapshot) return { index: -1, offset: 0 };\n\n    const { current: itemsContainer } = itemsContainerRef;\n\n    for (let i = 0; i < itemsContainer.children.length; i++) {\n        const child = itemsContainer.children[i];\n        const offsetTop = child.offsetTop;\n        const scrollTop = snapshot.scrollTop;\n        const offsetHeight = snapshot.offsetHeight;\n        // console.log('[scroll] child', [i, offsetTop, child.offsetHeight, scrollTop]);\n\n        if (offsetTop >= scrollTop && offsetTop <= scrollTop + offsetHeight) {\n            return { index: i, offset: offsetTop - scrollTop, offsetTop, scrollTop };\n        }\n    }\n\n    return { index: -1, offset: 0 };\n}\n\n// Returns a function, that, when invoked, will only be triggered at most once\n// during a given window of time. Normally, the throttled function will run\n// as much as it can, without ever going more than once per `wait` duration;\n// but if you'd like to disable the execution on the leading edge, pass\n// `{leading: false}`. To disable execution on the trailing edge, ditto.\nfunction throttle(func, wait, options) {\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n    if (!options) options = {};\n    var later = function() {\n        previous = options.leading === false ? 0 : Date.now();\n        timeout = null;\n        result = func.apply(context, args);\n        if (!timeout) context = args = null;\n    };\n    return function() {\n        var now = Date.now();\n        if (!previous && options.leading === false) previous = now;\n        var remaining = wait - (now - previous);\n        context = this;\n        args = arguments;\n        if (remaining <= 0 || remaining > wait) {\n            if (timeout) {\n                clearTimeout(timeout);\n                timeout = null;\n            }\n            previous = now;\n            result = func.apply(context, args);\n            if (!timeout) context = args = null;\n        } else if (!timeout && options.trailing !== false) {\n            timeout = setTimeout(later, remaining);\n        }\n        return result;\n    };\n}\n\nfunction isObject(value) {\n    const type = typeof value\n    return value != null && (type === 'object' || type === 'function')\n}\n\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked, or until the next browser frame is drawn. The debounced function\n * comes with a `cancel` method to cancel delayed `func` invocations and a\n * `flush` method to immediately invoke them. Provide `options` to indicate\n * whether `func` should be invoked on the leading and/or trailing edge of the\n * `wait` timeout. The `func` is invoked with the last arguments provided to the\n * debounced function. Subsequent calls to the debounced function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * If `wait` is omitted in an environment with `requestAnimationFrame`, `func`\n * invocation will be deferred until the next frame is drawn (typically about\n * 16ms).\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `debounce` and `throttle`.\n *\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0]\n *  The number of milliseconds to delay; if omitted, `requestAnimationFrame` is\n *  used (if available).\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', debounce(calculateLayout, 150))\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }))\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * const debounced = debounce(batchLog, 250, { 'maxWait': 1000 })\n * const source = new EventSource('/stream')\n * jQuery(source).on('message', debounced)\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel)\n *\n * // Check for pending invocations.\n * const status = debounced.pending() ? \"Pending...\" : \"Ready\"\n */\nfunction debounce(func, wait, options) {\n    let lastArgs,\n        lastThis,\n        maxWait,\n        result,\n        timerId,\n        lastCallTime\n\n    let lastInvokeTime = 0\n    let leading = false\n    let maxing = false\n    let trailing = true\n\n    // Bypass `requestAnimationFrame` by explicitly setting `wait=0`.\n    const useRAF = (!wait && wait !== 0 && typeof requestAnimationFrame === 'function')\n\n    if (typeof func !== 'function') {\n        throw new TypeError('Expected a function')\n    }\n    wait = +wait || 0\n    if (isObject(options)) {\n        leading = !!options.leading\n        maxing = 'maxWait' in options\n        maxWait = maxing ? Math.max(+options.maxWait || 0, wait) : maxWait\n        trailing = 'trailing' in options ? !!options.trailing : trailing\n    }\n\n    function invokeFunc(time) {\n        const args = lastArgs\n        const thisArg = lastThis\n\n        lastArgs = lastThis = undefined\n        lastInvokeTime = time\n        result = func.apply(thisArg, args)\n        return result\n    }\n\n    function startTimer(pendingFunc, wait) {\n        if (useRAF) {\n            cancelAnimationFrame(timerId)\n            return requestAnimationFrame(pendingFunc)\n        }\n        return setTimeout(pendingFunc, wait)\n    }\n\n    function cancelTimer(id) {\n        if (useRAF) {\n            return cancelAnimationFrame(id)\n        }\n        clearTimeout(id)\n    }\n\n    function leadingEdge(time) {\n        // Reset any `maxWait` timer.\n        lastInvokeTime = time\n        // Start the timer for the trailing edge.\n        timerId = startTimer(timerExpired, wait)\n        // Invoke the leading edge.\n        return leading ? invokeFunc(time) : result\n    }\n\n    function remainingWait(time) {\n        const timeSinceLastCall = time - lastCallTime\n        const timeSinceLastInvoke = time - lastInvokeTime\n        const timeWaiting = wait - timeSinceLastCall\n\n        return maxing\n            ? Math.min(timeWaiting, maxWait - timeSinceLastInvoke)\n            : timeWaiting\n    }\n\n    function shouldInvoke(time) {\n        const timeSinceLastCall = time - lastCallTime\n        const timeSinceLastInvoke = time - lastInvokeTime\n\n        // Either this is the first call, activity has stopped and we're at the\n        // trailing edge, the system time has gone backwards and we're treating\n        // it as the trailing edge, or we've hit the `maxWait` limit.\n        return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n            (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait))\n    }\n\n    function timerExpired() {\n        const time = Date.now()\n        if (shouldInvoke(time)) {\n            return trailingEdge(time)\n        }\n        // Restart the timer.\n        timerId = startTimer(timerExpired, remainingWait(time))\n    }\n\n    function trailingEdge(time) {\n        timerId = undefined\n\n        // Only invoke if we have `lastArgs` which means `func` has been\n        // debounced at least once.\n        if (trailing && lastArgs) {\n            return invokeFunc(time)\n        }\n        lastArgs = lastThis = undefined\n        return result\n    }\n\n    function cancel() {\n        if (timerId !== undefined) {\n            cancelTimer(timerId)\n        }\n        lastInvokeTime = 0\n        lastArgs = lastCallTime = lastThis = timerId = undefined\n    }\n\n    function flush() {\n        return timerId === undefined ? result : trailingEdge(Date.now())\n    }\n\n    function pending() {\n        return timerId !== undefined\n    }\n\n    function debounced(...args) {\n        const time = Date.now()\n        const isInvoking = shouldInvoke(time)\n\n        lastArgs = args\n        lastThis = this\n        lastCallTime = time\n\n        if (isInvoking) {\n            if (timerId === undefined) {\n                return leadingEdge(lastCallTime)\n            }\n            if (maxing) {\n                // Handle invocations in a tight loop.\n                timerId = startTimer(timerExpired, wait)\n                return invokeFunc(lastCallTime)\n            }\n        }\n        if (timerId === undefined) {\n            timerId = startTimer(timerExpired, wait)\n        }\n        return result\n    }\n    debounced.cancel = cancel\n    debounced.flush = flush\n    debounced.pending = pending\n    return debounced\n}\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// function debounce(func, wait, immediate) {\n//     let timeout;\n//     return function() {\n//         const context = this, args = arguments;\n//         const later = function() {\n//             timeout = null;\n//             if (!immediate) {\n//                 func.apply(context, args);\n//             }\n//         };\n//         const callNow = immediate && !timeout;\n//         clearTimeout(timeout);\n//         timeout = setTimeout(later, wait);\n//         if (callNow) {\n//             func.apply(context, args);\n//         }\n//     };\n// }\n\nexport function getFirstLetter(str) {\n    if (!str) return '';\n\n    for (let char of str) {\n        if (char.toUpperCase() !== char.toLowerCase()) {\n            return char;\n        } else if (char >= '0' && char <= '9') {\n            return char;\n        } else if (char.length > 1) {\n            return char;\n        }\n    }\n\n    return [...str].length > 0 ? [...str][0] : '';\n}\n\nfunction getLetters(title) {\n    if (!title) return null;\n    if (title.length === 0) return null;\n\n    const split = title.split(' ');\n    if (split.length === 1) {\n        return getFirstLetter(split[0]);\n    }\n    if (split.length > 1) {\n        return getFirstLetter(split[0]) + getFirstLetter(split[split.length - 1]);\n    }\n\n    return null;\n}\n\nasync function readImageSize(file) {\n    return new Promise((resolve, reject) => {\n        let useBlob = false;\n        const reader = new FileReader();\n\n        reader.addEventListener('load', function() {\n            try {\n                const image = new Image();\n                image.addEventListener('load', function() {\n                    const { width, height } = image;\n                    if (useBlob) {\n                        window.URL.revokeObjectURL(image.src);\n                    }\n\n                    resolve([width, height]);\n                });\n\n                image.src = useBlob ? window.URL.createObjectURL(file) : reader.result;\n            } catch {\n                reject();\n            }\n        });\n\n        reader.readAsDataURL(file);\n    });\n}\n\n/**\n * use this to make a Base64 encoded string URL friendly,\n * i.e. '+' and '/' are replaced with '-' and '_' also any trailing '='\n * characters are removed\n *\n * @param {String} str the encoded string\n * @returns {String} the URL friendly encoded String\n */\nfunction Base64EncodeUrl(str) {\n    return str\n        .replace(/\\+/g, '-')\n        .replace(/\\//g, '_')\n        .replace(/\\=+$/, '');\n}\n\n/**\n * Use this to recreate a Base64 encoded string that was made URL friendly\n * using Base64EncodeurlFriendly.\n * '-' and '_' are replaced with '+' and '/' and also it is padded with '+'\n *\n * @param {String} str the encoded string\n * @returns {String} the URL friendly encoded String\n */\nfunction Base64DecodeUrl(str) {\n    str = (str + '===').slice(0, str.length + (str.length % 4));\n    return str.replace(/-/g, '+').replace(/_/g, '/');\n}\n\nfunction arrayBufferToBase64(buffer) {\n    var binary = '';\n    var bytes = new Uint8Array(buffer);\n    var len = bytes.byteLength;\n    for (var i = 0; i < len; i++) {\n        binary += String.fromCharCode(bytes[i]);\n    }\n    return Base64EncodeUrl(window.btoa(binary));\n}\n\nfunction isAuthorizationReady(state) {\n    if (!state) return false;\n\n    return state['@type'] === 'authorizationStateReady';\n}\n\nfunction between(item, first, last, inclusive = false) {\n    return inclusive ? item >= first && item <= last : item > first && item < last;\n}\n\nfunction clamp(item, first, last) {\n    if (item < first) return first;\n    if (item > last) return last;\n\n    return item;\n}\n\nfunction getDurationString(secondsTotal, duration, reverse) {\n    if (reverse && duration > 0) {\n        secondsTotal = Math.max(Math.floor(duration) - secondsTotal, 0);\n    }\n\n    let hours = Math.floor(secondsTotal / 3600);\n    let minutes = Math.floor((secondsTotal - hours * 3600) / 60);\n    let seconds = secondsTotal - hours * 3600 - minutes * 60;\n\n    if (hours > 0 && minutes < 10) {\n        minutes = '0' + minutes;\n    }\n    if (seconds < 10) {\n        seconds = '0' + seconds;\n    }\n\n    return (reverse ? '-': '') + (hours > 0 ? hours + ':' : '') + minutes + ':' + seconds;\n}\n\nexport function getRandomInt(min, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random() * (max - min)) + min; //The maximum is exclusive and the minimum is inclusive\n}\n\nfunction historyEquals(first, second) {\n    if (!first && second) return false;\n    if (first && !second) return false;\n\n    if (!first && !second) return true;\n    if (first.length === 0 && second.length === 0) return true;\n\n    return first === second;\n}\n\nexport function albumHistoryEquals(first, second) {\n    if (first === second) return true;\n    if (!first && second) return false;\n    if (first && !second) return false;\n\n    if (first.length === 0 && second.length === 0) return true;\n    if (first.length !== second.length) return false;\n\n    for (let i = 0; i < first.length; i++) {\n        if (first[i] !== second[i]) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nfunction insertByOrder(array, element, comparator) {\n    let i = 0;\n    for (; i < array.length && comparator(array[i], element) < 0; i++) {}\n\n    return [...array.slice(0, i), element, ...array.slice(i)];\n}\n\nexport {\n    getBrowser,\n    getOSName,\n    stringToBoolean,\n    orderCompare,\n    getSize,\n    getPhotoThumbnailSize,\n    getPhotoSize,\n    getFitSize,\n    itemsInView,\n    throttle,\n    debounce,\n    getLetters,\n    readImageSize,\n    arrayBufferToBase64,\n    isAuthorizationReady,\n    between,\n    clamp,\n    getDurationString,\n    isAppleDevice,\n    historyEquals,\n    insertByOrder\n};\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nclass ActionScheduler {\n    constructor(actionCallback, cancelCallback) {\n        this.actions = new Map();\n        this.actionCallback = actionCallback;\n        this.cancelCallback = cancelCallback;\n    }\n\n    add = (key, timeout, action, cancel) => {\n        if (this.actions.has(key)) {\n            return false;\n        }\n\n        let expire = new Date();\n        expire.setMilliseconds(expire.getMilliseconds() + timeout);\n\n        this.actions.set(key, { expire: expire, action: action, cancel: cancel });\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setTimeout();\n\n        return true;\n    };\n\n    invoke = async key => {\n        const item = this.actions.get(key);\n        if (!item) return;\n\n        this.actions.delete(key);\n\n        await this.actionCallback({ key: key, action: item.action, cancel: item.cancel });\n        if (item.action) await item.action();\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setTimeout();\n    };\n\n    remove = key => {\n        const item = this.actions.get(key);\n        if (!item) return;\n\n        this.actions.delete(key);\n\n        this.cancelCallback({ key: key, action: item.action, cancel: item.cancel });\n        if (item.cancel) item.cancel();\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setTimeout();\n    };\n\n    setTimeout = () => {\n        let now = new Date();\n        let timeout = 1000000;\n        for (let [key, value] of this.actions) {\n            let actionTimeout = value.expire - now;\n            if (actionTimeout < timeout) timeout = actionTimeout;\n            if (timeout < 0) timeout = 0;\n        }\n\n        if (timeout < 1000000) {\n            this.timerId = setTimeout(this.handleTimer, timeout);\n        }\n    };\n\n    handleTimer = () => {\n        let now = new Date();\n        let expired = [];\n        for (let [key, value] of this.actions) {\n            let actionTimeout = value.expire - now;\n            if (actionTimeout <= 0) expired.push({ key: key, value: value });\n        }\n\n        for (let item of expired) {\n            this.actions.delete(item.key);\n            this.actionCallback({ key: item.key, action: item.value.action, cancel: item.value.cancel });\n            if (item.value.action) item.value.action();\n        }\n\n        this.setTimeout();\n    };\n}\n\nexport default ActionScheduler;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport ActionScheduler from '../Utils/ActionScheduler';\nimport { closeChat, showAlert } from '../Actions/Client';\nimport { subscribeNotifications } from '../registerServiceWorker';\nimport { PAGE_WIDTH_SMALL } from '../Constants';\nimport LStore from './LocalizationStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass ApplicationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n        this.addStatistics();\n\n        this.isSmallWidth = window.innerWidth < PAGE_WIDTH_SMALL;\n        window.addEventListener('resize', this.onWindowResize);\n    }\n\n    onWindowResize = () => {\n        const { isSmallWidth } = this;\n\n        const nextIsSmallWidth = window.innerWidth < PAGE_WIDTH_SMALL;\n        if (nextIsSmallWidth !== isSmallWidth) {\n            this.isSmallWidth = nextIsSmallWidth;\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdatePageWidth',\n                isSmallWidth: nextIsSmallWidth\n            })\n        }\n    };\n\n    reset = () => {\n        this.dialogsReady = false;\n        this.cacheLoaded = false;\n        this.setPhoneNumberRequest = null;\n        this.chatId = 0;\n        this.dialogChatId = 0;\n        this.messageId = null;\n        this.statistics = new Map();\n        this.authorizationState = null;\n        this.defaultPhone = null;\n        this.connectionState = null;\n        this.isChatDetailsVisible = false;\n        this.mediaViewerContent = null;\n        this.profileMediaViewerContent = null;\n        this.dragParams = null;\n        this.actionScheduler = new ActionScheduler(this.handleScheduledAction, this.handleCancelScheduledAction);\n    };\n\n    addScheduledAction = (key, timeout, action, cancel) => {\n        return this.actionScheduler.add(key, timeout, action, cancel);\n    };\n\n    invokeScheduledAction = async key => {\n        await this.actionScheduler.invoke(key);\n    };\n\n    removeScheduledAction = key => {\n        this.actionScheduler.remove(key);\n    };\n\n    handleScheduledAction = item => {\n        console.log('Invoked scheduled action key=', item.key);\n    };\n\n    handleCancelScheduledAction = item => {\n        console.log('Cancel scheduled action key=', item.key);\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                this.authorizationState = update.authorization_state;\n\n                switch (update.authorization_state['@type']) {\n                    case 'authorizationStateLoggingOut':\n                        this.loggingOut = true;\n                        if (this.chatId) {\n                            this.setChatId(0);\n                        }\n                        break;\n                    case 'authorizationStateWaitTdlibParameters':\n                        TdLibController.sendTdParameters();\n                        break;\n                    case 'authorizationStateWaitEncryptionKey':\n                        TdLibController.send({ '@type': 'checkDatabaseEncryptionKey' });\n                        break;\n                    case 'authorizationStateWaitPhoneNumber': {\n                        if (this.setPhoneNumberRequest) {\n                            this.setPhoneNumberRequest();\n\n                            this.setPhoneNumberRequest = null;\n                        }\n\n                        break;\n                    }\n                    case 'authorizationStateWaitCode':\n                        break;\n                    case 'authorizationStateWaitPassword':\n                        break;\n                    case 'authorizationStateReady':\n                        this.loggingOut = false;\n                        this.setPhoneNumberRequest = null;\n                        subscribeNotifications();\n                        break;\n                    case 'authorizationStateClosing':\n                        break;\n                    case 'authorizationStateClosed':\n                        this.reset();\n\n                        if (!this.loggingOut) {\n                            document.title += ': Zzz';\n\n                            TdLibController.clientUpdate({\n                                '@type': 'clientUpdateAppInactive'\n                            });\n                        } else {\n                            TdLibController.init();\n                        }\n                        break;\n                    default:\n                        break;\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'updateChatIsMarkedAsUnread': {\n                const { chat_id, is_marked_as_unread } = update;\n                if (chat_id === this.chatId && is_marked_as_unread) {\n                    closeChat();\n                }\n\n                break;\n            }\n            case 'updateConnectionState': {\n                this.connectionState = update.state;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'updateFatalError': {\n                this.emit(update['@type'], update);\n\n                break;\n            }\n            case 'updateServiceNotification': {\n                const { type, content } = update;\n\n                if (!content) return;\n                if (content['@type'] === 'messageText') {\n                    const { text } = content;\n                    if (!text) return;\n\n                    if (text['@type'] === 'formattedText' && text.text) {\n                        switch (type) {\n                            case 'AUTH_KEY_DROP_DUPLICATE':\n                                let result = window.confirm(text.text);\n                                if (result) {\n                                    TdLibController.logOut();\n                                }\n                                break;\n                            default:\n                                showAlert({\n                                    title: LStore.getString('AppName'),\n                                    message: text,\n                                    ok: LStore.getString('OK')\n                                });\n                                break;\n                        }\n                    }\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateAlert': {\n                this.emit('clientUpdateAlert', update);\n                break;\n            }\n            case 'clientUpdateAppInactive': {\n                this.emit('clientUpdateAppInactive');\n                break;\n            }\n            case 'clientUpdateCacheLoaded': {\n                this.cacheLoaded = true;\n                this.emit('clientUpdateCacheLoaded');\n                break;\n            }\n            case 'clientUpdateChatDetailsVisibility': {\n                const { visibility } = update;\n\n                this.isChatDetailsVisible = visibility;\n                this.emit('clientUpdateChatDetailsVisibility', update);\n                break;\n            }\n            case 'clientUpdateChatId': {\n                if (this.recording) {\n                    this.emit('clientUpdateInputShake');\n                    break;\n                }\n\n                const extendedUpdate = {\n                    '@type': 'clientUpdateChatId',\n                    nextChatId: update.chatId,\n                    nextMessageId: update.messageId,\n                    options: update.options,\n                    previousChatId: this.chatId,\n                    previousMessageId: this.messageId,\n                };\n\n                this.chatId = update.chatId;\n                this.messageId = update.messageId;\n\n                this.emit('clientUpdateChatId', extendedUpdate);\n                break;\n            }\n            case 'clientUpdateDeleteMessages': {\n                this.emit('clientUpdateDeleteMessages', update);\n                break;\n            }\n            case 'clientUpdateDialogChatId': {\n                const { chatId } = update;\n                this.dialogChatId = chatId;\n\n                this.emit('clientUpdateDialogChatId', update);\n                break;\n            }\n            case 'clientUpdateDialogsReady': {\n                this.dialogsReady = true;\n                this.emit('clientUpdateDialogsReady', update);\n                break;\n            }\n            case 'clientUpdateDragging': {\n                const { dragging, dataTransfer } = update;\n\n                this.dragParams = dragging ? { dragging, dataTransfer } : null;\n                this.emit('clientUpdateDragging', update);\n                break;\n            }\n            case 'clientUpdateFocusWindow': {\n                if (!this.authorizationState) {\n                    break;\n                }\n\n                TdLibController.send({\n                    '@type': 'setOption',\n                    name: 'online',\n                    value: { '@type': 'optionValueBoolean', value: update.focused }\n                });\n\n                this.emit('clientUpdateFocusWindow', update);\n                break;\n            }\n            case 'clientUpdateForward': {\n                this.emit('clientUpdateForward', update);\n                break;\n            }\n            case 'clientUpdateInputPasswordAlert': {\n                this.emit('clientUpdateInputPasswordAlert', update);\n                break;\n            }\n            case 'clientUpdateLeaveChat': {\n                if (update.inProgress && this.chatId === update.chatId) {\n                    TdLibController.setChatId(0);\n                }\n\n                break;\n            }\n            case 'clientUpdateLeaveVoiceChatAlert': {\n                this.emit('clientUpdateLeaveVoiceChatAlert', update);\n                break;\n            }\n            case 'clientUpdateMediaViewerContent': {\n                const { content } = update;\n                this.mediaViewerContent = content;\n\n                this.emit('clientUpdateMediaViewerContent', update);\n                break;\n            }\n            case 'clientUpdateNewContentAvailable': {\n                this.emit('clientUpdateNewContentAvailable', update);\n                break;\n            }\n            case 'clientUpdateOpenGameAlert': {\n                this.emit('clientUpdateOpenGameAlert', update);\n                break;\n            }\n            case 'clientUpdateOpenUrlAlert': {\n                this.emit('clientUpdateOpenUrlAlert', update);\n                break;\n            }\n            case 'clientUpdatePageWidth': {\n                this.emit('clientUpdatePageWidth', update);\n                break;\n            }\n            case 'clientUpdatePinMessage': {\n                this.emit('clientUpdatePinMessage', update);\n                break;\n            }\n            case 'clientUpdateProfileMediaViewerContent': {\n                const { content } = update;\n                this.profileMediaViewerContent = content;\n\n                this.emit('clientUpdateProfileMediaViewerContent', update);\n                break;\n            }\n            case 'clientUpdateRecordStart': {\n                this.recording = true;\n                break;\n            }\n            case 'clientUpdateRecordStop': {\n                this.recording = false;\n                break;\n            }\n            case 'clientUpdateRecordError': {\n                this.recording = false;\n                break;\n            }\n            case 'clientUpdateReportChat': {\n                this.emit('clientUpdateReportChat', update);\n                break;\n            }\n            case 'clientUpdateRequestBlockSender': {\n                this.emit('clientUpdateRequestBlockSender', update);\n                break;\n            }\n            case 'clientUpdateRequestClearHistory': {\n                this.emit('clientUpdateRequestClearHistory', update);\n                break;\n            }\n            case 'clientUpdateRequestLeaveChat': {\n                this.emit('clientUpdateRequestLeaveChat', update);\n                break;\n            }\n            case 'clientUpdateRequestUrlAlert': {\n                this.emit('clientUpdateRequestUrlAlert', update);\n                break;\n            }\n            case 'clientUpdateSearchChat': {\n                this.emit('clientUpdateSearchChat', update);\n                break;\n            }\n            case 'clientUpdateSetPhone': {\n                const { phone } = update;\n\n                this.defaultPhone = phone;\n\n                if (!phone) {\n                    this.setPhoneNumberRequest = null;\n                    TdLibController.clientUpdate({\n                        '@type': 'clientUpdateSetPhoneCanceled'\n                    });\n                } else {\n                    if (\n                        this.authorizationState &&\n                        (this.authorizationState['@type'] === 'authorizationStateWaitPhoneNumber' || this.authorizationState['@type'] === 'authorizationStateWaitOtherDeviceConfirmation')\n                    ) {\n                        this.setPhoneNumber(phone);\n                    } else {\n                        this.setPhoneNumberRequest = () => this.setPhoneNumber(phone);\n                    }\n                }\n\n                this.emit('clientUpdateSetPhone', update);\n                break;\n            }\n            case 'clientUpdateSnackbar': {\n                this.emit('clientUpdateSnackbar', update);\n                break;\n            }\n            case 'clientUpdateSetPhoneResult': {\n                this.emit('clientUpdateSetPhoneResult', update);\n                break;\n            }\n            case 'clientUpdateSetPhoneError': {\n                this.emit('clientUpdateSetPhoneError', update);\n                break;\n            }\n            case 'clientUpdateChatSelect': {\n                this.chatSelectOptions = update.options;\n\n                this.emit('clientUpdateChatSelect', update);\n                break;\n            }\n            case 'clientUpdateTdLibDatabaseExists': {\n                this.emit('clientUpdateTdLibDatabaseExists', update);\n                break;\n            }\n            case 'clientUpdateUnpinMessage': {\n                this.emit('clientUpdateUnpinMessage', update);\n                break;\n            }\n        }\n    };\n\n    setPhoneNumber = phone => {\n        TdLibController.send({\n            '@type': 'setAuthenticationPhoneNumber',\n            phone_number: phone\n        })\n            .then(result => {\n                TdLibController.clientUpdate({\n                    '@type': 'clientUpdateSetPhoneResult',\n                    result\n                });\n            })\n            .catch(error => {\n                TdLibController.clientUpdate({\n                    '@type': 'clientUpdateSetPhoneError',\n                    error\n                });\n            });\n    };\n\n    onUpdateStatistics = update => {\n        if (!update) return;\n\n        if (this.statistics.has(update['@type'])) {\n            const count = this.statistics.get(update['@type']);\n\n            this.statistics.set(update['@type'], count + 1);\n        } else {\n            this.statistics.set(update['@type'], 1);\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    addStatistics = () => {\n        TdLibController.on('update', this.onUpdateStatistics);\n    };\n\n    setChatId = (chatId, messageId = null) => {\n        const update = {\n            '@type': 'clientUpdateChatId',\n            nextChatId: chatId,\n            nextMessageId: messageId,\n            previousChatId: this.chatId,\n            previousMessageId: this.messageId\n        };\n\n        this.chatId = chatId;\n        this.messageId = messageId;\n        this.emit(update['@type'], update);\n    };\n\n    getChatId() {\n        return this.chatId;\n    }\n\n    getMessageId() {\n        return this.messageId;\n    }\n\n    getConnectionState() {\n        return this.connectionState;\n    }\n\n    getAuthorizationState() {\n        return this.authorizationState;\n    }\n\n    assign(source1, source2) {\n        Object.assign(source1, source2);\n        //this.set(Object.assign({}, source1, source2));\n    }\n}\n\nconst store = new ApplicationStore();\nwindow.app = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { getSearchMessagesFilter, openMedia } from '../Utils/Message';\nimport { getRandomInt } from '../Utils/Common';\nimport { isCurrentSource, playlistItemEquals } from '../Utils/Player';\nimport { supportsStreaming } from '../Utils/File';\nimport { getValidBlocks, isValidAudioBlock, isValidVoiceNoteBlock, openInstantViewMedia } from '../Utils/InstantView';\nimport { AUDIO_MIN_BUFFERED_TIME_S, PLAYER_PLAYBACKRATE_MAX, PLAYER_PLAYBACKRATE_NORMAL, PLAYER_PRELOAD_MAX_SIZE, PLAYER_PRELOAD_PRIORITY, PLAYER_VOLUME_MAX, PLAYER_VOLUME_MIN, PLAYER_VOLUME_NORMAL } from '../Constants';\nimport FileStore from './FileStore';\nimport MessageStore from './MessageStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nconst RepeatEnum = Object.freeze({\n    NONE: 'NONE',\n    REPEAT: 'REPEAT',\n    REPEAT_ONE: 'REPEAT_ONE'\n});\n\nexport { RepeatEnum };\n\nclass PlayerStore extends EventEmitter {\n    constructor() {\n        super();\n\n        const { playbackRate, audioPlaybackRate, volume } = this.loadPlayerSettings();\n\n        this.reset();\n\n        this.playbackRate = playbackRate;\n        this.audioPlaybackRate = audioPlaybackRate;\n        this.volume = volume;\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.playbackRate = PLAYER_PLAYBACKRATE_NORMAL;\n        this.audioPlaybackRate = PLAYER_PLAYBACKRATE_NORMAL;\n        this.volume = PLAYER_VOLUME_NORMAL;\n        this.repeat = RepeatEnum.NONE;\n        this.shuffle = false;\n\n        this.pipParams = { left: document.documentElement.clientWidth - 300, top: document.documentElement.clientHeight - 300 };\n        this.times = new Map();\n\n        this.closeInternal();\n    };\n\n    closeInternal = () => {\n        this.playlist = null;\n        this.message = null;\n        this.time = null;\n        this.videoStream = null;\n        this.instantView = null;\n        this.block = null;\n    }\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    onUpdate = async update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    close = () => {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaClose'\n        });\n    };\n\n    loadPlayerSettings() {\n        const player = JSON.parse(localStorage.getItem('player')) || {};\n\n        let { playbackRate, audioPlaybackRate, volume } = player;\n\n        playbackRate = +playbackRate;\n        audioPlaybackRate = +audioPlaybackRate;\n        volume = +volume;\n\n        playbackRate =\n            playbackRate >= PLAYER_PLAYBACKRATE_NORMAL && playbackRate <= PLAYER_PLAYBACKRATE_MAX\n                ? playbackRate\n                : PLAYER_PLAYBACKRATE_NORMAL;\n        audioPlaybackRate =\n            audioPlaybackRate >= PLAYER_PLAYBACKRATE_NORMAL && audioPlaybackRate <= PLAYER_PLAYBACKRATE_MAX\n                ? audioPlaybackRate\n                : PLAYER_PLAYBACKRATE_NORMAL;\n        volume = volume >= PLAYER_VOLUME_MIN && volume <= PLAYER_VOLUME_MAX ? volume : PLAYER_VOLUME_NORMAL;\n\n        return { playbackRate, audioPlaybackRate, volume };\n    }\n\n    savePlayerSettings() {\n        const { volume, playbackRate, audioPlaybackRate } = this;\n\n        localStorage.setItem('player', JSON.stringify({ volume, playbackRate, audioPlaybackRate }));\n    }\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateMediaClose': {\n                this.closeInternal();\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaActive': {\n                const { source } = update;\n\n                switch (source['@type']) {\n                    case 'message': {\n                        this.message = source;\n                        this.emit(update['@type'], update);\n                        this.getPlaylist(source);\n                        break;\n                    }\n                    case 'instantViewSource': {\n                        const { block, instantView } = source;\n                        this.instantView = instantView;\n                        this.block = block;\n                        this.getPlaylist(source);\n                        // this.playlist = null;\n                        // TdLibController.clientUpdate({\n                        //     '@type': 'clientUpdateMediaPlaylistLoading',\n                        //     source: { '@type': 'instantViewSource', block, instantView }\n                        // });\n                        this.emit(update['@type'], update);\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'clientUpdateMediaVolume': {\n                const { volume } = update;\n\n                this.volume = volume;\n\n                this.savePlayerSettings();\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaRepeat': {\n                const { repeat } = update;\n\n                this.repeat = repeat;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaShuffle': {\n                const { shuffle } = update;\n\n                this.shuffle = shuffle;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaybackRate': {\n                const { playbackRate } = update;\n\n                this.playbackRate = playbackRate;\n\n                this.savePlayerSettings();\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaAudioPlaybackRate': {\n                const { audioPlaybackRate } = update;\n\n                this.audioPlaybackRate = audioPlaybackRate;\n\n                this.savePlayerSettings();\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlay': {\n                this.playing = true;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaTitleMouseOver': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPause': {\n                this.playing = false;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaSeek': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaSeeking': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaStop': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaNext': {\n                this.emit(update['@type'], update);\n\n                this.moveToNextMedia(false);\n                break;\n            }\n            case 'clientUpdateMediaPrev': {\n                this.emit(update['@type'], update);\n\n                this.moveToPrevMedia();\n                break;\n            }\n            case 'clientUpdateMediaEnding': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaEnd': {\n                this.emit(update['@type'], update);\n\n                if (update.moveNext) {\n                    if (this.moveToNextMedia(true)) {\n                    } else {\n                        this.close();\n                    }\n                } else {\n                    this.close();\n                }\n                break;\n            }\n            case 'clientUpdateMediaShortcut': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaHint': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaTime': {\n                const { source, duration, currentTime, buffered, timestamp } = update;\n\n                if (this.time) {\n                    const { chatId, messageId, block } = this.time;\n                    if (isCurrentSource(chatId, messageId, block, source)) {\n                        this.time = {\n                            ...this.time,\n                            currentTime,\n                            duration,\n                            buffered,\n                            timestamp\n                        };\n                    }\n                }\n\n                if (buffered && currentTime && duration && supportsStreaming()) {\n                    for (let i = 0; i < buffered.length; i++) {\n                        const start = buffered.start(i);\n                        const end = buffered.end(i);\n                        if (start <= currentTime && currentTime <= end && (currentTime + AUDIO_MIN_BUFFERED_TIME_S < end || end === duration)) {\n                            this.preloadNextMedia();\n                            break;\n                        }\n                    }\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaProgress': {\n                const { source, buffered } = update;\n\n                if (this.time) {\n                    const { chatId, messageId, block } = this.time;\n                    if (isCurrentSource(chatId, messageId, block, source)) {\n                        this.time = { ...this.time, buffered };\n                    }\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaLoadedMetadata': {\n                const { source, duration, videoWidth, videoHeight } = update;\n                const { block } = source;\n\n                this.time = {\n                    chatId: source['@type'] === 'message' ? source.chat_id : 0,\n                    messageId: source['@type'] === 'message' ? source.id : 0,\n                    block,\n                    duration,\n                    videoWidth,\n                    videoHeight\n                };\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaCaptureStream': {\n                this.videoStream = update.stream;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaViewerPlay': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaViewerPause': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaViewerEnded': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaylistLoading': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaylistPrev': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaylist': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaylistNext': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdatePictureInPicture': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    preloadNextMedia = async () => {\n        const { message, block, playlist, repeat, shuffle } = this;\n\n        if (!playlist) return;\n        if (!message && !block) return;\n        if (repeat !== RepeatEnum.NONE) return;\n        if (shuffle) return;\n\n        const { items } = playlist;\n        if (!items) return;\n\n        const index = items.findIndex(x => playlistItemEquals(x, message || block));\n        if (index === -1) return;\n\n        const nextIndex = index - 1;\n        if (nextIndex === -1) return;\n\n        const nextItem = items[nextIndex];\n        if (!nextItem) return;\n\n        let audio = null;\n        switch (nextItem['@type']) {\n            case 'pageBlockAudio': {\n                audio = nextItem.audio;\n                break;\n            }\n            case 'message': {\n                const { content } = nextItem;\n                switch (content['@type']) {\n                    case 'messageAudio': {\n                        audio = content.audio;\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (!audio) return;\n\n        let { audio: file } = audio;\n        if (!file) return;\n        file = FileStore.get(file.id) || file;\n\n        const { id, local, expected_size } = file;\n\n        const offset = 0;\n        const limit = expected_size > PLAYER_PRELOAD_MAX_SIZE ? PLAYER_PRELOAD_MAX_SIZE : 0;\n\n        const { is_downloading_active, is_downloading_completed, download_offset, downloaded_prefix_size } = local;\n        if (is_downloading_completed) {\n            // console.log('[cache] preload cancel completed', id, [offset, limit], [download_offset, downloaded_prefix_size]);\n            return;\n        }\n        if (is_downloading_active) {\n            // console.log('[cache] preload cancel active', id, [offset, limit], [download_offset, downloaded_prefix_size]);\n            return;\n        }\n\n        if (download_offset <= offset && limit > 0 && limit <= downloaded_prefix_size) {\n            // console.log('[cache] preload cancel size', id, [offset, limit], [download_offset, downloaded_prefix_size]);\n            return;\n        }\n\n        // console.log('[cache] preload start', id, [offset, limit], [download_offset, downloaded_prefix_size], file);\n        const result = await TdLibController.send({\n            '@type': 'downloadFile',\n            file_id: id,\n            offset,\n            limit,\n            priority: PLAYER_PRELOAD_PRIORITY,\n            synchronous: true\n        });\n\n        // console.log('[cache] preload stop', id, [offset, limit], [download_offset, downloaded_prefix_size], result);\n    };\n\n    openPlaylistItem(item) {\n        const { instantView } = this;\n\n        switch (item['@type']) {\n            case 'message': {\n                openMedia(item.chat_id, item.id, false);\n                break;\n            }\n            case 'pageBlockAudio': {\n                openInstantViewMedia(item.audio, item.caption, item, instantView, false);\n                break;\n            }\n            case 'pageBlockVoiceNote': {\n                openInstantViewMedia(item.voice_note, item.caption, item, instantView, false);\n                break;\n            }\n        }\n    }\n\n    moveToPrevMedia = () => {\n        const { playlist, message, block } = this;\n        if (!playlist) return;\n        if (!message && !block) return;\n\n        const { items } = playlist;\n        if (!items) return;\n\n        const index = items.findIndex(x => playlistItemEquals(x, message || block));\n        if (index === -1) return;\n\n        if (index + 1 < items.length) {\n            this.openPlaylistItem(items[index + 1]);\n        }\n    };\n\n    moveToNextMedia = useRepeatShuffle => {\n        const { playlist, message, block } = this;\n\n        if (!playlist) return false;\n        if (!message && !block) return false;\n\n        const { items } = playlist;\n        if (!items) return false;\n\n        const index = items.findIndex(x => playlistItemEquals(x, message || block));\n        if (index === -1) return false;\n\n        let nextIndex = -1;\n        if (!useRepeatShuffle) {\n            nextIndex = index - 1;\n        } else {\n            switch (this.repeat) {\n                case RepeatEnum.NONE: {\n                    if (this.shuffle) {\n                        nextIndex = getRandomInt(0, items.length);\n                    } else {\n                        nextIndex = index - 1;\n                    }\n                    break;\n                }\n                case RepeatEnum.REPEAT_ONE: {\n                    nextIndex = index;\n                    break;\n                }\n                case RepeatEnum.REPEAT: {\n                    if (this.shuffle) {\n                        nextIndex = getRandomInt(0, items.length);\n                    } else {\n                        nextIndex = index - 1 >= 0 ? index - 1 : items.length - 1;\n                    }\n                    break;\n                }\n            }\n        }\n\n        if (nextIndex >= 0) {\n            this.openPlaylistItem(items[nextIndex])\n            return true;\n        }\n\n        return false;\n    };\n\n    getCurrentTime = (uniqueId) => {\n        return this.times.get(uniqueId) || { currentTime: 0, duration: 0 };\n    };\n\n    setCurrentTime = (uniqueId, info) => {\n        if (info.currentTime < 30 || info.currentTime > info.duration - 10) {\n            info.currentTime = 0;\n        }\n\n        this.times.set(uniqueId, info);\n    };\n\n    clearCurrentTime = (uniqueId) => {\n        this.times.delete(uniqueId);\n    };\n\n    getPlaylist = async source => {\n        const { playlist: currentPlaylist } = this;\n\n        if (currentPlaylist) {\n            const { items } = currentPlaylist;\n            if (items && items.find(x => playlistItemEquals(x, source['@type'] === 'instantViewSource' ? source.block : source))) {\n                return;\n            }\n        }\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaPlaylistLoading',\n            source\n        });\n\n        let items = [];\n        let totalCount = 0;\n        switch (source['@type']) {\n            case 'message': {\n                const { chat_id: chatId, id: messageId } = source;\n                const filter = getSearchMessagesFilter(chatId, messageId);\n                if (!filter) {\n                    this.playlist = {\n                        source,\n                        totalCount: 1,\n                        items: [source]\n                    };\n\n                    TdLibController.clientUpdate({\n                        '@type': 'clientUpdateMediaPlaylist',\n                        source,\n                        playlist: this.playlist\n                    });\n\n                    return;\n                }\n\n                const result = await TdLibController.send({\n                    '@type': 'searchChatMessages',\n                    chat_id: chatId,\n                    query: '',\n                    sender_user_id: 0,\n                    from_message_id: messageId,\n                    offset: -50,\n                    limit: 100,\n                    filter\n                });\n\n                MessageStore.setItems(result.messages);\n\n                items = result.messages;\n                totalCount = result.total_count;\n                break;\n            }\n            case 'instantViewSource': {\n                const { block, instantView } = source;\n                items = getValidBlocks(instantView, block['@type'] === 'pageBlockAudio' ? isValidAudioBlock : isValidVoiceNoteBlock).reverse();\n                totalCount = items.length;\n            }\n        }\n\n        this.playlist = {\n            source,\n            totalCount,\n            items\n        };\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaPlaylist',\n            source,\n            playlist: this.playlist\n        });\n    };\n}\n\nconst store = new PlayerStore();\nwindow.player = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { getBlob } from '../Utils/File';\nimport FileStore from './FileStore';\nimport TdLibController from '../Controllers/TdLibController';\nimport ChatStore from './ChatStore';\n\nclass MessageStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n        this.media = new Map();\n        this.selectedItems = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateNewMessage': {\n                this.set(update.message);\n                this.addMediaMessage(update.message);\n\n                this.emit('updateNewMessage', update);\n                break;\n            }\n            case 'updateDeleteMessages':\n                if (update.is_permanent) {\n                    this.removeMediaMessages(update.chat_id, update.message_ids);\n                }\n                this.emit('updateDeleteMessages', update);\n                break;\n            case 'updateMessageEdited': {\n                const chat = this.items.get(update.chat_id);\n                if (chat) {\n                    const message = chat.get(update.message_id);\n                    if (message) {\n                        const newMessage = {\n                            ...message,\n                            ...{\n                                reply_markup: update.reply_markup,\n                                edit_date: update.edit_date\n                            }\n                        };\n\n                        this.set(newMessage);\n                    }\n                }\n                this.emit('updateMessageEdited', update);\n                break;\n            }\n            case 'updateMessageIsPinned': {\n                const { chat_id, message_id, is_pinned } = update;\n\n                const chat = this.items.get(chat_id);\n                if (chat) {\n                    const message = chat.get(message_id);\n                    if (message && is_pinned !== message.is_pinned) {\n                        const newMessage = { ...message, ...{ is_pinned } };\n\n                        this.set(newMessage);\n                        this.updateMediaMessage(newMessage);\n                    }\n                }\n\n                if (is_pinned) {\n                    const data = ChatStore.getClientData(chat_id);\n                    if (data) {\n                        ChatStore.setClientData(chat_id, { ...data, ...{ unpinned: false }});\n                    }\n                }\n\n                this.emit('updateMessageIsPinned', update);\n                break;\n            }\n            case 'updateMessageInteractionInfo': {\n                const { chat_id, message_id, interaction_info } = update;\n\n                const chat = this.items.get(chat_id);\n                if (chat) {\n                    const message = chat.get(message_id);\n                    if (message) {\n                        const newMessage = { ...message, ...{ interaction_info } };\n\n                        this.set(newMessage);\n                    }\n                }\n                this.emit('updateMessageInteractionInfo', update);\n                break;\n            }\n            case 'updateMessageContent': {\n                const { chat_id, message_id, new_content } = update;\n\n                const message = this.get(chat_id, message_id);\n                if (message) {\n                    update.old_content = message.content;\n                    message.content = new_content;\n\n                    switch (new_content['@type']) {\n                        case 'messagePhoto': {\n                            if (update.old_content['@type'] === 'messagePhoto') {\n                                const { photo: oldPhoto } = update.old_content;\n                                if (!oldPhoto) break;\n\n                                const { photo: newPhoto } = new_content;\n                                if (!newPhoto) break;\n\n                                const oldSize = oldPhoto.sizes.find(x => x.type === 'i');\n                                if (!oldSize) break;\n\n                                const newSize = newPhoto.sizes.find(x => x.type === 'i');\n                                if (!newSize) break;\n                                if (newSize.photo.id === oldSize.photo.id) break;\n\n                                const oldBlob = getBlob(oldSize.photo);\n                                if (!oldBlob) break;\n\n                                FileStore.setBlob(newSize.photo.id, oldBlob);\n                            }\n\n                            break;\n                        }\n                    }\n\n                    this.updateMediaMessage(message);\n                }\n\n                this.emit('updateMessageContent', update);\n                break;\n            }\n            case 'updateMessageContentOpened': {\n                const { chat_id, message_id } = update;\n\n                const message = this.get(chat_id, message_id);\n                if (message) {\n                    const { content } = message;\n                    switch (content['@type']) {\n                        case 'messageVoiceNote': {\n                            message.content.is_listened = true;\n                            break;\n                        }\n                        case 'messageVideoNote': {\n                            message.content.is_viewed = true;\n                            break;\n                        }\n                    }\n                }\n\n                this.emit('updateMessageContentOpened', update);\n                break;\n            }\n            case 'updateMessageSendAcknowledged': {\n                this.emit('updateMessageSendAcknowledged', update);\n                break;\n            }\n            case 'updateMessageSendSucceeded': {\n                const chat = this.items.get(update.message.chat_id);\n                if (chat) {\n                    const message = chat.get(update.old_message_id);\n                    if (message) {\n                        message.sending_state = update.message.sending_state;\n                    }\n                }\n\n                this.updateMediaMessageSend(update.message, update.old_message_id);\n                this.set(update.message);\n                this.emit('updateMessageSendSucceeded', update);\n                break;\n            }\n            case 'updateMessageSendFailed': {\n                if (update.message.sending_state) {\n                    update.message.sending_state.error_code = update.error_code;\n                    update.message.sending_state.error_message = update.error_message;\n                }\n\n                const chat = this.items.get(update.message.chat_id);\n                if (chat) {\n                    const message = chat.get(update.old_message_id);\n                    if (message) {\n                        message.sending_state = update.message.sending_state;\n                        if (message.sending_state) {\n                            message.sending_state.error_code = update.error_code;\n                            message.sending_state.error_message = update.error_message;\n                        }\n                    }\n                    if (update.old_message_id !== update.message.id) {\n                        this.set(update.message);\n                    }\n                }\n                this.updateMediaMessageSend(update.message, update.old_message_id);\n                this.emit('updateMessageSendFailed', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateChatId': {\n                if (this.selectedItems.size > 0) {\n                    this.selectedItems.clear();\n\n                    this.emit('clientUpdateClearSelection', { '@type': 'clientUpdateClearSelection' });\n                }\n\n                break;\n            }\n            case 'clientUpdateChatMedia': {\n                this.setMedia(update.chatId, update.media);\n\n                this.emit('clientUpdateChatMedia', update);\n                break;\n            }\n            case 'clientUpdateCurrentPinnedMessage': {\n                this.emit('clientUpdateCurrentPinnedMessage', update);\n                break;\n            }\n            case 'clientUpdateClearSelection': {\n                this.selectedItems.clear();\n\n                this.emit('clientUpdateClearSelection', update);\n                break;\n            }\n            case 'clientUpdateClosePinned': {\n                this.emit('clientUpdateClosePinned', update);\n                break;\n            }\n            case 'clientUpdateEditMessage': {\n                this.emit('clientUpdateEditMessage', update);\n                break;\n            }\n            case 'clientUpdateSendText': {\n                this.emit('clientUpdateSendText', update);\n                break;\n            }\n            case 'clientUpdateStartMessageEditing': {\n                this.emit('clientUpdateStartMessageEditing', update);\n                break;\n            }\n            case 'clientUpdateStopMessageEditing': {\n                this.emit('clientUpdateStopMessageEditing', update);\n                break;\n            }\n            case 'clientUpdateMessageShake': {\n                this.emit('clientUpdateMessageShake', update);\n                break;\n            }\n            case 'clientUpdateMediaTab': {\n                this.emit('clientUpdateMediaTab', update);\n                break;\n            }\n            case 'clientUpdateMessageHighlighted': {\n                this.emit('clientUpdateMessageHighlighted', update);\n                break;\n            }\n            case 'clientUpdateMessageSelected': {\n                if (update.selected) {\n                    this.selectedItems.set(`chatId=${update.chatId}_messageId=${update.messageId}`, {\n                        chatId: update.chatId,\n                        messageId: update.messageId\n                    });\n                } else {\n                    this.selectedItems.delete(`chatId=${update.chatId}_messageId=${update.messageId}`);\n                }\n\n                this.emit('clientUpdateMessageSelected', update);\n                break;\n            }\n            case 'clientUpdateMessagesInView': {\n                this.emit('clientUpdateMessagesInView', update);\n                break;\n            }\n            case 'clientUpdateOpenPinned': {\n                this.emit('clientUpdateOpenPinned', update);\n                break;\n            }\n            case 'clientUpdateOpenReply': {\n                this.emit('clientUpdateOpenReply', update);\n                break;\n            }\n            case 'clientUpdateRecordStart': {\n                this.emit('clientUpdateRecordStart', update);\n                break;\n            }\n            case 'clientUpdateRecordStop': {\n                this.emit('clientUpdateRecordStop', update);\n                break;\n            }\n            case 'clientUpdateRecordError': {\n                this.emit('clientUpdateRecordError', update);\n                break;\n            }\n            case 'clientUpdateReply': {\n                this.emit('clientUpdateReply', update);\n                break;\n            }\n            case 'clientUpdateTryEditMessage': {\n                this.emit('clientUpdateTryEditMessage', update);\n                break;\n            }\n        }\n    };\n\n    hasSelectedMessage(chatId, messageId) {\n        return this.selectedItems.has(`chatId=${chatId}_messageId=${messageId}`);\n    }\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    load(chatId, messageId) {\n        TdLibController.send({\n            '@type': 'getMessage',\n            chat_id: chatId,\n            message_id: messageId\n        })\n            .then(message => {\n                this.set(message);\n                this.emit('getMessageResult', message);\n            })\n            .catch(error => {\n                const deletedMessage = {\n                    '@type': 'deletedMessage',\n                    chat_id: chatId,\n                    id: messageId,\n                    sender: { },\n                    content: null\n                };\n                this.set(deletedMessage);\n                this.emit('getMessageResult', deletedMessage);\n            });\n    }\n\n    get(chatId, messageId) {\n        let chat = this.items.get(chatId);\n        if (!chat) {\n            //this.load(chatId, messageId);\n            return null;\n        }\n\n        let message = chat.get(messageId);\n        if (!message) {\n            //this.load(chatId, messageId);\n            return null;\n        }\n\n        return message;\n    }\n\n    set(message) {\n        if (!message) return;\n\n        let chat = this.items.get(message.chat_id);\n        if (!chat) {\n            chat = new Map();\n            this.items.set(message.chat_id, chat);\n        }\n\n        chat.set(message.id, message);\n    }\n\n    setItems(messages) {\n        for (let i = 0; i < messages.length; i++) {\n            this.set(messages[i]);\n        }\n    }\n\n    getMedia(chatId) {\n        return this.media.get(chatId);\n    }\n\n    setMedia(chatId, media) {\n        const { photoAndVideo, document, audio, url, voiceNote, pinned } = media;\n        this.setItems(photoAndVideo);\n        this.setItems(document);\n        this.setItems(audio);\n        this.setItems(url);\n        this.setItems(voiceNote);\n        this.setItems(pinned);\n\n        return this.media.set(chatId, media);\n    }\n\n    removeMediaMessages(chatId, ids) {\n        if (!chatId) return;\n        if (!ids) return;\n\n        const media = this.getMedia(chatId);\n        if (!media) return;\n\n        const map = new Map(ids.map(x => [x, x]));\n\n        const audio = media.audio.filter(x => !map.has(x.id));\n        media.audio = audio.length !== media.audio.length ? audio : media.audio;\n\n        const document = media.document.filter(x => !map.has(x.id));\n        media.document = document.length !== media.document.length ? document : media.document;\n\n        const photoAndVideo = media.photoAndVideo.filter(x => !map.has(x.id));\n        media.photoAndVideo = photoAndVideo.length !== media.photoAndVideo.length ? photoAndVideo : media.photoAndVideo;\n\n        const url = media.url.filter(x => !map.has(x.id));\n        media.url = url.length !== media.url.length ? url : media.url;\n\n        const voiceNote = media.voiceNote.filter(x => !map.has(x.id));\n        media.voiceNote = voiceNote.length !== media.voiceNote.length ? voiceNote : media.voiceNote;\n\n        const pinned = media.pinned.filter(x => !map.has(x.id));\n        media.pinned = pinned.length !== media.pinned.length ? pinned : media.pinned;\n    }\n\n    addMediaMessage(message) {\n        if (!message) return;\n\n        const { chat_id, content } = message;\n        const media = this.getMedia(chat_id);\n        if (!media) return;\n\n        if (message.is_pinned) {\n            const { pinned } = media;\n            if (pinned) {\n                media.pinned = this.insertMessage(message, pinned);\n            }\n        }\n\n        switch (content['@type']) {\n            case 'messageAudio': {\n                const { audio: messages } = media;\n                if (messages) {\n                    media.audio = this.insertMessage(message, messages);\n                }\n                break;\n            }\n            case 'messageDocument': {\n                const { document: messages } = media;\n                if (messages) {\n                    media.document = this.insertMessage(message, messages);\n                }\n                break;\n            }\n            case 'messagePhoto': {\n                const { photoAndVideo: messages } = media;\n                if (messages) {\n                    media.photoAndVideo = this.insertMessage(message, messages);\n                }\n                break;\n            }\n            case 'messageText': {\n                const { text, web_page } = content;\n                let hasUrl = false;\n                if (web_page) {\n                    hasUrl = true;\n                } else if (text) {\n                    const { entities } = text;\n                    if (entities) {\n                        for (let i = 0; i < entities.length && !hasUrl; i++) {\n                            switch (entities[i].type['@type']) {\n                                case 'textEntityTypeEmailAddress': {\n                                    hasUrl = true;\n                                    break;\n                                }\n                                case 'textEntityTypeTextUrl': {\n                                    hasUrl = true;\n                                    break;\n                                }\n                                case 'textEntityTypeUrl': {\n                                    hasUrl = true;\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                }\n\n                if (hasUrl) {\n                    const { url: messages } = media;\n                    if (messages) {\n                        media.url = this.insertMessage(message, messages);\n                    }\n                }\n\n                break;\n            }\n            case 'messageVideo': {\n                const { photoAndVideo: messages } = media;\n                if (messages) {\n                    media.photoAndVideo = this.insertMessage(message, messages);\n                }\n                break;\n            }\n            case 'messageVoiceNote': {\n                const { voiceNote: messages } = media;\n                if (messages) {\n                    media.voiceNote = this.insertMessage(message, messages);\n                }\n                break;\n            }\n        }\n    }\n\n    updateMediaMessage(message) {\n        if (!message) return;\n\n        const { chat_id, id } = message;\n        this.removeMediaMessages(chat_id, [id]);\n        this.addMediaMessage(message);\n    }\n\n    updateMediaMessageSend(message, oldMessageId) {\n        if (!message) return;\n\n        const { chat_id } = message;\n        this.removeMediaMessages(chat_id, [oldMessageId]);\n        this.addMediaMessage(message);\n    }\n\n    insertMessage = (message, messages) => {\n        if (!messages) return null;\n        if (!message) return messages;\n\n        let index = -1;\n        for (let i = 0; i < messages.length; i++) {\n            if (messages[i].id < message.id) {\n                index = i;\n                break;\n            } else if (messages[i].id === message.id) {\n                index = -2;\n                break;\n            } else if (messages[i].id > message.id) {\n                continue;\n            }\n        }\n\n        if (index === -2) {\n            return messages;\n        } else if (index === -1) {\n            return [...messages, message];\n        }\n\n        const returnValue = [...messages];\n        returnValue.splice(index, 0, message);\n        return returnValue;\n    }\n}\n\nconst store = new MessageStore();\nwindow.message = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport OptionStore from '../Stores/OptionStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass UserStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n        this.fullInfoItems = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateUser': {\n                this.set(update.user);\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'updateUserFullInfo':\n                this.setFullInfo(update.user_id, update.user_full_info);\n\n                this.emit(update['@type'], update);\n                break;\n            case 'updateUserStatus': {\n                let user = this.get(update.user_id);\n                if (user) {\n                    this.assign(user, { status: update.status });\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateOpenUser': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    assign(source1, source2) {\n        Object.assign(source1, source2);\n        //this.set(Object.assign({}, source1, source2));\n    }\n\n    getMyId() {\n        const myId = OptionStore.get('my_id');\n        if (!myId) return null;\n        if (!myId.value) return null;\n\n        return parseInt(myId.value, 10);\n    }\n\n    get(userId) {\n        return this.items.get(userId);\n    }\n\n    set(user) {\n        this.items.set(user.id, user);\n    }\n\n    getFullInfo(id) {\n        return this.fullInfoItems.get(id);\n    }\n\n    setFullInfo(id, fullInfo) {\n        this.fullInfoItems.set(id, fullInfo);\n    }\n}\n\nconst store = new UserStore();\nwindow.user = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getRichText } from '../../../Utils/InstantView';\n\nfunction RichText(props) {\n    return getRichText(props.text);\n}\n\nRichText.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default RichText;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport dateFormat from '../Utils/Date';\nimport { getUserFullName, getUserShortName, getUserStatus, isMeUser, isUserOnline } from './User';\nimport { getSupergroupStatus } from './Supergroup';\nimport { getBasicGroupStatus } from './BasicGroup';\nimport { getLetters } from './Common';\nimport { getContent, isMessageUnread } from './Message';\nimport { isServiceMessage } from './ServiceMessage';\nimport { formatPhoneNumber } from './Phone';\nimport { getChannelStatus } from './Channel';\nimport { loadReplyContents } from './File';\nimport { SERVICE_NOTIFICATIONS_USER_IDS } from '../Constants';\nimport BasicGroupStore from '../Stores/BasicGroupStore';\nimport CallStore from '../Stores/CallStore';\nimport ChatStore from '../Stores/ChatStore';\nimport FileStore from '../Stores/FileStore';\nimport LStore from '../Stores/LocalizationStore';\nimport MessageStore from '../Stores/MessageStore';\nimport NotificationStore from '../Stores/NotificationStore';\nimport SupergroupStore from '../Stores/SupergroupStore';\nimport UserStore from '../Stores/UserStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function canBeReported(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    return chat.can_be_reported;\n}\n\nexport function canManageVoiceChats(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    let status = null;\n    const { type } = chat;\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(getBasicGroupId(chatId));\n            if (!basicGroup) return false;\n\n            status = basicGroup.status;\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            if (isChannelChat(chatId)) return false;\n            \n            const supergroup = SupergroupStore.get(getSupergroupId(chatId));\n            if (!supergroup) return false;\n\n            status = supergroup.status;\n            break;\n        }\n    }\n\n    if (!status) {\n        return false;\n    }\n\n    switch (status['@type']) {\n        case 'chatMemberStatusAdministrator': {\n            return status.can_manage_voice_chats;\n        }\n        case 'chatMemberStatusCreator': {\n            return status.is_member;\n        }\n    }\n\n    return false;\n}\n\nexport function getChatSender(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return { '@type': 'messageSenderChat', chat_id: chatId };\n        }\n        case 'chatTypeSupergroup': {\n            return { '@type': 'messageSenderChat', chat_id: chatId };\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return { '@type': 'messageSenderUser', user_id: getChatUserId(chatId) };\n        }\n    }\n\n    return null;\n}\n\nexport function getChatLocation(chatId) {\n    const supergoupId = getSupergroupId(chatId);\n    if (!supergoupId) return null;\n\n    const fullInfo = SupergroupStore.getFullInfo(supergoupId);\n    if (!fullInfo) return null;\n\n    return fullInfo.location;\n}\n\nexport function canSwitchBlocked(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return false;\n        }\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function getDeleteChatTitle(chatId, t = x => x) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return t('DeleteChat');\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n            if (supergroup) {\n                return supergroup.is_channel ? t('LeaveChannel') : t('LeaveMegaMenu');\n            }\n\n            return null;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return t('DeleteChatUser');\n        }\n    }\n\n    return null;\n}\n\nexport function getViewInfoTitle(chatId, t = x => x) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const { type } = chat;\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return t('ViewGroupInfo');\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return t('ViewProfile');\n        }\n        case 'chatTypeSupergroup': {\n            if (type.is_channel) {\n                return t('ViewChannelInfo');\n            }\n\n            return t('ViewGroupInfo');\n        }\n    }\n}\n\nexport function getChatPosition(chatId, chatList = { '@type': 'chatListMain'}) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    const { positions } = chat;\n    if (!positions) return null;\n    if (!positions.length) return null;\n\n    switch (chatList['@type']) {\n        case 'chatListMain': {\n            return positions.find(x => x.list['@type'] === 'chatListMain');\n        }\n        case 'chatListArchive': {\n            return positions.find(x => x.list['@type'] === 'chatListArchive');\n        }\n        case 'chatListFilter': {\n            return positions.find(x => x.list['@type'] === 'chatListFilter' && x.list.chat_filter_id === chatList.chat_filter_id);\n        }\n    }\n\n    return null;\n}\n\nexport function isChatPinned(chatId, chatList = { '@type': 'chatListMain'}) {\n    const position = getChatPosition(chatId, chatList);\n    if (!position) return false;\n\n    return position.is_pinned;\n}\n\nexport function hasChatList(chatId, chatList = { '@type': 'chatListMain'}) {\n    const position = getChatPosition(chatId, chatList);\n\n    return Boolean(position);\n}\n\nexport function getChatOrder(chatId, chatList = { '@type': 'chatListMain' }) {\n    const position = getChatPosition(chatId, chatList);\n    if (!position) return '0';\n\n    return position.order;\n}\n\nexport function chatListEquals(list1, list2) {\n    if (list1 && !list2) return false;\n    if (!list1 && list2) return false;\n    if (!list1 && !list2) return true;\n\n    if (list1['@type'] !== list2['@type']) return false;\n\n    switch (list1['@type']) {\n        case 'chatListMain': {\n            return true;\n        }\n        case 'chatListArchive': {\n            return true;\n        }\n        case 'chatListFilter': {\n            return list1.chat_filter_id === list2.chat_filter_id;\n        }\n    }\n\n    return false;\n}\n\nexport function positionListEquals(p1, p2) {\n    if (p1 && !p2) return false;\n    if (!p1 && p2) return false;\n    if (!p1 && !p2) return true;\n\n    const { list: list1 } = p1;\n    const { list: list2 } = p2;\n\n    return chatListEquals(list1, list2);\n}\n\nexport function hasOnePinnedMessage(chatId) {\n    const media = MessageStore.getMedia(chatId);\n    if (!media) return false;\n\n    const { pinned } = media;\n    if (!pinned) return false;\n\n    return pinned.length === 1;\n}\n\nexport function isChatArchived(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { positions } = chat;\n    if (!positions) return false;\n\n    const archivePosition = positions.find(x => x.list['@type'] === 'chatListArchive');\n    if (!archivePosition) return false;\n    if (archivePosition.order === '0') return false;\n\n    return true;\n}\n\nexport function canAddChatToList(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { is_sponsored, positions } = chat;\n    if (is_sponsored) return false;\n    if (!positions) return false;\n\n    const mainPosition = positions.find(x => x.list['@type'] === 'chatListMain');\n    if (mainPosition && isMeChat(chatId) || SERVICE_NOTIFICATIONS_USER_IDS.some(x => x === chatId)) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function draftEquals(draft1, draft2) {\n    if (!draft1 && !draft2) return true;\n    if (draft1 && !draft2) return false;\n    if (draft2 && !draft1) return false;\n\n    const { input_message_text: inputMessageText1, reply_to_message_id: replyToMessageId1 } = draft1;\n    const { input_message_text: inputMessageText2, reply_to_message_id: replyToMessageId2 } = draft2;\n\n    if (replyToMessageId1 !== replyToMessageId2) {\n        return false;\n    }\n\n    if (inputMessageText1['@type'] !== inputMessageText2['@type']) {\n        return false;\n    }\n\n    if (inputMessageText1['@type'] !== 'inputMessageText') {\n        return true;\n    }\n\n    const { text: formattedText1 } = inputMessageText1;\n    const { text: formattedText2 } = inputMessageText2;\n\n    if (!formattedText1 && !formattedText2) return true;\n    if (formattedText1 && !formattedText2) return false;\n    if (formattedText2 && !formattedText1) return false;\n\n    const { text: text1, entities: entities1 } = formattedText1;\n    const { text: text2, entities: entities2 } = formattedText2;\n\n    if (text1 !== text2) {\n        return false;\n    }\n\n    return entitiesEquals(entities1, entities2);\n}\n\nfunction entitiesEquals(entities1, entities2) {\n    if (!entities1 && !entities2) return true;\n    if (entities1 && !entities2) return false;\n    if (entities2 && !entities1) return false;\n\n    if (entities1.length !== entities2.length) {\n        return false;\n    }\n\n    const map = new Map();\n    entities1.forEach(x => {\n        map.set(`${x.type['@type']}_${x.offset}_${x.length}`, x);\n    });\n\n    return entities2.every(x => map.has(`${x.type['@type']}_${x.offset}_${x.length}`));\n}\n\nfunction getGroupChatTypingString(inputTypingManager) {\n    if (!inputTypingManager) return null;\n\n    let size = inputTypingManager.actions.size;\n    if (size > 2) {\n        return `${size} people are typing`;\n    } else if (size > 1) {\n        let firstUser;\n        let secondUser;\n        for (let userId of inputTypingManager.actions.keys()) {\n            if (!firstUser) {\n                firstUser = UserStore.get(userId);\n            } else if (!secondUser) {\n                secondUser = UserStore.get(userId);\n                break;\n            }\n        }\n\n        if (!firstUser || !secondUser) {\n            return `${size} people are typing`;\n        }\n\n        firstUser = firstUser.first_name ? firstUser.first_name : firstUser.second_name;\n        secondUser = secondUser.first_name ? secondUser.first_name : secondUser.second_name;\n\n        if (!firstUser || !secondUser) {\n            return `${size} people are typing`;\n        }\n\n        return `${firstUser} and ${secondUser} are typing`;\n    } else {\n        let firstUser;\n        if (inputTypingManager.actions.size >= 1) {\n            for (let userId of inputTypingManager.actions.keys()) {\n                if (!firstUser) {\n                    firstUser = UserStore.get(userId);\n                    break;\n                }\n            }\n\n            if (!firstUser) {\n                return `1 person is typing`;\n            }\n\n            firstUser = firstUser.first_name ? firstUser.first_name : firstUser.second_name;\n\n            if (!firstUser) {\n                return `1 person is typing`;\n            }\n\n            let action = inputTypingManager.actions.values().next().value.action;\n            switch (action['@type']) {\n                case 'chatActionRecordingVideo':\n                    return `${firstUser} is recording a video`;\n                case 'chatActionRecordingVideoNote':\n                    return `${firstUser} is recording a video message`;\n                case 'chatActionRecordingVoiceNote':\n                    return `${firstUser} is recording a voice message`;\n                case 'chatActionStartPlayingGame':\n                    return `${firstUser} is playing a game`;\n                case 'chatActionUploadingDocument':\n                    return `${firstUser} is sending a file`;\n                case 'chatActionUploadingPhoto':\n                    return `${firstUser} is sending a photo`;\n                case 'chatActionUploadingVideo':\n                    return `${firstUser} is sending a video`;\n                case 'chatActionUploadingVideoNote':\n                    return `${firstUser} is sending a video message`;\n                case 'chatActionUploadingVoiceNote':\n                    return `${firstUser} is sending a voice message`;\n                case 'chatActionChoosingContact':\n                case 'chatActionChoosingLocation':\n                case 'chatActionTyping':\n                default:\n                    return `${firstUser} is typing`;\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction getPrivateChatTypingString(inputTypingManager) {\n    if (!inputTypingManager) return null;\n\n    if (inputTypingManager.actions.size >= 1) {\n        let action = inputTypingManager.actions.values().next().value.action;\n        switch (action['@type']) {\n            case 'chatActionRecordingVideo':\n                return 'recording a video';\n            case 'chatActionRecordingVideoNote':\n                return 'recording a video message';\n            case 'chatActionRecordingVoiceNote':\n                return 'recording a voice message';\n            case 'chatActionStartPlayingGame':\n                return 'playing a game';\n            case 'chatActionUploadingDocument':\n                return 'sending a file';\n            case 'chatActionUploadingPhoto':\n                return 'sending a photo';\n            case 'chatActionUploadingVideo':\n                return 'sending a video';\n            case 'chatActionUploadingVideoNote':\n                return 'sending a video message';\n            case 'chatActionUploadingVoiceNote':\n                return 'sending a voice message';\n            case 'chatActionChoosingContact':\n            case 'chatActionChoosingLocation':\n            case 'chatActionTyping':\n            default:\n                return 'typing';\n        }\n    }\n\n    return null;\n}\n\nfunction getChatTypingString(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    let typingManager = ChatStore.getTypingManager(chat.id);\n    if (!typingManager) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const typingString = getPrivateChatTypingString(typingManager);\n            return typingString ? typingString + '...' : null;\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            const typingString = getGroupChatTypingString(typingManager);\n            return typingString ? typingString + '...' : null;\n        }\n    }\n\n    return null;\n}\n\nfunction getMessageSenderFullName(message, t = k => k) {\n    if (!message) return null;\n    if (isServiceMessage(message)) return null;\n    if (!message.sender) return null;\n\n    switch (message.sender['@type']) {\n        case 'messageSenderUser': {\n            return getUserFullName(message.sender.user_id, null, t);\n        }\n    }\n\n    return getChatTitle(message.sender.chat_id, false, t);\n}\n\nfunction getMessageSenderName(message, t = k => k) {\n    if (!message) return null;\n    if (isServiceMessage(message)) return null;\n\n    const { chat_id, sender } = message;\n\n    const chat = ChatStore.get(chat_id);\n    if (!chat) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return null;\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            if (isChannelChat(chat_id)) {\n                return null;\n            }\n\n            switch (sender['@type']) {\n                case 'messageSenderUser': {\n                    if (isMeUser(sender.user_id)) {\n                        return t('FromYou');\n                    }\n\n                    return getUserShortName(sender.user_id, t);\n                }\n                case 'messageSenderChat': {\n                    return getChatTitle(sender.chat_id, false, t);\n                }\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction getLastMessageSenderName(chat, t = k => k) {\n    if (!chat) return null;\n\n    return getMessageSenderName(chat.last_message, t);\n}\n\nfunction getLastMessageContent(chat, t = key => key) {\n    if (!chat) return null;\n\n    const { last_message } = chat;\n    if (!last_message) return null;\n\n    return getContent(last_message, t);\n}\n\nfunction showChatUnreadMessageIcon(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { is_marked_as_unread, last_message, last_read_outbox_message_id } = chat;\n    if (!last_message) return false;\n\n    const { is_outgoing } = last_message;\n\n    return (\n        is_outgoing && last_message.id > last_read_outbox_message_id && !is_marked_as_unread && !showChatDraft(chatId)\n    );\n}\n\nfunction showChatUnreadMentionCount(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { unread_mention_count } = chat;\n\n    return unread_mention_count > 0;\n}\n\nfunction showChatUnreadCount(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { is_marked_as_unread, unread_count, unread_mention_count } = chat;\n\n    return (\n        unread_count > 1 ||\n        (unread_count === 1 && unread_mention_count === 0) ||\n        (is_marked_as_unread && unread_count === 0 && unread_mention_count === 0)\n    );\n}\n\nfunction isChatUnread(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { is_marked_as_unread, unread_count, unread_mention_count } = chat;\n\n    return is_marked_as_unread || unread_count > 0;\n}\n\nfunction isChatMuted(chatId) {\n    return getChatMuteFor(chatId) > 0;\n}\n\nfunction getChatMuteFor(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return 0;\n\n    const { notification_settings } = chat;\n    if (!notification_settings) return 0;\n\n    const { use_default_mute_for, mute_for } = notification_settings;\n\n    if (use_default_mute_for) {\n        const settings = getScopeNotificationSettings(chatId);\n\n        return settings ? settings.mute_for : false;\n    }\n\n    return mute_for;\n}\n\nexport function getScopeNotificationSettings(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return NotificationStore.settings.get('notificationSettingsScopePrivateChats');\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            let settings = null;\n            if (isChannelChat(chatId)) {\n                settings = NotificationStore.settings.get('notificationSettingsScopeChannelChats');\n            } else {\n                settings = NotificationStore.settings.get('notificationSettingsScopeGroupChats');\n            }\n            return settings;\n        }\n    }\n\n    return null;\n}\n\nfunction getMessageDate(message) {\n    const date = new Date(message.date * 1000);\n\n    const dayStart = new Date();\n    dayStart.setHours(0, 0, 0, 0);\n    if (date > dayStart) {\n        return dateFormat(date, LStore.formatterDay);\n    }\n\n    const now = new Date();\n    const day = now.getDay();\n    const weekStart = now.getDate() - day + (day === 0 ? -6 : 1);\n    const monday = new Date(now.setDate(weekStart));\n    if (date > monday) {\n        return date.toLocaleString(LStore.i18n.language, { weekday: 'short' });\n        //return dateFormat(date, 'ddd');\n    }\n\n    return dateFormat(date, LStore.formatterYear);\n}\n\nfunction getLastMessageDate(chat) {\n    if (!chat) return null;\n    if (!chat.last_message) return null;\n    if (!chat.last_message.date) return null;\n    if (showChatDraft(chat.id)) return null;\n\n    return getMessageDate(chat.last_message);\n}\n\nfunction getChatSubtitleWithoutTyping(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    const { type } = chat;\n    if (!type) return null;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (basicGroup) {\n                return getBasicGroupStatus(basicGroup, chatId);\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(type.user_id);\n            if (user) {\n                return getUserStatus(user);\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (supergroup) {\n                return supergroup.is_channel\n                    ? getChannelStatus(supergroup, chatId)\n                    : getSupergroupStatus(supergroup, chatId);\n            }\n\n            break;\n        }\n    }\n\n    return null;\n}\n\nfunction getChatSubtitle(chatId, showSavedMessages = false) {\n    if (isMeChat(chatId) && showSavedMessages) {\n        return null;\n    }\n\n    const chatTypingString = getChatTypingString(chatId);\n    if (chatTypingString) {\n        return chatTypingString;\n    }\n\n    return getChatSubtitleWithoutTyping(chatId);\n}\n\nfunction getChatLetters(chatId, t) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    let title = chat.title || t('HiddenName');\n    if (title.length === 0) return null;\n\n    let letters = getLetters(title);\n    if (letters && letters.length > 0) {\n        return letters;\n    }\n\n    return chat.title.charAt(0);\n}\n\nfunction isAccentChatSubtitleWithoutTyping(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (user) {\n                return isUserOnline(user);\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction isAccentChatSubtitle(chatId) {\n    const typingString = getChatTypingString(chatId);\n    if (typingString) return false;\n\n    return isAccentChatSubtitleWithoutTyping(chatId);\n}\n\nfunction getChatUsername(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return null;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (user) {\n                return user.username;\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n            if (supergroup) {\n                return supergroup.username;\n            }\n            break;\n        }\n    }\n\n    return null;\n}\n\nfunction getChatPhoneNumber(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return null;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (user) {\n                return formatPhoneNumber(user.phone_number);\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            return null;\n        }\n    }\n\n    return null;\n}\n\nfunction getChatBio(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const fullInfo = BasicGroupStore.getFullInfo(chat.type.basic_group_id);\n            if (fullInfo) {\n                return fullInfo.description;\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const fullInfo = UserStore.getFullInfo(chat.type.user_id);\n            if (fullInfo) {\n                return fullInfo.bio;\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            const fullInfo = SupergroupStore.getFullInfo(chat.type.supergroup_id);\n            if (fullInfo) {\n                return fullInfo.description;\n            }\n\n            break;\n        }\n    }\n\n    return null;\n}\n\nfunction isPrivateChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction isGroupChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return true;\n        }\n        case 'chatTypeSupergroup': {\n            return !chat.type.is_channel;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction isChannelChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeSupergroup': {\n            return chat.type.is_channel;\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction isChatMember(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n    if (!type) return false;\n\n    switch (type['@type']) {\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (supergroup && supergroup.status) {\n                switch (supergroup.status['@type']) {\n                    case 'chatMemberStatusAdministrator': {\n                        return true;\n                    }\n                    case 'chatMemberStatusBanned': {\n                        return false;\n                    }\n                    case 'chatMemberStatusCreator': {\n                        return supergroup.status.is_member;\n                    }\n                    case 'chatMemberStatusLeft': {\n                        return false;\n                    }\n                    case 'chatMemberStatusMember': {\n                        return true;\n                    }\n                    case 'chatMemberStatusRestricted': {\n                        return supergroup.status.is_member;\n                    }\n                }\n            }\n            break;\n        }\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (basicGroup && basicGroup.status) {\n                switch (basicGroup.status['@type']) {\n                    case 'chatMemberStatusAdministrator': {\n                        return true;\n                    }\n                    case 'chatMemberStatusBanned': {\n                        return false;\n                    }\n                    case 'chatMemberStatusCreator': {\n                        return basicGroup.status.is_member;\n                    }\n                    case 'chatMemberStatusLeft': {\n                        return false;\n                    }\n                    case 'chatMemberStatusMember': {\n                        return true;\n                    }\n                    case 'chatMemberStatusRestricted': {\n                        return basicGroup.status.is_member;\n                    }\n                }\n            }\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return true;\n        }\n    }\n\n    return false;\n}\nexport function isContactChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (!user) return false;\n\n            return user.is_contact || user.is_mutual_contact;\n        }\n    }\n\n    return false;\n}\n\nexport function isNonContactChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (!user) return false;\n\n            return !user.is_contact;\n        }\n    }\n\n    return false;\n}\n\nexport function isBotChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (!user) return false;\n\n            return user.type['@type'] === 'userTypeBot';\n        }\n    }\n\n    return false;\n}\n\nexport function isChatRead(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return true;\n\n    const { last_message } = chat;\n    if (!last_message) return true;\n\n    const { id } = last_message;\n\n    return !isMessageUnread(chatId, id);\n}\n\nfunction getChatTitle(chatId, showSavedMessages = false) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    if (isMeChat(chatId) && showSavedMessages) {\n        return LStore.i18n.t('SavedMessages');\n    }\n\n    return chat.title || LStore.i18n.t('HiddenName');\n}\n\nexport function getChatType(chatId, t = key => key) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return '';\n\n    switch (chat.type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            if (isMeChat(chatId)) {\n                return '';\n            }\n\n            if (isBotChat(chatId)) {\n                return t('Bot');\n            }\n\n            if (isContactChat(chatId)) {\n                return t('FilterContact');\n            }\n\n            return t('FilterNonContact');\n        }\n        case 'chatTypeBasicGroup': {\n            return t('AccDescrGroup');\n        }\n        case 'chatTypeSupergroup': {\n            return isChannelChat(chatId) ? t('AccDescrGroup') : t('AccDescrChannel');\n        }\n    }\n\n    return '';\n}\n\nexport function isDeletedPrivateChat(chatId) {\n    const fallbackValue = false;\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return fallbackValue;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypeSecret':\n        case 'chatTypePrivate': {\n            const user = UserStore.get(chat.type.user_id);\n\n            return user && user.type['@type'] === 'userTypeDeleted';\n        }\n    }\n\n    return fallbackValue;\n}\n\nfunction isMeChat(chatId) {\n    const fallbackValue = false;\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return fallbackValue;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypeSecret':\n        case 'chatTypePrivate': {\n            return UserStore.getMyId() === chat.type.user_id;\n        }\n    }\n\n    return fallbackValue;\n}\n\nfunction getGroupChatMembers(chatId) {\n    const fallbackValue = [];\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return fallbackValue;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const fullInfo = BasicGroupStore.getFullInfo(chat.type.basic_group_id);\n            if (fullInfo) {\n                return fullInfo.members || fallbackValue;\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            break;\n        }\n        case 'chatTypeSecret':\n        case 'chatTypePrivate': {\n            break;\n        }\n    }\n\n    return fallbackValue;\n}\n\nexport function hasChatGroupCall(chatId) {\n    const chat = ChatStore.get(chatId);\n\n    return Boolean(chat && chat.voice_chat_group_call_id);\n}\n\nexport async function getChatMedia(chatId) {\n    // return;\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    // console.log('[media] getChatMedia start', chatId);\n    const { voice_chat_group_call_id } = chat;\n\n    const promises = [];\n\n    const limit = 100;\n    promises.push(getChatFullInfoRequest(chatId) || Promise.resolve(null));\n    promises.push(TdLibController.send({\n        '@type': 'searchChatMessages',\n        chat_id: chatId,\n        query: '',\n        sender_user_id: 0,\n        from_message_id: 0,\n        offset: 0,\n        limit,\n        filter: { '@type': 'searchMessagesFilterPhotoAndVideo' }\n    }));\n    promises.push(TdLibController.send({\n        '@type': 'searchChatMessages',\n        chat_id: chatId,\n        query: '',\n        sender_user_id: 0,\n        from_message_id: 0,\n        offset: 0,\n        limit,\n        filter: { '@type': 'searchMessagesFilterDocument' }\n    }));\n    promises.push(TdLibController.send({\n        '@type': 'searchChatMessages',\n        chat_id: chatId,\n        query: '',\n        sender_user_id: 0,\n        from_message_id: 0,\n        offset: 0,\n        limit,\n        filter: { '@type': 'searchMessagesFilterAudio' }\n    }));\n    promises.push(TdLibController.send({\n        '@type': 'searchChatMessages',\n        chat_id: chatId,\n        query: '',\n        sender_user_id: 0,\n        from_message_id: 0,\n        offset: 0,\n        limit,\n        filter: { '@type': 'searchMessagesFilterUrl' }\n    }));\n    promises.push(TdLibController.send({\n        '@type': 'searchChatMessages',\n        chat_id: chatId,\n        query: '',\n        sender_user_id: 0,\n        from_message_id: 0,\n        offset: 0,\n        limit,\n        filter: { '@type': 'searchMessagesFilterVoiceNote' }\n    }));\n    promises.push(TdLibController.send({\n        '@type': 'searchChatMessages',\n        chat_id: chatId,\n        query: '',\n        sender_user_id: 0,\n        from_message_id: 0,\n        offset: 0,\n        limit,\n        filter: { '@type': 'searchMessagesFilterPinned' }\n    }));\n    if (isPrivateChat(chatId) && !isMeChat(chatId)) {\n        promises.push(TdLibController.send({\n            '@type': 'getGroupsInCommon',\n            user_id: getChatUserId(chatId),\n            offset_chat_id: 0,\n            limit\n        }));\n    } else {\n        promises.push(Promise.resolve(null));\n    }\n    const call = CallStore.get(voice_chat_group_call_id);\n    if (hasChatGroupCall(chatId) && !call){\n        promises.push(TdLibController.send({\n            '@type': 'getGroupCall',\n            group_call_id: voice_chat_group_call_id\n        }));\n    } else {\n        promises.push(Promise.resolve(call));\n    }\n    if (isSupergroup(chatId) && !isChannelChat(chatId)){\n        promises.push(TdLibController.send({\n            '@type': 'getSupergroupMembers',\n            supergroup_id: getSupergroupId(chatId),\n            filter: { '@type': 'supergroupMembersFilterRecent' },\n            offset: 0,\n            limit: 200\n        }));\n    }\n\n    const [fullInfo, photoAndVideo, document, audio, url, voiceNote, pinned, groupsInCommon, groupCall, supergroupMembers] = await Promise.all(promises);\n    const media = {\n        fullInfo,\n        photoAndVideo: photoAndVideo.messages,\n        document: document.messages,\n        audio: audio.messages,\n        url: url.messages,\n        voiceNote: voiceNote.messages,\n        pinned: pinned.messages,\n        groupsInCommon: groupsInCommon ? groupsInCommon.chat_ids.map(x => ChatStore.get(x)) : [],\n        groupCall,\n        supergroupMembers\n    }\n    // console.log('[media] getChatMedia stop', chatId, media);\n\n    const store = FileStore.getStore();\n    loadReplyContents(store, pinned.messages);\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateChatMedia',\n        chatId,\n        media\n    });\n}\n\nexport async function getChatFullInfoRequest(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    const { type } = chat;\n    if (!type) return null;\n\n    switch (type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return TdLibController.send({\n                '@type': 'getUserFullInfo',\n                user_id: type.user_id\n            });\n        }\n        case 'chatTypeBasicGroup': {\n            return TdLibController.send({\n                '@type': 'getBasicGroupFullInfo',\n                basic_group_id: type.basic_group_id\n            });\n        }\n        case 'chatTypeSupergroup': {\n            return TdLibController.send({\n                '@type': 'getSupergroupFullInfo',\n                supergroup_id: type.supergroup_id\n            });\n        }\n    }\n\n    return null;\n}\n\nasync function getChatFullInfo(chatId) {\n    const request = getChatFullInfoRequest(chatId);\n    if (!request) return null;\n\n    return await request;\n}\n\nexport function getBasicGroupId(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    if (type && type['@type'] === 'chatTypeBasicGroup') {\n        return type.basic_group_id;\n    }\n\n    return 0;\n}\n\nfunction hasBasicGroupId(chatId, basicGroupId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    return type && type['@type'] === 'chatTypeBasicGroup' && type.basic_group_id === basicGroupId;\n}\n\n\nfunction isSupergroup(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    return type && type['@type'] === 'chatTypeSupergroup';\n}\n\nfunction getSupergroupId(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    if (type && type['@type'] === 'chatTypeSupergroup') {\n        return type.supergroup_id;\n    }\n\n    return 0;\n}\n\nfunction hasSupergroupId(chatId, supergroupId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    return isSupergroup(chatId) && type.supergroup_id === supergroupId;\n}\n\nfunction hasUserId(chatId, userId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    return (\n        type && (type['@type'] === 'chatTypePrivate' || type['@type'] === 'chatTypeSecret') && type.user_id === userId\n    );\n}\n\nfunction getChatUserId(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return 0;\n\n    const { type } = chat;\n\n    return type && (type['@type'] === 'chatTypePrivate' || type['@type'] === 'chatTypeSecret') ? type.user_id : 0;\n}\n\nfunction getPhotoFromChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    if (isPrivateChat(chatId)) {\n        const user = UserStore.get(getChatUserId(chatId));\n        if (user) {\n            return user.profile_photo;\n        }\n    }\n\n    return chat.photo;\n}\n\nfunction canSendMediaMessages(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type, permissions: globalPermissions } = chat;\n    if (!type) return false;\n    if (!globalPermissions) return false;\n\n    const { can_send_media_messages } = globalPermissions;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return true;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return is_member && permissions && permissions.can_send_media_messages;\n                }\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return can_send_media_messages;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member; //can_send_media_messages && is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return can_send_media_messages && !supergroup.is_channel;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return can_send_media_messages && is_member && permissions && permissions.can_send_media_messages;\n                }\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction getChatShortTitle(chatId, showSavedMessages = false, t = k => k) {\n    if (isMeChat(chatId) && showSavedMessages) {\n        return t('SavedMessages');\n    }\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return chat.title;\n        }\n        case 'chatTypeSupergroup': {\n            return chat.title;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return getUserShortName(chat.type.user_id, t);\n        }\n    }\n\n    return null;\n}\n\nfunction getGroupChatMembersCount(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(chat.type.basic_group_id);\n            if (basicGroup) {\n                return basicGroup.member_count;\n            }\n\n            return 0;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n            if (supergroup) {\n                return supergroup.member_count;\n            }\n\n            return 0;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return 0;\n        }\n    }\n\n    return 0;\n}\n\nfunction canClearHistory(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    return chat.can_be_deleted_only_for_self || chat.can_be_deleted_for_all_users;\n}\n\nfunction canDeleteChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return true;\n        }\n        case 'chatTypeSupergroup': {\n            return isChatMember(chatId);\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return !isMeChat(chatId);\n        }\n    }\n\n    return false;\n}\n\nfunction canSendPolls(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type, permissions: globalPermissions } = chat;\n    if (!type) return false;\n    if (!globalPermissions) return false;\n\n    const { can_send_polls } = globalPermissions;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return true;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return is_member && permissions && permissions.can_send_polls;\n                }\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return can_send_polls;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member; //can_send_polls && is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return can_send_polls && !supergroup.is_channel;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return can_send_polls && is_member && permissions && permissions.can_send_polls;\n                }\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction canSendMessages(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type, permissions: globalPermissions } = chat;\n    if (!type) return false;\n    if (!globalPermissions) return false;\n\n    const { can_send_messages } = globalPermissions;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return true;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return is_member && permissions && permissions.can_send_messages;\n                }\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return can_send_messages;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member; //can_send_messages && is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return can_send_messages && !supergroup.is_channel;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return can_send_messages && is_member && permissions && permissions.can_send_messages;\n                }\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction showChatDraft(chatId) {\n    const chat = ChatStore.get(chatId);\n    const draft = getChatDraft(chatId);\n\n    return draft && chat.unread_count === 0 && chat.unread_mention_count === 0;\n}\n\nfunction getChatDraft(chatId) {\n    const chat = ChatStore.get(chatId);\n\n    if (chat) {\n        const { draft_message } = chat;\n        if (draft_message) {\n            const { input_message_text } = draft_message;\n            if (input_message_text) {\n                return input_message_text.text;\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction getChatDraftReplyToMessageId(chatId) {\n    let replyToMessageId = 0;\n    const chat = ChatStore.get(chatId);\n    if (chat) {\n        const { draft_message } = chat;\n        if (draft_message) {\n            replyToMessageId = draft_message.reply_to_message_id;\n        }\n    }\n\n    return replyToMessageId;\n}\n\nfunction canPinMessages(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type, permissions: globalPermissions } = chat;\n    if (!type) return false;\n    if (!globalPermissions) return false;\n\n    const { can_pin_messages } = globalPermissions;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return status.can_pin_messages;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return false;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return false;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return is_member && permissions && permissions.can_pin_messages;\n                }\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return can_pin_messages;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return can_pin_messages || status.can_pin_messages;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member; //can_pin_messages && is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return false;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return can_pin_messages && is_member && permissions && permissions.can_pin_messages;\n                }\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction isChatVerified(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n    if (!type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(type.user_id);\n\n            return user && user.is_verified;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n\n            return supergroup && supergroup.is_verified;\n        }\n    }\n\n    return false;\n}\n\nfunction isChatSecret(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n    if (!type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return false;\n        }\n        case 'chatTypePrivate': {\n            return false;\n        }\n        case 'chatTypeSecret': {\n            return true;\n        }\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nexport function isCreator(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n    if (!type) return false;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const { basic_group_id } = type;\n            const basicGroup = BasicGroupStore.get(basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (status) return false;\n\n            return status['@type'] === 'chatMemberStatusCreator';\n        }\n        case 'chatTypePrivate': {\n            return false;\n        }\n        case 'chatTypeSecret': {\n            return false;\n        }\n        case 'chatTypeSupergroup': {\n            const { supergroup_id } = type;\n            const supergroup = SupergroupStore.get(supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            return status['@type'] === 'chatMemberStatusCreator';\n        }\n    }\n\n    return false;\n}\n\nexport function getChatTypeId(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return 0;\n\n    const { type } = chat;\n    if (!type) return 0;\n\n    switch (type['@type']) {\n        case 'chatTypeSupergroup': {\n            return type.supergroup_id;\n        }\n        case 'chatTypeBasicGroup': {\n            return type.basic_group_id;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return type.user_id;\n        }\n    }\n}\n\nexport {\n    showChatDraft,\n    getChatDraft,\n    getChatDraftReplyToMessageId,\n    getChatTypingString,\n    showChatUnreadMessageIcon,\n    showChatUnreadMentionCount,\n    showChatUnreadCount,\n    getChatMuteFor,\n    getChatSubtitle,\n    getChatSubtitleWithoutTyping,\n    getLastMessageSenderName,\n    getMessageSenderName,\n    getMessageSenderFullName,\n    getLastMessageContent,\n    getLastMessageDate,\n    getMessageDate,\n    getChatLetters,\n    isAccentChatSubtitle,\n    isAccentChatSubtitleWithoutTyping,\n    isChatMuted,\n    getChatUsername,\n    getChatPhoneNumber,\n    getChatBio,\n    isPrivateChat,\n    isGroupChat,\n    isChannelChat,\n    isChatUnread,\n    isChatMember,\n    isChatVerified,\n    isChatSecret,\n    getChatTitle,\n    getGroupChatMembers,\n    getChatFullInfo,\n    hasBasicGroupId,\n    hasSupergroupId,\n    isSupergroup,\n    getSupergroupId,\n    hasUserId,\n    getChatUserId,\n    getPhotoFromChat,\n    getChatShortTitle,\n    getGroupChatMembersCount,\n    isMeChat,\n    canClearHistory,\n    canDeleteChat,\n    canPinMessages,\n    canSendMediaMessages,\n    canSendMessages,\n    canSendPolls\n};\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport ChatStore from '../Stores/ChatStore';\nimport LStore from '../Stores/LocalizationStore';\n\nexport function getBasicGroupStatus(basicGroup, chatId) {\n    if (!basicGroup) return null;\n\n    const { status, member_count: count } = basicGroup;\n\n    if (status) {\n        if (status['@type'] === 'chatMemberStatusBanned') {\n            return LStore.getString('YouWereKicked');\n        } else if (status['@type'] === 'chatMemberStatusLeft') {\n            // return LStore.getString('YouLeft');\n        } else if (status['@type'] === 'chatMemberStatusCreator' && !status.is_member) {\n            // return LStore.getString('YouLeft');\n        }\n    }\n\n    if (count <= 1) {\n        return LStore.formatPluralString('Members', count);\n    }\n\n    const onlineCount = ChatStore.getOnlineMemberCount(chatId);\n    if (onlineCount > 1) {\n        return `${LStore.formatPluralString('Members', count)}, ${LStore.formatPluralString('OnlineCount', onlineCount)}`;\n    }\n\n    return LStore.formatPluralString('Members', count);;\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\nimport ChatStore from '../Stores/ChatStore';\nimport LStore from '../Stores/LocalizationStore';\nimport SupergroupStore from '../Stores/SupergroupStore';\n\nexport function getChannelStatus(supergroup, chatId) {\n    if (!supergroup) return '';\n\n    let { is_channel, member_count: count, username } = supergroup;\n    if (!is_channel) return '';\n\n    if (!count) {\n        const fullInfo = SupergroupStore.getFullInfo(supergroup.id);\n        if (fullInfo) {\n            count = fullInfo.member_count;\n        }\n    }\n\n    if (count <= 0) {\n        return username\n            ? LStore.getString('ChannelPublic').toLowerCase()\n            : LStore.getString('ChannelPrivate').toLowerCase();\n    }\n\n    if (count <= 1) {\n        return LStore.formatPluralString('Subscribers', 1);\n    }\n\n    const onlineCount = ChatStore.getOnlineMemberCount(chatId);\n    if (onlineCount > 1) {\n        return `${LStore.formatPluralString('Subscribers', count)}, ${LStore.formatPluralString('OnlineCount', onlineCount)}`;\n    }\n\n    return LStore.formatPluralString('Subscribers', count);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport dateFormat from '../Utils/Date';\nimport { getFirstLetter, getLetters, getSize } from './Common';\nimport { PROFILE_PHOTO_BIG_SIZE, PROFILE_PHOTO_SMALL_SIZE, SERVICE_NOTIFICATIONS_USER_IDS } from '../Constants';\nimport LStore from '../Stores/LocalizationStore';\nimport UserStore from '../Stores/UserStore';\n\nexport function isBotUser(userId) {\n    const user = UserStore.get(userId);\n\n    return user && user.type['@type'] === 'userTypeBot';\n}\n\nexport function isMeUser(userId) {\n    return UserStore.getMyId() === userId;\n}\n\nfunction getUserStatus(user) {\n    if (!user) return null;\n    if (!user.status) return null;\n\n    if (SERVICE_NOTIFICATIONS_USER_IDS.some(x => x === user.id)) {\n        return LStore.getString('ServiceNotifications');\n    }\n\n    if (user.is_support) {\n        return LStore.getString('SupportStatus');\n    }\n\n    if (user.type && user.type['@type'] === 'userTypeBot') {\n        return LStore.getString('Bot').toLowerCase();\n    }\n\n    switch (user.status['@type']) {\n        case 'userStatusEmpty': {\n            return LStore.getString('ALongTimeAgo');\n        }\n        case 'userStatusLastMonth': {\n            return LStore.getString('WithinAMonth');\n        }\n        case 'userStatusLastWeek': {\n            return LStore.getString('WithinAWeek');\n        }\n        case 'userStatusOffline': {\n            let { was_online } = user.status;\n            if (!was_online) return LStore.getString('Invisible');\n\n            const now = new Date();\n             const wasOnline = new Date(was_online * 1000);\n            // if (wasOnline > now) {\n            //     return 'last seen just now';\n            // }\n            //\n            // let diff = new Date(now - wasOnline);\n\n            // within a minute\n            // if (diff.getTime() / 1000 < 60) {\n            //     return 'last seen just now';\n            // }\n\n            // within an hour\n            // if (diff.getTime() / 1000 < 60 * 60) {\n            //     const minutes = Math.floor(diff.getTime() / 1000 / 60);\n            //     return `last seen ${minutes === 1 ? '1 minute' : minutes + ' minutes'} ago`;\n            // }\n\n            // today\n            const today = new Date();\n            today.setHours(0, 0, 0, 0);\n            if (wasOnline > today) {\n                // up to 6 hours ago\n                // if (diff.getTime() / 1000 < 6 * 60 * 60) {\n                //     const hours = Math.floor(diff.getTime() / 1000 / 60 / 60);\n                //     return `last seen ${hours === 1 ? '1 hour' : hours + ' hours'} ago`;\n                // }\n\n                // other\n                return LStore.formatString('LastSeenFormatted', LStore.formatString('TodayAtFormatted', dateFormat(wasOnline, LStore.formatterDay)));\n                // return `last seen today at ${dateFormat(wasOnline, 'H:mm')}`;\n            }\n\n            // yesterday\n            let yesterday = new Date();\n            yesterday.setDate(now.getDate() - 1);\n            today.setHours(0, 0, 0, 0);\n            if (wasOnline > yesterday) {\n                return LStore.formatString('LastSeenFormatted', LStore.formatString('YesterdayAtFormatted', dateFormat(wasOnline, LStore.formatterDay)));\n                // return `last seen yesterday at ${dateFormat(wasOnline, 'H:mm')}`;\n            }\n\n            return LStore.formatString('LastSeenDateFormatted', LStore.formatString('formatDateAtTime', dateFormat(wasOnline, LStore.formatterYear), dateFormat(wasOnline, LStore.formatterDay)));\n            // return `last seen ${dateFormat(wasOnline, 'dd.MM.yyyy')}`;\n        }\n        case 'userStatusOnline': {\n            return LStore.getString('Online');\n        }\n        case 'userStatusRecently': {\n            return LStore.getString('Lately');\n        }\n    }\n\n    return null;\n}\n\nfunction isUserOnline(user) {\n    if (!user) return false;\n\n    const { id, status, type } = user;\n    if (!status) return false;\n    if (!type) return false;\n    if (SERVICE_NOTIFICATIONS_USER_IDS.some(x => x === id)) return false;\n\n    return status['@type'] === 'userStatusOnline' && type['@type'] !== 'userTypeBot';\n}\n\nfunction getUserFullName(userId, user) {\n    user = UserStore.get(userId) || user;\n    if (!user) return null;\n\n    const { type, first_name, last_name } = user;\n    if (!type) return null;\n\n    switch (type['@type']) {\n        case 'userTypeBot':\n        case 'userTypeRegular': {\n            if (first_name && last_name) return `${first_name} ${last_name}`;\n            if (first_name) return first_name;\n            if (last_name) return last_name;\n        }\n        case 'userTypeDeleted':\n        case 'userTypeUnknown': {\n            return LStore.i18n.t('HiddenName');\n        }\n    }\n\n    return null;\n}\n\nfunction getUserShortName(userId, t = k => k) {\n    const user = UserStore.get(userId);\n    if (!user) return null;\n\n    const { type, first_name, last_name } = user;\n    if (!type) return null;\n\n    switch (type['@type']) {\n        case 'userTypeBot':\n        case 'userTypeRegular': {\n            if (first_name) return first_name;\n            if (last_name) return last_name;\n        }\n        case 'userTypeDeleted':\n        case 'userTypeUnknown': {\n            return t('HiddenName');\n        }\n    }\n\n    return null;\n}\n\nfunction isUserBlocked(userId) {\n    const fullInfo = UserStore.getFullInfo(userId);\n    if (fullInfo) {\n        return fullInfo.is_blocked;\n    }\n\n    return false;\n}\n\nfunction getUserLetters(userId, firstName = '', lastName = '', t = x => x) {\n    const user = UserStore.get(userId);\n    if (!user && !(firstName || lastName)) return null;\n\n    const title = getUserFullName(userId, null, t) || `${firstName} ${lastName}`.trim();\n    const letters = getLetters(title);\n    if (letters && letters.length > 0) {\n        return letters;\n    }\n\n    if (user) {\n        firstName = user.first_name;\n        lastName = user.last_name;\n    }\n\n    const firstNameSymbol = getFirstLetter(firstName) || firstName.charAt(0);\n    if (firstNameSymbol) return firstNameSymbol;\n\n    const lastNameSymbol = getFirstLetter(lastName) || lastName.charAt(0);\n    if (lastNameSymbol) return lastNameSymbol;\n\n    return '';\n}\n\nfunction getUserStatusOrder(user) {\n    if (!user) return 0;\n    if (!user.status) return 0;\n    if (user.type['@type'] === 'userTypeBot') return 0;\n\n    switch (user.status['@type']) {\n        case 'userStatusEmpty': {\n            return 1;\n        }\n        case 'userStatusLastMonth': {\n            return 10;\n        }\n        case 'userStatusLastWeek': {\n            return 100;\n        }\n        case 'userStatusOffline': {\n            return user.status.was_online;\n        }\n        case 'userStatusOnline': {\n            return user.status.expires;\n        }\n        case 'userStatusRecently': {\n            return 1000;\n        }\n    }\n}\n\nfunction getProfilePhoto(photo) {\n    if (!photo) return null;\n\n    const { id, sizes } = photo;\n    if (!sizes) return null;\n    if (!sizes.length) return null;\n\n    const { photo: small } = getSize(sizes, PROFILE_PHOTO_SMALL_SIZE);\n    const { photo: big } = getSize(sizes, PROFILE_PHOTO_BIG_SIZE);\n\n    return {\n        '@type': 'profilePhoto',\n        id,\n        small,\n        big\n    };\n}\n\nfunction getProfilePhotoDateHint(userProfilePhoto) {\n    if (!userProfilePhoto) return null;\n\n    const { added_date } = userProfilePhoto;\n    if (!added_date) return null;\n\n    const date = new Date(added_date * 1000);\n    return dateFormat(date, 'H:mm:ss d.MM.yyyy');\n}\n\nexport function isDeletedUser(userId) {\n    const user = UserStore.get(userId);\n\n    return user && user.type['@type'] === 'userTypeDeleted';\n}\n\nexport {\n    getUserStatus,\n    isUserOnline,\n    getUserFullName,\n    isUserBlocked,\n    getUserLetters,\n    getUserStatusOrder,\n    getProfilePhoto,\n    getProfilePhotoDateHint,\n    getUserShortName\n};\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { canSendMessages, getChatUserId, isGroupChat, isPrivateChat } from '../Utils/Chat';\nimport AppStore from '../Stores/ApplicationStore';\nimport LStore from '../Stores/LocalizationStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function showLeaveVoiceChatAlert(params) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateLeaveVoiceChatAlert',\n        params\n    });\n}\n\nexport function showInputPasswordAlert(state, onPassword) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateInputPasswordAlert',\n        state,\n        onPassword\n    });\n}\n\nexport function setText(text) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateSendText',\n        text\n    });\n}\n\nexport function showOpenGameAlert(game, params) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenGameAlert',\n        game,\n        params\n    });\n}\n\nexport function showOpenUrlAlert(url, params) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenUrlAlert',\n        url,\n        params\n    });\n}\n\nexport function showRequestUrlAlert(url, params) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateRequestUrlAlert',\n        url,\n        params\n    });\n}\n\nexport function showAlert(params) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateAlert',\n        params\n    });\n}\n\nexport function showSnackbar(message, action) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateSnackbar',\n        message,\n        action\n    });\n}\n\nexport function openArchive() {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateArchive',\n        open: true\n    });\n}\n\nexport function closeArchive() {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateArchive',\n        open: false\n    });\n}\n\nexport function editMessage(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateEditMessage',\n        chatId,\n        messageId\n    });\n}\n\nexport function deleteMessages(chatId, messageIds) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateDeleteMessages',\n        chatId,\n        messageIds\n    });\n}\n\nexport function replyMessage(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateReply',\n        chatId,\n        messageId\n    });\n}\n\nexport function forward(info) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateForward',\n        info\n    });\n}\n\nexport function forwardMessages(chatId, messageIds) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateForward',\n        info: {\n            chatId,\n            messageIds\n        }\n    });\n}\n\nexport function openUser(userId, popup = false) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenUser',\n        userId,\n        popup\n    });\n}\n\nexport function openChat(chatId, messageId = null, popup = false, options = null) {\n    const { chatSelectOptions } = AppStore;\n    if (chatSelectOptions) {\n        const { switchInline, botStartMessage } = chatSelectOptions;\n\n        let rejected = false\n        if (switchInline) {\n            if (!canSendMessages(chatId)) {\n                rejected = true;\n            }\n        } else if (botStartMessage) {\n            if (!canSendMessages(chatId)) {\n                rejected = true;\n            }\n\n            if (isPrivateChat(chatId)) {\n                if (getChatUserId(chatId) !== botStartMessage.botUserId) {\n                    rejected = true;\n                }\n            } else if (!isGroupChat(chatId)) {\n                rejected = true;\n            }\n        }\n\n        if (rejected) {\n            showAlert({\n                title: LStore.getString('AppName'),\n                message: LStore.getString('WriteChatCant'),\n                ok: LStore.getString('OK')\n            });\n\n            return;\n        }\n\n        AppStore.chatSelectOptions = null;\n\n        options = {\n            ...options,\n            ...chatSelectOptions,\n            ...{ closeChatSelect: true }\n        };\n    }\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenChat',\n        chatId,\n        messageId,\n        popup,\n        options,\n    });\n}\n\nexport function closeChat() {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenChat',\n        chatId: 0,\n        messageId: null,\n        popup: false,\n        options: null\n    });\n}\n\nexport function clearOpenChatOptions() {\n    TdLibController.clientUpdate({ '@type': 'clientUpdateClearOpenChatOptions' });\n}\n\nexport function openReply(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenReply',\n        chatId,\n        messageId\n    });\n}\n\nexport function highlightMessage(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMessageHighlighted',\n        chatId,\n        messageId\n    });\n}\n\nexport function selectMessage(chatId, messageId, selected) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMessageSelected',\n        chatId,\n        messageId,\n        selected\n    });\n}\n\nexport function clearSelection() {\n    TdLibController.clientUpdate({ '@type': 'clientUpdateClearSelection' });\n}\n\nexport function closePinned() {\n    TdLibController.clientUpdate({ '@type': 'clientUpdateClosePinned' });\n}\n\nexport function setInstantViewViewerContent(content) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateInstantViewViewerContent',\n        content\n    });\n}\n\nexport function setMediaViewerContent(content) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaViewerContent',\n        content\n    });\n}\n\nexport function setProfileMediaViewerContent(content) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateProfileMediaViewerContent',\n        content\n    });\n}\n\nexport function setInstantViewContent(content) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateInstantViewContent',\n        content\n    });\n}\n\nexport function searchChat(chatId, query = null) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateSearchChat',\n        chatId,\n        query\n    });\n}\n\nexport function requestUnpinMessage(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateUnpinMessage',\n        chatId,\n        messageId\n    });\n}\n\nexport function requestPinMessage(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdatePinMessage',\n        chatId,\n        messageId\n    });\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport classNames from 'classnames';\nimport { getUserFullName } from '../../Utils/User';\nimport { getChatTitle, isMeChat, isPrivateChat } from '../../Utils/Chat';\nimport { openUser as openUserCommand, openChat as openChatCommand } from '../../Actions/Client';\nimport ChatStore from '../../Stores/ChatStore';\nimport UserStore from '../../Stores/UserStore';\nimport './MessageAuthor.css';\nimport UserTile from '../Tile/UserTile';\nimport ChatTile from '../Tile/ChatTile';\nimport { senderEquals } from '../../Utils/Message';\n\nclass MessageAuthor extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { sender, t } = props;\n\n        if (!senderEquals(state.prevSender, sender)) {\n            return {\n                prevSender: sender,\n\n                fullName: MessageAuthor.getFullName(sender, t)\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        const { fullName } = this.state;\n\n        return fullName !== nextState.fullName;\n    }\n\n    componentDidMount() {\n        ChatStore.on('updateChatTitle', this.onUpdateChatTitle);\n        UserStore.on('updateUser', this.onUpdateUser);\n    }\n\n    componentWillUnmount() {\n        ChatStore.off('updateChatTitle', this.onUpdateChatTitle);\n        UserStore.off('updateUser', this.onUpdateUser);\n    }\n\n    onUpdateUser = update => {\n        const { sender, t } = this.props;\n        const { user } = update;\n\n        if (sender && sender.user_id !== user.id) return;\n\n        const fullName = MessageAuthor.getFullName(sender, t);\n        this.setState({ fullName });\n    };\n\n    onUpdateChatTitle = update => {\n        const { sender, t } = this.props;\n        const { chat_id } = update;\n\n        if (sender && sender.chat_id !== chat_id) return;\n\n        const fullName = MessageAuthor.getFullName(sender, t);\n        this.setState({ fullName });\n    };\n\n    static getFullName = (sender, t) => {\n        if (!sender) return '';\n\n        switch (sender['@type']) {\n            case 'messageSenderUser': {\n                return getUserFullName(sender.user_id, null, t);\n            }\n            case 'messageSenderChat': {\n                return getChatTitle(sender.chat_id, false, t);\n            }\n        }\n\n        return '';\n    };\n\n    handleSelect = event => {\n        const { sender, openUser, openChat, forwardInfo } = this.props;\n\n        let { user_id: userId, chat_id: chatId } = sender;\n\n        if (isMeChat(chatId) && forwardInfo) {\n            switch (forwardInfo.origin['@type']) {\n                case 'messageForwardOriginHiddenUser': {\n                    userId = 0;\n                    chatId = 0;\n                    break;\n                }\n                case 'messageForwardOriginUser': {\n                    userId = forwardInfo.origin.sender_user_id;\n                    chatId = 0;\n                    break;\n                }\n                case 'messageForwardOriginChannel': {\n                    chatId = forwardInfo.origin.chat_id;\n                    userId = 0;\n                    break;\n                }\n            }\n        }\n\n        event.stopPropagation();\n\n        if (openUser && userId) {\n            openUserCommand(userId, true);\n            return;\n        }\n\n        if (openChat && chatId) {\n            openChatCommand(chatId, null, true);\n            return;\n        }\n    };\n\n    render() {\n        const { sender, openUser, openChat, forwardInfo, t } = this.props;\n        let { fullName } = this.state;\n\n        let { chat_id: chatId, user_id: userId } = sender;\n\n        if (UserStore.getMyId() === sender.user_id && forwardInfo) {\n            switch (forwardInfo.origin['@type']) {\n                case 'messageForwardOriginHiddenUser': {\n                    userId = 0;\n                    chatId = 0;\n                    fullName = forwardInfo.origin.sender_name;\n                    break;\n                }\n                case 'messageForwardOriginUser': {\n                    userId = forwardInfo.origin.sender_user_id;\n                    chatId = 0;\n                    fullName = MessageAuthor.getFullName({ '@type': 'messageSenderUser', user_id: userId }, t);\n                    break;\n                }\n                case 'messageForwardOriginChannel': {\n                    userId = 0;\n                    chatId = forwardInfo.origin.chat_id;\n                    fullName = MessageAuthor.getFullName({ '@type': 'messageSenderChat', chat_id: chatId }, t);\n                    break;\n                }\n            }\n        }\n\n        if (!userId && !chatId && !fullName) {\n            return null;\n        }\n\n        if (!chatId) {\n            const tileColor = isPrivateChat(chatId)\n                ? 'message-author-color'\n                : `user_color_${(Math.abs(userId || fullName.charCodeAt(0)) % 7) + 1}`;\n            const className = classNames([tileColor], 'message-author');\n\n            return openUser ? (\n                <a className={className} onClick={this.handleSelect}>\n                    {fullName}\n                </a>\n            ) : (\n                <>{fullName}</>\n            );\n        }\n\n        const className = classNames('message-author-color', 'message-author');\n        return openChat ? (\n            <a className={className} onClick={this.handleSelect}>\n                {fullName}\n            </a>\n        ) : (\n            <>{fullName}</>\n        );\n    }\n}\n\nMessageAuthor.propTypes = {\n    sender: PropTypes.object,\n    forwardInfo: PropTypes.object,\n    openUser: PropTypes.bool,\n    openChat: PropTypes.bool\n};\n\nMessageAuthor.defaultProps = {\n    openUser: false,\n    openChat: false\n};\n\nexport default withTranslation()(MessageAuthor);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nclass EventEmitter {\n    constructor() {\n        this.observers = {};\n    }\n\n    on(events, listener) {\n        events.split(' ').forEach(event => {\n            this.observers[event] = this.observers[event] || [];\n            this.observers[event].push(listener);\n        });\n        return this;\n    }\n\n    off(event, listener) {\n        if (!this.observers[event]) return;\n        if (!listener) {\n            delete this.observers[event];\n            return;\n        }\n\n        this.observers[event] = this.observers[event].filter(l => l !== listener);\n    }\n\n    emit(event, ...args) {\n        if (this.observers[event]) {\n            const cloned = [].concat(this.observers[event]);\n            cloned.forEach(observer => {\n                observer(...args);\n            });\n        }\n\n        if (this.observers['*']) {\n            const cloned = [].concat(this.observers['*']);\n            cloned.forEach(observer => {\n                observer.apply(observer, [event, ...args]);\n            });\n        }\n    }\n}\n\nexport default EventEmitter;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { getAuthor, getMessageAudio } from './Message';\nimport { getBlockAudio } from './InstantView';\nimport { getSrc, supportsStreaming } from './File';\nimport { getAudioTitle } from './Media';\nimport PlayerStore from '../Stores/PlayerStore';\n\nexport function playlistItemEquals(item1, item2) {\n    if (!item1) return false;\n    if (!item2) return false;\n    if (item1['@type'] !== item2['@type']) return false;\n\n    switch (item1['@type']) {\n        case 'message': {\n            return item1.chat_id === item2.chat_id && item1.id === item2.id;\n        }\n    }\n\n    return item1 === item2;\n}\n\nexport function getMediaTitle(source, t = k => k) {\n    if (!source) return null;\n\n    switch (source['@type']) {\n        case 'message': {\n            const { content } = source;\n            if (!content) return null;\n\n            switch (content['@type']) {\n                case 'messageAudio': {\n                    const { audio } = content;\n                    if (audio) {\n                        return getAudioTitle(audio);\n                    }\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (web_page) {\n                        const { audio } = web_page;\n                        if (audio) {\n                            return getAudioTitle(audio);\n                        }\n                    }\n                    break;\n                }\n            }\n\n            return getAuthor(source, t);\n        }\n        case 'pageBlockAudio': {\n            const { audio } = source;\n            if (audio) {\n                return getAudioTitle(audio);\n            }\n\n            return null;\n        }\n        case 'pageBlockVoiceNote': {\n\n            return t('AttachAudio');\n        }\n    }\n\n    return null;\n}\n\nexport function getAudio(source) {\n    if (!source) return null;\n\n    switch (source['@type']) {\n        case 'message': {\n            return getMessageAudio(source.chat_id, source.id);\n        }\n        case 'pageBlockAudio': {\n            return getBlockAudio(source);\n        }\n    }\n\n    return false;\n}\n\nexport function isCurrentSource(chatId, messageId, block, source) {\n    if (!source) return false;\n\n    switch (source['@type']) {\n        case 'message': {\n            return source.chat_id === chatId && source.id === messageId;\n        }\n        case 'instantViewSource': {\n            return source.block === block;\n        }\n    }\n\n    return false;\n}\n\nexport function getCurrentTime(source) {\n    if (!source) return { currentTime: 0, duration: 0 };\n\n    let audio = null;\n    switch (source['@type']) {\n        case 'message': {\n            const { chat_id, id } = source;\n            audio = getMessageAudio(chat_id, id);\n            break;\n        }\n        case 'instantViewSource': {\n            const { block } = source;\n            audio = getBlockAudio(block);\n            break;\n        }\n    }\n\n    if (!audio) return { currentTime: 0, duration: 0 };\n\n    const { audio: file } = audio;\n    if (!file) return { currentTime: 0, duration: 0 };\n\n    const { remote } = file;\n    if (!remote) return { currentTime: 0, duration: 0 };\n\n    const { unique_id } = remote;\n    if (!unique_id) return { currentTime: 0, duration: 0 };\n\n    return PlayerStore.getCurrentTime(unique_id);\n}\n\nexport function getMediaMimeType(source) {\n    if (!source) return '';\n\n    switch (source['@type']) {\n        case 'message': {\n            const { content } = source;\n            if (content) {\n                const { audio, voice_note, video_note, web_page } = content;\n\n                if (audio) {\n                    return audio.mime_type;\n                }\n\n                if (voice_note) {\n                    return voice_note.mime_type;\n                }\n\n                if (video_note) {\n                    return 'video/mp4';\n                }\n\n                if (web_page) {\n                    if (web_page.audio) {\n                        return web_page.audio.mime_type;\n                    }\n\n                    if (web_page.voice_note) {\n                        return web_page.voice_note.mime_type;\n                    }\n\n                    if (web_page.video_note) {\n                        return 'video/mp4';\n                    }\n                }\n            }\n\n            break;\n        }\n        case 'instantViewSource': {\n            const { block } = source;\n            if (block) {\n                const { audio, voice_note, video_note } = block;\n\n                if (audio) {\n                    return audio.mime_type;\n                }\n\n                if (voice_note) {\n                    return voice_note.mime_type;\n                }\n\n                if (video_note) {\n                    return 'video/mp4';\n                }\n            }\n\n            break;\n        }\n    }\n\n    return '';\n}\n\nexport function getMediaSrc(source) {\n    if (!source) return '';\n\n    switch (source['@type']) {\n        case 'message': {\n            const { content } = source;\n            if (content) {\n                const { audio, voice_note, video_note, web_page } = content;\n\n                if (audio) {\n                    const { audio: file } = audio;\n                    if (file) {\n                        let src = getSrc(file);\n                        if (!src && supportsStreaming()) {\n                            src = `/streaming/file?id=${file.id}&size=${file.size}&mime_type=${audio.mime_type}`;\n                        }\n\n                        return src;\n                    }\n                }\n\n                if (voice_note) {\n                    const { voice } = voice_note;\n                    if (voice) {\n                        return getSrc(voice);\n                    }\n                }\n\n                if (video_note) {\n                    const { video } = video_note;\n                    if (video) {\n                        return getSrc(video);\n                    }\n                }\n\n                if (web_page) {\n                    if (web_page.audio) {\n                        const { audio: file } = web_page.audio;\n                        if (file) {\n                            let src = getSrc(file);\n                            if (!src && supportsStreaming()) {\n                                src = `/streaming/file?id=${file.id}&size=${file.size}&mime_type=${web_page.audio.mime_type}`;\n                            }\n\n                            return src;\n                        }\n                    }\n\n                    if (web_page.voice_note) {\n                        const { voice } = web_page.voice_note;\n                        if (voice) {\n                            return getSrc(voice);\n                        }\n                    }\n\n                    if (web_page.video_note) {\n                        const { video } = web_page.video_note;\n                        if (video) {\n                            return getSrc(video);\n                        }\n                    }\n                }\n            }\n\n            break;\n        }\n        case 'instantViewSource': {\n            const { block } = source;\n            if (block) {\n                const { audio, voice_note, video_note } = block;\n\n                if (audio) {\n                    const { audio: file } = audio;\n                    if (file) {\n                        let src = getSrc(file);\n                        if (!src && supportsStreaming()) {\n                            src = `/streaming/file?id=${file.id}&size=${file.size}&mime_type=${audio.mime_type}`;\n                        }\n\n                        return src;\n                    }\n                }\n\n                if (voice_note) {\n                    const { voice } = voice_note;\n                    if (voice) {\n                        return getSrc(voice);\n                    }\n                }\n\n                if (video_note) {\n                    const { video } = video_note;\n                    if (video) {\n                        return getSrc(video);\n                    }\n                }\n            }\n\n            break;\n        }\n    }\n\n    return '';\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport { isGroupChat } from '../../Utils/Chat';\nimport { modalManager } from '../../Utils/Modal';\nimport { openChat, openUser } from '../../Actions/Client';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './MentionLink.css';\n\nclass MentionLink extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {};\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const { userId, username } = props;\n\n        if (state.prevUserId !== userId || state.prevUsername !== username) {\n            return {\n                prevUserId: userId,\n                prevUsername: username,\n                error: false\n            };\n        }\n\n        return null;\n    }\n\n    handleClick = async event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        const { userId, username, popup } = this.props;\n        if (userId) {\n            openUser(userId, popup);\n        } else if (username) {\n            const chat = await TdLibController.send({\n                '@type': 'searchPublicChat',\n                username\n            }).catch(() => {\n                this.setState({ error: true });\n            });\n\n            if (chat) {\n                if (isGroupChat(chat.id)) {\n                    openChat(chat.id, null, false);\n                } else {\n                    openChat(chat.id, null, popup);\n                }\n            }\n        }\n    };\n\n    handleClose = () => {\n        this.setState({ error: false });\n    };\n\n    handleDialogClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    render() {\n        const { children, t, title, username } = this.props;\n        const { error } = this.state;\n\n        return (\n            <>\n                <a title={title} onClick={this.handleClick}>\n                    {children}\n                </a>\n                {error && (\n                    <Dialog\n                        manager={modalManager}\n                        transitionDuration={0}\n                        open={true}\n                        onClose={this.handleClose}\n                        onClick={this.handleDialogClick}\n                        aria-labelledby='confirm-dialog-title'>\n                        <DialogTitle id='confirm-dialog-title'>{t('Error')}</DialogTitle>\n                        <DialogContent classes={{ root: 'safe-link-content-root' }}>\n                            <DialogContentText>{`Can't find username ${username}.`}</DialogContentText>\n                        </DialogContent>\n                        <DialogActions>\n                            <Button onClick={this.handleClose}>{t('Ok')}</Button>\n                        </DialogActions>\n                    </Dialog>\n                )}\n            </>\n        );\n    }\n}\n\nMentionLink.propTypes = {\n    userId: PropTypes.number,\n    username: PropTypes.string,\n    title: PropTypes.string,\n    popup: PropTypes.bool\n};\n\nMentionLink.defaultProps = {\n    popup: true\n};\n\nexport default withTranslation()(MentionLink);\n","/*\n *  Copyright (c) 2021-present, J Miguel Farto\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { useRef, useLayoutEffect } from 'react';\n\nfunction Latex(props) {\n    const node = useRef();\n    const text = props.children;\n\n    useLayoutEffect(() => {\n        const element = [node.current];\n\n        window.MathJax.typeset(element);\n\n        return () => {\n            window.MathJax.typesetClear(element);\n        }\n    },\n    [text]);\n\n    return (\n        <span ref={node} class='latex'>\n            {text}\n        </span>\n    );}\n\nexport default Latex;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * Modified by J Miguel Farto to include LaTeX rendering (2021).\n */\n\nimport React from 'react';\nimport emojiRegex from 'emoji-regex';\nimport MentionLink from '../Components/Additional/MentionLink';\nimport Poll from '../Components/Message/Media/Poll';\nimport SafeLink from '../Components/Additional/SafeLink';\nimport Latex from '../Components/Additional/Latex';\nimport dateFormat from '../Utils/Date';\nimport { searchChat, setMediaViewerContent } from '../Actions/Client';\nimport { getChatTitle, isMeChat, isPrivateChat } from './Chat';\nimport { openUser } from '../Actions/Client';\nimport { getFitSize, getPhotoSize, getSize } from './Common';\nimport { download, saveOrDownload, supportsStreaming } from './File';\nimport { getAudioTitle } from './Media';\nimport { getDecodedUrl } from './Url';\nimport { getServiceMessageContent } from './ServiceMessage';\nimport { getUserFullName, isBotUser, isMeUser } from './User';\nimport { getBlockAudio } from './InstantView';\nimport { LOCATION_HEIGHT, LOCATION_SCALE, LOCATION_WIDTH, LOCATION_ZOOM, PHOTO_DISPLAY_SIZE, PHOTO_SIZE, PHOTO_THUMBNAIL_SIZE, PLAYER_AUDIO_2X_MIN_DURATION } from '../Constants';\nimport AppStore from '../Stores/ApplicationStore';\nimport ChatStore from '../Stores/ChatStore';\nimport FileStore from '../Stores/FileStore';\nimport LStore from '../Stores/LocalizationStore';\nimport MessageStore from '../Stores/MessageStore';\nimport PlayerStore from '../Stores/PlayerStore';\nimport UserStore from '../Stores/UserStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function isEmptySelection(selection) {\n    // new line symbol\n    if (selection.length === 1 && selection.charCodeAt(0) === 10) {\n        return true;\n    }\n\n    if (selection.length === 2 && selection.charCodeAt(0) === 10 && selection.charCodeAt(1) === 10) {\n        return true;\n    }\n\n    // console.log('[selection] isBad=false', { selection });\n    return selection.length === 0;\n}\n\nexport function senderEquals(lhs, rhs) {\n    if (!lhs && !rhs) return true;\n    if (!lhs && rhs) return false;\n    if (lhs && !rhs) return false;\n\n    switch (lhs['@type']) {\n        case 'messageSenderUser': {\n            return lhs.user_id === rhs.user_id;\n        }\n        case 'messageSenderChat': {\n            return lhs.chat_id === rhs.chat_id;\n        }\n    }\n\n    return false;\n}\n\nexport function forwardInfoEquals(lhs, rhs) {\n    if (!lhs && !rhs) return true;\n    if (!lhs && rhs) return false;\n    if (lhs && !rhs) return false;\n\n    switch (lhs.origin['@type']) {\n        case 'messageForwardOriginChannel': {\n            return lhs.origin.chat_id === rhs.origin.chat_id;\n        }\n        case 'messageForwardOriginHiddenUser': {\n            return lhs.origin.sender_name === rhs.origin.sender_name;\n        }\n        case 'messageForwardOriginUser': {\n            return lhs.origin.sender_user_id === rhs.origin.sender_user_id;\n        }\n    }\n\n    return false;\n}\n\nexport function isMetaBubble(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) {\n        return false;\n    }\n\n    const { content } = message;\n    if (!content) {\n        return false;\n    }\n\n    const { caption } = content;\n    if (caption && caption.text && caption.text.length > 0) {\n        return false;\n    }\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return true;\n        }\n        case 'messageInvoice': {\n            const { photo } = content;\n            return Boolean(photo);\n        }\n        case 'messageLocation': {\n            return true;\n        }\n        case 'messagePhoto': {\n            return true;\n        }\n        case 'messageSticker': {\n            return true;\n        }\n        case 'messageVideo': {\n            return true;\n        }\n        case 'messageVideoNote': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isMessageUnread(chatId, messageId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) {\n        return false;\n    }\n\n    const { last_read_inbox_message_id, last_read_outbox_message_id } = chat;\n\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) {\n        return false;\n    }\n\n    const { id, is_outgoing } = message;\n    const isMe = isMeChat(chatId);\n    if (is_outgoing && isMe) {\n        return false;\n    }\n\n    return is_outgoing ? id > last_read_outbox_message_id : id > last_read_inbox_message_id;\n}\n\nfunction getAuthor(message, t = k => k) {\n    if (!message) return null;\n\n    const { forward_info } = message;\n\n    if (forward_info) {\n        switch (forward_info['@type']) {\n            case 'messageForwardedFromUser': {\n                if (forward_info.sender_user_id > 0) {\n                    const user = UserStore.get(forward_info.sender_user_id);\n                    if (user) {\n                        return getUserFullName(forward_info.sender_user_id, null, t);\n                    }\n                }\n                break;\n            }\n            case 'messageForwardedPost': {\n                const chat = ChatStore.get(forward_info.chat_id);\n                if (chat) {\n                    return chat.title;\n                }\n                break;\n            }\n        }\n    }\n\n    return getTitle(message, t);\n}\n\nfunction getTitle(message, t = k => k) {\n    if (!message) return null;\n\n    const { sender, chat_id } = message;\n\n    if (!sender) {\n        return null;\n    }\n\n    if (sender.user_id) {\n        const user = UserStore.get(sender.user_id);\n        if (user) {\n            return getUserFullName(sender.user_id, null, t);\n        }\n    }\n\n    if (chat_id) {\n        const chat = ChatStore.get(chat_id);\n        if (chat) {\n            return chat.title;\n        }\n    }\n\n    return null;\n}\n\nfunction substring(text, start, end) {\n    if (start < 0) start = 0;\n    if (start > text.length - 1) start = text.length - 1;\n    if (end < start) end = start;\n    if (end > text.length) end = text.length;\n\n    return text.substring(start, end);\n}\n\nfunction stopPropagation(event) {\n    event.stopPropagation();\n}\n\nfunction searchCurrentChat(event, text) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    const { chatId } = AppStore;\n\n    searchChat(chatId, text);\n}\n\nfunction latexFormat(text) {\n    return text.match(/(?:\\$|\\\\\\(|\\\\\\[|\\\\begin\\{.*?})/) ?\n        <Latex>{text}</Latex> : text\n}\n\nfunction getFormattedText(formattedText, t = k => k, options = { }) {\n    if (formattedText['@type'] !== 'formattedText') return null;\n\n    const { text, entities } = formattedText;\n    if (!text) return null;\n    if (!entities) return [latexFormat(text)];\n    if (!entities.length) return [latexFormat(text)];\n\n    const isValidEntity = options.isValidEntity || (() => true);\n    let deleteLineBreakAfterPre = false;\n    let result = [];\n\n    let index = 0;\n    for (let i = 0; i < entities.length; i++) {\n        const entity = entities[i];\n        const { offset, length, type } = entity;\n\n        // skip nested entities\n        if (index > offset) {\n            continue;\n        }\n\n        let textBefore = substring(text, index, offset);\n        const textBeforeLength = textBefore.length;\n        if (textBefore) {\n            if (deleteLineBreakAfterPre && textBefore.length > 0 && textBefore[0] === '\\n') {\n                textBefore = textBefore.substr(1);\n                deleteLineBreakAfterPre = false;\n            }\n            if (textBefore) {\n                result.push(latexFormat(textBefore));\n            }\n        }\n\n        const entityKey = offset;\n        let entityText = substring(text, offset, offset + length);\n        if (deleteLineBreakAfterPre && entityText.length > 0 && entityText[0] === '\\n') {\n            entityText = entityText.substr(1);\n            deleteLineBreakAfterPre = false;\n        }\n\n        if (!isValidEntity(entity)) {\n            result.push(latexFormat(entityText));\n        } else {\n\n            switch (type['@type']) {\n                case 'textEntityTypeBold': {\n                    result.push(<strong key={entityKey}>{entityText}</strong>);\n                    break;\n                }\n                case 'textEntityTypeBotCommand': {\n                    let username = '';\n                    let command = entityText.length > 0 && entityText[0] === '/' ? substring(entityText, 1) : entityText;\n\n                    const split = command.split('@');\n                    if (split.length === 2) {\n                        command = split[0];\n                        username = split[1];\n                    } else {\n                        const chatId = AppStore.getChatId();\n                        if (!isPrivateChat(chatId)) {\n                            let botUserId = 0;\n\n                            const { chatId, messageId } = options;\n                            const message = MessageStore.get(chatId, messageId);\n                            if (message) {\n                                const { sender, via_bot_user_id } = message;\n                                botUserId = sender.user_id;\n                                if (via_bot_user_id) {\n                                    botUserId = via_bot_user_id;\n                                }\n\n                                if (isBotUser(botUserId)) {\n                                    const bot = UserStore.get(botUserId);\n                                    if (bot) {\n                                        username = bot.username;\n                                    }\n                                }\n                            }\n                        }\n                    }\n\n                    result.push(\n                        <SafeLink key={entityKey} url={`tg://bot_command?command=${command}` + (username ? `&bot=${username}` : '')}>\n                            {entityText}\n                        </SafeLink>\n                    );\n                    break;\n                }\n                case 'textEntityTypeCashtag': {\n                    result.push(\n                        <a key={entityKey} onClick={event => searchCurrentChat(event, entityText)}>\n                            {entityText}\n                        </a>\n                    );\n                    break;\n                }\n                case 'textEntityTypeCode': {\n                    result.push(<code key={entityKey}>{entityText}</code>);\n                    break;\n                }\n                case 'textEntityTypeEmailAddress': {\n                    result.push(\n                        <a\n                            key={entityKey}\n                            href={`mailto:${entityText}`}\n                            onClick={stopPropagation}\n                            target='_blank'\n                            rel='noopener noreferrer'>\n                            {entityText}\n                        </a>\n                    );\n                    break;\n                }\n                case 'textEntityTypeHashtag': {\n                    result.push(\n                        <a key={entityKey} onClick={event => searchCurrentChat(event, entityText)}>\n                            {entityText}\n                        </a>\n                    );\n                    break;\n                }\n                case 'textEntityTypeItalic': {\n                    result.push(<em key={entityKey}>{entityText}</em>);\n                    break;\n                }\n                case 'textEntityTypeMentionName': {\n                    result.push(\n                        <MentionLink key={entityKey} userId={type.user_id} title={getUserFullName(type.user_id, null, t)}>\n                            {entityText}\n                        </MentionLink>\n                    );\n                    break;\n                }\n                case 'textEntityTypeMention': {\n                    result.push(\n                        <MentionLink key={entityKey} username={entityText}>\n                            {entityText}\n                        </MentionLink>\n                    );\n                    break;\n                }\n                case 'textEntityTypePhoneNumber': {\n                    result.push(\n                        <a key={entityKey} href={`tel:${entityText}`} onClick={stopPropagation}>\n                            {entityText}\n                        </a>\n                    );\n                    break;\n                }\n                case 'textEntityTypePre': {\n                    result.push(<pre key={entityKey}>{entityText}</pre>);\n                    deleteLineBreakAfterPre = true;\n                    break;\n                }\n                case 'textEntityTypePreCode': {\n                    result.push(\n                        <pre key={entityKey}>\n                        <code>{entityText}</code>\n                    </pre>\n                    );\n                    deleteLineBreakAfterPre = true;\n                    break;\n                }\n                case 'textEntityTypeStrikethrough': {\n                    result.push(<strike key={entityKey}>{entityText}</strike>);\n                    break;\n                }\n                case 'textEntityTypeTextUrl': {\n                    const url = type.url ? type.url : entityText;\n\n                    result.push(\n                        <SafeLink key={entityKey} url={url}>\n                            {entityText}\n                        </SafeLink>\n                    );\n                    break;\n                }\n                case 'textEntityTypeUrl': {\n                    result.push(\n                        <SafeLink key={entityKey} url={entityText}>\n                            {entityText}\n                        </SafeLink>\n                    );\n                    break;\n                }\n                case 'textEntityTypeUnderline': {\n                    result.push(<u key={entityKey}>{entityText}</u>);\n                    break;\n                }\n                default:\n                    result.push(latexFormat(entityText));\n                    break;\n            }\n        }\n\n        index += textBeforeLength + entity.length;\n    }\n\n    if (index < text.length) {\n        let textAfter = text.substring(index);\n        if (deleteLineBreakAfterPre && textAfter.length > 0 && textAfter[0] === '\\n') {\n            textAfter = textAfter.substr(1);\n        }\n        if (textAfter) {\n            result.push(latexFormat(textAfter));\n        }\n    }\n\n    return result;\n}\n\nfunction getText(message, meta, t = k => k, options = { }) {\n    if (!message) return null;\n\n    let result = [];\n\n    const { content } = message;\n    if (!content) return [meta];\n\n    const { text, caption } = content;\n\n    if (text && text['@type'] === 'formattedText' && text.text) {\n        result = getFormattedText(text, t, options);\n    } else if (caption && caption['@type'] === 'formattedText' && caption.text) {\n        const formattedText = getFormattedText(caption, t);\n        if (formattedText) {\n            result = result.concat(formattedText);\n        }\n    }\n\n    return result && result.length > 0 ? [...result, meta] : [];\n}\n\nfunction getWebPage(message) {\n    if (!message) return null;\n    if (!message.content) return null;\n\n    return message.content.web_page;\n}\n\nexport function getViews(views) {\n    if (views < 1000) {\n        return views\n    }\n\n\n    if (views < 1000000) {\n        views = Math.trunc(views / 100);\n        const fractionDigits = views % 10 < 1 ? 0 : 1;\n\n        return (views / 10).toFixed(fractionDigits) + 'K';\n    }\n\n    views = Math.trunc(views / 100000);\n    const fractionDigits = views % 10 < 1 ? 0 : 1;\n\n    return (views / 10).toFixed(fractionDigits) + 'M';\n}\n\nwindow.getViews = getViews;\n\nfunction getDate(date) {\n    if (!date) return null;\n\n    const d = new Date(date * 1000);\n\n    return dateFormat(d, LStore.formatterDay);\n}\n\nfunction getDateHint(date) {\n    if (!date) return null;\n\n    const d = new Date(date * 1000);\n\n    return LStore.formatString('formatDateAtTime', dateFormat(d, LStore.formatterYear), dateFormat(d, LStore.formatterDay));\n}\n\nfunction isForwardOriginHidden(forwardInfo) {\n    if (!forwardInfo) return false;\n\n    const { origin } = forwardInfo;\n    if (!origin) return false;\n\n    switch (origin['@type']) {\n        case 'messageForwardOriginUser': {\n            return false;\n        }\n        case 'messageForwardOriginHiddenUser': {\n            return true;\n        }\n        case 'messageForwardOriginChannel': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction getForwardTitle(forwardInfo, t = key => key) {\n    if (!forwardInfo) return '';\n\n    const { origin } = forwardInfo;\n    if (!origin) return '';\n\n    switch (origin['@type']) {\n        case 'messageForwardOriginUser': {\n            const { sender_user_id } = origin;\n\n            return getUserFullName(sender_user_id, null, t);\n        }\n        case 'messageForwardOriginHiddenUser': {\n            const { sender_name } = origin;\n\n            return sender_name;\n        }\n        case 'messageForwardOriginChannel': {\n            const { chat_id, author_signature } = origin;\n\n            return getChatTitle(chat_id, false, t) + (author_signature ? ` (${author_signature})` : '');\n        }\n    }\n\n    return '';\n}\n\nfunction getUnread(message) {\n    if (!message) return false;\n    if (!message.chat_id) return false;\n    if (!message.is_outgoing) return false;\n\n    let chat = ChatStore.get(message.chat_id);\n    if (!chat) return false;\n\n    return chat.last_read_outbox_message_id < message.id;\n}\n\nfunction filterDuplicateMessages(result, history) {\n    if (result.messages.length === 0) return;\n    if (history.length === 0) return;\n\n    const map = history.reduce(function(accumulator, current) {\n        accumulator.set(current.id, current.id);\n        return accumulator;\n    }, new Map());\n\n    result.messages = result.messages.filter(x => !map.has(x.id));\n}\n\nexport function getCallContent(sender, content) {\n    const { is_video, discard_reason } = content;\n    const isMissed = discard_reason && discard_reason['@type'] === 'callDiscardReasonMissed';\n    const isBusy = discard_reason && discard_reason['@type'] === 'callDiscardReasonDeclined';\n    if (isMeUser(sender.user_id)) {\n        if (isMissed) {\n            if (is_video) {\n                return LStore.getString('CallMessageVideoOutgoingMissed');\n            } else {\n                return LStore.getString('CallMessageOutgoingMissed');\n            }\n        } else {\n            if (is_video) {\n                return LStore.getString('CallMessageVideoOutgoing');\n            } else {\n                return LStore.getString('CallMessageOutgoing');\n            }\n        }\n    } else {\n        if (isMissed) {\n            if (is_video) {\n                return LStore.getString('CallMessageVideoIncomingMissed');\n            } else {\n                return LStore.getString('CallMessageIncomingMissed');\n            }\n        } else if (isBusy) {\n            if (is_video) {\n                return LStore.getString('CallMessageVideoIncomingDeclined');\n            } else {\n                return LStore.getString('CallMessageIncomingDeclined');\n            }\n        } else {\n            if (is_video) {\n                return LStore.getString('CallMessageVideoIncoming');\n            } else {\n                return LStore.getString('CallMessageIncoming');\n            }\n        }\n    }\n}\n\nfunction getContent(message, t = key => key) {\n    if (!message) return null;\n\n    const { content, is_outgoing, sender } = message;\n    if (!content) return null;\n\n    let caption = '';\n    if (content.caption && content.caption.text) {\n        caption = `, ${content.caption.text}`;\n    }\n\n    if (message.ttl > 0) {\n        return getServiceMessageContent(message);\n    }\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return t('AttachGif') + caption;\n        }\n        case 'messageAudio': {\n            const { audio } = content;\n            const title = getAudioTitle(audio) || t('AttachMusic');\n\n            return title + caption;\n        }\n        case 'messageBasicGroupChatCreate': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageCall': {\n            const text = getCallContent(sender, content);\n\n            const { duration } = content;\n            if (duration > 0) {\n                return LStore.formatString('CallMessageWithDuration', text, LStore.formatCallDuration(duration));\n            }\n\n            return text;\n        }\n        case 'messageChatAddMembers': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatChangePhoto': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatChangeTitle': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatDeleteMember': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatDeletePhoto': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatJoinByLink': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatSetTtl': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatUpgradeFrom': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatUpgradeTo': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageContact': {\n            return t('AttachContact') + caption;\n        }\n        case 'messageContactRegistered': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageCustomServiceAction': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document && document.file_name) {\n                return document.file_name + caption;\n            }\n\n            return t('AttachDocument') + caption;\n        }\n        case 'messageExpiredPhoto': {\n            return t('AttachPhoto') + caption;\n        }\n        case 'messageExpiredVideo': {\n            return t('AttachVideo') + caption;\n        }\n        case 'messageGame': {\n            return t('AttachGame') + caption;\n        }\n        case 'messageGameScore': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageInviteVoiceChatParticipants': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageInvoice': {\n            const { title } = content;\n\n            return title + caption;\n        }\n        case 'messageLocation': {\n            return t('AttachLocation') + caption;\n        }\n        case 'messagePassportDataReceived': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePassportDataSent': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePaymentSuccessful': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePaymentSuccessfulBot': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePhoto': {\n            return t('AttachPhoto') + caption;\n        }\n        case 'messagePoll': {\n            const { poll } = content;\n\n            return ' ' + (poll.question || t('Poll')) + caption;\n        }\n        case 'messagePinMessage': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageScreenshotTaken': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageSticker': {\n            const { sticker } = content;\n            let emoji = '';\n            if (sticker && sticker.emoji) {\n                emoji = sticker.emoji;\n            }\n\n            return t('AttachSticker') + (emoji ? ` ${emoji}` : '') + caption;\n        }\n        case 'messageSupergroupChatCreate': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageText': {\n            return content.text.text + caption;\n        }\n        case 'messageUnsupported': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageVenue': {\n            return t('AttachLocation') + caption;\n        }\n        case 'messageVideo': {\n            return t('AttachVideo') + caption;\n        }\n        case 'messageVideoNote': {\n            return t('AttachRound') + caption;\n        }\n        case 'messageVoiceChatStarted': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageVoiceChatEnded': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageVoiceNote': {\n            return t('AttachAudio') + caption;\n        }\n        case 'messageWebsiteConnected': {\n            return getServiceMessageContent(message);\n        }\n        default: {\n            return t('UnsupportedAttachment');\n        }\n    }\n}\n\nfunction isMediaContent(content) {\n    if (!content) return false;\n\n    return content['@type'] === 'messagePhoto';\n}\n\nfunction getLocationId(\n    location,\n    width = LOCATION_WIDTH,\n    height = LOCATION_HEIGHT,\n    zoom = LOCATION_ZOOM,\n    scale = LOCATION_SCALE\n) {\n    if (!location) return null;\n\n    const { longitude, latitude } = location;\n    return `loc=${latitude},${longitude}&size=${width},${height}&scale=${scale}&zoom=${zoom}`;\n}\n\nfunction isVideoMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageVideo': {\n            return true;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            return Boolean(web_page.video);\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nfunction isLottieMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageDocument': {\n            const { document } = content;\n            if (!document) return false;\n\n            const { file_name } = document;\n\n            return file_name && file_name.toLowerCase().endsWith('.json');\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (!web_page) return false;\n\n            const { document } = web_page;\n            if (!document) return false;\n\n            const { file_name } = document;\n\n            return file_name && file_name.toLowerCase().endsWith('.json');\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nexport function isEmbedMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageText': {\n            const { web_page } = content;\n            if (!web_page) return false;\n\n            const { embed_url, site_name } = web_page;\n            if (!embed_url) return false;\n            if (!site_name) return false;\n\n            switch (site_name) {\n                case 'Coub': {\n                    return true;\n                }\n                case 'SoundCloud': {\n                    return true;\n                }\n                case 'Spotify': {\n                    return true;\n                }\n                case 'Twitch': {\n                    return true;\n                }\n                case 'YouTube': {\n                    return true;\n                }\n                case 'Vimeo': {\n                    return true;\n                }\n                case '': {\n                    return true;\n                }\n                case '.': {\n                    return true;\n                }\n            }\n\n            return false;\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nfunction isAnimationMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return true;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            return Boolean(web_page.animation);\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nfunction isContentOpened(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return true;\n\n    const { content } = message;\n    if (!content) return true;\n\n    switch (content['@type']) {\n        case 'messageVoiceNote': {\n            return content.is_listened;\n        }\n        case 'messageVideoNote': {\n            return content.is_viewed;\n        }\n        default: {\n            return true;\n        }\n    }\n}\n\nexport function hasVoice(source) {\n    if (!source) return false;\n\n    switch (source['@type']) {\n        case 'message': {\n            const message = MessageStore.get(source.chat_id, source.id);\n            if (!message) return false;\n\n            const { content } = message;\n            if (!content) return false;\n\n            switch (content['@type']) {\n                case 'messageVoiceNote': {\n                    const { voice_note } = content;\n                    if (voice_note) {\n                        return true;\n                    }\n\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (web_page) {\n                        const { voice_note } = web_page;\n                        if (voice_note) {\n                            return true;\n                        }\n                    }\n\n                    break;\n                }\n            }\n            break;\n        }\n        case 'pageBlockVoiceNote': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function useAudioPlaybackRate(source) {\n    if (!source) return false;\n\n    let audio = null;\n    switch (source['@type']) {\n        case 'message': {\n            audio = getMessageAudio(source.chat_id, source.id);\n            break;\n        }\n        case 'pageBlockAudio': {\n            audio = getBlockAudio(source);\n            break;\n        }\n    }\n\n    return audio && audio.duration > PLAYER_AUDIO_2X_MIN_DURATION;\n}\n\nexport function getMessageAudio(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAudio': {\n            const { audio } = content;\n\n            return audio;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { audio } = web_page;\n\n                return audio;\n            }\n\n            break;\n        }\n    }\n\n    return null;\n}\n\nfunction hasAudio(source) {\n    if (!source) return false;\n\n    switch (source['@type']) {\n        case 'message': {\n            return !!getMessageAudio(source.chat_id, source.id);\n        }\n        case 'pageBlockAudio': {\n            return !!getBlockAudio(source);\n        }\n    }\n\n    return false;\n}\n\nfunction hasVideoNote(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (video_note) {\n                return true;\n            }\n\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { video_note } = web_page;\n                if (video_note) {\n                    return true;\n                }\n            }\n\n            break;\n        }\n    }\n\n    return false;\n}\n\nfunction getSearchMessagesFilter(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAudio': {\n            const { audio } = content;\n            if (audio) {\n                return {\n                    '@type': 'searchMessagesFilterAudio'\n                };\n            }\n            break;\n        }\n        case 'messageVoiceNote': {\n            const { voice_note } = content;\n            if (voice_note) {\n                return {\n                    '@type': 'searchMessagesFilterVoiceNote'\n                };\n            }\n            break;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (video_note) {\n                return null;\n\n                return {\n                    '@type': 'searchMessagesFilterVideoNote'\n                };\n            }\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { audio, voice_note, video_note } = web_page;\n                if (audio) {\n                    return null;\n\n                    return {\n                        '@type': 'searchMessagesFilterAudio'\n                    };\n                }\n\n                if (voice_note) {\n                    return null;\n\n                    return {\n                        '@type': 'searchMessagesFilterVoiceNote'\n                    };\n                }\n\n                if (video_note) {\n                    return null;\n\n                    return {\n                        '@type': 'searchMessagesFilterVideoNote'\n                    };\n                }\n                break;\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction openAnimation(animation, message, fileCancel) {\n    if (!animation) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { animation: file } = animation;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    } else {\n        // download file at loadMediaViewerContent instead\n        // download(file, message, FileStore.updateAnimationBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateActiveAnimation',\n        chatId: chat_id,\n        messageId: id\n    });\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openAudio(audio, message, fileCancel) {\n    if (!audio) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { audio: file } = audio;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active && !supportsStreaming()) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    } else {\n        if (!supportsStreaming()) {\n            download(file, message, () => FileStore.updateAudioBlob(chat_id, id, file.id));\n        }\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    const { remote } = file;\n    const { unique_id } = remote;\n    const { currentTime, duration } = PlayerStore.getCurrentTime(unique_id);\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaActive',\n        source: MessageStore.get(chat_id, id),\n        currentTime,\n        duration\n    });\n}\n\nfunction openChatPhoto(photo, message, fileCancel) {\n    if (!photo) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    const photoSize = getPhotoSize(photo.sizes);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    download(file, message, () => FileStore.updatePhotoBlob(chat_id, id, file.id));\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openContact(contact, message, fileCancel) {\n    if (!contact) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    openUser(contact.user_id, true);\n}\n\nfunction openDocument(document, message, fileCancel) {\n    if (!document) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { document: file } = document;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    saveOrDownload(file, document.file_name, message);\n}\n\nfunction openGame(game, message, fileCancel) {\n    if (!game) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    const { animation } = game;\n    if (animation) {\n        let { animation: file } = animation;\n        if (!file) return;\n\n        file = FileStore.get(file.id) || file;\n        if (fileCancel && file.local.is_downloading_active) {\n            FileStore.cancelGetRemoteFile(file.id, message);\n            return;\n        } else if (fileCancel && file.remote.is_uploading_active) {\n            FileStore.cancelUploadFile(file.id, message);\n            return;\n        }\n\n        download(file, message, () => FileStore.updateAnimationBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateActiveAnimation',\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openPhoto(photo, message, fileCancel) {\n    if (!photo) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    const photoSize = getPhotoSize(photo.sizes);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    download(file, message, () => FileStore.updatePhotoBlob(chat_id, id, file.id));\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nasync function openSticker(sticker, message, fileCancel) {\n    if (!sticker) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    const { set_id } = sticker;\n    if (!set_id) return;\n\n    const stickerSet = await TdLibController.send({\n        '@type': 'getStickerSet',\n        set_id\n    });\n\n    if (!stickerSet) return;\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateStickerSet',\n        stickerSet\n    });\n}\n\nfunction openVideo(video, message, fileCancel) {\n    if (!video) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { video: file } = video;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active && !supportsStreaming()) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openVideoNote(videoNote, message, fileCancel) {\n    if (!videoNote) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { video: file } = videoNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    download(file, message, () => FileStore.updateVideoNoteBlob(chat_id, id, file.id));\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    const { remote } = file;\n    const { unique_id } = remote;\n    const { currentTime, duration } = PlayerStore.getCurrentTime(unique_id);\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaActive',\n        source: MessageStore.get(chat_id, id),\n        currentTime,\n        duration\n    });\n}\n\nfunction openVoiceNote(voiceNote, message, fileCancel) {\n    if (!voiceNote) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { voice: file } = voiceNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    } else {\n        download(file, message, () => FileStore.updateVoiceNoteBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    const { remote } = file;\n    const { unique_id } = remote;\n    const { currentTime, duration } = PlayerStore.getCurrentTime(unique_id);\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaActive',\n        source: MessageStore.get(chat_id, id),\n        currentTime,\n        duration\n    });\n}\n\nfunction openMedia(chatId, messageId, fileCancel = true) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation) {\n                openAnimation(animation, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageAudio': {\n            const { audio } = content;\n            if (audio) {\n                // openDocument(audio, message, fileCancel);\n                openAudio(audio, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (photo) {\n                openChatPhoto(photo, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageContact': {\n            const { contact } = content;\n            if (contact) {\n                openContact(contact, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document) {\n                openDocument(document, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageGame': {\n            const { game } = content;\n            if (game) {\n                openGame(game, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageInvoice':\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (photo) {\n                openPhoto(photo, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageSticker': {\n            const { sticker } = content;\n            if (sticker) {\n                openSticker(sticker, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, audio, document, photo, sticker, video, video_note, voice_note } = web_page;\n\n                if (animation) {\n                    openAnimation(animation, message, fileCancel);\n                    break;\n                }\n\n                if (audio) {\n                    openAudio(audio, message, fileCancel);\n                    break;\n                }\n\n                if (document) {\n                    openDocument(document, message, fileCancel);\n                    break;\n                }\n\n                if (sticker) {\n                    openSticker(sticker, message, fileCancel);\n                    break;\n                }\n\n                if (video) {\n                    openVideo(video, message, fileCancel);\n                    break;\n                }\n\n                if (video_note) {\n                    openVideoNote(video_note, message, fileCancel);\n                    break;\n                }\n\n                if (voice_note) {\n                    openVoiceNote(voice_note, message, fileCancel);\n                    break;\n                }\n\n                if (photo) {\n                    openPhoto(photo, message, fileCancel);\n                    break;\n                }\n            }\n\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video) {\n                openVideo(video, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (video_note) {\n                openVideoNote(video_note, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageVoiceNote': {\n            const { voice_note } = content;\n            if (voice_note) {\n                openVoiceNote(voice_note, message, fileCancel);\n            }\n\n            break;\n        }\n    }\n}\n\nfunction isDeletedMessage(message) {\n    return message && message['@type'] === 'deletedMessage';\n}\n\nexport function getReplyMinithumbnail(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (!animation) return null;\n\n            const { minithumbnail } = animation;\n            return minithumbnail || null;\n        }\n        case 'messageAudio': {\n            return null;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return photo.minithumbnail || null;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (!document) return null;\n\n            const { minithumbnail } = document;\n            return minithumbnail || null;\n        }\n        case 'messageGame': {\n            const { game } = content;\n            if (!game) return null;\n\n            const { animation, photo } = game;\n            if (animation) {\n                const { minithumbnail } = animation;\n                if (minithumbnail) {\n                    return minithumbnail;\n                }\n            }\n\n            if (photo) {\n                return photo.minithumbnail || null;\n            }\n\n            return null;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return photo.minithumbnail || null;\n        }\n        case 'messageSticker': {\n            return null;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, audio, document, photo, sticker, video, video_note } = web_page;\n                if (photo) {\n                    return photo.minithumbnail || null;\n                }\n                if (animation) {\n                    const { minithumbnail } = animation;\n                    return minithumbnail || null;\n                }\n                if (audio) {\n                    return null;\n                }\n                if (document) {\n                    const { minithumbnail } = document;\n                    return minithumbnail || null;\n                }\n                if (sticker) {\n                    return null;\n                }\n                if (video) {\n                    const { minithumbnail } = video;\n                    return minithumbnail || null;\n                }\n                if (video_note) {\n                    const { minithumbnail } = video_note;\n                    return minithumbnail || null;\n                }\n            }\n\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (!video) return null;\n\n            const { minithumbnail } = video;\n            return minithumbnail || null;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (!video_note) return null;\n\n            const { minithumbnail } = video_note;\n            return minithumbnail || null;\n        }\n    }\n\n    return null;\n}\n\nexport function getReplyThumbnail(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (!animation) return null;\n\n            const { thumbnail } = animation;\n            return thumbnail || null;\n        }\n        case 'messageAudio': {\n            const { audio } = content;\n            if (!audio) return null;\n\n            const { album_cover_thumbnail } = audio;\n            return album_cover_thumbnail || null;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return getPhotoSize(photo.sizes, PHOTO_THUMBNAIL_SIZE);\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (!document) return null;\n\n            const { thumbnail } = document;\n            return thumbnail || null;\n        }\n        case 'messageGame': {\n            const { game } = content;\n            if (!game) return null;\n\n            const { animation, photo } = game;\n            if (animation) {\n                const { thumbnail } = animation;\n                if (thumbnail) {\n                    return thumbnail;\n                }\n            }\n\n            if (photo) {\n                return getPhotoSize(photo.sizes, PHOTO_THUMBNAIL_SIZE);\n            }\n\n            return null;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return getPhotoSize(photo.sizes, PHOTO_THUMBNAIL_SIZE);\n        }\n        case 'messageSticker': {\n            const { sticker } = content;\n            if (!sticker) return null;\n\n            const { thumbnail } = sticker;\n            return thumbnail || null;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, audio, document, photo, sticker, video, video_note } = web_page;\n                if (photo) {\n                    return getPhotoSize(photo.sizes, PHOTO_THUMBNAIL_SIZE);\n                }\n                if (animation) {\n                    const { thumbnail } = animation;\n                    return thumbnail || null;\n                }\n                if (audio) {\n                    const { album_cover_thumbnail } = audio;\n                    return album_cover_thumbnail || null;\n                }\n                if (document) {\n                    const { thumbnail } = document;\n                    return thumbnail || null;\n                }\n                if (sticker) {\n                    const { thumbnail } = sticker;\n                    return thumbnail || null;\n                }\n                if (video) {\n                    const { thumbnail } = video;\n                    return thumbnail || null;\n                }\n                if (video_note) {\n                    const { thumbnail } = video_note;\n                    return thumbnail || null;\n                }\n            }\n\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (!video) return null;\n\n            const { thumbnail } = video;\n            return thumbnail || null;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (!video_note) return null;\n\n            const { thumbnail } = video_note;\n            return thumbnail || null;\n        }\n    }\n\n    return null;\n}\n\nfunction getEmojiMatches(chatId, messageId) {\n    return 0;\n\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return 0;\n\n    const { content } = message;\n    if (!content) return 0;\n    if (content['@type'] !== 'messageText') return 0;\n\n    const { text: textContent } = content;\n    if (!textContent) return;\n    if (textContent['@type'] !== 'formattedText') return 0;\n\n    const { text, entities } = textContent;\n    if (!text) return 0;\n    if (entities && entities.length > 0) return 0;\n\n    let lastIndex = 0;\n    let emojiMatches = 0;\n    let m;\n    const re = emojiRegex();\n    do {\n        m = re.exec(text);\n\n        if (m) {\n            emojiMatches += 1;\n            // none-emoji symbol between prev and current emojis or before first\n            if (lastIndex !== m.index) {\n                emojiMatches = 0;\n                break;\n            }\n            // more than 3 emojis in a row\n            if (emojiMatches > 3) {\n                emojiMatches = 0;\n                break;\n            }\n            lastIndex = re.lastIndex;\n        }\n        // none-emoji symbol at the end\n        if (!m && lastIndex !== text.length) {\n            emojiMatches = 0;\n            break;\n        }\n    } while (m);\n\n    return emojiMatches;\n}\n\nfunction messageComparatorDesc(left, right) {\n    return left.id - right.id;\n}\n\nfunction checkInclusion(index, entities) {\n    if (!entities) return false;\n    if (!entities.length) return false;\n\n    for (let i = 0; i < entities.length; i++) {\n        if (index >= entities[i].offset && index < entities[i].offset + entities[i].length) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction checkIntersection(startIndex, endIndex, entities) {\n    if (!entities) return false;\n    if (!entities.length) return false;\n\n    for (let i = 0; i < entities.length; i++) {\n        if (startIndex <= entities[i].offset && entities[i].offset + entities[i].length - 1 <= endIndex) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction checkEntity(startIndex, endIndex, entities) {\n    return (\n        !checkInclusion(startIndex, entities) &&\n        !checkInclusion(endIndex, entities) &&\n        !checkIntersection(startIndex, endIndex, entities)\n    );\n}\n\nfunction removeOffsetAfter(start, countToRemove, entities) {\n    if (!entities) return;\n    if (!entities.length) return;\n\n    entities.forEach(e => {\n        if (e.offset > start) {\n            e.offset -= countToRemove;\n        }\n    });\n}\n\nfunction addOffsetAfter(start, countToAdd, entities) {\n    if (!entities) return;\n    if (!entities.length) return;\n\n    entities.forEach(e => {\n        if (e.offset > start) {\n            e.offset += countToAdd;\n        }\n    });\n}\n\nfunction removeEntities(startIndex, endIndex, entities) {\n    if (!entities) return;\n    if (!entities.length) return;\n\n    for (let i = 0; i < entities.length; i++) {\n        const entity = entities[i];\n        const entityStart = entity.offset;\n        const entityEnd = entity.offset + entity.length - 1;\n        if (\n            (startIndex <= entityStart && entityStart <= endIndex) ||\n            (startIndex <= entityEnd && entityEnd <= endIndex) ||\n            (entityStart < startIndex && endIndex > entityEnd)\n        ) {\n            entities.splice(i--, 1);\n        }\n    }\n}\n\nfunction addTextNode(offset, length, text, nodes) {\n    const node = document.createTextNode(text.substr(offset, length));\n    nodes.push(node);\n}\n\nexport function getNodes(text, entities, t = k => k) {\n    if (!text) return [];\n\n    entities = (entities || []).sort((a, b) => {\n        if (a.offset - b.offset !== 0) {\n            return a.offset - b.offset;\n        }\n\n        return b.length - a.length;\n    });\n\n    let nodes = [];\n    let offset = 0;\n    let prevEntity = null;\n    entities.forEach(x => {\n        if (x.offset - offset > 0) {\n            addTextNode(offset, x.offset - offset, text, nodes);\n            offset = x.offset;\n        }\n\n        if (!(prevEntity && checkInclusion(x.offset, [prevEntity]))) {\n            switch (x.type['@type']) {\n                case 'textEntityTypeBold': {\n                    const node = document.createElement('b');\n                    node.innerText = text.substr(x.offset, x.length);\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypeBotCommand': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeCashtag': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeCode': {\n                    const node = document.createTextNode('`' + text.substr(x.offset, x.length) + '`');\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypeEmailAddress': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeHashtag': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeItalic': {\n                    const node = document.createElement('i');\n                    node.innerText = text.substr(x.offset, x.length);\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypeMention': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeMentionName': {\n                    try {\n                        const { user_id } = x.type;\n                        const user = UserStore.get(user_id);\n                        if (user) {\n                            const node = document.createElement('a');\n                            // node.href = getDecodedUrl(url, false);\n                            node.title = getUserFullName(user_id, null, t);\n                            // node.target = '_blank';\n                            // node.rel = 'noopener noreferrer';\n                            node.dataset.userId = user_id;\n                            node.innerText = text.substr(x.offset, x.length);\n                            nodes.push(node);\n                        } else {\n                            addTextNode(x.offset, x.length, text, nodes);\n                        }\n                    } catch {\n                        addTextNode(x.offset, x.length, text, nodes);\n                    }\n                    break;\n                }\n                case 'textEntityTypePhoneNumber': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypePre': {\n                    const node = document.createTextNode('```' + text.substr(x.offset, x.length) + '```');\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypePreCode': {\n                    const node = document.createTextNode('```' + text.substr(x.offset, x.length) + '```');\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypeStrikethrough': {\n                    const node = document.createElement('strike');\n                    node.innerText = text.substr(x.offset, x.length);\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypeTextUrl': {\n                    try {\n                        const { url } = x.type;\n\n                        const node = document.createElement('a');\n                        node.href = getDecodedUrl(url, false);\n                        node.title = getDecodedUrl(url, false);\n                        node.target = '_blank';\n                        node.rel = 'noopener noreferrer';\n                        node.innerText = text.substr(x.offset, x.length);\n                        nodes.push(node);\n                    } catch {\n                        addTextNode(x.offset, x.length, text, nodes);\n                    }\n                    break;\n                }\n                case 'textEntityTypeUrl': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeUnderline': {\n                    const node = document.createElement('u');\n                    node.innerText = text.substr(x.offset, x.length);\n                    nodes.push(node);\n                    break;\n                }\n                default: {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n            }\n\n            prevEntity = x;\n            offset += x.length;\n        }\n    });\n\n    if (offset < text.length) {\n        addTextNode(offset, text.length - offset, text, nodes);\n    }\n\n    return nodes;\n}\n\n// based on code from official Android Telegram client\n// https://github.com/DrKLO/Telegram/blob/28eb8dfd0ef959fd5ad7d5d22f1d32879707c0a0/TMessagesProj/src/main/java/org/telegram/messenger/MediaDataController.java#L3782\nexport function getEntities(text) {\n    const entities = [];\n    if (!text) return { text, entities };\n\n    text = text.replace(/<div><br><\\/div>/gi, '<br>');\n    text = text.replace(/<div>/gi, '<br>');\n    text = text.replace(/<\\/div>/gi, '');\n    text = text.split('<br>').join('\\n');\n\n    // 0 looking for html entities\n    text = getHTMLEntities(text, entities);\n\n    // 1 looking for ``` and ` in order to find mono and pre entities\n    text = getMonoPreEntities(text, entities);\n\n    // 2 looking for bold, italic, etc. entities\n    text = getSimpleMarkupEntities(text, entities);\n\n    return { text, entities };\n}\n\nfunction compareEntities(a, b) {\n    const { offset: offsetA } = a;\n    const { offset: offsetB } = b;\n\n    if (offsetA < offsetB) {\n        return -1;\n    }\n\n    if (offsetA > offsetB) {\n        return 1;\n    }\n\n    return 0;\n}\n\nexport function getUrlMentionHashtagEntities(text, entities) {\n    const { text: t1, entities: e1 } = getUrlEntities(text, entities);\n\n    const { text: t2, entities: e2 } = getMentionHashtagEntities(t1, e1);\n\n    return { text: t2, entities: e2 };\n}\n\nconst urlRegExp = /((ftp|http|https):\\/\\/)?([\\w_-]+(?:(?:\\.[\\w_-]+)+))([\\w.,@?^=%&:/~+#-]*[\\w@?^=%&/~+#-])?/g;\n\nexport function getUrlEntities(text, entities) {\n    let e = [];\n    const regExp = urlRegExp;\n    let result = regExp.exec(text);\n    while (result) {\n        const { index: offset } = result;\n        const length = result[0].length;\n\n        e.push({\n            '@type': 'textEntity',\n            type: { '@type': 'textEntityTypeUrl' },\n            length,\n            offset\n        });\n\n        result = regExp.exec(text);\n    }\n\n    return { text, entities: [...entities, ...e].sort(compareEntities) };\n}\n\nexport function getMentionHashtagEntities(text, entities) {\n    let e = [];\n    const regExp = mentionHashtagRegExp;\n    let result = regExp.exec(text);\n    while (result) {\n        let { index: offset } = result;\n        let i = 1;\n\n        let ch = text[offset];\n        if (ch !== '#' && ch !== '@') {\n            offset++;\n            i++;\n            ch = text[offset];\n        }\n\n        const length = result[0].length - i + 1;\n\n        if (ch === '@') {\n            e.push({\n                '@type': 'textEntity',\n                type: { '@type': 'textEntityTypeMention' },\n                length,\n                offset\n            });\n        } else if (ch === '#') {\n            e.push({\n                '@type': 'textEntity',\n                type: { '@type': 'textEntityTypeHashtag' },\n                length,\n                offset\n            });\n        }\n\n        result = regExp.exec(text);\n    }\n\n    return { text, entities: [...entities, ...e].sort(compareEntities) };\n}\n\nconst twitterInstagramEntities = new Map();\nconst mentionHashtagRegExp = /(^|\\s|\\()@[a-zA-Z\\d_.]{1,32}|(^|\\s|\\()#[\\w]+/g;\n\n// based on https://github.com/DrKLO/Telegram/blob/5a2a813dc029ba1b9a31b514a78eb85fced0183f/TMessagesProj/src/main/java/org/telegram/messenger/MessageObject.java#L3191\nexport function getTwitterInstagramEntities(patternType, text, entities) {\n    const key = `${patternType}_${text}`;\n\n    let e = [];\n    if (!twitterInstagramEntities.has(key)) {\n        let result = mentionHashtagRegExp.exec(text);\n        while (result) {\n            let { index: offset } = result;\n            let i = 1;\n\n            let ch = text[offset];\n            if (ch !== '@' && ch !== '#') {\n                offset++;\n                i++;\n                ch = text[offset];\n            }\n\n            const length = result[0].length - i + 1;\n            const foundText = result[0].substr(i);\n            let url = null;\n\n            // instagram\n            if (patternType === 1) {\n                if (ch === '@') {\n                    url = 'https://instagram.com/' + foundText;\n                } else if (ch === '#') {\n                    url = 'https://instagram.com/explore/tags/' + foundText;\n                }\n                // twitter\n            } else if (patternType === 2) {\n                if (ch === '@') {\n                    url = 'https://twitter.com/' + foundText;\n                } else if (ch === '#') {\n                    url = 'https://twitter.com/hashtag/' + foundText;\n                }\n            }\n\n            if (url) {\n                e.push({\n                    '@type': 'textEntity',\n                    type: { '@type': 'textEntityTypeTextUrl', url },\n                    length,\n                    offset\n                });\n            }\n\n            result = mentionHashtagRegExp.exec(text);\n        }\n\n        twitterInstagramEntities.set(key, e);\n    } else {\n        e = twitterInstagramEntities.get(key);\n    }\n\n    return { text, entities: [...entities, ...e].sort(compareEntities) };\n}\n\nexport function getHTMLEntities(text, entities) {\n    const result = new DOMParser().parseFromString(text, 'text/html');\n\n    let offset = 0;\n    let length = 0;\n\n    let finalText = '';\n    result.body.childNodes.forEach(node => {\n        const { textContent, nodeName } = node;\n\n        length = textContent.length;\n        finalText += textContent;\n\n        if (!checkEntity(offset, offset + length - 1, entities)) {\n            return;\n        }\n\n        switch (nodeName) {\n            case '#text': {\n                offset += length;\n                break;\n            }\n            case 'A': {\n                if (node.dataset.userId) {\n                    entities.push({\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        type: { '@type': 'textEntityTypeMentionName', user_id: node.dataset.userId },\n                        textContent: finalText.substring(offset, offset + length)\n                    });\n                } else if (node.href) {\n                    entities.push({\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        type: { '@type': 'textEntityTypeTextUrl', url: node.href },\n                        textContent: finalText.substring(offset, offset + length)\n                    });\n                }\n                offset += length;\n                break;\n            }\n            case 'B':\n            case 'STRONG': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypeBold' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            case 'BR': {\n                break;\n            }\n            case 'CODE': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypeCode' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            case 'I':\n            case 'EM': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypeItalic' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            case 'PRE': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypePre' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            case 'DEL':\n            case 'S':\n            case 'STRIKE': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypeStrikethrough' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            case 'INS':\n            case 'U': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypeUnderline' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            default: {\n                offset += length;\n                break;\n            }\n        }\n    });\n    text = finalText;\n\n    return text;\n}\n\nexport function getMonoPreEntities(text, entities) {\n    const mono = '`';\n    const pre = '```';\n    let isPre = false;\n\n    let index = -1;     // first index of end tag\n    let lastIndex = 0;  // first index after end tag\n    let start = -1;     // first index of start tag\n\n    let offset = 0, length = 0;\n\n    while ((index = text.indexOf(isPre ? pre : mono, lastIndex)) !== -1) {\n        if (start === -1) {\n            // find start tag\n            isPre = text.length - index > 2 && text[index + 1] === mono && text[index + 2] === mono;\n            start = index;\n            lastIndex = index + (isPre ? 3 : 1);\n        } else {\n            // find end tag\n            for (let i = index + (isPre ? 3 : 1); i < text.length; i++) {\n                if (text[i] === mono) {\n                    index++;\n                } else {\n                    break;\n                }\n            }\n\n            lastIndex = index + (isPre ? 3 : 1);\n            if (isPre) {\n                // add pre tag\n\n                let textBefore = text.substring(0, start);\n                let textContent = text.substring(start + 3, index);\n                let textAfter = text.substring(index + 3, text.length);\n\n                if (textContent.length > 0) {\n                    offset = start;\n                    length = index - start - 3;\n\n                    text = textBefore + textContent + textAfter;\n\n                    const entity = {\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        language: '',\n                        type: { '@type': 'textEntityTypePre' },\n                        textContent: text.substring(offset, offset + length)\n                    };\n                    removeEntities(offset, offset + length - 1 + 6);\n                    removeOffsetAfter(offset + length, 6, entities);\n                    entities.push(entity);\n                    lastIndex -= 6;\n\n                    // clean text before\n                    if (textBefore.length > 0) {\n                        const lastChar = textBefore[textBefore.length - 1];\n                        if (lastChar !== '\\n') {\n                            if (lastChar === ' ' || lastChar === '\\xA0') {\n                                textBefore = textBefore.substr(0, textBefore.length - 1) + '\\n';\n                                text = textBefore + textContent + textAfter;\n                            } else {\n                                textBefore += '\\n';\n                                text = textBefore + textContent + textAfter;\n                                addOffsetAfter(offset - 1, 1, entities);\n                                lastIndex += 1;\n                            }\n                        }\n                    }\n\n                    // clean text after\n                    if (textAfter.length > 0) {\n                        const firstChar = textAfter[0];\n                        if (firstChar !== '\\n') {\n                            if (firstChar === ' ' || firstChar === '\\xA0') {\n                                textAfter = '\\n' + textAfter.substr(1);\n                                text = textBefore + textContent + textAfter;\n                            } else {\n                                textAfter = '\\n' + textAfter;\n                                text = textBefore + textContent + textAfter;\n                                addOffsetAfter(offset + length - 1, 1, entities);\n                                lastIndex += 1;\n                            }\n                        }\n                    }\n\n                    // clean text content\n                    if (textContent.length > 2) {\n                        if (textContent[0] === '\\n') {\n                            textContent = textContent.substring(1);\n                            text = textBefore + textContent + textAfter;\n                            entity.length -= 1;\n                            entity.textContent = textContent;\n                            removeOffsetAfter(entity.offset + entity.length - 1, 1, entities);\n                            lastIndex -= 1;\n                        }\n                    }\n\n                    if (textContent.length > 2) {\n                        if (textContent[textContent.length - 1] === '\\n') {\n                            textContent = textContent.substring(0, textContent.length - 1);\n                            text = textBefore + textContent + textAfter;\n                            entity.length -= 1;\n                            entity.textContent = textContent;\n                            removeOffsetAfter(entity.offset + entity.length - 1, 1, entities);\n                            lastIndex -= 1;\n                        }\n                    }\n                }\n            } else {\n                // add code tag\n                if (start + 1 !== index) {\n                    offset = start;\n                    length = index - start - 1;\n\n                    text =\n                        text.substring(0, start) +\n                        text.substring(start + 1, index) +\n                        text.substring(index + 1, text.length);\n\n                    const entity = {\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        type: { '@type': 'textEntityTypeCode' },\n                        textContent: text.substring(offset, offset + length)\n                    };\n                    removeEntities(offset, offset + length - 1 + 2);\n                    removeOffsetAfter(offset + length, 2, entities);\n                    entities.push(entity);\n                    lastIndex -= 2;\n                }\n            }\n\n            start = -1;\n            isPre = false;\n        }\n    }\n\n    // 1.1 case when ``` is one ` mono symbol\n    if (start !== -1 && isPre) {\n        offset = start;\n        length = 1;\n\n        if (checkEntity(offset, offset + length + 2 - 1, entities)) {\n            text = text.substring(0, start) + text.substring(start + 2, text.length);\n\n            const entity = {\n                '@type': 'textEntity',\n                offset,\n                length,\n                type: { '@type': 'textEntityTypeCode' },\n                textContent: text.substring(offset, offset + length)\n            };\n            removeEntities(offset, offset + length - 1 + 2);\n            removeOffsetAfter(offset + length, 2, entities);\n            entities.push(entity);\n        }\n    }\n\n    return text;\n}\n\nexport function getSimpleMarkupEntities(text, entities) {\n    const entityTypes = {\n        '*': 'textEntityTypeBold',\n        '_': 'textEntityTypeItalic',\n        '~': 'textEntityTypeStrikethrough'\n    };\n\n    let index = -1;     // first index of end tag\n    let lastIndex = 0;  // first index after end tag\n    let start = -1;     // first index of start tag\n\n    let offset = 0, length = 0;\n\n    Object.entries(entityTypes).forEach(([checkChar, type]) => {\n        const checkString = checkChar + checkChar;\n        lastIndex = 0;\n        start = -1;\n        while ((index = text.indexOf(checkString, lastIndex)) !== -1) {\n            if (start === -1) {\n                const prevChar = index === 0 ? ' ' : text[index - 1];\n                if (\n                    !checkInclusion(index, entities) &&\n                    (prevChar === ' ' || prevChar === '\\xA0' || prevChar === '\\n')\n                ) {\n                    start = index;\n                }\n                lastIndex = index + 2;\n            } else {\n                for (let a = index + 2; a < text.length; a++) {\n                    if (text[a] === checkChar) {\n                        index++;\n                    } else {\n                        break;\n                    }\n                }\n                lastIndex = index + 2;\n                if (checkInclusion(index, entities) || checkIntersection(start, index, entities)) {\n                    start = -1;\n                    continue;\n                }\n                if (start + 2 !== index) {\n                    offset = start;\n                    length = index - start - 2;\n                    text =\n                        text.substring(0, start) +\n                        text.substring(start + 2, index) +\n                        text.substring(index + 2, text.length);\n\n                    const entity = {\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        language: '',\n                        type: { '@type': type },\n                        textContent: text.substring(offset, offset + length)\n                    };\n                    removeOffsetAfter(offset + length, 4, entities);\n                    entities.push(entity);\n                    lastIndex -= 4;\n                }\n                start = -1;\n            }\n        }\n    })\n\n    return text;\n}\n\nexport function canMessageBeEdited(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { can_be_edited } = message;\n\n    return can_be_edited;\n}\n\nexport function showMessageForward(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    if (isMeChat(chatId)) return false;\n\n    const { forward_info, content } = message;\n\n    return forward_info && content && content['@type'] !== 'messageSticker' && content['@type'] !== 'messageAudio';\n}\n\nexport function isTextMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n\n    return content && content['@type'] === 'messageText';\n}\n\nexport function isMessagePinned(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n\n    return message && message.is_pinned;\n}\n\nexport function canMessageBeUnvoted(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return;\n    if (content['@type'] !== 'messagePoll') return;\n\n    const { poll } = content;\n    if (!poll) return false;\n\n    const { type, is_closed, options } = poll;\n    if (!type) return false;\n    if (type['@type'] !== 'pollTypeRegular') return false;\n    if (is_closed) return false;\n\n    return options.some(x => x.is_chosen || x.is_being_chosen);\n}\n\nexport function canMessageBeClosed(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content, can_be_edited } = message;\n    if (!content) return;\n    if (content['@type'] !== 'messagePoll') return;\n\n    return can_be_edited;\n}\n\nexport function canMessageBeForwarded(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n\n    return message && message.can_be_forwarded;\n}\n\nexport function canMessageBeDeleted(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n\n    return message && (message.can_be_deleted_only_for_self || message.can_be_deleted_for_all_users);\n}\n\nexport function getMessageStyle(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation, caption } = content;\n            if (caption && caption.text) {\n                return { maxWidth: PHOTO_DISPLAY_SIZE };\n            }\n            if (!animation) return null;\n\n            const { width, height, thumbnail } = animation;\n\n            const size = thumbnail || { width, height };\n            if (!size) return null;\n\n            const fitSize = getFitSize(size, PHOTO_DISPLAY_SIZE, true);\n            if (!fitSize) return null;\n\n            return { width: fitSize.width };\n        }\n        case 'messageGame': {\n            return { maxWidth : PHOTO_DISPLAY_SIZE + 10 + 9 * 2 };\n        }\n        case 'messageInvoice': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            const size = getSize(photo.sizes, PHOTO_SIZE);\n            if (!size) return null;\n\n            const fitSize = getFitSize(size, PHOTO_DISPLAY_SIZE, true);\n            if (!fitSize) return null;\n\n            return { width: fitSize.width };\n        }\n        case 'messagePhoto': {\n            const { photo, caption } = content;\n            if (caption && caption.text) {\n                return { maxWidth: PHOTO_DISPLAY_SIZE };\n            }\n            if (!photo) return null;\n\n            const size = getSize(photo.sizes, PHOTO_SIZE);\n            if (!size) return null;\n\n            const fitSize = getFitSize(size, PHOTO_DISPLAY_SIZE, true);\n            if (!fitSize) return null;\n\n            return { width: fitSize.width };\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (!web_page) return null;\n\n            return { maxWidth : PHOTO_DISPLAY_SIZE + 10 + 9 * 2 };\n        }\n        case 'messageVideo': {\n            const { video, caption } = content;\n            if (caption && caption.text) {\n                return { maxWidth: PHOTO_DISPLAY_SIZE };\n            }\n\n            if (!video) return null;\n\n            const { thumbnail, width, height } = video;\n\n            const size = thumbnail || { width, height };\n            if (!size) return null;\n\n            const fitSize = getFitSize(size, PHOTO_DISPLAY_SIZE, true);\n            if (!fitSize) return null;\n\n            return { width: fitSize.width };\n        }\n    }\n\n    return null;\n}\n\nexport {\n    getAuthor,\n    getTitle,\n    getText,\n    getFormattedText,\n    getWebPage,\n    getContent,\n    getDate,\n    getDateHint,\n    isForwardOriginHidden,\n    getForwardTitle,\n    getUnread,\n    filterDuplicateMessages,\n    isMediaContent,\n    isDeletedMessage,\n    isVideoMessage,\n    isAnimationMessage,\n    isLottieMessage,\n    getLocationId,\n    isContentOpened,\n    hasAudio,\n    hasVideoNote,\n    getSearchMessagesFilter,\n    openMedia,\n    getEmojiMatches,\n    messageComparatorDesc,\n    substring,\n    stopPropagation\n};\n","\n/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nclass Currency{\n    constructor(){\n        this.list = new Map([\n            [\"AED\", \".\"],\n            [\"AFN\", \"\"],\n            [\"ARS\", \"$\"],\n            [\"AUD\", \"$\"],\n            [\"AZN\", \"\"],\n            [\"BND\", \"B$\"],\n            [\"BRL\", \"R$\"],\n            [\"CAD\", \"$\"],\n            [\"CHF\", \"Fr\"],\n            [\"CLP\", \"$\"],\n            [\"CNY\", \"\"],\n            [\"COP\", \"$\"],\n            [\"EGP\", \"E\"],\n            [\"EUR\", \"\"],\n            [\"GBP\", \"\"],\n            [\"HKD\", \"$\"],\n            [\"IDR\", \"Rp\"],\n            [\"ILS\", \"\"],\n            [\"INR\", \"\"],\n            [\"ISK\", \"kr\"],\n            [\"JPY\", \"\"],\n            [\"KRW\", \"\"],\n            [\"KZT\", \"\"],\n            [\"MXN\", \"$\"],\n            [\"MYR\", \"RM\"],\n            [\"NOK\", \"kr\"],\n            [\"NZD\", \"$\"],\n            [\"PHP\", \"\"],\n            [\"RUB\", \"\"],\n            [\"SAR\", \"SR\"],\n            [\"SEK\", \"kr\"],\n            [\"SGD\", \"$\"],\n            [\"TRY\", \"\"],\n            [\"TTD\", \"$\"],\n            [\"TWD\", \"$\"],\n            [\"TZS\", \"TSh\"],\n            [\"UAH\", \"\"],\n            [\"UGX\", \"USh\"],\n            [\"USD\", \"$\"],\n            [\"UYU\", \"$\"],\n            [\"VND\", \"\"],\n            [\"YER\", \"\"],\n            [\"ZAR\", \"R\"],\n            [\"IRR\", \"\"],\n            [\"IQD\", \".\"],\n            [\"VEF\", \"Bs.F.\"]\n        ]);\n    }\n\n    get(currency){\n        return this.list.get(currency);\n    }\n\n    set(currency, symbol){\n        this.list.set(currency, symbol);\n    }\n\n    getPow(currency){\n        if (currency === 'CLF'){\n            return 4;\n        }\n        if (['BHD', 'IQD', 'JOD', 'KWD', 'LYD', 'OMR', 'TND'].includes(currency)){\n            return 3;\n        }\n        if (['BIF', 'BYR', 'CLP', 'CVE', 'DJF', 'GNF', 'ISK', 'JPY', 'KMF', 'KRW', 'MGA', 'PYG', 'RWF', 'UGX', 'UYI', 'VND', 'VUV', 'XAF', 'XOF', 'XPF'].includes(currency)){\n            return 0;\n        }\n        if (currency === 'MRO'){\n            return 1;\n        }\n\n        return 2;\n    }\n\n    getString(totalAmount, currency){\n        const amount = (totalAmount/Math.pow(10.0, this.getPow(currency))).toFixed(2);\n        return `${amount} ${this.get(currency)}`;\n    }\n}\n\nlet currency = new Currency();\nexport default currency;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Currency from './Currency';\nimport MessageAuthor from '../Components/Message/MessageAuthor';\nimport { isChannelChat, isSupergroup } from './Chat';\nimport { getUserShortName, isMeUser } from './User';\nimport ChatStore from '../Stores/ChatStore';\nimport LStore from '../Stores/LocalizationStore';\nimport MessageStore from '../Stores/MessageStore';\n\nconst serviceMap = new Map();\nserviceMap.set('messageText', false);\nserviceMap.set('messageAnimation', false);\nserviceMap.set('messageAudio', false);\nserviceMap.set('messageDocument', false);\nserviceMap.set('messagePhoto', false);\nserviceMap.set('messageExpiredPhoto', true);\nserviceMap.set('messageSticker', false);\nserviceMap.set('messageVideo', false);\nserviceMap.set('messageExpiredVideo', true);\nserviceMap.set('messageVideoNote', false);\nserviceMap.set('messageVoiceNote', false);\nserviceMap.set('messageLocation', false);\nserviceMap.set('messageVenue', false);\nserviceMap.set('messageContact', false);\nserviceMap.set('messageDice', false);\nserviceMap.set('messageGame', false);\nserviceMap.set('messagePoll', false);\nserviceMap.set('messageInvoice', false);\nserviceMap.set('messageCall', false);\nserviceMap.set('messageBasicGroupChatCreate', true);\nserviceMap.set('messageSupergroupChatCreate', true);\nserviceMap.set('messageChatChangeTitle', true);\nserviceMap.set('messageChatChangePhoto', true);\nserviceMap.set('messageChatDeletePhoto', true);\nserviceMap.set('messageChatAddMembers', true);\nserviceMap.set('messageChatJoinByLink', true);\nserviceMap.set('messageChatDeleteMember', true);\nserviceMap.set('messageChatUpgradeTo', true);\nserviceMap.set('messageChatUpgradeFrom', true);\nserviceMap.set('messagePinMessage', true);\nserviceMap.set('messageScreenshotTaken', true);\nserviceMap.set('messageChatSetTtl', true);\nserviceMap.set('messageCustomServiceAction', true);\nserviceMap.set('messageGameScore', true);\nserviceMap.set('messagePaymentSuccessful', true);\nserviceMap.set('messagePaymentSuccessfulBot', true);\nserviceMap.set('messageContactRegistered', true);\nserviceMap.set('messageWebsiteConnected', true);\nserviceMap.set('messagePassportDataSent', true);\nserviceMap.set('messagePassportDataReceived', true);\nserviceMap.set('messageLiveLocationApproached', true);\nserviceMap.set('messageUnsupported', true);\nserviceMap.set('messageVoiceChatStarted', true);\nserviceMap.set('messageVoiceChatEnded', true);\nserviceMap.set('messageInviteVoiceChatParticipants', true);\n\nexport function isServiceMessage(message) {\n    if (!message) return false;\n    if (!message.content) return false;\n\n    return serviceMap.has(message.content['@type']) && serviceMap.get(message.content['@type']) || message.ttl > 0;\n}\n\nfunction getTTLString(ttl) {\n    if (ttl < 60) {\n        return LStore.formatPluralString('Seconds', Math.floor(ttl));\n    }\n    if (ttl < 60 * 60) {\n        return LStore.formatPluralString('Minutes', Math.floor(ttl / 60));\n    }\n    if (ttl < 24 * 60 * 60) {\n        return LStore.formatPluralString('Hours', Math.floor(ttl / 60 / 60));\n    }\n\n    const days = ttl / 60 / 60 / 24;\n    if (ttl % 7 === 0) {\n        return LStore.formatPluralString('Weeks', Math.floor(days / 7));\n    }\n\n    return `${LStore.formatPluralString('Weeks', Math.floor(days / 7))} ${LStore.formatPluralString('Days', Math.floor(days % 7))}`\n}\n\nfunction getCallDuration(duration) {\n    const days = Math.floor(duration / (3600 * 24));\n    if (days > 0) {\n        return LStore.formatPluralString('Days', days);\n    }\n\n    const hours = Math.floor(duration / 3600);\n    if (hours > 0) {\n        return LStore.formatPluralString('Hours', hours);\n    }\n\n    const minutes = Math.floor(duration / 60);\n    if (minutes > 0) {\n        return LStore.formatPluralString('Minutes', minutes);\n    }\n\n    return LStore.formatPluralString('Seconds', duration);\n}\n\nfunction getPassportElementTypeString(type) {\n    switch (type['@type']) {\n        case 'passportElementTypeAddress': {\n            return LStore.getString('ActionBotDocumentAddress');\n        }\n        case 'passportElementTypeBankStatement': {\n            return LStore.getString('ActionBotDocumentBankStatement');\n        }\n        case 'passportElementTypeDriverLicense': {\n            return LStore.getString('ActionBotDocumentDriverLicence');\n        }\n        case 'passportElementTypeEmailAddress': {\n            return LStore.getString('ActionBotDocumentEmail');\n        }\n        case 'passportElementTypeIdentityCard': {\n            return LStore.getString('ActionBotDocumentIdentityCard');\n        }\n        case 'passportElementTypeInternalPassport': {\n            return LStore.getString('ActionBotDocumentInternalPassport');\n        }\n        case 'passportElementTypePassport': {\n            return LStore.getString('ActionBotDocumentPassport');\n        }\n        case 'passportElementTypePassportRegistration': {\n            return LStore.getString('ActionBotDocumentPassportRegistration');\n        }\n        case 'passportElementTypePersonalDetails': {\n            return LStore.getString('ActionBotDocumentIdentity');\n        }\n        case 'passportElementTypePhoneNumber': {\n            return LStore.getString('ActionBotDocumentPhone');\n        }\n        case 'passportElementTypeRentalAgreement': {\n            return LStore.getString('ActionBotDocumentRentalAgreement');\n        }\n        case 'passportElementTypeTemporaryRegistration': {\n            return LStore.getString('ActionBotDocumentTemporaryRegistration');\n        }\n        case 'passportElementTypeUtilityBill': {\n            return LStore.getString('ActionBotDocumentUtilityBill');\n        }\n    }\n\n    return '';\n}\n\nfunction getMessageAuthor(key, message, openUser) {\n    if (!message) return null;\n\n    const { chat_id, sender } = message;\n\n    if (sender) {\n        return <MessageAuthor key={key} sender={sender} openUser={openUser} />;\n    }\n\n    const chat = ChatStore.get(chat_id);\n    if (!chat) return null;\n\n    return chat.title;\n}\n\nexport function getServiceMessageContent(message, openUser = false) {\n    if (!message) return null;\n    if (!message.content) return null;\n\n    const { chat_id, ttl, sender, content, is_outgoing: isOutgoing } = message;\n    const isChannel = isChannelChat(chat_id);\n    if (ttl > 0) {\n        switch (content['@type']) {\n            case 'messagePhoto': {\n                if (isOutgoing) {\n                    return LStore.getString('ActionYouSendTTLPhoto');\n                }\n\n                return LStore.replace(LStore.getString('ActionSendTTLPhoto'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n            }\n            case 'messageVideo': {\n                if (isOutgoing) {\n                    return LStore.getString('ActionYouSendTTLVideo');\n                }\n\n                return LStore.replace(LStore.getString('ActionSendTTLVideo'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n            }\n        }\n    }\n\n    switch (content['@type']) {\n        case 'messageExpiredPhoto': {\n            return LStore.getString('AttachPhotoExpired');\n        }\n        case 'messageExpiredVideo': {\n            return LStore.getString('AttachVideoExpired');\n        }\n        case 'messageBasicGroupChatCreate': {\n            if (isOutgoing) {\n                return LStore.getString('ActionYouCreateGroup');\n            }\n\n            return LStore.replace(LStore.getString('ActionCreateGroup'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n        }\n        case 'messageSupergroupChatCreate': {\n            if (isChannel) {\n                return LStore.getString('ActionCreateChannel');\n            }\n\n            return LStore.getString('ActionCreateMega');\n        }\n        case 'messageChatChangeTitle': {\n            const { title } = content;\n\n            if (isChannel) {\n                return LStore.getString('ActionChannelChangedTitle').replace('un2', title);\n            }\n\n            if (isOutgoing) {\n                return LStore.getString('ActionYouChangedTitle').replace('un2', title);\n            }\n\n            return LStore.replace(LStore.getString('ActionChangedTitle').replace('un2', title), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n        }\n        case 'messageChatChangePhoto': {\n            if (isChannel) {\n                return LStore.getString('ActionChannelChangedPhoto');\n            }\n\n            if (isOutgoing) {\n                return LStore.getString('ActionYouChangedPhoto');\n            }\n\n            return LStore.replace(LStore.getString('ActionChangedPhoto'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n        }\n        case 'messageChatDeletePhoto': {\n            if (isChannel) {\n                return LStore.getString('ActionChannelRemovedPhoto');\n            }\n\n            if (isOutgoing) {\n                return LStore.getString('ActionYouRemovedPhoto');\n            }\n\n            return LStore.replace(LStore.getString('ActionRemovedPhoto'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n        }\n        case 'messageChatAddMembers': {\n            const singleMember = content.member_user_ids.length === 1;\n            if (singleMember) {\n                const memberUserId = content.member_user_ids[0];\n                if (sender.user_id === memberUserId) {\n                    if (isSupergroup(chat_id) && isChannel) {\n                        return LStore.getString('ChannelJoined');\n                    }\n\n                    if (isSupergroup(chat_id) && !isChannel) {\n                        if (isMeUser(memberUserId)) {\n                            return LStore.getString('ChannelMegaJoined');\n                        }\n\n                        return LStore.replace(LStore.getString('ActionAddUserSelfMega'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n                    }\n\n                    if (isOutgoing) {\n                        return LStore.getString('ActionAddUserSelfYou');\n                    }\n\n                    return LStore.replace(LStore.getString('ActionAddUserSelf'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n                }\n\n                if (isOutgoing) {\n                    return LStore.replace(LStore.getString('ActionYouAddUser'), 'un2', <MessageAuthor key='un2' sender={{ '@type': 'messageSenderUser', user_id: memberUserId }} openUser={openUser} />);\n                }\n\n                if (isMeUser(memberUserId)) {\n                    if (isSupergroup(chat_id)) {\n                        if (!isChannel) {\n                            return LStore.replace(LStore.getString('MegaAddedBy'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n                        }\n\n                        return LStore.replace(LStore.getString('ChannelAddedBy'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n                    }\n\n                    return LStore.replace(LStore.getString('ActionAddUserYou'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n                }\n\n                return LStore.replaceTwo(LStore.getString('ActionAddUser'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />, 'un2', <MessageAuthor key='un2' sender={{ '@type': 'messageSenderUser', user_id: memberUserId }} openUser={openUser} />);\n            }\n\n            const members = content.member_user_ids\n                .map(x => <MessageAuthor key={x} sender={{ '@type': 'messageSenderUser', user_id: x }} openUser={openUser} />)\n                .reduce((accumulator, current, index, array) => {\n                    // const separator = index === array.length - 1 ? ' and ' : ', ';\n                    const separator = ', ';\n                    return accumulator === null ? [current] : [...accumulator, separator, current];\n                }, null);\n\n            if (isOutgoing) {\n                return LStore.replace(LStore.getString('ActionYouAddUser'), 'un2', members);\n            }\n\n            return LStore.replaceTwo(LStore.getString('ActionAddUser'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />, 'un2', members);\n        }\n        case 'messageChatJoinByLink': {\n            if (isOutgoing) {\n                return LStore.getString('ActionInviteYou');\n            }\n\n            return LStore.replace(LStore.getString('ActionInviteUser'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n        }\n        case 'messageChatDeleteMember': {\n            if (content.user_id === sender.user_id) {\n                if (isOutgoing) {\n                    return LStore.getString('ActionYouLeftUser');\n                }\n\n                return LStore.replace(LStore.getString('ActionLeftUser'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n            }\n\n            if (isOutgoing) {\n                return LStore.replace(LStore.getString('ActionYouKickUser'), 'un2', <MessageAuthor key='un2' sender={{ '@type': 'messageSenderUser', user_id: content.user_id }} openUser={openUser} />);\n            } else if (isMeUser(content.user_id)) {\n                return LStore.replace(LStore.getString('ActionKickUserYou'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n            }\n\n            return LStore.replaceTwo(LStore.getString('ActionKickUser'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />, 'un2', <MessageAuthor key='un2' sender={{ '@type': 'messageSenderUser', user_id: content.user_id }} openUser={openUser} />);\n        }\n        case 'messageChatUpgradeTo': {\n            return LStore.getString('ActionMigrateFromGroup');\n        }\n        case 'messageChatUpgradeFrom': {\n            return LStore.getString('ActionMigrateFromGroup');\n        }\n        case 'messagePinMessage': {\n            const author = getMessageAuthor('un1', message, openUser);\n            const pinnedMessage = MessageStore.get(message.chat_id, content.message_id);\n            if (!pinnedMessage || !pinnedMessage.content) {\n                return LStore.replace(LStore.getString('ActionPinnedNoText'), 'un1', author);\n            }\n\n            switch (pinnedMessage.content['@type']) {\n                case 'messageAnimation': {\n                    return LStore.replace(LStore.getString('ActionPinnedGif'), 'un1', author);\n                }\n                case 'messageAudio': {\n                    return LStore.replace(LStore.getString('ActionPinnedMusic'), 'un1', author);\n                }\n                case 'messageContact': {\n                    return LStore.replace(LStore.getString('ActionPinnedContact'), 'un1', author);\n                }\n                case 'messageDocument': {\n                    return LStore.replace(LStore.getString('ActionPinnedFile'), 'un1', author);\n                }\n                case 'messageExpiredPhoto': {\n                    return LStore.replace(LStore.getString('ActionPinnedPhoto'), 'un1', author);\n                }\n                case 'messageExpiredVideo': {\n                    return LStore.replace(LStore.getString('ActionPinnedVideo'), 'un1', author);\n                }\n                case 'messageGame': {\n                    return LStore.replace(LStore.formatString('ActionPinnedGame', '\\uD83C\\uDFAE ' + pinnedMessage.content.game.title), 'un1', author);\n                }\n                case 'messageLocation': {\n                    if (pinnedMessage.content.live_period > 0) {\n                        return LStore.replace(LStore.getString('ActionPinnedGeoLive'), 'un1', author);\n                    }\n\n                    return LStore.replace(LStore.getString('ActionPinnedGeo'), 'un1', author);\n                }\n                case 'messagePhoto': {\n                    return LStore.replace(LStore.getString('ActionPinnedPhoto'), 'un1', author);\n                }\n                case 'messagePoll': {\n                    if (pinnedMessage.content.poll.type['@type'] === 'pollTypeQuiz') {\n                        return LStore.replace(LStore.getString('ActionPinnedQuiz'), 'un1', author);\n                    }\n\n                    return LStore.replace(LStore.getString('ActionPinnedPoll'), 'un1', author);\n                }\n                case 'messageSticker': {\n                    return LStore.replace(LStore.getString('ActionPinnedSticker'), 'un1', author);\n                }\n                case 'messageText': {\n                    const maxLength = 20;\n                    let text = pinnedMessage.content.text.text;\n                    if (text.length >= maxLength) {\n                        text = text.substring(0, maxLength);\n                    }\n\n                    return LStore.replace(LStore.formatString('ActionPinnedText', text), 'un1', author);\n                }\n                case 'messageVenue': {\n                    return LStore.replace(LStore.getString('ActionPinnedGeo'), 'un1', author);\n                }\n                case 'messageVideo': {\n                    return LStore.replace(LStore.getString('ActionPinnedVideo'), 'un1', author);\n                }\n                case 'messageVideoNote': {\n                    return LStore.replace(LStore.getString('ActionPinnedRound'), 'un1', author);\n                }\n                case 'messageVoiceNote': {\n                    return LStore.replace(LStore.getString('ActionPinnedVoice'), 'un1', author);\n                }\n            }\n\n            return LStore.replace(LStore.getString('ActionPinnedNoText'), 'un1', author);\n        }\n        case 'messageScreenshotTaken': {\n            if (isOutgoing) {\n                return LStore.getString('ActionTakeScreenshootYou');\n            }\n\n            return LStore.replace(LStore.getString('ActionTakeScreenshoot'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n        }\n        case 'messageChatSetTtl': {\n            const { ttl } = content;\n            const ttlString = getTTLString(ttl);\n\n            if (ttl <= 0) {\n                if (isOutgoing) {\n                    return LStore.getString('MessageLifetimeYouRemoved');\n                }\n\n                return LStore.formatString('MessageLifetimeRemoved', getUserShortName(sender.user_id, LStore.i18n.t));\n            }\n\n            if (isOutgoing) {\n                return LStore.formatString('MessageLifetimeChangedOutgoing', ttlString);\n            }\n\n            return LStore.formatString('MessageLifetimeChanged', getUserShortName(sender.user_id, LStore.i18n.t), ttlString);\n        }\n        case 'messageCustomServiceAction': {\n            return content.text;\n        }\n        case 'messageGameScore': {\n            const { score, game_message_id } = content;\n\n            const messageGame = MessageStore.get(message.chat_id, game_message_id);\n            if (messageGame) {\n                const { content: messageGameContent } = messageGame;\n                if (messageGameContent && messageGameContent['@type'] === 'messageGame') {\n                    const { game } = messageGameContent;\n                    if (game) {\n                        if (isOutgoing) {\n                            return LStore.formatString('ActionYouScoredInGame', LStore.formatPluralString('Points', score)).replace('un2', game.title);\n                        }\n\n                        const str = LStore.formatString('ActionUserScoredInGame', LStore.formatPluralString('Points', score)).replace('un2', game.title);\n                        return LStore.replace(str, 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n                    }\n                }\n            }\n\n            if (isOutgoing) {\n                return LStore.formatString('ActionYouScored', LStore.formatPluralString('Points', score));\n            }\n\n            const str = LStore.formatString('ActionUserScored', LStore.formatPluralString('Points', score));\n            return LStore.replace(str, 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n        }\n        case 'messagePaymentSuccessful': {\n            const chat = ChatStore.get(message.chat_id);\n\n            const messageInvoice = MessageStore.get(message.chat_id, content.invoice_message_id);\n            if (messageInvoice) {\n                const { content } = messageInvoice;\n                if (content && content['@type'] === 'messageInvoice') {\n                    const { invoice, total_amount, currency } = content;\n                    if (invoice) {\n                        return LStore.formatString('PaymentSuccessfullyPaid', Currency.getString(total_amount, currency), getUserShortName(chat.type.user_id, LStore.i18n.t), invoice.title);\n                    }\n\n                    return LStore.formatString('PaymentSuccessfullyPaidNoItem', Currency.getString(total_amount, currency), getUserShortName(chat.type.user_id, LStore.i18n.t));\n                }\n            }\n            break;\n        }\n        case 'messagePaymentSuccessfulBot': {\n            // bots only\n            break;\n        }\n        case 'messageContactRegistered': {\n            return LStore.replace(LStore.formatString('NotificationContactJoined', 'un1'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n        }\n        case 'messageWebsiteConnected': {\n            return LStore.formatString('ActionBotAllowed', content.domain_name);\n        }\n        case 'messagePassportDataSent': {\n            const chat = ChatStore.get(message.chat_id);\n\n            const documents = content.types\n                .map(x => getPassportElementTypeString(x))\n                .reduce((accumulator, current) => {\n                    return accumulator === null ? current : accumulator + ', ' + current;\n                }, null);\n\n            return LStore.formatString('ActionBotDocuments', getUserShortName(chat.type.user_id, LStore.i18n.t), documents);\n        }\n        case 'messagePassportDataReceived': {\n            // bots only\n            break;\n        }\n        case 'messageLiveLocationApproached': {\n            const { approacher, observer, distance } = content;\n            if (isMeUser(observer.user_id)) {\n                return LStore.replace(LStore.formatString('ActionUserWithinRadius', LStore.formatDistance(distance, 2)), 'un1', <MessageAuthor key='un1' sender={approacher} openUser={openUser} />);\n            }\n\n            if (isMeUser(approacher.user_id)) {\n                return LStore.replace(LStore.formatString('ActionUserWithinYouRadius', LStore.formatDistance(distance, 2)), 'un1', <MessageAuthor key='un1' sender={observer} openUser={openUser} />);\n            }\n\n            return LStore.replaceTwo(LStore.formatString('ActionUserWithinOtherRadius', LStore.formatDistance(distance, 2)), 'un1', <MessageAuthor key='un1' sender={approacher} openUser={openUser} />, 'un2', <MessageAuthor key='un2' sender={observer} openUser={openUser} />);\n        }\n        case 'messageUnsupported': {\n            return LStore.getString('UnsupportedMedia');\n        }\n        case 'messageVoiceChatStarted': {\n            if (isOutgoing) {\n                return LStore.getString('ActionGroupCallStartedByYou');\n            }\n\n            return LStore.replace(LStore.getString('ActionGroupCallStarted'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n        }\n        case 'messageVoiceChatEnded': {\n            const { duration } = content;\n\n            return LStore.formatString('ActionGroupCallEnded', getCallDuration(duration));\n        }\n        case 'messageInviteVoiceChatParticipants': {\n            const singleMember = content.user_ids.length === 1;\n            if (singleMember) {\n                const memberUserId = content.user_ids[0];\n                if (memberUserId !== 0) {\n                    if (isOutgoing) {\n                        return LStore.replace(LStore.getString('ActionGroupCallYouInvited'), 'un2', <MessageAuthor key='un2' sender={{ '@type': 'messageSenderUser', user_id: memberUserId }} openUser={openUser} />);\n                    }\n\n                    if (isMeUser(memberUserId)) {\n                        return LStore.replace(LStore.getString('ActionGroupCallInvitedYou'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />);\n                    }\n\n                    return LStore.replaceTwo(LStore.getString('ActionGroupCallInvited'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />, 'un2', <MessageAuthor key='un2' sender={{ '@type': 'messageSenderUser', user_id: memberUserId }} openUser={openUser} />);\n                }\n            }\n\n            const members = content.user_ids\n                .map(x => <MessageAuthor key={x} sender={{ '@type': 'messageSenderUser', user_id: x }} openUser={openUser} />)\n                .reduce((accumulator, current, index, array) => {\n                    // const separator = index === array.length - 1 ? ' and ' : ', ';\n                    const separator = ', ';\n                    return accumulator === null ? [current] : [...accumulator, separator, current];\n                }, null);\n\n            if (isOutgoing) {\n                return LStore.replace(LStore.getString('ActionGroupCallYouInvited'), 'un2', members);\n            }\n\n            return LStore.replaceTwo(LStore.getString('ActionAddUser'), 'un1', <MessageAuthor key='un1' sender={sender} openUser={openUser} />, 'un2', members);\n        }\n    }\n\n    return LStore.getString('UnsupportedMedia');\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport classNames from 'classnames';\nimport IconButton from '@material-ui/core/IconButton';\nimport CallIcon from '@material-ui/icons/Call';\nimport { getCallContent } from '../../../Utils/Message';\nimport LStore from '../../../Stores/LocalizationStore';\nimport MessageStore from '../../../Stores/MessageStore';\nimport './Call.css';\n\nclass Call extends React.Component {\n    render() {\n        const { chatId, messageId, call, openMedia, title, meta } = this.props;\n\n        const message = MessageStore.get(chatId, messageId);\n        if (!message) return null;\n\n        const { sender, content } = message;\n\n        const callTitle = getCallContent(sender, content);\n        const durationString = call.duration > 0 ? LStore.formatCallDuration(Math.floor(call.duration || 0)) : null;\n\n        return (\n            <div className={classNames('call', 'document', { 'media-title': title })}>\n                <IconButton className='call-button' color='primary' aria-label='Call'>\n                    <CallIcon fontSize='large' />\n                </IconButton>\n                <div className='document-content'>\n                    <div className='document-title'>{callTitle}</div>\n                    { durationString && (\n                        <div className='document-action'>\n                            {durationString}\n                            {meta}\n                        </div>\n                    )}\n                </div>\n            </div>\n        );\n    }\n}\n\nCall.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    call: PropTypes.object,\n    openMedia: PropTypes.func\n};\n\nexport default withTranslation()(Call);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport UserTile from '../../Tile/UserTile';\nimport { formatPhoneNumber } from '../../../Utils/Phone';\nimport { getUserFullName } from '../../../Utils/User';\nimport UserStore from '../../../Stores/UserStore';\nimport './Contact.css';\n\nclass Contact extends React.Component {\n    render() {\n        const { contact, title, openMedia, meta, caption, t } = this.props;\n        if (!contact) return null;\n\n        const { user_id: id, first_name, last_name, phone_number } = contact;\n\n        const user = UserStore.get(id) || {\n            '@type': 'user',\n            type: { '@type': 'userTypeRegular' },\n            id,\n            first_name,\n            last_name\n        };\n\n        const fullName = getUserFullName(id, user, t);\n        const number = formatPhoneNumber(phone_number);\n\n        return (\n            <div className={classNames('contact', { 'media-title': title })}>\n                <div className='contact-tile'>\n                    <UserTile userId={id} firstName={first_name} lastName={last_name} />\n                </div>\n                <div className='contact-content'>\n                    <div className='contact-name'>\n                        {id > 0 ? <a onClick={openMedia}>{fullName}</a> : <span>{fullName}</span>}\n                    </div>\n                    <div className='contact-phone'>\n                        {number}\n                        {!caption && meta}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nContact.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    contact: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default withTranslation()(Contact);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Animation from './Animation';\nimport Photo from './Photo';\nimport { getFormattedText } from '../../../Utils/Message';\nimport { getFitSize, getSize } from '../../../Utils/Common';\nimport { getSrc } from '../../../Utils/File';\nimport { PHOTO_DISPLAY_SIZE, PHOTO_SIZE } from '../../../Constants';\nimport './Game.css';\n\nclass Game extends React.Component {\n    getContent = () => {\n        const { chatId, messageId, game, size, displaySize, openMedia } = this.props;\n        if (!game) return null;\n\n        const { photo, animation } = game;\n\n        if (animation) {\n            const animationSrc = getSrc(animation.animation);\n            if (animationSrc || animation.thumbnail) {\n                return <Animation stretch={true} chatId={chatId} messageId={messageId} animation={animation} openMedia={openMedia} />;\n            }\n        }\n\n        if (photo) {\n            let style = {\n                width: 0,\n                height: 0\n            };\n            const photoSize = getSize(photo.sizes, size);\n            if (photoSize) {\n                const fitPhotoSize = getFitSize(photoSize, displaySize);\n                if (fitPhotoSize) {\n                    style.width = fitPhotoSize.width;\n                    style.height = fitPhotoSize.height;\n                }\n            }\n\n            return <Photo chatId={chatId} messageId={messageId} photo={photo} style={style} openMedia={openMedia} />;\n        }\n\n        return null;\n    };\n\n    render() {\n        const { game, meta, t } = this.props;\n        if (!game) return null;\n\n        const { title, text, description } = game;\n        const formattedText = getFormattedText(text, t);\n\n        return (\n            <>\n                <div className='game'>\n                    <div className='border' />\n                    <div className='game-wrapper'>\n                        {title && <div className='game-title'>{title}</div>}\n                        {formattedText && <div className='game-text'>{formattedText}</div>}\n                        {description && <div className='game-description'>{description}</div>}\n                        {this.getContent()}\n                    </div>\n                </div>\n                {meta}\n            </>\n        );\n    }\n}\n\nGame.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    game: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n\n    size: PropTypes.number,\n    displaySize: PropTypes.number\n};\n\nGame.defaultProps = {\n    size: PHOTO_SIZE,\n    displaySize: PHOTO_DISPLAY_SIZE\n};\n\nexport default withTranslation()(Game);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Location from './Location';\nimport './Venue.css';\n\nclass Venue extends React.Component {\n    render() {\n        const { chatId, messageId, venue, openMedia, meta, title, caption } = this.props;\n        if (!venue) return null;\n\n        const { title: venueTitle, address, location } = venue;\n        if (!location) return null;\n\n        const { longitude, latitude } = location;\n        const source = `https://maps.google.com/?q=${latitude},${longitude}`;\n\n        return (\n            <div className='venue'>\n                <Location\n                    type='venue'\n                    chatId={chatId}\n                    messageId={messageId}\n                    location={location}\n                    openMedia={openMedia}\n                    title={title}\n                    caption={caption}\n                />\n                <div className='venue-content'>\n                    <a href={source} target='_blank' rel='noopener noreferrer'>\n                        <div className='venue-title'>{venueTitle}</div>\n                    </a>\n                    <div className='venue-subtitle'>\n                        {address}\n                        {!caption && meta}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nVenue.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    venue: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Venue;\n","export function LOG(message, ...optionalParams) {\n    return;\n    console.log(message, ...optionalParams);\n}\n\nexport function ERROR(message, ...optionalParams) {\n    console.error(message, ...optionalParams);\n}\n\nexport function logSourceBufferRanges (sourceBuffer, currentTime, duration) {\n    const ranges = [];\n    for (let i = 0; i < sourceBuffer.buffered.length; i++) {\n        ranges.push({ start: sourceBuffer.buffered.start(i), end: sourceBuffer.buffered.end(i)})\n    }\n\n    LOG('[SourceBuffer] ranges', sourceBuffer.id, currentTime, duration, sourceBuffer.pendingUpdates.length, JSON.stringify(ranges));\n}\n\nexport const strtokBITSET = {\n    get: (buf, off, bit) => {\n        return (buf[off] & (1 << bit)) !== 0;\n    },\n    len: 1\n};\n\nfunction readUTF16String(buffer) {\n    let offset = 2;\n    let label = 'utf-16';\n    if (buffer[0] === 0xFE && buffer[1] === 0xFF) { // big endian\n        offset = 2;\n        label = 'utf-16be';\n    } else if (buffer[0] === 0xFF && buffer[1] === 0xFE) { // little endian\n        offset = 2;\n        label = 'utf-16le';\n    }\n\n    return new TextDecoder(label).decode(buffer.slice(offset));\n}\n\nfunction readUTF8String(buffer) {\n    return new TextDecoder('utf-8').decode(buffer);\n}\n\nfunction readWindows1292String(buffer) {\n    return new TextDecoder('iso-8859-1').decode(buffer);\n}\n\n/**\n *\n * @param buffer Decoder input data\n * @param encoding 'utf16le' | 'utf16' | 'utf8' | 'iso-8859-1'\n * @return {string}\n */\nexport function decodeString(buffer, encoding) {\n    // annoying workaround for a double BOM issue\n    // https://github.com/leetreveil/musicmetadata/issues/84\n    if (buffer[0] === 0xFF && buffer[1] === 0xFE && buffer[2] === 0xFE && buffer[3] === 0xFF) {\n        buffer = buffer.slice(2);\n    }\n\n    if (encoding === 'utf16le' || encoding === 'utf16') {\n        return readUTF16String(buffer);\n    } else if (encoding === 'utf8') {\n        return readUTF8String(buffer);\n    } else if (encoding === 'iso-8859-1') {\n        return readWindows1292String(buffer);\n    }\n\n    throw Error(encoding + ' encoding is not supported!');\n}\n\nexport function trimRightNull(x) {\n    const pos0 = x.indexOf('\\0');\n    return pos0 === -1 ? x : x.substr(0, pos0);\n}\n\n/**\n * Read bit-aligned number start from buffer\n * Total offset in bits = byteOffset * 8 + bitOffset\n * @param buf Byte buffer\n * @param byteOffset Starting offset in bytes\n * @param bitOffset Starting offset in bits: 0 = lsb\n * @param len Length of number in bits\n * @return {number} decoded bit aligned number\n */\nexport function getBitAllignedNumber(buf, byteOffset, bitOffset, len){\n    const byteOff = byteOffset + ~~(bitOffset / 8);\n    const bitOff = bitOffset % 8;\n    let value = buf[byteOff];\n    value &= 0xff >> bitOff;\n    const bitsRead = 8 - bitOff;\n    const bitsLeft = len - bitsRead;\n    if (bitsLeft < 0) {\n        value >>= (8 - bitOff - len);\n    } else if (bitsLeft > 0) {\n        value <<= bitsLeft;\n        value |= getBitAllignedNumber(buf, byteOffset, bitOffset + bitsRead, bitsLeft);\n    }\n    return value;\n}\n\n/**\n * Read bit-aligned number start from buffer\n * Total offset in bits = byteOffset * 8 + bitOffset\n * @param buf Byte buffer\n * @param byteOffset Starting offset in bytes\n * @param bitOffset Starting offset in bits: 0 = most significant bit, 7 is least significant bit\n * @return {boolean} decoded bit aligned number\n */\nexport function isBitSet(buf, byteOffset, bitOffset) {\n    return getBitAllignedNumber(buf, byteOffset, bitOffset, 1) === 1;\n}","import { trimRightNull } from './Common';\n\n/**\n * 28 bits (representing up to 256MB) integer, the msb is 0 to avoid 'false syncsignals'.\n * 4 * %0xxxxxxx\n */\nexport const UINT32SYNCSAFE = {\n    get: (buf, off) => {\n        return buf[off + 3] & 0x7f | (buf[off + 2] << 7) | (buf[off + 1] << 14) | (buf[off] << 21);\n    },\n    len: 4\n};\n\nexport const UINT8 = {\n    get: (buf, off) => {\n        return buf[off];\n    }\n}\n\nexport const UINT32_BE = {\n    get: (buf, off) => {\n        return buf[off + 3] | (buf[off + 2] << 8) | (buf[off + 1] << 16) | (buf[off] << 24);\n    }\n}\n\nexport const UINT24_BE = {\n    get: (buf, off) => {\n        return buf[off + 2] | (buf[off + 1] << 8) | (buf[off] << 16);\n    }\n}\n\nexport const UINT16_BE = {\n    get: (buf, off) => {\n        return buf[off + 1] | (buf[off] << 8);\n    }\n}\n\nexport const ASCII_TEXT = {\n    get: (buf, off, len) => {\n        return new TextDecoder('ascii').decode(buf.slice(off, off + len));\n    }\n}\n\nexport const Id3v1StringType = {\n    get: (buf, off, len) => {\n        let value = new TextDecoder('ascii').decode(buf.slice(off, off + len));\n        value = trimRightNull(value);\n        value = value.trim();\n        return value.length > 0 ? value : undefined;\n    }\n}","import {Id3v1StringType, UINT8} from '../../Utils/Token';\n\n/**\n * Spec: http://id3.org/ID3v1\n * Wiki: https://en.wikipedia.org/wiki/ID3\n */\nexport const ID3v1Header = {\n    len: 128,\n\n    /**\n     * @param buf Buffer possibly holding the 128 bytes ID3v1.1 metadata header\n     * @param off Offset in buffer in bytes\n     * @returns ID3v1.1 header if first 3 bytes equals 'TAG', otherwise null is returned\n     */\n    get: (buf, off) => {\n        const header = Id3v1StringType.get(buf, off, 3);\n        return header === 'TAG' ? {\n            header,\n            title: Id3v1StringType.get(buf, off + 3, 30),\n            artist: Id3v1StringType.get(buf, off + 33, 30),\n            album: Id3v1StringType.get(buf, off + 63, 30),\n            year: Id3v1StringType.get(buf, off + 93, 4),\n            comment: Id3v1StringType.get(buf, off + 97, 28),\n            // ID3v1.1 separator for track\n            zeroByte: UINT8.get(buf, off + 127),\n            // track: ID3v1.1 field added by Michael Mutschler\n            track: UINT8.get(buf, off + 126),\n            genre: UINT8.get(buf, off + 127)\n        } : null;\n    }\n};","import {ID3v1Header} from './ID3v1Token';\nimport {Id3v1StringType} from '../../Utils/Token';\n\nexport class ID3v1Parser {\n    parse(buffer) {\n        if (buffer.length < 128) {\n            console.log('[ID3v1Parser] Skip checking for ID3v1 because the file-size is less than 128 bytes');\n            return null;\n        }\n\n        return ID3v1Header.get(buffer, buffer.length - ID3v1Header.len);\n    }\n}\n\nexport function hasID3v1Header(buffer) {\n    if (buffer.length >= 128) {\n        const tag = Id3v1StringType.get(buffer, buffer.length - 128, 3);\n        return tag === 'TAG';\n    }\n    return false;\n}","import { strtokBITSET } from '../../Utils/Common';\nimport { UINT16_BE, UINT32_BE, ASCII_TEXT, UINT32SYNCSAFE } from '../../Utils/Token';\n\n/**\n * ID3v2 header\n * Ref: http://id3.org/id3v2.3.0#ID3v2_header\n */\nexport const ID3v2Header = {\n    get: (buffer, offset) => {\n        // ID3v2/file identifier   'ID3'\n        const fileIdentifier = ASCII_TEXT.get(buffer, offset, 3); // new TextDecoder('ascii').decode(buffer.slice(offset, 3));\n\n        // ID3v2 versionIndex\n        const version = {\n            major: buffer[offset + 3],\n            revision: buffer[offset + 4]\n        };\n\n        // ID3v2 flags\n        const flags = {\n            raw: buffer[offset + 5],\n            // Unsynchronisation\n            unsynchronisation: strtokBITSET.get(buffer, offset + 5, 7),\n            // Extended header\n            isExtendedHeader: strtokBITSET.get(buffer, offset + 5, 6),\n            // Experimental indicator\n            expIndicator: strtokBITSET.get(buffer, offset + 5, 5),\n            footer: strtokBITSET.get(buffer, offset + 5, 4)\n        };\n\n        // ID3v2 size\n        // The ID3v2 tag size is the size of the complete tag after unsychronisation, including padding, excluding the header but not excluding the extended header\n        const size = UINT32SYNCSAFE.get(buffer, offset + 6);\n\n        return {\n            fileIdentifier,\n            version,\n            flags,\n            size\n        };\n    },\n    len: 10\n}\n\n/**\n * ID3v2 header\n * Ref: http://id3.org/id3v2.3.0#ID3v2_extended_header\n */\nexport const ExtendedHeader = {\n    len: 10,\n\n    get: (buf, off) => {\n        // Extended header size (10 or 6 excluding itself)\n        const size = UINT32_BE.get(buf, off);\n\n        // Extended Flags\n        const extendedFlags = UINT16_BE.get(buf, off + 4);\n\n        // Size of padding\n        const sizeOfPadding = UINT32_BE.get(buf, off + 6);\n\n        // CRC data present\n        const crcDataPresent = strtokBITSET.get(buf, off + 4, 31);\n\n        const crcData = crcDataPresent ? UINT32_BE.get(buf, off + 10) : null;\n\n        return {\n            size,\n            extendedFlags,\n            sizeOfPadding,\n            crcDataPresent,\n            crcData\n        };\n    }\n}\n\nexport const TextEncodingToken = {\n    len: 1,\n\n    get: (buf, off) => {\n        switch (buf[off]) {\n            case 0x00:\n                return { encoding: 'iso-8859-1' }; // binary\n            case 0x01:\n                return { encoding: 'utf16', bom: true };\n            case 0x02:\n                return { encoding: 'utf16', bom: false };\n            case 0x03:\n                return { encoding: 'utf8', bom: false };\n            default:\n                return { encoding: 'utf8', bom: false };\n\n        }\n    }\n};","import {TextEncodingToken} from './ID3v2Token';\nimport {decodeString} from '../../Utils/Common';\n\nconst defaultEnc = 'iso-8859-1';\n\nexport class FrameParser {\n\n    /**\n     * Create id3v2 frame parser\n     * @param major - Major version, e.g. (4) for  id3v2.4\n     */\n    constructor(major)  {\n        this.major = major;\n    }\n\n    readData(b, type) {\n\n        if (b.length === 0) {\n            console.log(`id3v2.${this.major} header has empty tag type=${type}`);\n            return;\n        }\n\n        const {encoding, bom} = TextEncodingToken.get(b, 0);\n        let output = [];\n\n        console.debug(`Parsing tag type=${type}, encoding=${encoding}, bom=${bom}`);\n        switch (type) {\n            case 'TPE1': // 4.2.1. Text information frames - details\n            case 'TIT2': {\n                const text = decodeString(b.slice(1), encoding).replace(/\\x00+$/, '');\n                output = this.major >= 4 ? this.splitValue(type, text) : [text];\n            }\n            default:\n                //console.log('Warning: unsupported id3v2-tag-type: ' + type);\n                break;\n        }\n\n        return output;\n    }\n\n    /**\n     * id3v2.4 defines that multiple T* values are separated by 0x00\n     * id3v2.3 defines that TCOM, TEXT, TOLY, TOPE & TPE1 values are separated by /\n     * @param tag - Tag name\n     * @param text - Concatenated tag value\n     * @returns Split tag value\n     */\n    splitValue(tag, text) {\n        let values;\n        if (this.major < 4) {\n            values = text.split(/\\x00/g);\n            if (values.length > 1) {\n                console.log(`ID3v2.${this.major} ${tag} uses non standard null-separator.`);\n            } else {\n                values = text.split(/\\//g);\n            }\n        } else {\n            values = text.split(/\\x00/g);\n        }\n        return FrameParser.trimArray(values);\n    }\n\n    static trimArray(values) {\n        return values.map(value => value.replace(/\\x00+$/, '').trim());\n    }\n}","import { ExtendedHeader, ID3v2Header } from './ID3v2Token';\nimport { strtokBITSET } from '../../Utils/Common';\nimport { ASCII_TEXT, UINT24_BE, UINT32_BE, UINT32SYNCSAFE } from '../../Utils/Token';\nimport { FrameParser } from './FrameParser';\n\nexport class ID3v2Parser {\n    static removeUnsyncBytes(buffer) {\n        let readI = 0;\n        let writeI = 0;\n        while (readI < buffer.length - 1) {\n            if (readI !== writeI) {\n                buffer[writeI] = buffer[readI];\n            }\n            readI += (buffer[readI] === 0xFF && buffer[readI + 1] === 0) ? 2 : 1;\n            writeI++;\n        }\n        if (readI < buffer.length) {\n            buffer[writeI++] = buffer[readI];\n        }\n        return buffer.slice(0, writeI);\n    }\n\n    static readFrameData(buf, frameHeader, majorVer, includeCovers, warningCollector) {\n        const frameParser = new FrameParser(majorVer, warningCollector);\n        switch (majorVer) {\n            case 2:\n                return frameParser.readData(buf, frameHeader.id, includeCovers);\n            case 3:\n            case 4:\n                if (frameHeader.flags.format.unsynchronisation) {\n                    buf = ID3v2Parser.removeUnsyncBytes(buf);\n                }\n                if (frameHeader.flags.format.data_length_indicator) {\n                    buf = buf.slice(4, buf.length);\n                }\n                return frameParser.readData(buf, frameHeader.id, includeCovers);\n            default:\n                throw new Error('Unexpected majorVer: ' + majorVer);\n        }\n    }\n\n    static readFrameFlags(b) {\n        return {\n            status: {\n                tag_alter_preservation: strtokBITSET.get(b, 0, 6),\n                file_alter_preservation: strtokBITSET.get(b, 0, 5),\n                read_only: strtokBITSET.get(b, 0, 4)\n            },\n            format: {\n                grouping_identity: strtokBITSET.get(b, 1, 7),\n                compression: strtokBITSET.get(b, 1, 3),\n                encryption: strtokBITSET.get(b, 1, 2),\n                unsynchronisation: strtokBITSET.get(b, 1, 1),\n                data_length_indicator: strtokBITSET.get(b, 1, 0)\n            }\n        };\n    }\n\n    static readFrameHeader(v, majorVer) {\n        let header;\n        switch (majorVer) {\n\n            case 2:\n                header = {\n                    id: ASCII_TEXT.get(v, 0, 3),\n                    length: UINT24_BE.get(v, 3)\n                };\n                break;\n\n            case 3:\n                header = {\n                    id: ASCII_TEXT.get(v, 0, 4),\n                    length: UINT32_BE.get(v, 4),\n                    flags: ID3v2Parser.readFrameFlags(v.slice(8, 10))\n                };\n                break;\n\n            case 4:\n                header = {\n                    id: ASCII_TEXT.get(v, 0, 4),\n                    length: UINT32SYNCSAFE.get(v, 4),\n                    flags: ID3v2Parser.readFrameFlags(v.slice(8, 10))\n                };\n                break;\n\n            default:\n                throw new Error('Unexpected majorVer: ' + majorVer);\n        }\n\n        return header;\n    }\n\n    static getFrameHeaderLength(majorVer) {\n        switch (majorVer) {\n            case 2:\n                return 6;\n            case 3:\n            case 4:\n                return 10;\n            default:\n                throw new Error('header versionIndex is incorrect');\n        }\n    }\n\n    parseMetadata(data) {\n        let offset = 0;\n        const tags = [];\n\n        while (true) {\n            if (offset === data.length) break;\n\n            const frameHeaderLength = ID3v2Parser.getFrameHeaderLength(this.id3Header.version.major);\n            if (offset + frameHeaderLength > data.length) {\n                console.log('Illegal ID3v2 tag length');\n                break;\n            }\n\n            const frameHeaderBytes = data.slice(offset, offset += frameHeaderLength);\n            const frameHeader = ID3v2Parser.readFrameHeader(frameHeaderBytes, this.id3Header.version.major);\n\n            // Last frame. Check first char is a letter, bit of defensive programming\n            if (frameHeader.id === '' || frameHeader.id === '\\u0000\\u0000\\u0000\\u0000' || 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.indexOf(frameHeader.id[0]) === -1) {\n                console.log('Illegal ID3v2 tag header', frameHeaderBytes, frameHeader.id);\n                break;\n            }\n\n            const frameDataBytes = data.slice(offset, offset += frameHeader.length);\n            const values = ID3v2Parser.readFrameData(frameDataBytes, frameHeader, this.id3Header.version.major, true, []);\n\n            console.log('[ID3v2Parser] parseMetadata', offset, frameHeader.length, frameHeader.id, values);\n            tags.push({ id: frameHeader.id, value: values });\n        }\n        return tags;\n    }\n\n    parseExtendedHeader(buffer) {\n        const extendedHeader = ExtendedHeader.get(buffer, 10);\n\n        return this.parseId3Data(buffer, this.id3Header.size + extendedHeader.size + 4, this.id3Header.size);\n    }\n\n    parseId3Data(buf, offset, dataLen) {\n        const buffer = buf.slice(offset, offset + dataLen);\n        return this.parseMetadata(buffer)\n    }\n\n    parse(buffer) {\n        const id3Header = ID3v2Header.get(buffer, 0);\n\n        this.id3Header = id3Header;\n        if (id3Header.fileIdentifier !== 'ID3') {\n            throw new Error('expected ID3-header file-identifier \\'ID3\\' was not found');\n        }\n\n        if (id3Header.flags.isExtendedHeader) {\n            return this.parseExtendedHeader(buffer);\n        } else {\n            return this.parseId3Data(buffer, ID3v2Header.len, id3Header.size);\n        }\n    }\n}\n\nexport function hasID3v2Header(buffer) {\n    if (buffer.length > 10) {\n        const tag = ASCII_TEXT.get(buffer, 0, 3);\n        return tag === 'ID3';\n    }\n    return false;\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { hasID3v1Header, ID3v1Parser } from './ID3v1/ID3v1Parser';\nimport { hasID3v2Header, ID3v2Parser } from './ID3v2/ID3v2Parser';\nimport { getArrayBuffer } from '../../../../Utils/File';\n\nexport class ID3Parser {\n\n    async parse(file) {\n        const tags = { artist: '', title: '' };\n        const result = { tags };\n\n        if (!file) return result;\n\n        const arrayBuffer = await getArrayBuffer(file);\n        if (!arrayBuffer) return result;\n\n        const buffer = new Uint8Array(arrayBuffer);\n        if (!buffer) return result;\n\n        if (hasID3v2Header(buffer)) {\n            const id3Tags = new ID3v2Parser().parse(buffer);\n            if (id3Tags) {\n                const artistTag = id3Tags.find(x => x.id === 'TPE1');\n                if (artistTag && artistTag.value.length > 0){\n                    tags.artist = artistTag.value[0];\n                }\n                const titleTag = id3Tags.find(x => x.id === 'TIT2');\n                if (titleTag && titleTag.value.length > 0){\n                    tags.title = titleTag.value[0];\n                }\n            }\n        } else if (hasID3v1Header(buffer)) {\n            const id3Tags = new ID3v1Parser().parse(buffer);\n\n            if (id3Tags) {\n                tags.artist = id3Tags.artist;\n                tags.title = id3Tags.title;\n            }\n        }\n\n        return result;\n    }\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Photo from './Photo';\nimport './Invoice.css';\n\nclass Invoice extends React.Component {\n    render() {\n        const { chatId, messageId, invoice, openMedia, meta, t } = this.props;\n        if (!invoice) return null;\n\n        const { title, description, photo, is_test, total_amount, currency } = invoice;\n\n        return (\n            <div className='invoice'>\n                { title && <div className='web-page-site-name'>{title}</div> }\n                { description && <div className='invoice-description'>{description}{!Boolean(photo) && meta}</div> }\n                { photo &&  (\n                    <div className='invoice-photo'>\n                        <Photo chatId={chatId} messageId={messageId} photo={photo} openMedia={openMedia} meta={meta}/>\n                        <div className='media-top-meta'>{is_test ? t('PaymentTestInvoice') : t('PaymentInvoice')}</div>\n                    </div>\n                )}\n            </div>\n        );\n    }\n}\n\nInvoice.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n\n    invoice: PropTypes.object,\n    openMedia: PropTypes.func\n};\n\nexport default withTranslation()(Invoice);","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Animation from '../Components/Message/Media/Animation';\nimport Audio from '../Components/Message/Media/Audio';\nimport Call from '../Components/Message/Media/Call';\nimport Contact from '../Components/Message/Media/Contact';\nimport Document from '../Components/Message/Media/Document';\nimport Game from '../Components/Message/Media/Game';\nimport Location from '../Components/Message/Media/Location';\nimport Photo from '../Components/Message/Media/Photo';\nimport Poll from '../Components/Message/Media/Poll';\nimport Sticker, { StickerSourceEnum } from '../Components/Message/Media/Sticker';\nimport Venue from '../Components/Message/Media/Venue';\nimport Video from '../Components/Message/Media/Video';\nimport VideoNote from '../Components/Message/Media/VideoNote';\nimport VoiceNote from '../Components/Message/Media/VoiceNote';\nimport { ID3Parser } from '../Components/Player/Steaming/MP3/ID3Parser';\nimport { getRandomInt, readImageSize } from './Common';\nimport { PHOTO_DISPLAY_SIZE, THUMBNAIL_BLURRED_SIZE_90 } from '../Constants';\nimport FileStore from '../Stores/FileStore';\nimport MessageStore from '../Stores/MessageStore';\nimport { getSrc } from './File';\nimport classNames from 'classnames';\nimport Invoice from '../Components/Message/Media/Invoice';\n\nconst waveformCache = new Map();\n\nexport function getNormalizedWaveform(data) {\n    if (waveformCache.has(data)) {\n        return waveformCache.get(data);\n    }\n\n    const bytes = Array.from(atob(data)).map(x => x.charCodeAt(0) & 0xFF);\n    const waveform = [];\n    const barsCount = Math.floor(bytes.length * 8 / 5);\n    for (let i = 0; i < barsCount; i++) {\n        const byteIndex = Math.floor(i * 5 / 8);\n        const barPadding = i * 5 % 8;\n\n        const bits = bytes[byteIndex] | (((byteIndex + 1 < bytes.length) ? bytes[byteIndex + 1] : 0) << 8);\n        waveform.push(((bits >>> barPadding) & 0x1F) / 31.0);\n    }\n\n    for (let i = 0; i < (100 - barsCount); i++) {\n        waveform.push(0);\n    }\n\n    waveformCache.set(data, waveform);\n\n    return waveform;\n}\n\nexport function getThumb(thumbnail, minithumbnail, width, height) {\n    const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n    const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n    const isBlurred = thumbnailSrc ? isBlurredThumbnail({ width: thumbnail.width, height: thumbnail.height }) : Boolean(miniSrc);\n\n    let thumb;\n    if (thumbnailSrc) {\n        switch (thumbnail.format['@type']) {\n            case 'thumbnailFormatJpeg':\n            case 'thumbnailFormatPng':\n            case 'thumbnailFormatWebp':\n            case 'thumbnailFormatGif': {\n                thumb = (\n                    <img\n                        className={classNames('media-viewer-content-video-thumbnail', {\n                            'media-blurred': isBlurred\n                        })}\n                        src={thumbnailSrc}\n                        alt=''\n                        width={width}\n                        height={height}\n                    />\n                );\n                break;\n            }\n            case 'thumbnailFormatTgs': {\n                thumb = (\n                    <div\n                        className='media-viewer-content-video-thumbnail'\n                        style={{ width, height }}\n                    />\n                );\n                break;\n            }\n            case 'thumbnailFormatMpeg4': {\n                thumb = (\n                    <video\n                        className={classNames('media-viewer-content-video-thumbnail', {\n                            'media-blurred': isBlurred\n                        })}\n                        src={thumbnailSrc}\n                        autoPlay={false}\n                        loop\n                        playsInline\n                        width={width}\n                        height={height}\n                    >\n                        <source src={thumbnailSrc} type='video/mp4'/>\n                    </video>\n                );\n                break;\n            }\n            default: {\n                thumb = (\n                    <div\n                        className='media-viewer-content-video-thumbnail'\n                        style={{ width, height }}\n                    />\n                );\n            }\n        }\n    } else if (miniSrc) {\n        thumb = (\n            <img\n                className={classNames('media-viewer-content-video-thumbnail', {\n                    'media-blurred': isBlurred\n                })}\n                src={miniSrc}\n                alt=''\n                width={width}\n                height={height}\n            />\n        );\n    } else {\n        thumb = (\n            <div\n                className='media-viewer-content-video-thumbnail'\n                style={{ width, height }}\n            />\n        );\n    }\n\n    return thumb;\n}\n\nexport function isEditedMedia(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return true;\n        }\n        case 'messageAudio': {\n            return true;\n        }\n        case 'messageDocument': {\n            return true;\n        }\n        case 'messagePhoto': {\n            return true;\n        }\n        case 'messageVideo': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isValidAnimatedSticker(sticker, chatId, messageId) {\n    if (!sticker) return false;\n    if (!sticker.is_animated) return false;\n\n    const message = MessageStore.get(chatId, messageId);\n    if (message) {\n        const { sending_state } = message;\n        if (sending_state && !sticker.set_id) return false;\n    }\n\n    return true;\n}\n\nexport function isBlurredThumbnail(thumbnail, displaySize = PHOTO_DISPLAY_SIZE, blurredSize = THUMBNAIL_BLURRED_SIZE_90) {\n    if (!thumbnail) return false;\n    // if (displaySize <= blurredSize * 2) return false;\n\n    return Math.max(thumbnail.width, thumbnail.height) <= blurredSize;\n}\n\nexport function getAudioTitle(audio) {\n    if (!audio) return null;\n\n    const { file_name, title, performer } = audio;\n    const trimmedTitle = title ? title.trim() : '';\n    const trimmedPerformer = performer ? performer.trim() : '';\n\n    return trimmedTitle || trimmedPerformer\n        ? `${trimmedPerformer || 'Unknown Artist'}  ${trimmedTitle || 'Unknown Track'}`\n        : file_name;\n}\n\nexport function getAudioShortTitle(audio) {\n    if (!audio) return null;\n\n    const { file_name, title, performer } = audio;\n    const trimmedTitle = title ? title.trim() : '';\n    const trimmedPerformer = performer ? performer.trim() : '';\n\n    return trimmedTitle || trimmedPerformer ? `${trimmedPerformer || 'Unknown Artist'}` : file_name;\n}\n\nexport function getAudioSubtitle(audio) {\n    if (!audio) return null;\n\n    const { title } = audio;\n    const trimmedTitle = title ? title.trim() : '';\n\n    return trimmedTitle || 'Unknown Track';\n}\n\nexport function getStickers(sets) {\n    return sets.reduce((stickers, set) => stickers.concat(set.stickers), []);\n}\n\nexport function getNeighborStickersFromSets(sticker, sets, stickersPerRow) {\n    const result = [];\n    const [row, column] = toRowColumn(sticker, sets, stickersPerRow);\n    if (row === -1) return [];\n    if (column === -1) return [];\n\n    const prevPrevRow = row - 2;\n    const prevRow = row - 1;\n    const nextRow = row + 1;\n    const nextNextRow = row + 2;\n\n    const prevColumn = column - 1;\n    const nextColumn = column + 1;\n\n    let skipPrevRow = prevRow < 0;\n    let skipPrePrevRow = prevPrevRow < 0;\n    if (!skipPrevRow) {\n        if (prevColumn >= 0) {\n            let index = toIndex(prevRow, prevColumn, sets, stickersPerRow);\n            if (index === -1) {\n                skipPrevRow = true;\n                index = skipPrePrevRow ? -1 : toIndex(prevPrevRow, prevColumn, sets, stickersPerRow);\n                skipPrePrevRow = index === -1;\n            }\n            if (index !== -1) {\n                result.push(index);\n            }\n        }\n\n        let index = skipPrevRow ? -1 : toIndex(prevRow, column, sets, stickersPerRow);\n        if (index === -1) {\n            skipPrevRow = true;\n            index = skipPrePrevRow ? -1 : toIndex(prevPrevRow, column, sets, stickersPerRow);\n            skipPrePrevRow = index === -1;\n        }\n        if (index !== -1) {\n            result.push(index);\n        }\n\n        if (nextColumn < stickersPerRow) {\n            let index = skipPrevRow ? -1 : toIndex(prevRow, nextColumn, sets, stickersPerRow);\n            if (index === -1) {\n                index = skipPrePrevRow ? -1 : toIndex(prevPrevRow, nextColumn, sets, stickersPerRow);\n            }\n            if (index !== -1) {\n                result.push(index);\n            }\n        }\n    }\n\n    if (prevColumn >= 0) {\n        const index = toIndex(row, prevColumn, sets, stickersPerRow);\n        if (index !== -1) {\n            result.push(index);\n        }\n    }\n\n    if (nextColumn < stickersPerRow) {\n        const index = toIndex(row, nextColumn, sets, stickersPerRow);\n        if (index !== -1) {\n            result.push(index);\n        }\n    }\n\n    let totalRows = sets.reduce((totalRows, set) => totalRows + Math.ceil(set.stickers.length / stickersPerRow), 0);\n    let skipNextRow = nextRow >= totalRows;\n    let skipNextNextRow = nextRow >= totalRows;\n    if (!skipNextRow) {\n        if (prevColumn >= 0) {\n            let index = toIndex(nextRow, prevColumn, sets, stickersPerRow);\n            if (index === -1) {\n                skipNextRow = true;\n                index = skipNextNextRow ? -1 : toIndex(nextNextRow, prevColumn, sets, stickersPerRow);\n                skipNextNextRow = index === -1;\n            }\n            if (index !== -1) {\n                result.push(index);\n            }\n        }\n\n        let index = skipNextRow ? -1 : toIndex(nextRow, column, sets, stickersPerRow);\n        if (index === -1) {\n            skipNextRow = true;\n            index = skipNextNextRow ? -1 : toIndex(nextNextRow, column, sets, stickersPerRow);\n            skipNextNextRow = index === -1;\n        }\n        if (index !== -1) {\n            result.push(index);\n        }\n\n        if (nextColumn < stickersPerRow) {\n            let index = skipNextRow ? -1 : toIndex(nextRow, nextColumn, sets, stickersPerRow);\n            if (index === -1) {\n                index = skipNextNextRow ? -1 : toIndex(nextNextRow, nextColumn, sets, stickersPerRow);\n            }\n            if (index !== -1) {\n                result.push(index);\n            }\n        }\n    }\n\n    const items = getStickers(sets);\n    return result.map(x => items[x]);\n}\n\nfunction toRowColumn(sticker, sets, stickersPerRow) {\n    const setIndex = sets.findIndex(x => x.id === sticker.set_id);\n    if (setIndex === -1) return [-1, -1];\n\n    const stickerIndex = sets[setIndex].stickers.findIndex(x => x.sticker.id === sticker.sticker.id);\n    if (stickerIndex === -1) return [-1, -1];\n\n    let prevRows = 0;\n    for (let i = 0; i < setIndex; i++) {\n        prevRows += Math.ceil(sets[i].stickers.length / stickersPerRow);\n    }\n\n    return [prevRows + Math.floor(stickerIndex / stickersPerRow), stickerIndex % stickersPerRow];\n}\n\nfunction toIndex(row, column, sets, stickersPerRow) {\n    let index = -1;\n    let totalRows = 0;\n    let setIndex = -1;\n    for (let i = 0; i < sets.length; i++) {\n        let setRows = Math.ceil(sets[i].stickers.length / stickersPerRow);\n        totalRows += setRows;\n        if (totalRows > row) {\n            setIndex = i;\n            break;\n        }\n    }\n    if (setIndex === -1) return index;\n\n    let setRow = row;\n    let setColumn = column;\n    for (let i = 0; i < setIndex; i++) {\n        let setRows = Math.ceil(sets[i].stickers.length / stickersPerRow);\n        setRow -= setRows;\n    }\n\n    index = stickersPerRow * setRow + setColumn;\n\n    if (index >= sets[setIndex].stickers.length) return -1;\n\n    for (let i = 0; i < setIndex; i++) {\n        index += sets[i].stickers.length;\n    }\n\n    return index;\n}\n\nfunction getInputMediaThumbnail(thumbnail) {\n    if (!thumbnail) return null;\n\n    const { file, width, height } = thumbnail;\n    if (!file) return null;\n\n    return {\n        '@type': 'inputThumbnail',\n        thumbnail: {\n            '@type': 'inputFileId',\n            id: file.id\n        },\n        width,\n        height\n    };\n}\n\nfunction getInputMediaCaption(text) {\n    if (!text) return null;\n\n    return {\n        '@type': 'formattedText',\n        text: text,\n        entities: null\n    };\n}\n\nexport function getInputMediaContent(media, text) {\n    if (!media) return null;\n\n    switch (media['@type']) {\n        case 'animation': {\n            const { animation: file, thumbnail, width, height, duration } = media;\n\n            return {\n                '@type': 'inputMessageAnimation',\n                animation: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                duration,\n                width,\n                height,\n                caption: getInputMediaCaption(text)\n            };\n        }\n        case 'audio': {\n            const { audio: file, album_cover_thumbnail: thumbnail, title, performer, duration } = media;\n\n            return {\n                '@type': 'inputMessageAudio',\n                audio: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                album_cover_thumbnail: getInputMediaThumbnail(thumbnail),\n                duration,\n                title,\n                performer,\n                caption: getInputMediaCaption(text)\n            };\n        }\n        case 'contact': {\n            return {\n                '@type': 'inputMessageContact',\n                contact: media\n            };\n        }\n        case 'document': {\n            const { document: file, thumbnail } = media;\n\n            return {\n                '@type': 'inputMessageDocument',\n                document: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                caption: getInputMediaCaption(text)\n            };\n        }\n        case 'game': {\n            return null;\n        }\n        case 'invoice': {\n            return null;\n        }\n        case 'location': {\n            return {\n                '@type': 'inputMessageLocation',\n                location: media,\n                live_period: 0\n            };\n        }\n        case 'photo': {\n            const { sizes } = media;\n            if (!sizes.length) return null;\n\n            const thumbnail = sizes[0];\n            const photo = sizes[sizes.length - 1];\n            if (!photo) return null;\n\n            const { photo: file, width, height } = photo;\n\n            return {\n                '@type': 'inputMessagePhoto',\n                photo: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                added_sticker_file_ids: [],\n                width,\n                height,\n                caption: getInputMediaCaption(text),\n                ttl: 0\n            };\n        }\n        case 'poll': {\n            return null;\n        }\n        case 'sticker': {\n            const { sticker: file, thumbnail, width, height } = media;\n\n            return {\n                '@type': 'inputMessageSticker',\n                sticker: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                width,\n                height,\n                caption: getInputMediaCaption(text)\n            };\n        }\n        case 'venue': {\n            return {\n                '@type': 'inputMessageVenue',\n                venue: media\n            };\n        }\n        case 'video': {\n            const { video: file, thumbnail, width, height, duration, supports_streaming } = media;\n\n            return {\n                '@type': 'inputMessageVideo',\n                video: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                added_sticker_file_ids: [],\n                duration,\n                width,\n                height,\n                supports_streaming,\n                caption: getInputMediaCaption(text),\n                ttl: 0\n            };\n        }\n        case 'videoNote': {\n            const { video: file, thumbnail, duration, length } = media;\n\n            return {\n                '@type': 'inputMessageVideoNote',\n                video: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                duration,\n                length,\n                ttl: 0\n            };\n        }\n        case 'voiceNote': {\n            const { voice: file, duration, waveform } = media;\n\n            return {\n                '@type': 'inputMessageVideoNote',\n                voice_note: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                duration,\n                waveform\n            };\n        }\n    }\n\n    return null;\n}\n\nexport function getMedia(message, openMedia, options = {}) {\n    if (!message) return null;\n\n    const { hasTitle = false, hasCaption = false, inlineMeta = null, meta = null, date = null } = options;\n\n    const { chat_id, id, content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation':\n            return (\n                <Animation\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    animation={content.animation}\n                    openMedia={openMedia}\n                    stretch={true}\n                />\n            );\n        case 'messageAudio':\n            return (\n                <Audio\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    audio={content.audio}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                    date={date}\n                />\n            );\n        case 'messageCall':\n            return (\n                <Call\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    call={content}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageContact':\n            return (\n                <Contact\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    contact={content.contact}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageDocument':\n            return (\n                <Document\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    document={content.document}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                    date={date}\n                />\n            );\n        case 'messageGame':\n            return (\n                <Game\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    game={content.game}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageInvoice':\n            return (\n                <Invoice\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    invoice={content}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageLocation':\n            return (\n                <Location\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    location={content.location}\n                    openMedia={openMedia}\n                />\n            );\n        case 'messagePhoto':\n            return (\n                <Photo\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    photo={content.photo}\n                    openMedia={openMedia}\n                    stretch={true}\n                />\n            );\n        case 'messagePoll':\n            return <Poll chatId={chat_id} messageId={id} poll={content.poll} openMedia={openMedia} meta={inlineMeta} />;\n        case 'messageSticker':\n            return (\n                <Sticker\n                    chatId={chat_id}\n                    messageId={id}\n                    sticker={content.sticker}\n                    openMedia={openMedia}\n                    source={StickerSourceEnum.MESSAGE}\n                    meta={meta}\n                />\n            );\n        case 'messageText':\n            return null;\n        case 'messageVenue':\n            return (\n                <Venue\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    venue={content.venue}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageVideo':\n            return (\n                <Video\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    video={content.video}\n                    openMedia={openMedia}\n                    stretch={true}\n                />\n            );\n        case 'messageVideoNote':\n            return (\n                <VideoNote\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    videoNote={content.video_note}\n                    openMedia={openMedia}\n                    meta={meta}\n                />\n            );\n        case 'messageVoiceNote':\n            return (\n                <VoiceNote\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    voiceNote={content.voice_note}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        default:\n            return [`[${content['@type']}]`, inlineMeta];\n    }\n}\n\nexport async function getMediaTags(file) {\n    return new Promise(async resolve => {\n        const tag = await new ID3Parser().parse(file);\n\n        const { tags } = tag;\n        const { artist, title } = tags;\n\n        const audio = document.createElement('audio');\n        const url = URL.createObjectURL(file);\n\n        audio.src = url;\n        audio.addEventListener('loadedmetadata', function(){\n            URL.revokeObjectURL(url);\n            const duration = audio.duration;\n            audio.src = null;\n            resolve({ title, performer : artist, duration : Math.trunc(duration) });\n        },false);\n        audio.addEventListener('error', function() {\n            resolve(null);\n        });\n    })\n}\n\nexport async function getMediaDocumentFromFile(file) {\n    if (!file) {\n        return null;\n    }\n\n    const fileId = -getRandomInt(1, 1000000);\n    FileStore.setBlob(fileId, file);\n\n    const { name, type, size } = file;\n\n    if (type === 'audio/mp3') {\n        const tags = await getMediaTags(file);\n        if (tags) {\n            const { title, performer, duration } = tags;\n\n            return ({\n                '@type': 'messageAudio',\n                audio: {\n                    '@type': 'audio',\n                    duration,\n                    title,\n                    performer,\n                    file_name: name,\n                    mime_type: type,\n                    album_cover_minithumbnail: null,\n                    album_cover_thumbnail: null,\n                    audio: {\n                        '@type': 'file',\n                        id: fileId,\n                        size,\n                        expected_size: size,\n                        local: {\n                            is_downloading_completed: true\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n    return ({\n        '@type': 'messageDocument',\n        document: {\n            '@type': 'document',\n            file_name: name,\n            mime_type: type,\n            minithumbnail: null,\n            thumbnail: null,\n            document: {\n                '@type': 'file',\n                id: fileId,\n                size,\n                expected_size: size,\n                local: {\n                    is_downloading_completed: true\n                }\n            }\n        }\n    });\n}\n\nexport async function getMediaPhotoFromFile(file) {\n    if (!file) {\n        return null;\n    }\n\n    if (file.type.startsWith('image')) {\n        const [width, height] = await readImageSize(file);\n\n        const fileId = -getRandomInt(1, 1000000);\n        FileStore.setBlob(fileId, file);\n\n        const photoSize = {\n            '@type': 'photoSize',\n            photo: {\n                '@type': 'file',\n                id: fileId,\n                size: file.size,\n                expected_size: file.expected_size,\n                local: {\n                    is_downloading_completed: true\n                }\n            },\n            width,\n            height\n        };\n\n        return ({\n            '@type': 'messagePhoto',\n            photo: {\n                '@type': 'photo',\n                has_stickers: false,\n                minithumbnail: null,\n                sizes: [ photoSize ]\n            }\n        });\n    } else {\n        return null;\n    }\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass SupergroupStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n        this.fullInfoItems = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateSupergroup': {\n                const prevSupergroup = this.get(update.supergroup.id);\n\n                this.set(update.supergroup);\n\n                this.emit(update['@type'], { ...update, prevSupergroup });\n                break;\n            }\n            case 'updateSupergroupFullInfo':\n                this.setFullInfo(update.supergroup_id, update.supergroup_full_info);\n\n                this.emit(update['@type'], update);\n                break;\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {};\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    get(id) {\n        return this.items.get(id);\n    }\n\n    set(supergroup) {\n        this.items.set(supergroup.id, supergroup);\n    }\n\n    getFullInfo(id) {\n        return this.fullInfoItems.get(id);\n    }\n\n    setFullInfo(id, fullInfo) {\n        this.fullInfoItems.set(id, fullInfo);\n    }\n}\n\nconst store = new SupergroupStore();\nwindow.supergroup = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass InstantViewStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = [];\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateBlocksInView': {\n                this.emit('clientUpdateBlocksInView', update);\n                break;\n            }\n            case 'clientUpdateInstantViewContent': {\n                const { content } = update;\n\n                if (content) {\n                    this.items.push(content.instantView);\n                } else {\n                    this.items = [];\n                }\n\n                this.emit('clientUpdateInstantViewContent', update);\n\n                break;\n            }\n            case 'clientUpdateInstantViewUrl': {\n                this.emit('clientUpdateInstantViewUrl', update);\n                break;\n            }\n            case 'clientUpdateInstantViewViewerContent': {\n                const { content } = update;\n\n                this.viewerContent = content;\n\n                this.emit('clientUpdateInstantViewViewerContent', update);\n                break;\n            }\n            case 'clientUpdatePrevInstantView': {\n                if (this.items.length <= 1) return;\n\n                this.items.pop();\n                const prevInstantView = this.items.pop();\n\n                TdLibController.clientUpdate({\n                    '@type': 'clientUpdateInstantViewContent',\n                    content: {\n                        instantView: prevInstantView\n                    }\n                });\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    hasPrev() {\n        return this.items.length > 1;\n    }\n\n    getCurrent() {\n        return this.items.length > 0 ? this.items[this.items.length - 1] : null;\n    }\n}\n\nconst store = new InstantViewStore();\nwindow.instantView = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\nimport { isEmptyText } from '../../../Utils/InstantView';\n\nfunction Caption(props) {\n    const { text, credit } = props;\n\n    const hasText = !isEmptyText(text);\n    const hastCredit = !isEmptyText(credit);\n    if (!hasText && !hastCredit) return null;\n\n    return (\n        <figcaption>\n            {hasText && <RichText text={text} />}\n            {hastCredit && (\n                <cite>\n                    <RichText text={credit} />\n                </cite>\n            )}\n        </figcaption>\n    );\n}\n\nCaption.propTypes = {\n    text: PropTypes.object.isRequired,\n    credit: PropTypes.object.isRequired\n};\n\nexport default Caption;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Anchor(props) {\n    return <a id={props.name} />;\n}\n\nAnchor.propTypes = {\n    name: PropTypes.string.isRequired\n};\n\nexport default Anchor;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Caption from './Caption';\nimport MediaAnimation from '../../../Components/Message/Media/Animation';\nimport { IV_PHOTO_DISPLAY_SIZE } from '../../../Constants';\n\nfunction Animation(props) {\n    const { animation, block, caption, need_autoplay, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaAnimation\n                type='iv'\n                pageBlock={block}\n                animation={animation}\n                displaySize={IV_PHOTO_DISPLAY_SIZE}\n                openMedia={openMedia}\n            />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nAnimation.propTypes = {\n    block: PropTypes.object.isRequired,\n    animation: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    needAutoplay: PropTypes.bool.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Animation;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\nimport dateFormat from '../../../Utils/Date';\nimport { isEmptyText } from '../../../Utils/InstantView';\n\nfunction AuthorDate(props) {\n    const { author, publishDate } = props;\n\n    const hasAuthor = !isEmptyText(author);\n    const hasDate = publishDate > 0;\n    if (!hasAuthor && !hasDate) return null;\n\n    const d = publishDate > 0 ? new Date(publishDate * 1000) : null;\n\n    return (\n        <address>\n            {hasAuthor && (\n                <a rel='author'>\n                    <RichText text={author} />\n                </a>\n            )}\n            {hasAuthor && hasDate && '  '}\n            {hasDate && <time dateTime={d.toISOString()}>{dateFormat(d, 'dd MMM, yyyy')}</time>}\n        </address>\n    );\n}\n\nAuthorDate.propTypes = {\n    author: PropTypes.object,\n    publishDate: PropTypes.number\n};\n\nexport default AuthorDate;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Blockquote(props) {\n    const { text, credit } = props;\n    return (\n        <blockquote>\n            <RichText text={text} />\n            {credit && (\n                <cite>\n                    <RichText text={credit} />\n                </cite>\n            )}\n        </blockquote>\n    );\n}\n\nBlockquote.propTypes = {\n    text: PropTypes.object.isRequired,\n    credit: PropTypes.object.isRequired\n};\n\nexport default Blockquote;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport Caption from './Caption';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction Collage(props) {\n    const { pageBlocks, caption, iv } = props;\n\n    return (\n        <div className='collage'>\n            {pageBlocks.map((x, index) => getPageBlock(x, iv, index))}\n            <Caption text={caption.text} credit={caption.credit} />\n        </div>\n    );\n}\n\nCollage.propTypes = {\n    pageBlocks: PropTypes.array.isRequired,\n    caption: PropTypes.object.isRequired\n};\n\nexport default withIV(Collage);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction Cover(props) {\n    return getPageBlock(props.cover, props.iv);\n}\n\nCover.propTypes = {\n    cover: PropTypes.object.isRequired\n};\n\nexport default withIV(Cover);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport RichText from '../RichText/RichText';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction Details(props) {\n    const { header, pageBlocks, isOpen, iv } = props;\n\n    return (\n        <details open={isOpen}>\n            <summary>\n                <RichText text={header} />\n            </summary>\n            {pageBlocks.map((x, index) => getPageBlock(x, iv, index))}\n        </details>\n    );\n}\n\nDetails.propTypes = {\n    header: PropTypes.object.isRequired,\n    pageBlocks: PropTypes.array.isRequired,\n    isOpen: PropTypes.bool.isRequired\n};\n\nexport default withIV(Details);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Divider() {\n    return <hr />;\n}\n\nexport default Divider;\n","/**\n *\n * inject script to facilitate iframe resizing\n * https://github.com/davidjbradshaw/iframe-resizer\n *\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport { iframeResizer as iframeResizerLib } from 'iframe-resizer';\n\nclass IframeResizer extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.frameRef = React.createRef();\n    }\n\n    componentDidMount() {\n        // can't update until we have a mounted iframe\n        this.updateIframe(this.props);\n        this.resizeIframe(this.props);\n    }\n\n    componentWillUnmount() {\n        // React will remove the iframe, however we need to manually\n        // call iframe-resizer to stop its listeners\n        const frame = this.frameRef.current;\n        if (!frame) return;\n\n        const { iframeResizer } = frame;\n        if (!iframeResizer) return;\n\n        iframeResizer.removeListeners();\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // can replace content if we got new props\n        this.updateIframe(nextProps);\n        this.resizeIframe(nextProps);\n    }\n\n    updateIframe = props => {\n        // has src - no injected content\n        if (props.src) return;\n        // do we have content to inject (content or children)\n        const content = props.content || props.children;\n        if (!content) return;\n        // get frame to inject into\n        const frame = this.frameRef.current;\n        if (!frame) return;\n        // verify frame document access\n        // Due to browser security, this will fail with the following error\n        //   Uncaught DOMException: Failed to read the 'contentDocument' property from 'HTMLIFrameElement':\n        //   Blocked a frame with origin \"http://<hostname>\" from accessing a cross-origin frame.\n        // resolve this by loading documents from the same domain name,\n        // or injecting HTML `content` vs. loading via `src`\n        const doc = frame.contentDocument;\n        if (!doc) return;\n        // replace iframe document content\n        if (typeof content === 'string') {\n            // assume this is a HTML block\n            //   we could send this in via REACT dangerously set HTML\n            //   but we are in an iframe anyway, already a red-headed step-child.\n            doc.open();\n            doc.write(content);\n            doc.close();\n        } else {\n            // assume this is a REACT component\n            doc.open();\n            doc.write('<div id=\"iframe-root\"></div>');\n            doc.close();\n            ReactDOM.render(content, doc.getElementById('iframe-root'));\n        }\n    };\n\n    // inject the iframe resizer \"content window\" script\n    injectIframeResizerUrl = () => {\n        if (!this.props.iframeResizerUrl) return;\n        const frame = this.frameRef.current;\n        if (!frame) return;\n        // verify frame document access\n        // Due to browser security, this will fail with the following error\n        //   Uncaught DOMException: Failed to read the 'contentDocument' property from 'HTMLIFrameElement':\n        //   Blocked a frame with origin \"http://<hostname>\" from accessing a cross-origin frame.\n        // resolve this by loading documents from the same domain name,\n        // or injecting HTML `content` vs. loading via `src`\n        const doc = frame.contentDocument;\n        if (!doc) return;\n        // where can we insert into? (fail into whatever we can find)\n        let injectTarget = null;\n        ['head', 'HEAD', 'body', 'BODY', 'div', 'DIV'].forEach(tagName => {\n            if (injectTarget) return;\n            const found = doc.getElementsByTagName(tagName);\n            if (!(found && found.length)) return;\n            injectTarget = found[0];\n        });\n        if (!injectTarget) {\n            console.error('Unable to inject iframe resizer script');\n            return;\n        }\n        const resizerScriptElement = document.createElement('script');\n        resizerScriptElement.type = 'text/javascript';\n        resizerScriptElement.src = this.props.iframeResizerUrl;\n        injectTarget.appendChild(resizerScriptElement);\n    };\n\n    onLoad = () => {\n        this.injectIframeResizerUrl();\n        // DISABLED because it's causing a loading loop :(\n        // if (this.props.onIframeLoaded) this.props.onIframeLoaded();\n    };\n\n    resizeIframe = props => {\n        const frame = this.frameRef.current;\n        if (!frame) return;\n        if (props.iframeResizerEnable) {\n            iframeResizerLib(props.iframeResizerOptions, frame);\n        }\n    };\n\n    render() {\n        const { src, id, frameBorder, className, style } = this.props;\n        return (\n            <iframe\n                ref={this.frameRef}\n                src={src}\n                id={id}\n                frameBorder={frameBorder}\n                className={className}\n                style={style}\n                onLoad={this.onLoad}\n            />\n        );\n    }\n}\nIframeResizer.propTypes = {\n    // iframe content/document\n    // option 1. content of HTML to load in the iframe\n    content: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\n    // option 2. src to a URL to load in the iframe\n    src: PropTypes.string,\n    // iframe-resizer controls and helpers\n    iframeResizerEnable: PropTypes.bool,\n    iframeResizerOptions: PropTypes.object,\n    iframeResizerUrl: PropTypes.oneOfType([\n        PropTypes.string, // URL to inject\n        PropTypes.bool // false = disable inject\n    ]),\n    // misc props to pass through to iframe\n    id: PropTypes.string,\n    frameBorder: PropTypes.number,\n    className: PropTypes.string,\n    style: PropTypes.object\n    // optional extra callback when iframe is loaded\n    // onIframeLoaded: PropTypes.func,\n};\nIframeResizer.defaultProps = {\n    // resize iframe\n    iframeResizerEnable: true,\n    iframeResizerOptions: {\n        // log: true,\n        // autoResize: true,\n        // checkOrigin: false,\n        // resizeFrom: 'parent',\n        // heightCalculationMethod: 'max',\n        // initCallback: () => { console.log('ready!'); },\n        // resizedCallback: () => { console.log('resized!'); },\n    },\n    iframeResizerUrl: 'https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.8/iframeResizer.contentWindow.min.js',\n    // misc props to pass through to iframe\n    frameBorder: 0,\n    style: {\n        width: '100%',\n        minHeight: 20\n    }\n};\n\nexport default IframeResizer;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactIframeResizer from '../../Additional/IframeResizer';\nimport Caption from './Caption';\n\nclass Embedded extends React.Component {\n    state = {};\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.url !== state.prevUrl || props.html !== state.prevHtml) {\n            return {\n                url: null,\n                html: null,\n                prevUrl: props.url,\n                prevHtml: props.html\n            };\n        }\n\n        return null;\n    }\n\n    componentDidMount() {\n        this.setIframeSource();\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        const { url, html } = this.props;\n\n        if (url !== prevProps.url || html !== prevProps.html) {\n            this.setIframeSource();\n        }\n    }\n\n    setIframeSource() {\n        const { url, html } = this.props;\n\n        this.setState({\n            url,\n            html\n        });\n    }\n\n    render() {\n        const { url, html } = this.state;\n        const { width, height, caption, isFullWidth, allowScrolling } = this.props;\n\n        const options = {\n            scrolling: allowScrolling\n        };\n\n        const hasWidthHeight = width > 0 && height > 0;\n        const hasSource = Boolean(url) || Boolean(html);\n\n        return (\n            <figure>\n                {hasSource && (\n                    <>\n                        {hasWidthHeight ? (\n                            <iframe\n                                src={url ? url : null}\n                                srcDoc={url ? null : html}\n                                width={width > 0 ? width : null}\n                                height={height > 0 ? height : null}\n                                allowFullScreen={isFullWidth}\n                                scrolling={allowScrolling ? 'auto' : 'no'}\n                                frameBorder={0}\n                            />\n                        ) : (\n                            <ReactIframeResizer\n                                content={html}\n                                src={url}\n                                iframeResizerOptions={options}\n                                style={{ width: '100%' }}\n                            />\n                        )}\n                    </>\n                )}\n                <Caption text={caption.text} credit={caption.credit} />\n            </figure>\n        );\n    }\n}\n\nEmbedded.propTypes = {\n    url: PropTypes.string.isRequired,\n    html: PropTypes.string.isRequired,\n    posterPhoto: PropTypes.object,\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    caption: PropTypes.object.isRequired,\n    isFullWidth: PropTypes.bool.isRequired,\n    allowScrolling: PropTypes.bool.isRequired\n};\n\nexport default Embedded;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport Caption from './Caption';\nimport { getPageBlock } from '../../../Utils/InstantView';\nimport AuthorDate from './AuthorDate';\nimport RichText from '../RichText/RichText';\n\nfunction EmbeddedPost(props) {\n    const { url, author, authorPhoto, date, pageBlocks, caption, iv } = props;\n\n    return (\n        <blockquote>\n            <figure>\n                {Boolean(author) && <h3>{author}</h3>}\n                <AuthorDate author={null} publishDate={date} />\n                {pageBlocks.map((x, index) => getPageBlock(x, iv, index))}\n                <Caption text={caption.text} credit={caption.credit} />\n            </figure>\n        </blockquote>\n    );\n}\n\nEmbeddedPost.propTypes = {\n    url: PropTypes.string.isRequired,\n    author: PropTypes.string.isRequired,\n    authorPhoto: PropTypes.object,\n    date: PropTypes.number.isRequired,\n    pageBlocks: PropTypes.array.isRequired,\n    caption: PropTypes.object.isRequired\n};\n\nexport default withIV(EmbeddedPost);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport './ErrorHandler.css';\n\nclass ErrorHandler extends React.Component {\n    state = {\n        error: null,\n        errorInfo: null\n    };\n\n    componentDidCatch(error, errorInfo) {\n        this.setState({ error, errorInfo });\n    }\n\n    render() {\n        const { children } = this.props;\n        const { error, errorInfo } = this.state;\n        if (error || errorInfo) {\n            return (\n                <div className='error-handler'>\n                    <span>\n                        <pre>\n                            {`${error.name}: ${error.message}`}\n                            {errorInfo.componentStack}\n                        </pre>\n                    </span>\n                </div>\n            );\n        }\n\n        return children;\n    }\n}\n\nexport default ErrorHandler;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Footer(props) {\n    return (\n        <footer>\n            <RichText text={props.footer} />\n        </footer>\n    );\n}\n\nFooter.propTypes = {\n    footer: PropTypes.object.isRequired\n};\n\nexport default Footer;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Header(props) {\n    return (\n        <h3>\n            <RichText text={props.header} />\n        </h3>\n    );\n}\n\nHeader.propTypes = {\n    header: PropTypes.object.isRequired\n};\n\nexport default Header;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Kicker(props) {\n    const { kicker } = props;\n    return (\n        <h6 className='kicker'>\n            <RichText text={kicker} />\n        </h6>\n    );\n}\n\nKicker.propTypes = {\n    kicker: PropTypes.object.isRequired\n};\n\nexport default Kicker;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction ListItem(props) {\n    return <li data-before={props.label}>{props.pageBlocks.map((x, index) => getPageBlock(x, props.iv, index))}</li>;\n}\n\nListItem.propTypes = {\n    label: PropTypes.string.isRequired,\n    pageBlocks: PropTypes.array.isRequired\n};\n\nexport default withIV(ListItem);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ListItem from './ListItem';\n\nfunction List(props) {\n    return (\n        <ul>\n            {props.items.map((x, index) => (\n                <ListItem key={index} label={x.label} pageBlocks={x.page_blocks} />\n            ))}\n        </ul>\n    );\n}\n\nList.propTypes = {\n    items: PropTypes.array.isRequired\n};\n\nexport default List;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Paragraph(props) {\n    return (\n        <p>\n            <RichText text={props.text} />\n        </p>\n    );\n}\n\nParagraph.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Paragraph;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Caption from './Caption';\nimport MediaPhoto from '../../../Components/Message/Media/Photo';\nimport { IV_PHOTO_DISPLAY_SIZE, IV_PHOTO_SIZE } from '../../../Constants';\n\nfunction Photo(props) {\n    const { photo, caption, url, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaPhoto photo={photo} size={IV_PHOTO_SIZE} displaySize={IV_PHOTO_DISPLAY_SIZE} openMedia={openMedia} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nPhoto.propTypes = {\n    photo: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    url: PropTypes.string.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Photo;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Preformatted(props) {\n    return (\n        <pre>\n            <RichText text={props.text} />\n        </pre>\n    );\n}\n\nPreformatted.propTypes = {\n    text: PropTypes.object.isRequired,\n    language: PropTypes.string.isRequired\n};\n\nexport default Preformatted;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction PullQuote(props) {\n    const { text, credit } = props;\n    return (\n        <aside>\n            <RichText text={text} />\n            {credit && (\n                <cite>\n                    <RichText text={credit} />\n                </cite>\n            )}\n        </aside>\n    );\n}\n\nPullQuote.propTypes = {\n    text: PropTypes.object.isRequired,\n    credit: PropTypes.object.isRequired\n};\n\nPullQuote.propTypes = {};\n\nexport default PullQuote;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport SafeLink from '../../Additional/SafeLink';\nimport dateFormat from '../../../Utils/Date';\nimport TdLibController from '../../../Controllers/TdLibController';\n\nclass RelatedArticle extends React.Component {\n    handleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { url } = this.props;\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateInstantViewUrl',\n            url\n        });\n    };\n\n    render() {\n        const { author, description, publishDate, title, url } = this.props;\n\n        const d = publishDate > 0 ? new Date(publishDate * 1000) : null;\n        const hasAuthorDateSeparator = author && d;\n        const hasAuthorDate = d || author;\n\n        return (\n            <li>\n                <SafeLink url={url} onClick={this.handleClick}>\n                    {title}\n                </SafeLink>\n                {hasAuthorDate && (\n                    <address>\n                        {author}\n                        {hasAuthorDateSeparator && '  '}\n                        {d && <time dateTime={d.toISOString()}>{dateFormat(d, 'dd MMM, yyyy')}</time>}\n                    </address>\n                )}\n                {/*{ description && (*/}\n                {/*    <div>{description}</div>*/}\n                {/*)}*/}\n            </li>\n        );\n    }\n}\n\nRelatedArticle.propTypes = {\n    url: PropTypes.string.isRequired,\n    title: PropTypes.string.isRequired,\n    description: PropTypes.string.isRequired,\n    photo: PropTypes.object,\n    author: PropTypes.string.isRequired,\n    publishDate: PropTypes.number.isRequired\n};\n\nexport default RelatedArticle;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RelatedArticle from './RelatedArticle';\nimport RichText from '../RichText/RichText';\n\nfunction RelatedArticles(props) {\n    return (\n        <>\n            <h4>\n                <RichText text={props.header} />\n            </h4>\n            <ul className='related-articles'>\n                {props.articles.map(x => (\n                    <RelatedArticle\n                        key={x.url}\n                        url={x.url}\n                        title={x.title}\n                        description={x.description}\n                        photo={x.photo}\n                        author={x.author}\n                        publishDate={x.publish_date}\n                    />\n                ))}\n            </ul>\n        </>\n    );\n}\n\nRelatedArticles.propTypes = {\n    header: PropTypes.object.isRequired,\n    articles: PropTypes.array.isRequired\n};\n\nexport default RelatedArticles;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport Caption from './Caption';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction Slideshow(props) {\n    const { pageBlocks, caption, iv } = props;\n\n    return (\n        <div className='slideshow'>\n            {pageBlocks.map((x, index) => getPageBlock(x, iv, index))}\n            <Caption text={caption.text} credit={caption.credit} />\n        </div>\n    );\n}\n\nSlideshow.propTypes = {\n    pageBlocks: PropTypes.array.isRequired,\n    caption: PropTypes.object.isRequired\n};\n\nexport default withIV(Slideshow);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Subheader(props) {\n    return (\n        <h4>\n            <RichText text={props.subheader} />\n        </h4>\n    );\n}\n\nSubheader.propTypes = {\n    subheader: PropTypes.object.isRequired\n};\n\nexport default Subheader;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Subtitle(props) {\n    return (\n        <h2>\n            <RichText text={props.subtitle} />\n        </h2>\n    );\n}\n\nSubtitle.propTypes = {\n    subtitle: PropTypes.object.isRequired\n};\n\nexport default Subtitle;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Title(props) {\n    return (\n        <h1>\n            <RichText text={props.title} />\n        </h1>\n    );\n}\n\nTitle.propTypes = {\n    title: PropTypes.object.isRequired\n};\n\nexport default Title;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Bold(props) {\n    return (\n        <b>\n            <RichText text={props.text} />\n        </b>\n    );\n}\n\nBold.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Bold;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction EmailAddress(props) {\n    return (\n        <a href={`mailto:${props.emailAddress}`}>\n            <RichText text={props.text} />\n        </a>\n    );\n}\n\nEmailAddress.propTypes = {\n    emailAddress: PropTypes.string.isRequired,\n    text: PropTypes.object.isRequired\n};\n\nexport default EmailAddress;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Fixed(props) {\n    return (\n        <code>\n            <RichText text={props.text} />\n        </code>\n    );\n}\n\nFixed.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Fixed;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getSrc } from '../../../Utils/File';\nimport FileStore from '../../../Stores/FileStore';\n\nclass Icon extends React.Component {\n    componentDidMount() {\n        FileStore.on('clientUpdateDocumentThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n        FileStore.on('clientUpdateDocumentBlob', this.onClientUpdateDocumentBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateDocumentThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n        FileStore.off('clientUpdateDocumentBlob', this.onClientUpdateDocumentBlob);\n    }\n\n    onClientUpdateDocumentThumbnailBlob = update => {\n        const { document } = this.props;\n        if (!document) return;\n\n        const { thumbnail } = document;\n        if (!thumbnail) return;\n\n        const { file } = thumbnail;\n        if (!file) return;\n\n        const { fileId } = update;\n\n        if (file.id !== fileId) {\n            return;\n        }\n\n        this.forceUpdate();\n    };\n\n    onClientUpdateDocumentBlob = update => {\n        const { document } = this.props;\n        if (!document) return;\n\n        const file = document.document;\n        if (!file) return;\n\n        const { fileId } = update;\n\n        if (file.id !== fileId) {\n            return;\n        }\n\n        this.forceUpdate();\n    };\n\n    emptyPlaceholderSrc(width, height) {\n        return `data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 ${width} ${height}\"%3E%3C/svg%3E`;\n    }\n\n    render() {\n        const { document, height, width } = this.props;\n        if (!document) return null;\n\n        const { thumbnail, document: file } = document;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const src = getSrc(file);\n\n        return (\n            <img\n                src={src || thumbnailSrc || this.emptyPlaceholderSrc(1, 1)}\n                width={width > 0 ? width : null}\n                height={height > 0 ? height : null}\n                draggable={false}\n                alt=''\n            />\n        );\n    }\n}\n\nIcon.propTypes = {\n    document: PropTypes.object.isRequired,\n    height: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired\n};\n\nexport default Icon;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Italic(props) {\n    return (\n        <i>\n            <RichText text={props.text} />\n        </i>\n    );\n}\n\nItalic.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Italic;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Marked(props) {\n    return (\n        <mark>\n            <RichText text={props.text} />\n        </mark>\n    );\n}\n\nMarked.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Marked;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction PhoneNumber(props) {\n    return (\n        <a href={`tel:${props.phoneNumber}`}>\n            <RichText text={props.text} />\n        </a>\n    );\n}\n\nPhoneNumber.propTypes = {\n    phoneNumber: PropTypes.string.isRequired,\n    text: PropTypes.object.isRequired\n};\n\nexport default PhoneNumber;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction Plain(props) {\n    return props.text;\n}\n\nPlain.propTypes = {\n    text: PropTypes.string.isRequired\n};\n\nexport default Plain;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Strikethrough(props) {\n    return (\n        <del>\n            <RichText text={props.text} />\n        </del>\n    );\n}\n\nStrikethrough.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Strikethrough;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Subscript(props) {\n    return (\n        <sub>\n            <RichText text={props.text} />\n        </sub>\n    );\n}\n\nSubscript.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Subscript;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Superscript(props) {\n    return (\n        <sup>\n            <RichText text={props.text} />\n        </sup>\n    );\n}\n\nSuperscript.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Superscript;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Anchor(props) {\n    const { name, text } = props;\n\n    return (\n        <a id={name}>\n            {text && <RichText text={text} />}\n        </a>\n    );\n}\n\nAnchor.propTypes = {\n    name: PropTypes.string.isRequired,\n    text: PropTypes.object\n};\n\nexport default Anchor;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Texts(props) {\n    return (\n        <>\n            {props.texts.map((x, index) => (\n                <RichText key={index} text={x} />\n            ))}\n        </>\n    );\n}\n\nTexts.propTypes = {\n    texts: PropTypes.arrayOf(PropTypes.object).isRequired\n};\n\nexport default Texts;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Underline(props) {\n    return (\n        <ins>\n            <RichText text={props.text} />\n        </ins>\n    );\n}\n\nUnderline.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Underline;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\nimport SafeLink from '../../Additional/SafeLink';\nimport TdLibController from '../../../Controllers/TdLibController';\n\nclass Url extends React.Component {\n    handleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { url } = this.props;\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateInstantViewUrl',\n            url\n        });\n    };\n\n    render() {\n        const { text, url } = this.props;\n\n        return (\n            <SafeLink url={url} onClick={this.handleClick}>\n                <RichText text={text} />\n            </SafeLink>\n        );\n    }\n}\n\nUrl.propTypes = {\n    text: PropTypes.object.isRequired,\n    url: PropTypes.string.isRequired\n};\n\nexport default Url;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport RichText from '../RichText/RichText';\nimport { getPageBlock, isEmptyText } from '../../../Utils/InstantView';\n\nfunction Table(props) {\n    const { caption, cells, isBordered, isStriped, iv } = props;\n\n    return (\n        <table striped={isStriped ? '' : null} border={isBordered ? 1 : 0}>\n            {!isEmptyText(caption) && (\n                <caption>\n                    <RichText text={caption} />\n                </caption>\n            )}\n            <tbody>\n                {cells.map((row, rowIndex) => {\n                    return <tr key={rowIndex}>{row.map((x, index) => getPageBlock(x, iv, index))}</tr>;\n                })}\n            </tbody>\n        </table>\n    );\n}\n\nTable.propTypes = {\n    caption: PropTypes.object.isRequired,\n    cells: PropTypes.array.isRequired,\n    isBordered: PropTypes.bool.isRequired,\n    isStriped: PropTypes.bool.isRequired\n};\n\nexport default withIV(Table);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\nimport { getHorizontalAlignment, getVerticalAlignment, isEmptyText } from '../../../Utils/InstantView';\n\nfunction TableCell(props) {\n    const { text, isHeader, colspan, rowspan, align, valign } = props;\n    if (isEmptyText(text)) return null;\n\n    const attributes = {\n        colSpan: colspan,\n        rowSpan: rowspan,\n        align: getHorizontalAlignment(align),\n        valign: getVerticalAlignment(valign)\n    };\n\n    const content = <RichText text={text} />;\n\n    return isHeader ? <th {...attributes}>{content}</th> : <td {...attributes}>{content}</td>;\n}\n\nTableCell.propTypes = {\n    text: PropTypes.object.isRequired,\n    isHeader: PropTypes.bool.isRequired,\n    colspan: PropTypes.number.isRequired,\n    rowspan: PropTypes.number.isRequired,\n    align: PropTypes.object.isRequired,\n    valign: PropTypes.object.isRequired\n};\n\nexport default TableCell;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Caption from './Caption';\nimport Location from '../../Message/Media/Location';\nimport { IV_LOCATION_HEIGHT, IV_LOCATION_WIDTH } from '../../../Constants';\n\nfunction Map(props) {\n    const { location, caption } = props;\n\n    return (\n        <figure>\n            <Location width={IV_LOCATION_WIDTH} height={IV_LOCATION_HEIGHT} location={location} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nMap.propTypes = {\n    location: PropTypes.object.isRequired,\n    zoom: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    caption: PropTypes.object.isRequired\n};\n\nexport default Map;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport MediaAudio from '../../Message/Media/Audio';\nimport Caption from './Caption';\n\nfunction Audio(props) {\n    const { audio, block, caption, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaAudio block={block} audio={audio} openMedia={openMedia} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nAudio.propTypes = {\n    block: PropTypes.object.isRequired,\n    audio: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Audio;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction ChatLink(props) {\n    return <div />;\n}\n\nChatLink.propTypes = {\n    title: PropTypes.string.isRequired,\n    photo: PropTypes.object,\n    username: PropTypes.string.isRequired\n};\n\nexport default ChatLink;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Caption from './Caption';\nimport MediaVideo from '../../../Components/Message/Media/Video';\nimport { IV_PHOTO_DISPLAY_SIZE } from '../../../Constants';\n\nfunction Video(props) {\n    const { video, caption, needAutoplay, isLooped, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaVideo video={video} displaySize={IV_PHOTO_DISPLAY_SIZE} openMedia={openMedia} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nVideo.propTypes = {\n    video: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    needAutoplay: PropTypes.bool.isRequired,\n    isLooped: PropTypes.bool.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Video;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport MediaVoiceNote from '../../Message/Media/VoiceNote';\nimport Caption from './Caption';\n\nfunction VoiceNote(props) {\n    const { voiceNote, block, caption, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaVoiceNote block={block} voiceNote={voiceNote} openMedia={openMedia} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nVoiceNote.propTypes = {\n    block: PropTypes.object.isRequired,\n    voiceNote: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default VoiceNote;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Anchor from '../Components/InstantView/Blocks/Anchor';\nimport Animation from '../Components/InstantView/Blocks/Animation';\nimport AuthorDate from '../Components/InstantView/Blocks/AuthorDate';\nimport BlockQuote from '../Components/InstantView/Blocks/Blockquote';\nimport Collage from '../Components/InstantView/Blocks/Collage';\nimport Cover from '../Components/InstantView/Blocks/Cover';\nimport Details from '../Components/InstantView/Blocks/Details';\nimport Divider from '../Components/InstantView/Blocks/Divider';\nimport Embedded from '../Components/InstantView/Blocks/Embedded';\nimport EmbeddedPost from '../Components/InstantView/Blocks/EmbeddedPost';\nimport ErrorHandler from '../Components/InstantView/Blocks/ErrorHandler';\nimport Footer from '../Components/InstantView/Blocks/Footer';\nimport Header from '../Components/InstantView/Blocks/Header';\nimport Kicker from '../Components/InstantView/Blocks/Kicker';\nimport List from '../Components/InstantView/Blocks/List';\nimport ListItem from '../Components/InstantView/Blocks/ListItem';\nimport Paragraph from '../Components/InstantView/Blocks/Paragraph';\nimport Photo from '../Components/InstantView/Blocks/Photo';\nimport Preformatted from '../Components/InstantView/Blocks/Preformatted';\nimport PullQuote from '../Components/InstantView/Blocks/PullQuote';\nimport RelatedArticle from '../Components/InstantView/Blocks/RelatedArticle';\nimport RelatedArticles from '../Components/InstantView/Blocks/RelatedArticles';\nimport Slideshow from '../Components/InstantView/Blocks/Slideshow';\nimport Subheader from '../Components/InstantView/Blocks/Subheader';\nimport Subtitle from '../Components/InstantView/Blocks/Subtitle';\nimport Title from '../Components/InstantView/Blocks/Title';\nimport Bold from '../Components/InstantView/RichText/Bold';\nimport EmailAddress from '../Components/InstantView/RichText/EmailAddress';\nimport Fixed from '../Components/InstantView/RichText/Fixed';\nimport Icon from '../Components/InstantView/RichText/Icon';\nimport Italic from '../Components/InstantView/RichText/Italic';\nimport Marked from '../Components/InstantView/RichText/Marked';\nimport PhoneNumber from '../Components/InstantView/RichText/PhoneNumber';\nimport Plain from '../Components/InstantView/RichText/Plain';\nimport Strikethrough from '../Components/InstantView/RichText/Strikethrough';\nimport Subscript from '../Components/InstantView/RichText/Subscript';\nimport Superscript from '../Components/InstantView/RichText/Superscript';\nimport TextAnchor from '../Components/InstantView/RichText/Anchor';\nimport Texts from '../Components/InstantView/RichText/Texts';\nimport Underline from '../Components/InstantView/RichText/Underline';\nimport Url from '../Components/InstantView/RichText/Url';\nimport Table from '../Components/InstantView/Blocks/Table';\nimport TableCell from '../Components/InstantView/Blocks/TableCell';\nimport Map from '../Components/InstantView/Blocks/Map';\nimport Audio from '../Components/InstantView/Blocks/Audio';\nimport ChatLink from '../Components/InstantView/Blocks/ChatLink';\nimport Video from '../Components/InstantView/Blocks/Video';\nimport VoiceNote from '../Components/InstantView/Blocks/VoiceNote';\nimport { download, supportsStreaming } from './File';\nimport { setInstantViewViewerContent } from '../Actions/Client';\nimport FileStore from '../Stores/FileStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function getBlockAudio(block) {\n    if (!block) return null;\n    if (block['@type'] !== 'pageBlockAudio') return null;\n\n    return block.audio;\n}\n\nexport function openInstantViewMedia(media, caption, block, instantView, fileCancel) {\n    // console.log('[IV] openIVMedia', media);\n\n    if (!media) return;\n\n    const chatId = 0;\n    const messageId = 0;\n\n    switch (media['@type']) {\n        case 'animation': {\n            let { animation: file } = media;\n            if (!file) return;\n\n            file = FileStore.get(file.id) || file;\n            if (fileCancel && file.local.is_downloading_active) {\n                FileStore.cancelGetRemoteFile(file.id, media);\n                return;\n            } else if (fileCancel && file.remote.is_uploading_active) {\n                FileStore.cancelUploadFile(file.id, media);\n                return;\n            } else {\n                download(file, media, () => FileStore.updateAnimationBlob(chatId, messageId, file.id));\n            }\n\n            setInstantViewViewerContent({\n                media,\n                caption,\n                block,\n                instantView\n            });\n            break;\n        }\n        case 'audio': {\n            let { audio: file } = media;\n            if (!file) return;\n\n            file = FileStore.get(file.id) || file;\n            if (fileCancel && file.local.is_downloading_active && !supportsStreaming()) {\n                FileStore.cancelGetRemoteFile(file.id, media);\n                return;\n            } else if (fileCancel && file.remote.is_uploading_active) {\n                FileStore.cancelUploadFile(file.id, media);\n                return;\n            } else {\n                if (!supportsStreaming()) {\n                    download(file, media, () => FileStore.updateAudioBlob(chatId, messageId, file.id));\n                }\n            }\n\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateMediaActive',\n                source: {\n                    '@type': 'instantViewSource',\n                    instantView,\n                    block\n                }\n            });\n            break;\n        }\n        case 'photo': {\n            setInstantViewViewerContent({\n                media,\n                caption,\n                block,\n                instantView\n            });\n            break;\n        }\n        case 'video': {\n            let { video: file } = media;\n            if (!file) return;\n\n            file = FileStore.get(file.id) || file;\n            if (fileCancel && file.local.is_downloading_active) {\n                FileStore.cancelGetRemoteFile(file.id, media);\n                return;\n            } else if (fileCancel && file.remote.is_uploading_active) {\n                FileStore.cancelUploadFile(file.id, media);\n                return;\n            } else {\n                download(file, media, () => FileStore.updateVideoBlob(chatId, messageId, file.id));\n            }\n\n            setInstantViewViewerContent({\n                media,\n                caption,\n                block,\n                instantView\n            });\n            break;\n        }\n        case 'voiceNote': {\n            let { voice: file } = media;\n            if (!file) return;\n\n            file = FileStore.get(file.id) || file;\n            if (fileCancel && file.local.is_downloading_active) {\n                FileStore.cancelGetRemoteFile(file.id, media);\n                return;\n            } else if (fileCancel && file.remote.is_uploading_active) {\n                FileStore.cancelUploadFile(file.id, media);\n                return;\n            } else {\n                download(file, media, () => FileStore.updateVoiceNoteBlob(chatId, messageId, file.id));\n            }\n\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateMediaActive',\n                source: {\n                    '@type': 'instantViewSource',\n                    instantView,\n                    block\n                }\n            });\n            break;\n        }\n    }\n}\n\nexport function getPageBlock(block, iv, key = undefined, ref = null) {\n    if (!block) return null;\n\n    let element = null;\n    switch (block['@type']) {\n        case 'pageBlockAnchor': {\n            element = <Anchor name={block.name} />;\n            break;\n        }\n        case 'pageBlockAnimation': {\n            element = (\n                <Animation\n                    block={block}\n                    caption={block.caption}\n                    animation={block.animation}\n                    needAutoplay={block.need_autoplay}\n                    openMedia={() => openInstantViewMedia(block.animation, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        case 'pageBlockAudio': {\n            element = (\n                <Audio\n                    block={block}\n                    caption={block.caption}\n                    audio={block.audio}\n                    openMedia={() => openInstantViewMedia(block.audio, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        case 'pageBlockAuthorDate': {\n            element = <AuthorDate author={block.author} publishDate={block.publish_date} />;\n            break;\n        }\n        case 'pageBlockBlockQuote': {\n            element = <BlockQuote credit={block.credit} text={block.text} />;\n            break;\n        }\n        case 'pageBlockCollage': {\n            element = <Collage pageBlocks={block.page_blocks} caption={block.caption} />;\n            break;\n        }\n        case 'pageBlockChatLink': {\n            element = <ChatLink title={block.title} photo={block.photo} username={block.username} />;\n            break;\n        }\n        case 'pageBlockCover': {\n            element = <Cover cover={block.cover} />;\n            break;\n        }\n        case 'pageBlockDetails': {\n            element = <Details header={block.header} pageBlocks={block.page_blocks} isOpen={block.is_open} />;\n            break;\n        }\n        case 'pageBlockDivider': {\n            element = <Divider />;\n            break;\n        }\n        case 'pageBlockEmbedded': {\n            element = (\n                <Embedded\n                    url={block.url}\n                    html={block.html}\n                    posterPhoto={block.poster_photo}\n                    width={block.width}\n                    height={block.height}\n                    caption={block.caption}\n                    isFullWidth={block.is_full_width}\n                    allowScrolling={block.allow_scrolling}\n                />\n            );\n            break;\n        }\n        case 'pageBlockEmbeddedPost': {\n            element = (\n                <EmbeddedPost\n                    url={block.url}\n                    author={block.author}\n                    authorPhoto={block.author_photo}\n                    date={block.date}\n                    pageBlocks={block.page_blocks}\n                    caption={block.caption}\n                />\n            );\n            break;\n        }\n        case 'pageBlockFooter': {\n            element = <Footer footer={block.footer} />;\n            break;\n        }\n        case 'pageBlockHeader': {\n            element = <Header header={block.header} />;\n            break;\n        }\n        case 'pageBlockKicker': {\n            element = <Kicker kicker={block.kicker} />;\n            break;\n        }\n        case 'pageBlockList': {\n            element = <List items={block.items} />;\n            break;\n        }\n        case 'pageBlockListItem': {\n            element = <ListItem label={block.label} pageBlocks={block.page_blocks} />;\n            break;\n        }\n        case 'pageBlockMap': {\n            element = (\n                <Map\n                    location={block.location}\n                    zoom={block.zoom}\n                    width={block.width}\n                    height={block.height}\n                    caption={block.caption}\n                />\n            );\n            break;\n        }\n        case 'pageBlockParagraph': {\n            element = <Paragraph text={block.text} />;\n            break;\n        }\n        case 'pageBlockPhoto': {\n            element = (\n                <Photo\n                    caption={block.caption}\n                    photo={block.photo}\n                    url={block.url}\n                    openMedia={() => openInstantViewMedia(block.photo, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        case 'pageBlockPreformatted': {\n            element = <Preformatted text={block.text} language={block.language} />;\n            break;\n        }\n        case 'pageBlockPullQuote': {\n            element = <PullQuote credit={block.credit} text={block.text} />;\n            break;\n        }\n        case 'pageBlockRelatedArticle': {\n            element = (\n                <RelatedArticle\n                    url={block.url}\n                    title={block.title}\n                    description={block.description}\n                    photo={block.photo}\n                    author={block.author}\n                    publishDate={block.publish_date}\n                />\n            );\n            break;\n        }\n        case 'pageBlockRelatedArticles': {\n            element = <RelatedArticles header={block.header} articles={block.articles} />;\n            break;\n        }\n        case 'pageBlockSlideshow': {\n            element = <Slideshow pageBlocks={block.page_blocks} caption={block.caption} />;\n            break;\n        }\n        case 'pageBlockSubheader': {\n            element = <Subheader subheader={block.subheader} />;\n            break;\n        }\n        case 'pageBlockSubtitle': {\n            element = <Subtitle subtitle={block.subtitle} />;\n            break;\n        }\n        case 'pageBlockTable': {\n            element = (\n                <Table\n                    caption={block.caption}\n                    cells={block.cells}\n                    isBordered={block.is_bordered}\n                    isStriped={block.is_striped}\n                />\n            );\n            break;\n        }\n        case 'pageBlockTableCell': {\n            element = (\n                <TableCell\n                    text={block.text}\n                    isHeader={block.is_header}\n                    colspan={block.colspan}\n                    rowspan={block.rowspan}\n                    align={block.align}\n                    valign={block.valign}\n                />\n            );\n            break;\n        }\n        case 'pageBlockTitle': {\n            element = <Title title={block.title} />;\n            break;\n        }\n        case 'pageBlockVideo': {\n            element = (\n                <Video\n                    block={block}\n                    caption={block.caption}\n                    video={block.video}\n                    needAutoplay={block.need_autoplay}\n                    isLooped={block.is_looped}\n                    openMedia={() => openInstantViewMedia(block.video, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        case 'pageBlockVoiceNote': {\n            element = (\n                <VoiceNote\n                    block={block}\n                    caption={block.caption}\n                    voiceNote={block.voice_note}\n                    openMedia={() => openInstantViewMedia(block.voice_note, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        default: {\n            element = <div>{`[${block['@type']}]`}</div>;\n            break;\n        }\n    }\n\n    return <ErrorHandler key={key} ref={ref}>{element}</ErrorHandler>;\n}\n\nexport function getRichText(richText) {\n    if (!richText) {\n        return null;\n    }\n\n    if (richText instanceof String) {\n        return richText;\n    }\n\n    switch (richText['@type']) {\n        case 'richTextAnchor': {\n            const { name, text } = richText;\n\n            return <TextAnchor text={text} name={name} />;\n        }\n        case 'richTextBold': {\n            const { text } = richText;\n\n            return <Bold text={text} />;\n        }\n        case 'richTextEmailAddress': {\n            const { email_address, text } = richText;\n\n            return <EmailAddress emailAddress={email_address} text={text} />;\n        }\n        case 'richTextFixed': {\n            const { text } = richText;\n\n            return <Fixed text={text} />;\n        }\n        case 'richTextIcon': {\n            const { document, height, width } = richText;\n\n            return <Icon document={document} height={height} width={width} />;\n        }\n        case 'richTextItalic': {\n            const { text } = richText;\n\n            return <Italic text={text} />;\n        }\n        case 'richTextMarked': {\n            const { text } = richText;\n\n            return <Marked text={text} />;\n        }\n        case 'richTextPhoneNumber': {\n            const { phone_number, text } = richText;\n\n            return <PhoneNumber phoneNumber={phone_number} text={text} />;\n        }\n        case 'richTextPlain': {\n            const { text } = richText;\n\n            return <Plain text={text} />;\n        }\n        case 'richTextStrikethrough': {\n            const { text } = richText;\n\n            return <Strikethrough text={text} />;\n        }\n        case 'richTextSubscript': {\n            const { text } = richText;\n\n            return <Subscript text={text} />;\n        }\n        case 'richTextSuperscript': {\n            const { text } = richText;\n\n            return <Superscript text={text} />;\n        }\n        case 'richTexts': {\n            const { texts } = richText;\n\n            return <Texts texts={texts} />;\n        }\n        case 'richTextUnderline': {\n            const { text } = richText;\n\n            return <Underline text={text} />;\n        }\n        case 'richTextUrl': {\n            const { text, url } = richText;\n\n            return <Url text={text} url={url} />;\n        }\n    }\n\n    return `[${richText['@type']}]`;\n}\n\nexport function isEmptyText(richText) {\n    if (!richText) return true;\n\n    switch (richText['@type']) {\n        case 'richTextAnchor': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextBold': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextEmailAddress': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextFixed': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextIcon': {\n            return false;\n        }\n        case 'richTextItalic': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextMarked': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextPhoneNumber': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextPlain': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextStrikethrough': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextSubscript': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextSuperscript': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTexts': {\n            const { texts } = richText;\n\n            return texts.every(isEmptyText);\n        }\n        case 'richTextUnderline': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextUrl': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n    }\n\n    return false;\n}\n\nexport function getHorizontalAlignment(align) {\n    if (!align) return null;\n\n    switch (align['@type']) {\n        case 'pageBlockHorizontalAlignmentCenter': {\n            return 'center';\n        }\n        case 'pageBlockHorizontalAlignmentLeft': {\n            return 'left';\n        }\n        case 'pageBlockHorizontalAlignmentRight': {\n            return 'right';\n        }\n    }\n\n    return null;\n}\n\nexport function getVerticalAlignment(valign) {\n    if (!valign) return null;\n\n    switch (valign['@type']) {\n        case 'pageBlockVerticalAlignmentBottom': {\n            return 'bottom';\n        }\n        case 'pageBlockVerticalAlignmentMiddle': {\n            return 'middle';\n        }\n        case 'pageBlockVerticalAlignmentTop': {\n            return 'top';\n        }\n    }\n\n    return null;\n}\n\nexport function getInnerBlocks(block) {\n    if (!block) return [];\n\n    switch (block['@type']) {\n        case 'pageBlockAnchor': {\n            return [];\n        }\n        case 'pageBlockAnimation': {\n            return [block.caption];\n        }\n        case 'pageBlockAudio': {\n            return [block.caption];\n        }\n        case 'pageBlockAuthorDate': {\n            return [];\n        }\n        case 'pageBlockBlockQuote': {\n            return [];\n        }\n        case 'pageBlockChatLink': {\n            return [];\n        }\n        case 'pageBlockCollage': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([], innerBlocks);\n        }\n        case 'pageBlockCover': {\n            return [block.cover];\n        }\n        case 'pageBlockDetails': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([], innerBlocks);\n        }\n        case 'pageBlockDivider': {\n            return [];\n        }\n        case 'pageBlockEmbedded': {\n            return [block.caption];\n        }\n        case 'pageBlockEmbeddedPost': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([block.caption], innerBlocks);\n        }\n        case 'pageBlockFooter': {\n            return [];\n        }\n        case 'pageBlockHeader': {\n            return [];\n        }\n        case 'pageBlockKicker': {\n            return [];\n        }\n        case 'pageBlockList': {\n            const innerBlocks = block.items.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([], innerBlocks);\n        }\n        case 'pageBlockListItem': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([], innerBlocks);\n        }\n        case 'pageBlockMap': {\n            return [block.caption];\n        }\n        case 'pageBlockParagraph': {\n            return [];\n        }\n        case 'pageBlockPhoto': {\n            return [block.caption];\n        }\n        case 'pageBlockPreformatted': {\n            return [];\n        }\n        case 'pageBlockPullQuote': {\n            return [];\n        }\n        case 'pageBlockRelatedArticle': {\n            return [];\n        }\n        case 'pageBlockRelatedArticles': {\n            return [...block.articles];\n        }\n        case 'pageBlockSlideshow': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([block.caption], innerBlocks);\n        }\n        case 'pageBlockSubheader': {\n            return [];\n        }\n        case 'pageBlockSubtitle': {\n            return [];\n        }\n        case 'pageBlockTable': {\n            return [...block.cells];\n        }\n        case 'pageBlockTableCell': {\n            return [];\n        }\n        case 'pageBlockTitle': {\n            return [];\n        }\n        case 'pageBlockVideo': {\n            return [block.caption];\n        }\n    }\n\n    return [];\n}\n\nexport function getBlockMedia(block) {\n    if (!block) return null;\n\n    switch (block['@type']) {\n        case 'pageBlockAnimation': {\n            return block.animation;\n        }\n        case 'pageBlockPhoto': {\n            return block.photo;\n        }\n        case 'pageBlockVideo': {\n            return block.video;\n        }\n    }\n\n    return null;\n}\n\nexport function getBlockCaption(block) {\n    if (!block) return null;\n\n    switch (block['@type']) {\n        case 'pageBlockAnimation': {\n            return block.caption;\n        }\n        case 'pageBlockPhoto': {\n            return block.caption;\n        }\n        case 'pageBlockVideo': {\n            return block.caption;\n        }\n    }\n\n    return null;\n}\n\nexport function getBlockUrl(block) {\n    if (!block) return null;\n\n    switch (block['@type']) {\n        case 'pageBlockPhoto': {\n            return block.url;\n        }\n    }\n\n    return null;\n}\n\nexport function isValidMediaBlock(block) {\n    if (!block) return false;\n\n    switch (block['@type']) {\n        case 'pageBlockAnimation': {\n            return true;\n        }\n        case 'pageBlockPhoto': {\n            return true;\n        }\n        case 'pageBlockVideo': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isValidAudioBlock(block) {\n    if (!block) return false;\n\n    return block['@type'] === 'pageBlockAudio';\n}\n\nexport function isValidVoiceNoteBlock(block) {\n    if (!block) return false;\n\n    return block['@type'] === 'pageBlockVoiceNote';\n}\n\nexport function getValidBlocks(iv, func) {\n    if (!iv) return [];\n\n    const { page_blocks } = iv;\n\n    const blocks = [];\n    page_blocks.forEach(x => {\n        blocks.push(x);\n        const innerBlocks = getInnerBlocks(x);\n        innerBlocks.forEach(i => {\n            blocks.push(i);\n        });\n    });\n\n    return blocks.filter(func);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/*\n * Date Format 1.2.3\n * (c) 2007-2009 Steven Levithan <stevenlevithan.com>\n * MIT license\n *\n * Includes enhancements by Scott Trenda <scott.trenda.net>\n * and Kris Kowal <cixar.com/~kris.kowal/>\n *\n * Accepts a date, a mask, or a date and a mask.\n * Returns a formatted version of the given date.\n * The date defaults to the current date/time.\n * The mask defaults to dateFormat.masks.default.\n */\n\nconst dateFormat = (function() {\n    const token = /d{1,4}|M{1,4}|yy(?:yy)?|([HhmsAa])\\1?|[LloSZWN]|\"[^\"]*\"|'[^']*'/g;\n    const timezone = /\\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\\d{4})?)\\b/g;\n    const timezoneClip = /[^-+\\dA-Z]/g;\n\n    // Regexes and supporting functions are cached through closure\n    return function(date, mask, utc, gmt) {\n        // You can't provide utc if you skip other args (use the 'UTC:' mask prefix)\n        if (arguments.length === 1 && kindOf(date) === 'string' && !/\\d/.test(date)) {\n            mask = date;\n            date = undefined;\n        }\n\n        date = date || new Date();\n\n        if (!(date instanceof Date)) {\n            date = new Date(date);\n        }\n\n        if (isNaN(date)) {\n            throw TypeError('Invalid date');\n        }\n\n        mask = String(dateFormat.masks[mask] || mask || dateFormat.masks['default']);\n\n        // Allow setting the utc/gmt argument via the mask\n        var maskSlice = mask.slice(0, 4);\n        if (maskSlice === 'UTC:' || maskSlice === 'GMT:') {\n            mask = mask.slice(4);\n            utc = true;\n            if (maskSlice === 'GMT:') {\n                gmt = true;\n            }\n        }\n\n        var _ = utc ? 'getUTC' : 'get';\n        var d = date[_ + 'Date']();\n        var D = date[_ + 'Day']();\n        var M = date[_ + 'Month']();\n        var y = date[_ + 'FullYear']();\n        var H = date[_ + 'Hours']();\n        var m = date[_ + 'Minutes']();\n        var s = date[_ + 'Seconds']();\n        var L = date[_ + 'Milliseconds']();\n        var o = utc ? 0 : date.getTimezoneOffset();\n        var W = getWeek(date);\n        var N = getDayOfWeek(date);\n        var flags = {\n            d: d,\n            dd: pad(d),\n            ddd: dateFormat.i18n.dayNames[D],\n            dddd: dateFormat.i18n.dayNames[D + 7],\n            M: M + 1,\n            MM: pad(M + 1),\n            MMM: dateFormat.i18n.monthNames[M],\n            MMMM: dateFormat.i18n.monthNames[M + 12],\n            yy: String(y).slice(2),\n            yyyy: y,\n            h: H % 12 || 12,\n            hh: pad(H % 12 || 12),\n            H: H,\n            HH: pad(H),\n            m: m,\n            mm: pad(m),\n            s: s,\n            ss: pad(s),\n            l: pad(L, 3),\n            L: pad(Math.round(L / 10)),\n            a: H < 12 ? dateFormat.i18n.timeNames[0] : dateFormat.i18n.timeNames[1],\n            aa: H < 12 ? dateFormat.i18n.timeNames[2] : dateFormat.i18n.timeNames[3],\n            A: H < 12 ? dateFormat.i18n.timeNames[4] : dateFormat.i18n.timeNames[5],\n            AA: H < 12 ? dateFormat.i18n.timeNames[6] : dateFormat.i18n.timeNames[7],\n            Z: gmt ? 'GMT' : utc ? 'UTC' : (String(date).match(timezone) || ['']).pop().replace(timezoneClip, ''),\n            o: (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + (Math.abs(o) % 60), 4),\n            S: ['th', 'st', 'nd', 'rd'][d % 10 > 3 ? 0 : (((d % 100) - (d % 10) != 10) * d) % 10],\n            W: W,\n            N: N\n        };\n\n        return mask.replace(token, function(match) {\n            if (match in flags) {\n                return flags[match];\n            }\n            return match.slice(1, match.length - 1);\n        });\n    };\n})();\n\ndateFormat.masks = {\n    default: 'ddd MMM dd yyyy HH:mm:ss',\n    shortDate: 'M/d/yy',\n    mediumDate: 'MMM d, yyyy',\n    longDate: 'MMMM d, yyyy',\n    fullDate: 'dddd, MMMM d, yyyy',\n    shortTime: 'h:mm AA',\n    mediumTime: 'h:mm:ss AA',\n    longTime: 'h:mm:ss AA Z',\n    isoDate: 'yyyy-MM-dd',\n    isoTime: 'HH:mm:ss',\n    isoDateTime: \"yyyy-MM-dd'T'HH:mm:sso\",\n    isoUtcDateTime: \"UTC:yyyy-MM-dd'T'HH:mm:ss'Z'\",\n    expiresHeaderFormat: 'ddd, dd MMM yyyy HH:mm:ss Z'\n};\n\n// Internationalization strings\ndateFormat.i18n = {\n    dayNames: [\n        'Sun',\n        'Mon',\n        'Tue',\n        'Wed',\n        'Thu',\n        'Fri',\n        'Sat',\n        'Sunday',\n        'Monday',\n        'Tuesday',\n        'Wednesday',\n        'Thursday',\n        'Friday',\n        'Saturday'\n    ],\n    monthNames: [\n        'Jan',\n        'Feb',\n        'Mar',\n        'Apr',\n        'May',\n        'Jun',\n        'Jul',\n        'Aug',\n        'Sep',\n        'Oct',\n        'Nov',\n        'Dec',\n        'January',\n        'February',\n        'March',\n        'April',\n        'May',\n        'June',\n        'July',\n        'August',\n        'September',\n        'October',\n        'November',\n        'December'\n    ],\n    timeNames: ['AM', 'PM', 'AM', 'PM', 'AM', 'PM', 'AM', 'PM']\n};\n\nfunction pad(val, len) {\n    val = String(val);\n    len = len || 2;\n    while (val.length < len) {\n        val = '0' + val;\n    }\n    return val;\n}\n\n/**\n * Get the ISO 8601 week number\n * Based on comments from\n * http://techblog.procurios.nl/k/n618/news/view/33796/14863/Calculate-ISO-8601-week-and-year-in-javascript.html\n *\n * @param  {Object} `date`\n * @return {Number}\n */\nfunction getWeek(date) {\n    // Remove time components of date\n    var targetThursday = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\n    // Change date to Thursday same week\n    targetThursday.setDate(targetThursday.getDate() - ((targetThursday.getDay() + 6) % 7) + 3);\n\n    // Take January 4th as it is always in week 1 (see ISO 8601)\n    var firstThursday = new Date(targetThursday.getFullYear(), 0, 4);\n\n    // Change date to Thursday same week\n    firstThursday.setDate(firstThursday.getDate() - ((firstThursday.getDay() + 6) % 7) + 3);\n\n    // Check if daylight-saving-time-switch occurred and correct for it\n    var ds = targetThursday.getTimezoneOffset() - firstThursday.getTimezoneOffset();\n    targetThursday.setHours(targetThursday.getHours() - ds);\n\n    // Number of weeks between target Thursday and first Thursday\n    var weekDiff = (targetThursday - firstThursday) / (86400000 * 7);\n    return 1 + Math.floor(weekDiff);\n}\n\n/**\n * Get ISO-8601 numeric representation of the day of the week\n * 1 (for Monday) through 7 (for Sunday)\n *\n * @param  {Object} `date`\n * @return {Number}\n */\nfunction getDayOfWeek(date) {\n    var dow = date.getDay();\n    if (dow === 0) {\n        dow = 7;\n    }\n    return dow;\n}\n\n/**\n * kind-of shortcut\n * @param  {*} val\n * @return {String}\n */\nfunction kindOf(val) {\n    if (val === null) {\n        return 'null';\n    }\n\n    if (val === undefined) {\n        return 'undefined';\n    }\n\n    if (typeof val !== 'object') {\n        return typeof val;\n    }\n\n    if (Array.isArray(val)) {\n        return 'array';\n    }\n\n    return {}.toString\n        .call(val)\n        .slice(8, -1)\n        .toLowerCase();\n}\n\nexport default dateFormat;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// changes ssrcs\nimport CallStore, { LOG_CALL } from '../Stores/CallStore';\n\nexport function getTransport(joinResponse) {\n    const { payload, candidates } = joinResponse;\n\n    const { ufrag, pwd, fingerprints } = payload;\n\n    return {\n        ufrag,\n        pwd,\n        fingerprints,\n        candidates\n    };\n}\n\nexport function mergeSsrcs(ssrcs, newSsrcs) {\n    let res = false;\n    let has = (ssrcs, needle) => {\n        for (let entry of ssrcs) {\n            if (entry.ssrc === needle.ssrc) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    // remove old ssrcs\n    for (let ssrc of ssrcs) {\n        if (!ssrc.isRemoved && !has(newSsrcs, ssrc)) {\n            console.log(`ssrc REMOVE ${ssrc.name} ${ssrc.ssrc}`, ssrc);\n            ssrc.isRemoved = true;\n            res = true;\n        }\n    }\n\n    // add Main ssrc\n    for (let ssrc of newSsrcs) {\n        if (ssrc.isMain && !has(ssrcs, ssrc)) {\n            console.log(`ssrc ADD ${ssrc.name} ${ssrc.ssrc}`, ssrc);\n            ssrcs.push(ssrc);\n            res = true;\n        }\n    }\n\n    // add new ssrc\n    for (let ssrc of newSsrcs) {\n        if (!has(ssrcs, ssrc)) {\n            console.log(`ssrc ADD ${ssrc.name} ${ssrc.ssrc}`, ssrc);\n            ssrcs.push(ssrc);\n            res = true;\n        }\n    }\n    return res;\n}\n\nexport function parseSdp(sdp) {\n    let lines = sdp.split(\"\\r\\n\");\n    let lookup = (prefix, force = true) => {\n        for (let line of lines) {\n            if (line.startsWith(prefix)) {\n                return line.substr(prefix.length);\n            }\n        }\n        if (force) {\n            console.error(\"Can't find prefix\", prefix);\n        }\n        return null;\n    };\n\n    let info = {\n        // transport\n        fingerprint: lookup(\"a=fingerprint:\").split(\" \")[1],\n        hash: lookup(\"a=fingerprint:\").split(\" \")[0],\n        setup: lookup(\"a=setup:\"),\n        pwd: lookup(\"a=ice-pwd:\"),\n        ufrag: lookup(\"a=ice-ufrag:\"),\n    };\n    let rawSource = lookup(\"a=ssrc:\", false);\n    if (rawSource) {\n        info.source = parseInt(rawSource.split(\" \")[0]);\n    }\n    return info;\n}\n\nexport async function getStream(constraints, muted) {\n    const stream = await navigator.mediaDevices.getUserMedia (constraints);\n    stream.getTracks().forEach(x => {\n        x.onmute = x => {\n            LOG_CALL('track.onmute', x);\n        };\n        x.onunmute = x => {\n            LOG_CALL('track.onunmute', x);\n        };\n\n        x.enabled = !muted;\n    });\n\n    LOG_CALL('getStream result', stream);\n    return stream;\n}\n\n/// NOTE: telegram returns sign source, while webrtc uses unsign source internally\n/// unsign => sign\nexport function toTelegramSource(source) {\n    return source << 0;\n}\n\n/// NOTE: telegram returns sign source, while webrtc uses unsign source internally\n/// sign => unsign\nexport function fromTelegramSource(source) {\n    return source >>> 0;\n}\n\nexport function getCallStatus(call) {\n    let connected = false;\n    let status = '';\n    if (call) {\n        const { groupCallId, connection } = call;\n        const groupCall = CallStore.get(groupCallId);\n        if (groupCall) {\n            if (!groupCall.can_unmute_self) {\n                status = 'forceMuted';\n            } else {\n                status = !CallStore.isMuted() ? 'unmuted' : 'muted';\n            }\n        }\n        connected = connection && connection.iceConnectionState !== 'new' && connection.iceConnectionState !== 'connecting' && connection.iceConnectionState !== 'checking';\n    }\n\n    return { connected, status };\n}\n\nexport function getAmplitude(array, scale = 3) {\n    if (!array) return 0;\n\n    const { length } = array;\n    let total = 0;\n    for (let i = 0; i < length; i++) {\n        total += array[i] * array[i];\n    }\n    const rms = Math.sqrt(total / length) / 255;\n\n    return Math.min(1, rms * scale);\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport { getDisplayName } from '../../Utils/HOC';\n\nconst IVContext = React.createContext(null);\n\nexport default IVContext;\n\nexport function withIV(Component) {\n    class IVComponent extends React.Component {\n        render() {\n            return <IVContext.Consumer>{value => <Component iv={value} {...this.props} />}</IVContext.Consumer>;\n        }\n    }\n    IVComponent.displayName = `WithIV(${getDisplayName(Component)})`;\n\n    return IVComponent;\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\n\nexport function compose(...funcs) {\n    return funcs.reduce((a, b) => (...args) => a(b(...args)), arg => arg);\n}\n\nexport function withSaveRef() {\n    return Component => {\n        return React.forwardRef((props, ref) => <Component {...props} forwardedRef={ref} />);\n    };\n}\n\nexport function withRestoreRef() {\n    return Component => {\n        return class extends React.Component {\n            render() {\n                const { forwardedRef, ...rest } = this.props;\n\n                return <Component {...rest} ref={forwardedRef} />;\n            }\n        };\n    };\n}\n\nexport function getDisplayName(WrappedComponent) {\n    return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass BasicGroupStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n        this.fullInfoItems = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateBasicGroup': {\n                this.set(update.basic_group);\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'updateBasicGroupFullInfo': {\n                this.setFullInfo(update.basic_group_id, update.basic_group_full_info);\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {};\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    get(groupId) {\n        return this.items.get(groupId);\n    }\n\n    set(group) {\n        this.items.set(group.id, group);\n    }\n\n    getFullInfo(id) {\n        return this.fullInfoItems.get(id);\n    }\n\n    setFullInfo(id, fullInfo) {\n        this.fullInfoItems.set(id, fullInfo);\n    }\n}\n\nconst store = new BasicGroupStore();\nwindow.basicgroup = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport ModalManager from '@material-ui/core/Modal/ModalManager';\n\nconst modalManager = new ModalManager();\n\nexport { modalManager };","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nfunction toAudioSsrc(ssrc) {\n    if (ssrc.isMain) {\n        return \"0\";\n    }\n    return `audio${ssrc.ssrc}`;\n}\n\nexport class SdpBuilder {\n    #lines = [];\n    #newLine = [];\n\n    add(line) {\n        this.#lines.push(line);\n        return this;\n    }\n    push(word) {\n        this.#newLine.push(word);\n        return this;\n    }\n    addJoined(separator = \"\") {\n        this.add(this.#newLine.join(separator));\n        this.#newLine = [];\n        return this;\n    }\n\n    get lines() {\n        return this.#lines;\n    }\n\n    join() {\n        return this.#lines.join(\"\\n\");\n    }\n\n    finalize() {\n        return this.join() + \"\\n\";\n    }\n\n    addCandidate(c) {\n        this.push(\"a=candidate:\");\n        this.push(\n            `${c.foundation} ${c.component} ${c.protocol} ${c.priority} ${c.ip} ${c.port} typ ${c.type}`\n        );\n        if (\"rel-addr\" in c) {\n            this.push(` raddr ${c[\"rel-addr\"]} rport ${c[\"rel-port\"]}`);\n        }\n        this.push(` generation ${c.generation}`);\n        this.addJoined();\n        return this;\n    }\n\n    addHeader(sessionId, transport, ssrcs) {\n        this.add(\"v=0\"); // version\n        this.add(`o=- ${sessionId} 2 IN IP4 0.0.0.0`); // sessionId, 2=sesionVersion\n        this.add(\"s=-\"); // name of the session\n        // this.add(\"c=IN IP4 0.0.0.0\");\n        this.add(\"t=0 0\"); // time when session is valid\n        this.add(`a=group:BUNDLE ${ssrcs.map(toAudioSsrc).join(\" \")}`);\n        this.add(\"a=ice-lite\"); // ice-lite: is a minimal version of the ICE specification, intended for servers running on a public IP address.\n        // this.add(`a=ice-ufrag:${transport.ufrag}`);\n        // this.add(`a=ice-pwd:${transport.pwd}`);\n        // for (let fingerprint of transport.fingerprints) {\n        //     this.add(`a=fingerprint:${fingerprint.hash} ${fingerprint.fingerprint}`);\n        //     //this.add(`a=setup:${fingerprint.setup}`);\n        //     this.add(`a=setup:passive`);\n        // }\n\n        return this;\n    }\n\n    addTransport(transport) {\n        this.add(`a=ice-ufrag:${transport.ufrag}`);\n        this.add(`a=ice-pwd:${transport.pwd}`);\n        for (let fingerprint of transport.fingerprints) {\n            this.add(`a=fingerprint:${fingerprint.hash} ${fingerprint.fingerprint}`);\n            //this.add(`a=setup:${fingerprint.setup}`);\n            this.add(`a=setup:passive`);\n        }\n        const { candidates } = transport;\n        for (let candidate of candidates) {\n            this.addCandidate(candidate);\n        }\n        return this;\n    }\n\n    addSsrcEntry(entry, transport, isAnswer) {\n        let add = (x) => this.add(x);\n        let ssrc = entry.ssrc;\n        // TODO: port = 0 or 1\n        add(`m=audio ${entry.isMain ? 1 : 0} RTP/SAVPF 111 126`);\n        if (true || entry.isMain) {\n            add(\"c=IN IP4 0.0.0.0\");\n        }\n        add(`a=mid:${toAudioSsrc(entry)}`);\n        if (entry.isRemoved) {\n            add(\"a=inactive\");\n            return;\n        }\n\n        if (true || entry.isMain) {\n            this.addTransport(transport);\n        }\n\n        add(\"a=rtpmap:111 opus/48000/2\");\n        add(\"a=rtpmap:126 telephone-event/8000\");\n        add(\"a=fmtp:111 minptime=10; useinbandfec=1; usedtx=1\");\n        add(\"a=rtcp:1 IN IP4 0.0.0.0\");\n        add(\"a=rtcp-mux\");\n        add(\"a=rtcp-fb:111 transport-cc\");\n        add(\"a=extmap:1 urn:ietf:params:rtp-hdrext:ssrc-audio-level\");\n        // add(\n        //     \"a=extmap:3 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\"\n        // );\n        // add(\n        //     \"a=extmap:5 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\"\n        // );\n        if (isAnswer) {\n            add(\"a=recvonly\");\n            return this;\n        }\n        if (entry.isMain) {\n            add(\"a=sendrecv\");\n        } else {\n            add(\"a=sendonly\");\n            add(\"a=bundle-only\");\n        }\n        add(`a=ssrc-group:FID ${ssrc}`);\n        add(`a=ssrc:${ssrc} cname:stream${ssrc}`);\n        add(`a=ssrc:${ssrc} msid:stream${ssrc} audio${ssrc}`);\n        add(`a=ssrc:${ssrc} mslabel:audio${ssrc}`);\n        add(`a=ssrc:${ssrc} label:audio${ssrc}`);\n        return this;\n    }\n\n    addConference(conference, isAnswer = false) {\n        let ssrcs = conference.ssrcs;\n        if (isAnswer) {\n            for (let ssrc of ssrcs) {\n                if (ssrc.isMain) {\n                    ssrcs = [ssrc];\n                    break;\n                }\n            }\n        }\n\n        this.addHeader(conference.sessionId, conference.transport, ssrcs);\n        for (let entry of ssrcs) {\n            this.addSsrcEntry(entry, conference.transport, isAnswer);\n        }\n        return this;\n    }\n\n    static fromConference(conference, isAnswer = false) {\n        return new SdpBuilder().addConference(conference, isAnswer).finalize();\n    }\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { SdpBuilder } from './SdpBuilder';\nimport { mergeSsrcs } from './Utils';\n\nexport default class LocalConferenceDescription {\n    #sessionId;\n    #transport;\n    #ssrcs = [];\n\n    onSsrcs;\n\n    constructor() {\n        this.#sessionId = Date.now();\n    }\n\n    updateFromServer(data) {\n        if (data.transport) {\n            this.#transport = data.transport;\n        }\n        if (mergeSsrcs(this.#ssrcs, data.ssrcs) && this.onSsrcs) {\n            this.onSsrcs(this.#ssrcs);\n        }\n    }\n\n    generateSdp(isAnswer = false) {\n        return SdpBuilder.fromConference(\n            {\n                sessionId: this.#sessionId,\n                transport: this.#transport,\n                ssrcs: this.#ssrcs,\n            },\n            isAnswer\n        );\n    }\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { getAmplitude } from './Utils';\nimport { LOG_CALL } from '../Stores/CallStore';\nimport { GROUP_CALL_AMPLITUDE_ANALYSE_COUNT_MAX } from '../Constants';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport default class StreamManager {\n    constructor(interval) {\n        this.context = new (window.AudioContext || window.webkitAudioContext)();\n        this.interval = interval;\n        this.timer = null;\n\n        this.items = [];\n        this.outputStream = new MediaStream();\n        this.inputStream = null;\n        this.counter = 0;\n    }\n\n    addTrack(stream, type) {\n        if (!stream) return;\n\n        const tracks = stream.getAudioTracks();\n        if (!tracks.length) return;\n\n        const track = tracks[0];\n        LOG_CALL('[manager] addTrack', type, track, stream);\n        if (!track) return;\n\n        const { context, items, inputStream, outputStream } = this;\n\n        // add analyser\n        const source = type === 'input' ? stream.id : Number(stream.id.substring(6));\n        const streamSource = context.createMediaStreamSource(stream);\n        const analyser = context.createAnalyser();\n        const gain = context.createGain();\n        const streamDestination = context.createMediaStreamDestination();\n\n        track.e = source;\n        track.onended = () => {\n            // LOG_CALL('[manager] track.onended');\n            this.removeTrack(track);\n        };\n\n        analyser.minDecibels = -100;\n        analyser.maxDecibels = -30;\n        analyser.smoothingTimeConstant = 0.05;\n        analyser.fftSize = 1024;\n\n        // connect Web Audio API\n        streamSource.connect(analyser);\n        // analyser.connect(context.destination);\n\n        // this.removeTrack(track);\n        switch (type) {\n            case 'input': {\n                if (!inputStream) {\n                    this.inputStream = stream;\n                } else {\n                    this.inputStream.addTrack(track);\n                }\n                break;\n            }\n            case 'output': {\n                for (let i = 0; i < items.length; i++) {\n                    const { track: t, type } = items[i];\n                    if (t.e === source && type === 'input') {\n                        items.splice(i, 1);\n                        outputStream.removeTrack(t);\n                        break;\n                    }\n                }\n\n                outputStream.addTrack(track);\n                break;\n            }\n        }\n\n        items.push({\n            type,\n            source,\n            stream,\n            track,\n            streamSource,\n            analyser,\n            gain\n        });\n\n        this.changeTimer();\n    }\n\n    removeTrack(track) {\n        // LOG_CALL('[manager] removeTrack', track);\n        if (!track) return;\n\n        const { items, inputStream, outputStream } = this;\n\n        let handled = false;\n        for (let i = 0; i < items.length && !handled; i++) {\n            const { track: t, type } = items[i];\n            switch (type) {\n                case 'output': {\n                    if (t === track) {\n                        items.splice(i, 1);\n                        outputStream.removeTrack(track);\n                        handled = true;\n                    }\n                    break;\n                }\n                case 'input': {\n                    if (t === track) {\n                        items.splice(i, 1);\n                        inputStream.removeTrack(track);\n                        handled = true;\n                    }\n                    break;\n                }\n            }\n        }\n\n        this.changeTimer();\n    }\n\n    replaceInputAudio(stream, oldTrack) {\n        if (!stream) return;\n\n        this.removeTrack(oldTrack);\n        this.addTrack(stream, 'input');\n    }\n\n    changeTimer() {\n        const { timer, items, interval } = this;\n\n        clearInterval(timer);\n        if (items.length > 0) {\n            this.timer = setInterval(() => this.analyse(), interval);\n        }\n    }\n\n    getAmplitude(item) {\n        const { analyser, stream, track, source, type } = item;\n        if (!analyser) return;\n\n        const array = new Uint8Array(analyser.frequencyBinCount);\n        analyser.getByteFrequencyData(array);\n        const value = getAmplitude(array);\n\n        return {\n            type,\n            source,\n            stream,\n            track,\n            value\n        };\n    }\n\n    analyse() {\n        const { items } = this;\n        const all = this.counter % 3 === 0;\n        const filteredItems = all ? items : items.filter(x => x.type === 'input');\n        const amplitudes = filteredItems.filter(x => x.track.kind === 'audio').slice(0, GROUP_CALL_AMPLITUDE_ANALYSE_COUNT_MAX).map(x => this.getAmplitude(x));\n        this.counter++;\n        if (this.counter >= 1000) {\n            this.counter = 0;\n        }\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateGroupCallAmplitude',\n            amplitudes,\n            type: all ? 'all' : 'input'\n        });\n    }\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport EventEmitter from './EventEmitter';\nimport LocalConferenceDescription from '../Calls/LocalConferenceDescription';\nimport StreamManager from '../Calls/StreamManager';\nimport { canManageVoiceChats, getChatTitle } from '../Utils/Chat';\nimport { closeGroupCallPanel } from '../Actions/Call';\nimport { getUserFullName } from '../Utils/User';\nimport { fromTelegramSource, getStream, getTransport, parseSdp, toTelegramSource } from '../Calls/Utils';\nimport { showAlert, showLeaveVoiceChatAlert } from '../Actions/Client';\nimport { throttle } from '../Utils/Common';\nimport { GROUP_CALL_AMPLITUDE_ANALYSE_INTERVAL_MS, GROUP_CALL_PARTICIPANTS_LOAD_LIMIT } from '../Constants';\nimport AppStore from './ApplicationStore';\nimport LStore from './LocalizationStore';\nimport UserStore from './UserStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nconst JOIN_TRACKS = true;\n\nexport function LOG_CALL(str, ...data) {\n    // return;\n    console.log('[call]' + str, ...data);\n}\n\nexport function ERROR_CALL(str, ...data) {\n    console.error('[call]' + str, ...data);\n}\n\nclass CallStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n\n        this.updateGroupCallParticipants = throttle(this.updateGroupCallParticipants, 1000);\n    }\n\n    reset = () => {\n        this.currentGroupCall = null;\n        this.items = new Map();\n        this.participants = new Map();\n        this.panelOpened = false;\n        this.animated = true;\n    };\n\n    onUpdate = async update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateLoggingOut': {\n                        const { currentGroupCall } = this;\n                        if (currentGroupCall) {\n                            const { groupCallId } = currentGroupCall;\n                            if (groupCallId) {\n                                const groupCall = this.get(groupCallId);\n                                if (groupCall && groupCall.is_joined) {\n                                    await this.hangUp(groupCallId, false, false);\n                                }\n                            }\n                        }\n\n                        this.reset();\n                        break;\n                    }\n                }\n\n                this.emit('updateAuthorizationState', update);\n                break;\n            }\n            case 'updateChatVoiceChat': {\n                LOG_CALL('[update] updateChatVoiceChat', update);\n                const { chat_id, voice_chat_group_call_id } = update;\n                if (AppStore.getChatId() === chat_id && voice_chat_group_call_id) {\n                    const groupCall = this.get(voice_chat_group_call_id);\n                    if (!groupCall) {\n                        TdLibController.send({\n                            '@type': 'getGroupCall',\n                            group_call_id: voice_chat_group_call_id\n                        });\n                    }\n                }\n\n                this.emit('updateChatVoiceChat', update);\n                break;\n            }\n            case 'updateGroupCall': {\n                const { group_call } = update;\n                LOG_CALL('[update] updateGroupCall', group_call);\n                const prevGroupCall = this.get(group_call.id);\n\n                this.set(group_call);\n\n                const { need_rejoin, is_joined } = group_call;\n                const { currentGroupCall } = this;\n                if (currentGroupCall && currentGroupCall.groupCallId === group_call.id) {\n                    if (need_rejoin) {\n                        this.rejoinGroupCall();\n                    } else if (prevGroupCall && prevGroupCall.is_joined && !is_joined) {\n                        this.hangUp(currentGroupCall.groupCallId);\n                    }\n                }\n\n                this.emit('updateGroupCall', update);\n                break;\n            }\n            case 'updateGroupCallParticipant': {\n                const { group_call_id, participant } = update;\n\n                let participants = this.participants.get(group_call_id);\n                if (!participants) {\n                    participants = new Map();\n                    this.participants.set(group_call_id, participants);\n                }\n\n                const { user_id, is_muted_for_all_users, is_muted_for_current_user, order } = participant;\n                const isMuted = is_muted_for_all_users || is_muted_for_current_user;\n                const prevParticipant = participants.get(user_id);\n\n                participants.set(user_id, participant);\n\n                // mute stream on updateGroupCallParticipant, unmute can be done only on UI user action\n                if (user_id === UserStore.getMyId() && isMuted) {\n                    const { currentGroupCall } = this;\n                    if (currentGroupCall) {\n                        const { groupCallId, streamManager } = currentGroupCall;\n                        if (group_call_id === groupCallId) {\n                            const audioTracks = streamManager.inputStream.getAudioTracks();\n                            if (audioTracks.length > 0) {\n                                audioTracks[0].enabled = false;\n                            }\n                        }\n                    }\n                }\n\n                LOG_CALL('[update] updateGroupCallParticipant', !prevParticipant || prevParticipant.order === '0' && participant.order !== '0' || prevParticipant.order !== '0' && participant.order === '0', prevParticipant, participant);\n                // no information before || join group call || leave group call\n                if (!prevParticipant || prevParticipant.order === '0' && participant.order !== '0' || prevParticipant.order !== '0' && participant.order === '0') {\n                    this.updateGroupCallParticipants(group_call_id);\n                }\n\n                this.emit('updateGroupCallParticipant', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateGroupCall': {\n                this.currentGroupCall = update.call;\n\n                if (this.panelOpened && !this.currentGroupCall) {\n                    closeGroupCallPanel();\n                }\n\n                this.emit('clientUpdateGroupCall', update);\n                break;\n            }\n            case 'clientUpdateGroupCallAmplitude': {\n                const { amplitudes } = update;\n\n                const { currentGroupCall } = this;\n                if (currentGroupCall) {\n                    const { isSpeakingMap, groupCallId, meSignSource } = currentGroupCall;\n\n                    for (let i = 0; i < amplitudes.length; i++) {\n                        const { type, source, value } = amplitudes[i];\n\n                        let telegramSource = null;\n                        switch (type) {\n                            case 'input': {\n                                telegramSource = toTelegramSource(source);\n                                break;\n                            }\n                            case 'output': {\n                                telegramSource = meSignSource;\n                                break;\n                            }\n                        }\n\n                        let params = isSpeakingMap.get(source);\n                        if (!params) {\n                            params = { isSpeaking: false, speakingTimer: null, cancelSpeakingTimer: null };\n                            isSpeakingMap.set(source, params);\n                        }\n\n                        const isSpeaking = value > 0.2;\n                        if (isSpeaking !== params.isSpeaking) {\n                            params.isSpeaking = isSpeaking;\n                            if (isSpeaking) {\n                                clearTimeout(params.cancelSpeakingTimer);\n                                params.speakingTimer = setTimeout(() => {\n                                    if (params.isSpeaking) {\n                                        TdLibController.send({\n                                            '@type': 'setGroupCallParticipantIsSpeaking',\n                                            source: toTelegramSource(source),\n                                            group_call_id : groupCallId,\n                                            is_speaking : true\n                                        });\n                                    }\n                                }, 150);\n                            } else {\n                                clearTimeout(params.cancelSpeakingTimer);\n                                params.cancelSpeakingTimer = setTimeout(() => {\n                                    if (!params.isSpeaking) {\n                                        TdLibController.send({\n                                            '@type': 'setGroupCallParticipantIsSpeaking',\n                                            source: toTelegramSource(source),\n                                            group_call_id: groupCallId,\n                                            is_speaking: false\n                                        });\n                                    }\n                                }, 1000);\n                            }\n                        }\n                    }\n                }\n\n                this.emit('clientUpdateGroupCallAmplitude', update);\n                break;\n            }\n            case 'clientUpdateGroupCallConnectionState': {\n                this.emit('clientUpdateGroupCallConnectionState', update);\n                break;\n            }\n            case 'clientUpdateGroupCallPanel': {\n                this.panelOpened = update.opened;\n                this.emit('clientUpdateGroupCallPanel', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    assign(source1, source2) {\n        this.set(Object.assign({}, source1, source2));\n    }\n\n    get(callId) {\n        return this.items.get(callId);\n    }\n\n    set(call) {\n        this.items.set(call.id, call);\n    }\n\n    playSound(sound) {\n        try {\n            this.audio = this.audio || new Audio();\n            const { audio } = this;\n\n            audio.src = sound;\n            audio.play();\n        } catch (e) {\n            ERROR_CALL('playSound', sound, e);\n        }\n    }\n\n    startConnectingSound(connection) {\n        this.stopConnectingSound(null);\n\n        setTimeout(() => {\n            const { currentGroupCall } = this;\n            if (currentGroupCall && currentGroupCall.connection === connection && (connection.iceConnectionState === 'checking' || connection.iceConnectionState === 'new')) {\n                const audio = new Audio('sounds/group_call_connect.mp3');\n                audio.loop = true;\n                audio.connection = connection;\n\n                this.connectionAudio = audio;\n\n                audio.play();\n            }\n        }, 2500);\n    }\n\n    stopConnectingSound(connection) {\n        const { connectionAudio } = this;\n        if (!connectionAudio) return;\n        if (connection && connectionAudio.connection !== connection) return;\n\n        this.connectionAudio = null;\n        connectionAudio.pause();\n    }\n\n    async updateGroupCallParticipants(groupCallId) {\n        LOG_CALL(`updateGroupCallParticipants id=${groupCallId}`);\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n        if (currentGroupCall.groupCallId !== groupCallId) return;\n\n        const { transport, meSignSource, connection, description, handleUpdateGroupCallParticipants } = currentGroupCall;\n        if (!handleUpdateGroupCallParticipants) return;\n        if (!transport) return;\n        if (!meSignSource) return;\n        if (!description) return;\n\n        if (currentGroupCall.updatingSdp) {\n            LOG_CALL(`updateGroupCallParticipants id=${groupCallId} cancel`, currentGroupCall.updatingSdp);\n            return\n        }\n\n        const ts = new Date().getMilliseconds();\n\n        try {\n            LOG_CALL(`updateGroupCallParticipants id=${groupCallId} updateSdp start`, ts);\n            currentGroupCall.updatingSdp = true;\n\n            let participants = Array.from(this.participants.get(groupCallId).values()).filter(x => x.order !== '0');\n            if (!participants.some(x => x.user_id === UserStore.getMyId())) {\n                participants = [{ '@type': 'groupCallParticipantMe', source: currentGroupCall.meSignSource, user_id: UserStore.getMyId() }, ...participants];\n            }\n            const ssrcs = participants.map(x => ({\n                ssrc: fromTelegramSource(x.source),\n                isMain: x.source === currentGroupCall.meSignSource,\n                name: getUserFullName(x.user_id),\n                userId: x.user_id\n            }));\n            LOG_CALL(`updateGroupCallParticipants id=${groupCallId} ssrcs`, participants, ssrcs);\n            const data = {\n                transport,\n                ssrcs\n            };\n\n            description.updateFromServer(data);\n            const sdp = description.generateSdp();\n\n            LOG_CALL(`[conn][updateGroupCallParticipants] setRemoteDescription participantsCount=${participants.length} signaling=${connection.signalingState} ice=${connection.iceConnectionState} gathering=${connection.iceGatheringState} connection=${connection.connectionState}`, sdp);\n            await connection.setRemoteDescription({\n                type: 'offer',\n                sdp,\n            });\n\n            LOG_CALL(`[conn][updateGroupCallParticipants] createAnswer id=${groupCallId}`, ts);\n            const answer = await connection.createAnswer();\n            LOG_CALL(`[conn][updateGroupCallParticipants] setLocalDescription id=${groupCallId}`, ts);\n            await connection.setLocalDescription(answer);\n        } finally {\n            LOG_CALL(`updateGroupCallParticipants id=${groupCallId} updateSdp finish`, ts);\n            currentGroupCall.updatingSdp = false;\n        }\n    }\n\n    async startGroupCall(chatId) {\n        let { currentGroupCall } = this;\n        LOG_CALL('startGroupCall', currentGroupCall);\n        if (currentGroupCall) {\n            const { chatId: oldChatId } = currentGroupCall;\n\n            showAlert({\n                title: LStore.getString('VoipOngoingChatAlertTitle'),\n                message: LStore.replaceTags(LStore.formatString('VoipOngoingChatAlert', getChatTitle(oldChatId), getChatTitle(chatId))),\n                ok: LStore.getString('OK'),\n                cancel: LStore.getString('Cancel'),\n                onResult: async result => {\n                    if (result) {\n                        currentGroupCall = this.currentGroupCall;\n                        if (currentGroupCall) {\n                            await this.hangUp(currentGroupCall.groupCallId);\n                        }\n                        await this.startGroupCallInternal(chatId);\n                    }\n                }\n            });\n\n            return;\n        }\n\n        await this.startGroupCallInternal(chatId);\n    }\n\n    async startGroupCallInternal(chatId) {\n        LOG_CALL('[tdweb] createVoiceChat', chatId);\n        const groupCallId = await TdLibController.send({\n            '@type': 'createVoiceChat',\n            chat_id: chatId\n        });\n        LOG_CALL('[tdweb] createVoiceChat result', groupCallId);\n    }\n\n    async joinGroupCall(chatId, groupCallId, muted = true, rejoin = false) {\n        if (!this.audio) {\n            this.audio = new Audio()\n            this.audio.play();\n        }\n\n        LOG_CALL(`joinGroupCall chatId=${chatId} id=${groupCallId} muted=${muted} rejoin=${rejoin}`);\n        const groupCall = this.get(groupCallId);\n        if (!groupCall) {\n            LOG_CALL('[tdweb] getGroupCall id=' + groupCallId);\n            TdLibController.send({ '@type': 'getGroupCall', group_call_id: groupCallId });\n        }\n\n        let { currentGroupCall } = this;\n        let streamManager = null;\n        try {\n            if (rejoin) {\n                streamManager = currentGroupCall.streamManager;\n            } else {\n                const constraints = {\n                    audio: true,\n                    video: false\n                };\n                const stream = await getStream(constraints, muted);\n\n                streamManager = new StreamManager(GROUP_CALL_AMPLITUDE_ANALYSE_INTERVAL_MS);\n                streamManager.addTrack(stream, 'input');\n            }\n        } catch (e) {\n            ERROR_CALL('joinGroupCall getStream error', e);\n            showAlert({\n                title: LStore.getString('AppName'),\n                message: LStore.getString('VoipNeedMicPermission'),\n                ok: LStore.getString('OK')\n            });\n        }\n        if (!streamManager || !streamManager.inputStream) return;\n\n        LOG_CALL('joinGroupCall has another', groupCallId, currentGroupCall);\n        if (currentGroupCall && !rejoin) {\n            const { chatId: oldChatId } = currentGroupCall;\n\n            showAlert({\n                title: LStore.getString('VoipOngoingChatAlertTitle'),\n                message: LStore.replaceTags(LStore.formatString('VoipOngoingChatAlert', getChatTitle(oldChatId), getChatTitle(chatId))),\n                ok: LStore.getString('OK'),\n                cancel: LStore.getString('Cancel'),\n                onResult: async result => {\n                    if (result) {\n                        currentGroupCall = this.currentGroupCall;\n                        if (currentGroupCall) {\n                            this.hangUp(currentGroupCall.groupCallId);\n                        }\n                        this.joinGroupCallInternal(chatId, groupCallId, streamManager, muted, rejoin);\n                    }\n                }\n            });\n\n            return;\n        }\n\n        await this.joinGroupCallInternal(chatId, groupCallId, streamManager, muted, rejoin);\n    }\n\n    setCurrentGroupCall(call) {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateGroupCall',\n            call\n        });\n    }\n\n    async rejoinGroupCall() {\n        const { currentGroupCall } = this;\n        LOG_CALL('rejoinGroupCall', currentGroupCall);\n        if (!currentGroupCall) return;\n\n        const { chatId, groupCallId } = currentGroupCall;\n\n        this.hangUp(groupCallId, false, true);\n        this.joinGroupCall(chatId, groupCallId, this.isMuted(), true);\n    }\n\n    async joinGroupCallInternal(chatId, groupCallId, streamManager, muted, rejoin = false) {\n        LOG_CALL('joinGroupCallInternal start', groupCallId);\n        LOG_CALL('[conn] ctor');\n\n        const connection = new RTCPeerConnection(null);\n        connection.ontrack = event => {\n            LOG_CALL('[conn] ontrack', event);\n            this.onTrack(event);\n        };\n        connection.onsignalingstatechange = event => {\n            LOG_CALL('[conn] onsignalingstatechange', connection.signalingState);\n        };\n        connection.onnegotiationneeded = event => {\n            LOG_CALL('[conn] onnegotiationneeded', connection.signalingState);\n            this.startNegotiation(muted, rejoin);\n        };\n        connection.onicecandidate = event => {\n            LOG_CALL('[conn] onicecandidate', event);\n        };\n        connection.oniceconnectionstatechange = event => {\n            LOG_CALL(`[conn] oniceconnectionstatechange = ${connection.iceConnectionState}`);\n\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateGroupCallConnectionState',\n                state: connection.iceConnectionState,\n                groupCallId\n            });\n\n            if (connection.iceConnectionState !== 'checking') {\n                this.stopConnectingSound(connection);\n            }\n\n            switch (connection.iceConnectionState) {\n                case 'checking': {\n                    break;\n                }\n                case 'closed': {\n                    this.hangUp(groupCallId);\n                    break;\n                }\n                case 'completed': {\n                    break;\n                }\n                case 'connected': {\n                    const { currentGroupCall } = this;\n                    if (currentGroupCall && currentGroupCall.connection === connection && !currentGroupCall.joined) {\n                        currentGroupCall.joined = true;\n                        this.playSound('sounds/group_call_start.mp3');\n                    }\n                    break;\n                }\n                case 'disconnected': {\n                    break;\n                }\n                case 'failed': {\n                    //TODO: replace with ICE restart\n                    // this.hangUp(groupCallId);\n                    connection.restartIce();\n                    break;\n                }\n                case 'new': {\n                    break;\n                }\n            }\n        };\n        connection.ondatachannel = event => {\n            LOG_CALL(`[conn] ondatachannel`);\n        };\n\n        if (streamManager.inputStream) {\n            streamManager.inputStream.getTracks().forEach(track => {\n                LOG_CALL('[conn] addTrack', track);\n                connection.addTrack(track, streamManager.inputStream);\n            });\n        }\n\n        let { currentGroupCall } = this;\n        if (currentGroupCall && rejoin) {\n            currentGroupCall.connection = connection;\n            currentGroupCall.handleUpdateGroupCallParticipants = false;\n            currentGroupCall.updatingSdp = false;\n            LOG_CALL('joinGroupCallInternal update currentGroupCall', groupCallId, currentGroupCall);\n        } else {\n            currentGroupCall = {\n                chatId,\n                groupCallId,\n                connection,\n                handleUpdateGroupCallParticipants: false,\n                updatingSdp: false,\n                streamManager,\n                isSpeakingMap: new Map()\n            }\n            this.setCurrentGroupCall(currentGroupCall);\n            LOG_CALL('joinGroupCallInternal set currentGroupCall', groupCallId, currentGroupCall);\n        }\n    }\n\n    startNegotiation = async (isMuted, rejoin) => {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n\n        const { connection, groupCallId, streamManager } = currentGroupCall;\n        if (!connection) return;\n\n        const offerOptions = {\n            offerToReceiveAudio: 1,\n            offerToReceiveVideo: 0,\n        };\n        let offer = await connection.createOffer(offerOptions);\n        LOG_CALL('[conn][joinGroupCallInternal] setLocalDescription', offer);\n        await connection.setLocalDescription(offer);\n        let clientInfo = parseSdp(offer.sdp);\n        let { ufrag, pwd, hash, setup, fingerprint, source } = clientInfo;\n        LOG_CALL('[conn][joinGroupCallInternal] clientInfo', clientInfo);\n\n\n        offer = await connection.createOffer(offerOptions);\n        LOG_CALL('[conn][joinGroupCallInternal] setLocalDescription', offer);\n        await connection.setLocalDescription(offer);\n        clientInfo = parseSdp(offer.sdp);\n        LOG_CALL('[conn][joinGroupCallInternal] clientInfo', clientInfo);\n\n        currentGroupCall.meSignSource = toTelegramSource(source);\n\n        if (!rejoin) {\n            this.startConnectingSound(connection);\n        }\n\n        // this.participants.set(currentGroupCall.groupCallId, new Map());\n        const request = {\n            '@type': 'joinGroupCall',\n            group_call_id: groupCallId,\n            payload: {\n                '@type': 'groupCallPayload',\n                ufrag,\n                pwd,\n                fingerprints: [{ '@type': 'groupCallPayloadFingerprint', hash, setup: 'active', fingerprint }]\n            },\n            source: currentGroupCall.meSignSource,\n            is_muted: isMuted\n        };\n\n        let result = null;\n        try {\n            LOG_CALL(`[tdweb] joinGroupCall id=${groupCallId}`, request);\n            result = await TdLibController.send(request);\n            LOG_CALL('[tdweb] joinGroupCall result', result);\n        } catch (e) {\n            ERROR_CALL('[tdweb] joinGroupCall error', e);\n        }\n\n        if (!result) {\n            LOG_CALL('joinGroupCallInternal abort 0');\n            this.closeConnectionAndStream(connection, streamManager);\n            return;\n        }\n\n        const transport = getTransport(result);\n        this.currentGroupCall.transport = transport;\n\n        if (connection.iceConnectionState !== 'new') {\n            LOG_CALL(`joinGroupCallInternal abort 1 connectionState=${connection.iceConnectionState}`);\n            this.closeConnectionAndStream(connection, streamManager);\n            return;\n        }\n        if (this.currentGroupCall !== currentGroupCall) {\n            LOG_CALL('joinGroupCallInternal abort 2', this.currentGroupCall, currentGroupCall);\n            this.closeConnectionAndStream(connection, streamManager);\n            return;\n        }\n        if (currentGroupCall.connection !== connection) {\n            LOG_CALL('joinGroupCallInternal abort 3');\n            this.closeConnectionAndStream(connection, streamManager);\n            return;\n        }\n\n        const description = new LocalConferenceDescription();\n        description.onSsrcs = () => { };\n\n        currentGroupCall.description = description\n\n        LOG_CALL(`[tdweb] loadGroupCallParticipants limit=${GROUP_CALL_PARTICIPANTS_LOAD_LIMIT}`);\n        const r1 = await TdLibController.send({\n            '@type': 'loadGroupCallParticipants',\n            group_call_id: groupCallId,\n            limit: GROUP_CALL_PARTICIPANTS_LOAD_LIMIT\n        });\n        LOG_CALL(`[tdweb] loadGroupCallParticipants result`, r1);\n\n        LOG_CALL(`[tdweb] loadGroupCallParticipants limit=${GROUP_CALL_PARTICIPANTS_LOAD_LIMIT}`);\n        const r2 = await TdLibController.send({\n            '@type': 'loadGroupCallParticipants',\n            group_call_id: groupCallId,\n            limit: GROUP_CALL_PARTICIPANTS_LOAD_LIMIT\n        });\n        LOG_CALL(`[tdweb] loadGroupCallParticipants result`, r2);\n\n        let meParticipant = null;\n        const participants = this.participants.get(groupCallId);\n        if (participants) {\n            meParticipant = participants.get(UserStore.getMyId());\n        }\n\n        if (meParticipant && meParticipant.source !== currentGroupCall.meSignSource) {\n            LOG_CALL('[fix] meParticipant', meParticipant.source, currentGroupCall.meSignSource);\n            meParticipant = { ...meParticipant, ...{ source: currentGroupCall.meSignSource } };\n            this.participants.get(groupCallId).set(UserStore.getMyId(), meParticipant);\n        }\n\n        if (!meParticipant) {\n            meParticipant = {\n                '@type': 'groupCallParticipantMe',\n                user_id: UserStore.getMyId(),\n                source: currentGroupCall.meSignSource,\n                can_be_muted: true,\n                can_be_unmuted: true,\n                can_unmute_self: true,\n                is_muted_for_all_users: true,\n                is_muted_for_current_user: false,\n                is_speaking: false,\n                order: Number\n            };\n        }\n\n        const data1 = {\n            transport,\n            ssrcs: [{\n                ssrc: fromTelegramSource(meParticipant.source),\n                isMain: true,\n                name: getUserFullName(meParticipant.user_id),\n                user_id: meParticipant.user_id\n            }]\n        };\n\n        description.updateFromServer(data1);\n        const sdp1 = description.generateSdp(true);\n\n        LOG_CALL(`[conn][joinGroupCallInternal] setRemoteDescription signaling=${connection.signalingState} ice=${connection.iceConnectionState} gathering=${connection.iceGatheringState} connection=${connection.connectionState}`, sdp1);\n        await connection.setRemoteDescription({\n            type: 'answer',\n            sdp: sdp1,\n        });\n\n        // setTimeout(async () => {\n        currentGroupCall.handleUpdateGroupCallParticipants = true;\n        await this.updateGroupCallParticipants(groupCallId);\n        // }, 2500);\n\n        // const data2 = {\n        //     transport,\n        //     ssrcs: participants.map(x => ({\n        //         ssrc: x.source >>> 0,\n        //         isMain: x.source === currentGroupCall.meSignSource,\n        //         name: getUserFullName(x.user_id)\n        //     }))\n        // };\n        //\n        // description.updateFromServer(data2);\n        // const sdp2 = description.generateSdp();\n        //\n        // await connection.setRemoteDescription({\n        //     type: 'offer',\n        //     sdp: sdp2,\n        // });\n        // const answer = await connection.createAnswer();\n        // await connection.setLocalDescription(answer);\n\n        LOG_CALL('joinGroupCallInternal stop', groupCallId);\n    }\n\n    async hangUp(groupCallId, discard = false, rejoin = false) {\n        LOG_CALL(`hangUp start id=${groupCallId} discard=${discard} rejoin=${rejoin}`);\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n        if (currentGroupCall.groupCallId !== groupCallId) return;\n\n        const { connection, streamManager } = currentGroupCall;\n        if (!rejoin) {\n            this.setCurrentGroupCall(null);\n            this.stopConnectingSound(null);\n        }\n\n        this.closeConnectionAndStream(connection, rejoin ? null : streamManager);\n\n        if (JOIN_TRACKS) {\n            document.getElementById('group-call-player').innerHTML = '';\n        } else {\n            document.getElementById('players').innerHTML = '';\n        }\n\n        if (!rejoin) {\n            if (discard) {\n                LOG_CALL(`[tdweb] discardGroupCall id=${groupCallId}`);\n                await TdLibController.send({\n                    '@type': 'discardGroupCall',\n                    group_call_id: groupCallId\n                });\n                return;\n            }\n\n            const groupCall = this.get(groupCallId);\n            if (groupCall && groupCall.is_joined) {\n                LOG_CALL(`[tdweb] leaveGroupCall id=${groupCallId}`);\n                await TdLibController.send({\n                    '@type': 'leaveGroupCall',\n                    group_call_id: groupCallId\n                });\n                return;\n            }\n\n            LOG_CALL(`[tdweb] id=${groupCallId} payload=null`);\n            await TdLibController.send({\n                '@type': 'joinGroupCall',\n                group_call_id: groupCallId,\n                payload: null\n            });\n        }\n    }\n\n    closeConnectionAndStream(connection, streamManager) {\n        try {\n            if (connection) {\n                LOG_CALL('[conn][closeConnectionAndStream] close');\n                connection.close();\n            }\n        } catch (e) {\n            LOG_CALL('hangUp error 1', e);\n        }\n\n        try {\n            if (streamManager) {\n                streamManager.inputStream.getTracks().forEach(t => {\n                    t.stop();\n                    streamManager.removeTrack(t);\n                });\n            }\n        } catch (e) {\n            LOG_CALL('hangUp error 2', e);\n        }\n\n        try {\n            if (streamManager) {\n                streamManager.outputStream.getTracks().forEach(t => {\n                    t.stop();\n                    streamManager.removeTrack(t);\n                });\n            }\n        } catch (e) {\n            LOG_CALL('hangUp error 3', e);\n        }\n    }\n\n    async leaveGroupCall(chatId, groupCallId, forceDiscard = false) {\n        LOG_CALL('leaveGroupCall', chatId, groupCallId);\n        const manageVoiceCalls = canManageVoiceChats(chatId);\n        if (manageVoiceCalls) {\n            if (forceDiscard) {\n                this.playSound('sounds/group_call_end.mp3');\n                await this.hangUp(groupCallId, true);\n                return;\n            }\n\n            showLeaveVoiceChatAlert({\n                onResult: async result => {\n                    LOG_CALL('leaveGroupCall result', result);\n                    if (!result) return;\n\n                    this.playSound('sounds/group_call_end.mp3');\n                    await this.hangUp(groupCallId, result.discard);\n                }\n            });\n            return;\n        }\n\n        this.playSound('sounds/group_call_end.mp3');\n        await this.hangUp(groupCallId);\n    }\n\n    removeTrack(track, streamManager, endpoint, stream) {\n        if (JOIN_TRACKS) {\n            streamManager.removeTrack(track);\n\n            const player = document.getElementById('group-call-player');\n            if (!player) return;\n\n            const tags = player.getElementsByTagName('audio');\n            const audio = tags.length > 0 ? tags[0] : null;\n            if (!audio) return;\n\n            audio.srcObject = streamManager.outputStream;\n        } else {\n            const players = document.getElementById('players');\n            if (!players) return;\n\n            for (let audio of players.getElementsByTagName('audio')) {\n                if (audio.e === endpoint && audio.srcObject === stream) {\n                    players.removeChild(audio);\n                    break;\n                }\n            }\n        }\n    }\n\n    tryAddTrack(event) {\n        const { streams, track } = event;\n\n        const stream = streams[0];\n        const endpoint = stream.id.substring(6);\n        track.e = endpoint;\n\n        if (JOIN_TRACKS) {\n            if (!track) return;\n\n            const { currentGroupCall } = this;\n            if (!currentGroupCall) return;\n\n            const { streamManager, meSignSource } = currentGroupCall;\n            if (!streamManager) return;\n\n            const player = document.getElementById('group-call-player');\n            if (!player) return;\n\n            const tags = player.getElementsByTagName('audio');\n            let audio = tags.length > 0 ? tags[0] : null;\n\n            track.onended = () => {\n                LOG_CALL('[track] onended');\n                this.removeTrack(track, streamManager, endpoint, stream);\n            }\n\n            streamManager.addTrack(stream, 'output');\n\n            if (!audio) {\n                audio = document.createElement('audio');\n                audio.e = endpoint;\n                audio.autoplay = true;\n                audio.srcObject = streamManager.outputStream;\n                audio.volume = 1.0;\n                if (typeof audio.sinkId !== 'undefined') {\n                    const { outputDeviceId } = currentGroupCall;\n                    if (outputDeviceId) {\n                        audio.setSinkId(outputDeviceId);\n                    }\n                }\n\n                player.appendChild(audio);\n                // audio.play();\n            } else {\n                audio.srcObject = streamManager.outputStream;\n            }\n        } else {\n            const players = document.getElementById('players');\n            if (!players) return;\n\n            if (track) {\n                track.onended = () => {\n                    LOG_CALL('conn.track.onended');\n                    this.removeTrack(track, null, endpoint, stream);\n                }\n            }\n\n            let handled;\n            for (let audio of players.getElementsByTagName('audio')) {\n                if (audio.e === endpoint) {\n                    audio.srcObject = stream;\n                    handled = true;\n                    break;\n                }\n            }\n\n            if (!handled) {\n                const audio = document.createElement('audio');\n                audio.e = endpoint;\n                audio.autoplay = true;\n                audio.srcObject = stream;\n                audio.volume = 1.0;\n\n                const { currentGroupCall } = this;\n                if (currentGroupCall) {\n                    const participants = this.participants.get(currentGroupCall.groupCallId);\n                    if (participants) {\n                        const participant = Array.from(participants.values()).find(x => x.source === toTelegramSource(Number.parseInt(endpoint, 10)));\n                        if (participant) {\n                            audio.dataset.userId = participant.user_id;\n                        }\n                    }\n\n                    if (typeof audio.sinkId !== 'undefined') {\n                        const { outputDeviceId } = currentGroupCall;\n                        if (outputDeviceId) {\n                            audio.setSinkId(outputDeviceId);\n                        }\n                    }\n                }\n                audio.dataset.source = endpoint;\n\n                players.appendChild(audio);\n                audio.play();\n            }\n        }\n    }\n\n    replaceOutputDevice(deviceId) {\n        if (JOIN_TRACKS) {\n            const player = document.getElementById('group-call-player');\n            if (!player) return;\n\n            for (let audio of player.getElementsByTagName('audio')) {\n                if (typeof audio.sinkId !== 'undefined') {\n                    audio.setSinkId(deviceId);\n                }\n            }\n        } else {\n            const players = document.getElementById('players');\n            if (!players) return;\n\n            for (let audio of players.getElementsByTagName('audio')) {\n                if (typeof audio.sinkId !== 'undefined') {\n                    audio.setSinkId(deviceId);\n                }\n            }\n        }\n    }\n\n    setOutputDeviceId(deviceId) {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n\n        currentGroupCall.outputDeviceId = deviceId;\n\n        this.replaceOutputDevice(deviceId);\n    }\n\n    getOutputDeviceId() {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return null;\n\n        if (JOIN_TRACKS) {\n            const player = document.getElementById('group-call-player');\n            if (!player) return null;\n\n            for (let audio of player.getElementsByTagName('audio')) {\n                if (typeof audio.sinkId !== 'undefined') {\n                    return audio.sinkId;\n                }\n            }\n        } else {\n            const players = document.getElementById('players');\n            if (!players) return null;\n\n            for (let audio of players.getElementsByTagName('audio')) {\n                if (typeof audio.sinkId !== 'undefined') {\n                    return audio.sinkId;\n                }\n            }\n        }\n\n        return null;\n    }\n\n    async replaceInputAudioDevice(stream) {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n\n        const { connection, streamManager } = currentGroupCall;\n        if (!connection) return;\n\n        const { inputStream } = streamManager;\n\n        // const videoTrack = stream.getVideoTracks()[0];\n        // const sender = pc.getSenders().find(function(s) {\n        //     return s.track.kind == videoTrack.kind;\n        // });\n        // sender.replaceTrack(videoTrack);\n\n        const audioTrack = stream.getAudioTracks()[0];\n        const sender2 = connection.getSenders().find(x => {\n            return x.track.kind === audioTrack.kind;\n        });\n        const oldTrack = sender2.track;\n        await sender2.replaceTrack(audioTrack);\n\n        oldTrack.stop();\n        streamManager.replaceInputAudio(stream, oldTrack);\n    }\n\n    async setInputAudioDeviceId(deviceId, stream) {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n\n        await this.replaceInputAudioDevice(stream);\n    }\n\n    getInputAudioDeviceId() {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return null;\n\n        const { connection } = currentGroupCall;\n        if (!connection) return null;\n\n        let deviceId = null\n        connection.getSenders().forEach(s => {\n            const { track } = s;\n            if (track && track.kind === 'audio') {\n                const settings = track.getSettings();\n                if (settings) {\n                    deviceId = settings.deviceId;\n                }\n            }\n        });\n\n        return deviceId;\n    }\n\n    getInputVideoDeviceId() {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return null;\n\n        const { connection } = currentGroupCall;\n        if (!connection) return null;\n\n        let deviceId = null\n        connection.getSenders().forEach(s => {\n            const { track } = s;\n            if (track && track.kind === 'video') {\n                const settings = track.getSettings();\n                if (settings) {\n                    deviceId = settings.deviceId;\n                }\n            }\n        });\n\n        return deviceId;\n    }\n\n    onTrack(event) {\n        this.tryAddTrack(event);\n    }\n\n    isMuted() {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return true;\n\n        const { groupCallId, streamManager } = currentGroupCall;\n        if (!streamManager) return true;\n\n        const audioTracks = streamManager.inputStream.getAudioTracks();\n        if (audioTracks.length > 0) {\n            return !audioTracks[0].enabled;\n        }\n\n        return true;\n    }\n\n    changeMuted(muted) {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n\n        const { groupCallId, streamManager } = currentGroupCall;\n        if (!streamManager) return;\n\n        const audioTracks = streamManager.inputStream.getAudioTracks();\n        if (audioTracks.length > 0) {\n            audioTracks[0].enabled = !muted;\n        }\n\n        LOG_CALL(`[tdweb] toggleGroupCallParticipantIsMuted id=${groupCallId} user_id=${UserStore.getMyId()} is_muted=${muted}`, this.get(groupCallId));\n        TdLibController.send({\n            '@type': 'toggleGroupCallParticipantIsMuted',\n            group_call_id: groupCallId,\n            user_id: UserStore.getMyId(),\n            is_muted: muted\n        });\n    }\n\n    changeUserMuted(userId, muted) {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n\n        const { groupCallId, connection } = currentGroupCall;\n        if (!connection) return;\n\n        if (UserStore.getMyId() === userId) {\n            connection.getSenders().forEach(s => {\n                const { track } = s;\n                if (track && track.kind === 'audio') {\n                    track.enabled = !muted;\n                }\n            });\n        }\n\n        LOG_CALL(`[tdweb] toggleGroupCallParticipantIsMuted id=${groupCallId} user_id=${UserStore.getMyId()} is_muted=${muted}`, this.get(groupCallId));\n        TdLibController.send({\n            '@type': 'toggleGroupCallParticipantIsMuted',\n            group_call_id: groupCallId,\n            user_id: userId,\n            is_muted: muted\n        });\n    }\n\n    toggleMuteNewParticipants(groupCallId, mute) {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n\n        const { groupCallId: currentGroupCallId } = currentGroupCall;\n        if (groupCallId !== currentGroupCallId) return;\n\n        LOG_CALL('toggleMuteNewParticipants', groupCallId, mute);\n        TdLibController.send({\n            '@type': 'toggleGroupCallMuteNewParticipants',\n            group_call_id: groupCallId,\n            mute_new_participants: mute\n        });\n    }\n\n    setGroupCallParticipantVolumeLevel(groupCallId, userId, volume) {\n        const { currentGroupCall } = this;\n        if (!currentGroupCall) return;\n\n        const { groupCallId: currentGroupCallId } = currentGroupCall;\n        if (groupCallId !== currentGroupCallId) return;\n\n        LOG_CALL('setGroupCallParticipantVolumeLevel', groupCallId, userId, volume);\n        TdLibController.send({\n            '@type': 'setGroupCallParticipantVolumeLevel',\n            group_call_id: groupCallId,\n            user_id: userId,\n            volume_level: volume\n        });\n    }\n}\n\nconst store = new CallStore();\nwindow.call = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { KEY_SUGGESTED_LANGUAGE_PACK_ID } from '../Constants';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass OptionStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateOption':\n                const { name, value } = update;\n\n                this.set(name, value);\n\n                if (name === KEY_SUGGESTED_LANGUAGE_PACK_ID) {\n                    localStorage.setItem(name, value.value);\n                }\n\n                this.emit('updateOption', update);\n                break;\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {};\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    get(name) {\n        return this.items.get(name);\n    }\n\n    set(name, value) {\n        this.items.set(name, value);\n    }\n}\n\nconst store = new OptionStore();\nwindow.option = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport CloseIcon from '../../Assets/Icons/Close';\nimport { ANIMATION_DURATION_300MS } from '../../Constants';\nimport FileStore from '../../Stores/FileStore';\nimport './FileProgress.css';\n\nclass FileProgress extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.completeAnimation = false;\n        const { file } = this.props;\n        this.state = {\n            prevPropsFile: file,\n            prevFile: null,\n            file: FileStore.get(file.id) || file\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const { file } = props;\n        const { prevPropsFile } = state;\n\n        if (file && prevPropsFile && file.id !== prevPropsFile.id) {\n            return {\n                prevPropsFile: file,\n                prevFile: null,\n                file: FileStore.get(file.id) || file\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { download, upload, icon, thumbnailSrc } = this.props;\n\n        if (nextProps.thumbnailSrc !== thumbnailSrc) {\n            return true;\n        }\n\n        if (nextProps.icon !== icon) {\n            return true;\n        }\n\n        if (this.isDownloading(nextState.file, nextState.prevFile) && !download) {\n            return false;\n        }\n\n        if (this.isUploading(nextState.file, nextState.prevFile) && !upload) {\n            return false;\n        }\n\n        const nextLocal = nextState.file ? nextState.file.local : null;\n        const nextIdbKey = nextState.file ? nextState.file.idb_key : null;\n        const prevLocal = this.state.prevFile ? this.state.prevFile.local : null;\n        const prevIdbKey = this.state.prevFile ? this.state.prevFile.idb_key : null;\n        const isDownloadingCompleted =\n            prevLocal && nextLocal && !prevLocal.is_downloading_completed && nextLocal.is_downloading_completed;\n        const receiveIdbKey = nextIdbKey && !prevIdbKey;\n\n        if (nextState.file.id === this.state.file.id && isDownloadingCompleted && receiveIdbKey) {\n            return false;\n        }\n\n        if (nextState.file !== this.state.file) {\n            return true;\n        }\n\n        if (nextState.prevFile !== this.state.prevFile) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        this.mount = true;\n        FileStore.on('updateFile', this.onUpdateFile);\n    }\n\n    componentWillUnmount() {\n        this.mount = false;\n        FileStore.off('updateFile', this.onUpdateFile);\n    }\n\n    fileEquals(file1, file2) {\n        if (file1 === file2 && file1 === null) return true;\n        if (file1 !== null && file2 === null) return false;\n        if (file1 === null && file2 !== null) return false;\n\n        const { local: local1, remote: remote1 } = file1;\n        const { local: local2, remote: remote2 } = file2;\n\n        if (local1.can_be_deleted !== local2.can_be_deleted) return false;\n        if (local1.can_be_downloaded !== local2.can_be_downloaded) return false;\n        if (local1.download_offset !== local2.download_offset) return false;\n        if (local1.downloaded_prefix_size !== local2.downloaded_prefix_size) return false;\n        if (local1.downloaded_size !== local2.downloaded_size) return false;\n        if (local1.is_downloading_active !== local2.is_downloading_active) return false;\n        if (local1.is_downloading_completed !== local2.is_downloading_completed) return false;\n        if (local1.path !== local2.path) return false;\n\n        if (remote1.id !== remote2.id) return false;\n        if (remote1.is_uploading_active !== remote2.is_uploading_active) return false;\n        if (remote1.is_uploading_completed !== remote2.is_uploading_completed) return false;\n        if (remote1.uploaded_size !== remote2.uploaded_size) return false;\n\n        return true;\n    }\n\n    onUpdateFile = update => {\n        const currentFile = this.state.file;\n        const nextFile = update.file;\n\n        if (currentFile && currentFile.id === nextFile.id) {\n            if (this.fileEquals(nextFile, currentFile)) {\n                // console.log('[fp] update equals', nextFile, currentFile);\n            } else {\n                // console.log('[fp] update', nextFile, currentFile);\n                this.setState({ file: nextFile, prevFile: currentFile });\n            }\n        }\n    };\n\n    isDownloading = (file, prevFile) => {\n        if (!this.props.download) return false;\n\n        const wasActive = prevFile && prevFile.local && prevFile.local.is_downloading_active;\n        const isActive = file && file.local && file.local.is_downloading_active;\n\n        return wasActive || isActive;\n    };\n\n    isUploading = (file, prevFile) => {\n        if (!this.props.upload) return false;\n\n        const wasActive = prevFile && prevFile.remote && prevFile.remote.is_uploading_active;\n        const isActive = file && file.remote && file.remote.is_uploading_active;\n\n        return wasActive || isActive;\n    };\n\n    getProgressParams = (file, prevFile) => {\n        const { local, remote } = file;\n\n        let wasActive = false;\n        let isActive = false;\n        let isCompleted = false;\n        let progressSize = 0;\n        let size = 0;\n        if (this.isDownloading(file, prevFile)) {\n            wasActive = prevFile && prevFile.local && prevFile.local.is_downloading_active;\n            isActive = local.is_downloading_active;\n            isCompleted = local.is_downloading_completed;\n            progressSize = local.downloaded_size;\n            size = file.size;\n            // console.log(\n            //     `FileProgress.getProgressParams isDownloading id=${\n            //         file.id\n            //     } was_active=${wasActive} is_active=${isActive} is_completed=${isCompleted} progress_size=${progressSize} size=${size}`,\n            //     file,\n            //     prevFile\n            // );\n        } else if (this.isUploading(file, prevFile)) {\n            wasActive = prevFile && prevFile.remote && prevFile.remote.is_uploading_active;\n            isActive = remote.is_uploading_active;\n            isCompleted = remote.is_uploading_completed;\n            progressSize = remote.uploaded_size;\n            size = file.size;\n            // console.log(\n            //     `FileProgress.getProgressParams isUploading id=${\n            //         file.id\n            //     } was_active=${wasActive} is_active=${isActive} is_completed=${isCompleted} progress_size=${progressSize} size=${size}`,\n            //     file,\n            //     prevFile\n            // );\n        } else {\n            // console.log(\n            //     `FileProgress.getProgressParams none id=${file.id} download=${this.props.download} upload=${\n            //         this.props.upload\n            //     } was_active=${wasActive} is_active=${isActive} is_completed=${isCompleted} progress_size=${progressSize} size=${size}`,\n            //     file,\n            //     prevFile\n            // );\n        }\n\n        return [wasActive, isActive, isCompleted, progressSize, size];\n    };\n\n    render() {\n        let { thumbnailSrc, cancelButton, zIndex, icon, completeIcon } = this.props;\n        const { file, prevFile } = this.state;\n        if (!file) return null;\n\n        const [wasActive, isActive, isCompleted, progressSize, size] = this.getProgressParams(file, prevFile);\n\n        let inProgress = isActive;\n        let progress = 0;\n        if (isActive) {\n            progress = progressSize && size ? 100 - ((size - progressSize) / size) * 100 : 1;\n        }\n\n        const startCompleteAnimation = wasActive && !isActive;\n        if (startCompleteAnimation) {\n            this.completeAnimation = true;\n            // console.log('FileProgress.render animationComplete=true');\n            progress = isCompleted ? 100 : 0;\n            inProgress = true;\n            setTimeout(() => {\n                this.completeAnimation = false;\n                if (!this.mount) return;\n                // console.log('FileProgress.render animationComplete=false');\n\n                this.setState({ prevFile: null });\n            }, ANIMATION_DURATION_300MS);\n        }\n\n        const style = {\n            zIndex: zIndex,\n            background: !thumbnailSrc && typeof thumbnailSrc !== 'undefined' ? null : 'rgba(0, 0, 0, 0.25)'\n        };\n\n        const isDownloadingCompleted =\n            file &&\n            file.local &&\n            (file.local.is_downloading_completed || file.idb_key || file.local.is_uploading_completed) &&\n            !this.completeAnimation &&\n            !isActive;\n\n        // console.log(\n        //     `[fp]] render \\\\\n        //     id=${file.id} showProgress=${inProgress} progress=${progress} \\\\\n        //     was_active=${wasActive} is_active=${isActive} is_completed=${isCompleted} \\\\\n        //     progress_size=${progressSize} size=${size} complete_animation=${this.completeAnimation} \\\\\n        //     is_downloading_completed=${isDownloadingCompleted}\n        //     completeIcon=${completeIcon}`,\n        //     file,\n        //     prevFile\n        // );\n        //cancelButton = true;\n        //inProgress = true;\n\n        if (isDownloadingCompleted) {\n            // console.log('FileProgress.render completeIcon');\n            if (completeIcon) {\n                return (\n                    <div className={classNames('file-progress', 'file-progress-complete')} style={style}>\n                        {completeIcon}\n                    </div>\n                );\n            }\n\n            return null;\n        }\n\n        if (inProgress || this.completeAnimation) {\n            // console.log('FileProgress.render inProgressIcon');\n            return (\n                <div className='file-progress' style={style}>\n                    <CircularProgress\n                        className='file-progress-indicator'\n                        classes={{ circle: 'file-progress-circle' }}\n                        variant='static'\n                        value={progress}\n                        size={48}\n                        thickness={2}\n                    />\n                    {cancelButton && <CloseIcon />}\n                </div>\n            );\n        }\n\n        if (icon) {\n            // console.log('FileProgress.render icon');\n            return (\n                <div className='file-progress' style={style}>\n                    {icon}\n                </div>\n            );\n        }\n\n        return null;\n    }\n}\n\nFileProgress.propTypes = {\n    file: PropTypes.object.isRequired,\n    thumbnailSrc: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n    cancelButton: PropTypes.bool,\n    download: PropTypes.bool,\n    upload: PropTypes.bool,\n    zIndex: PropTypes.number,\n\n    icon: PropTypes.node,\n    completeIcon: PropTypes.node\n};\n\nFileProgress.defaultProps = {\n    cancelButton: false,\n    download: true,\n    upload: false\n};\n\nexport default FileProgress;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport FileProgress from '../../Viewer/FileProgress';\nimport { getSize, getFitSize } from '../../../Utils/Common';\nimport { getSrc } from '../../../Utils/File';\nimport { isBlurredThumbnail } from '../../../Utils/Media';\nimport { PHOTO_SIZE, PHOTO_DISPLAY_SIZE, PHOTO_THUMBNAIL_SIZE } from '../../../Constants';\nimport FileStore from '../../../Stores/FileStore';\nimport './Photo.css';\n\nclass Photo extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { photo, size, thumbnailSize } = props;\n        if (photo !== state.prevPhoto) {\n            return {\n                prevPhoto: photo,\n                photoSize: getSize(photo.sizes, size),\n                thumbSize: getSize(photo.sizes, thumbnailSize),\n                minithumbnail: photo ? photo.minithumbnail : null\n            };\n        }\n\n        return null;\n    }\n\n    componentDidMount() {\n        FileStore.on('clientUpdatePhotoBlob', this.onClientUpdatePhotoBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdatePhotoBlob', this.onClientUpdatePhotoBlob);\n    }\n\n    onClientUpdatePhotoBlob = update => {\n        const { photoSize, thumbSize } = this.state;\n        const { fileId } = update;\n\n        if (photoSize && photoSize.photo && photoSize.photo.id === fileId) {\n            this.forceUpdate();\n        } else if (thumbSize && thumbSize.photo && thumbSize.photo.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    render() {\n        const { className, displaySize, stretch, openMedia, showProgress, title, caption, type, style } = this.props;\n        const { thumbSize, photoSize, minithumbnail } = this.state;\n\n        if (!photoSize) return null;\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbSrc = getSrc(thumbSize ? thumbSize.photo : null);\n        const src = getSrc(photoSize.photo);\n        const isBlurred = isBlurredThumbnail(thumbSize, displaySize);\n\n        const fitPhotoSize = getFitSize(photoSize, displaySize, stretch);\n        if (!fitPhotoSize) return null;\n\n        const photoStyle = {\n            minWidth: stretch ? fitPhotoSize.width : null,\n            width: !stretch ? fitPhotoSize.width : null,\n            height: fitPhotoSize.height,\n            ...style\n        };\n\n        const hasSrc = Boolean(src || thumbSrc);\n\n        // console.log('[photo] render', [thumbSize, thumbSrc, photoSize, src, minithumbnail]);\n\n        return (\n            <div\n                className={classNames(className, 'photo', {\n                    'photo-big': type === 'message',\n                    'photo-title': title,\n                    'photo-caption': caption,\n                    pointer: openMedia\n                })}\n                style={photoStyle}\n                onClick={openMedia}>\n                {miniSrc && (\n                    <img\n                        className={classNames('photo-preview', 'media-mini-blurred')}\n                        src={miniSrc}\n                        alt=''\n                    />\n                )}\n                {hasSrc && (\n                    <img\n                        className={classNames('photo-thumbnail', { 'media-blurred': !src && thumbSrc && isBlurred })}\n                        draggable={false}\n                        src={src || thumbSrc}\n                        alt=''\n                    />\n                )}\n                {showProgress && <FileProgress file={photoSize.photo} download upload cancelButton />}\n            </div>\n        );\n    }\n}\n\nPhoto.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    photo: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    showProgress: PropTypes.bool,\n\n    size: PropTypes.number,\n    thumbnailSize: PropTypes.number,\n    displaySize: PropTypes.number,\n    stretch: PropTypes.bool,\n    style: PropTypes.object\n};\n\nPhoto.defaultProps = {\n    size: PHOTO_SIZE,\n    thumbnailSize: PHOTO_THUMBNAIL_SIZE,\n    displaySize: PHOTO_DISPLAY_SIZE,\n    stretch: false,\n    showProgress: true\n};\n\nexport default Photo;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path d='M5,19 L19,19 C19.5522847,19 20,19.4477153 20,20 C20,20.5128358 19.6139598,20.9355072 19.1166211,20.9932723 L19,21 L5,21 C4.44771525,21 4,20.5522847 4,20 C4,19.4871642 4.38604019,19.0644928 4.88337887,19.0067277 L5,19 L19,19 L5,19 Z M11.8833789,3.00672773 L12,3 C12.5128358,3 12.9355072,3.38604019 12.9932723,3.88337887 L13,4 L13,13.585 L16.2928932,10.2928932 C16.6533772,9.93240926 17.2206082,9.90467972 17.6128994,10.2097046 L17.7071068,10.2928932 C18.0675907,10.6533772 18.0953203,11.2206082 17.7902954,11.6128994 L17.7071068,11.7071068 L12.7071068,16.7071068 C12.3466228,17.0675907 11.7793918,17.0953203 11.3871006,16.7902954 L11.2928932,16.7071068 L6.29289322,11.7071068 C5.90236893,11.3165825 5.90236893,10.6834175 6.29289322,10.2928932 C6.65337718,9.93240926 7.22060824,9.90467972 7.61289944,10.2097046 L7.70710678,10.2928932 L11,13.585 L11,4 C11,3.48716416 11.3860402,3.06449284 11.8833789,3.00672773 L12,3 L11.8833789,3.00672773 Z' />,\n    'Download'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path\n        transform='translate(-12.000000, -12.000000)'\n        d='M19.3717789,13.8876217 L33.8466511,23.2537154 C34.2588127,23.5204082 34.3767385,24.0707284 34.1100457,24.48289 C34.0418356,24.5883056 33.9520666,24.6780745 33.8466511,24.7462846 L19.3717789,34.1123783 C18.9596173,34.3790711 18.4092971,34.2611454 18.1426043,33.8489838 C18.0495218,33.705129 18,33.5374371 18,33.3660938 L18,14.6339062 C18,14.1429865 18.3979691,13.7450173 18.8888889,13.7450173 C19.0602323,13.7450173 19.2279241,13.7945391 19.3717789,13.8876217 Z'\n    />,\n    'PlayArrow'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nlet data = null;\nexport async function loadData() {\n    if (data) return data;\n\n    try {\n        const response = await fetch('data/countries.txt');\n        const text = await response.text();\n\n        const lines = text.split('\\n');\n        const data2 = [];\n        lines.forEach(x => {\n            const split = x.split(';');\n            const item = {\n                prefix: split[0],\n                code: split[1],\n                name: split[2],\n                pattern: split[3],\n                count: Number(split[4]),\n                emoji: split[5]\n            };\n            data2.push(item);\n        });\n        data2.forEach(x => {\n            x.phone = '+' + x.prefix;\n        });\n\n        data = data2.filter(x => x.emoji);\n\n        return data;\n    } catch (error) {\n        console.error(error);\n    }\n}\n\nfunction clearPhone(phone) {\n    if (!phone) return phone;\n\n    return phone\n        .replace(/ /g, '')\n        .replace('+', '')\n        .toLowerCase();\n}\n\nfunction isPhoneWithOptionCode(phone, option) {\n    if (!phone) return false;\n    if (!option) return false;\n\n    phone = clearPhone(phone);\n    const code = clearPhone(option.phone);\n\n    return phone.startsWith(code) && option.pattern;\n}\n\nfunction getCountryFromPhone(phone, data) {\n    if (!data) return null;\n\n    const index = data.findIndex(x => isPhoneWithOptionCode(phone, x));\n\n    return index !== -1 ? data[index] : null;\n}\n\nfunction formatByPattern(phone, pattern) {\n    phone = clearPhone(phone);\n\n    let result = '';\n    let index = 0;\n    for (let i = 0; i < pattern.length && index < phone.length; i++) {\n        if (pattern[i] >= '0' && pattern[i] <= '9') {\n            result += pattern[i];\n            if (phone[index] === pattern[i]) {\n                index++;\n            }\n        } else if (pattern[i] === ' ') {\n            result += pattern[i];\n        } else if (pattern[i] === 'X') {\n            result += phone[index++];\n        }\n    }\n\n    result += ' ' + phone.substring(index);\n\n    return '+' + result;\n}\n\nexport function formatPhoneNumber(phone) {\n    if (!phone) return phone;\n    if (!data) return phone.startsWith('+') ? phone : '+' + phone;\n\n    const country = getCountryFromPhone(phone, data);\n    if (!country) return phone.startsWith('+') ? phone : '+' + phone;\n\n    return formatByPattern(phone, country.pattern);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { openChat, showAlert, showOpenUrlAlert } from '../../Actions/Client';\nimport { getDecodedUrl, getHref, isTelegramLink, isUrlSafe } from '../../Utils/Url';\nimport { openChatSelect } from '../../Actions/Message';\nimport { isBotChat } from '../../Utils/Chat';\nimport AppStore from '../../Stores/ApplicationStore';\nimport LStore from '../../Stores/LocalizationStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './SafeLink.css';\n\nclass SafeLink extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { displayText, mail, url } = props;\n\n        if (state.prevUrl !== url || state.prevDisplayText !== displayText) {\n            return {\n                prevUrl: url,\n                prevDisplayText: displayText,\n                safe: isUrlSafe(displayText, url),\n                decodedUrl: getDecodedUrl(url, mail),\n                href: getHref(url, mail)\n            };\n        }\n\n        return null;\n    }\n\n    handleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { onClick } = this.props;\n        const { decodedUrl } = this.state;\n\n        showOpenUrlAlert(decodedUrl, { onClick, punycode: false, ask: true, tryTelegraph: false });\n    };\n\n    async handleAddStickersLink(name) {\n        const stickerSet = await TdLibController.send({\n            '@type': 'searchStickerSet',\n            name\n        }).catch(() => {\n            showAlert({\n                title: LStore.getString('AppName'),\n                message: LStore.getString('ChooseStickerSetNotFound'),\n                ok: LStore.getString('OK')\n            });\n        });\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateStickerSet',\n            stickerSet\n        });\n    }\n\n    handleBotCommand(command) {\n        if (!command) return;\n\n        TdLibController.send({\n            '@type': 'sendMessage',\n            chat_id: AppStore.getChatId(),\n            message_thread_id: 0,\n            reply_to_message_id: 0,\n            options: null,\n            reply_markup: null,\n            input_message_content: {\n                '@type': 'inputMessageText',\n                text: {\n                    '@type': 'formattedText',\n                    text: command,\n                    entities: []\n                },\n                disable_web_page_preview: true,\n                clear_draft: false\n            }\n        });\n    }\n\n    async handleOpenUsername(username) {\n        const chat = await TdLibController.send({\n            '@type': 'searchPublicChat',\n            username\n        }).catch(() => {\n            showAlert({\n                title: LStore.getString('AppName'),\n                message: LStore.getString('NoUsernameFound'),\n                ok: LStore.getString('OK')\n            });\n        });\n\n        if (!chat) return;\n\n        openChat(chat.id);\n    }\n\n    async handleBotStart(username, parameter, isGroup) {\n        const chat = await TdLibController.send({\n            '@type': 'searchPublicChat',\n            username\n        }).catch(() => {\n            showAlert({\n                title: LStore.getString('AppName'),\n                message: LStore.getString('NoUsernameFound'),\n                ok: LStore.getString('OK')\n            });\n        });\n\n        if (!chat) return;\n        if (!isBotChat(chat.id)) return;\n\n        if (isGroup) {\n            openChatSelect({ botStartMessage: { botUserId: chat.type.user_id, parameter }})\n        } else {\n            openChat(chat.id, null, false, { botStartMessage: { botUserId: chat.type.user_id, parameter }});\n        }\n    }\n\n    async handleOpenMessageLinkInfo(url) {\n        const result = await TdLibController.send({\n            '@type': 'getMessageLinkInfo',\n            url\n        }).catch(e => {\n            console.log('[SafeLink] getMessageLinkInfo error', url, e);\n            throw e;\n        });\n\n        if (!result) return;\n\n        const { is_public, chat_id, message, for_album, for_comment } = result;\n        if (!chat_id) return;\n\n        openChat(chat_id, message ? message.id: null, false);\n    };\n\n    async handlePrivatePost(url) {\n        if (url.searchParams.has('channel')) {\n\n        }\n\n        if (url.searchParams.has('post')) {\n\n        }\n\n        if (url.searchParams.has('thread')) {\n\n        }\n\n        if (url.searchParams.has('comment')) {\n\n        }\n\n        await this.handleOpenMessageLinkInfo(url.href);\n    }\n\n    async handleUnknownDeepLink(href) {\n        const result = await TdLibController.send({\n            '@type': 'getDeepLinkInfo',\n            link: href\n        });\n\n        const { text, need_update_application } = result;\n\n        showAlert({\n            title: LStore.getString('AppName'),\n            message: text,\n            ok: LStore.getString('OK')\n        });\n    }\n\n    /// based on Android handleIntent function\n    handleSafeClick = async event => {\n        event && event.stopPropagation();\n\n        let { onClick, url: href } = this.props;\n\n        href = href.startsWith('http') || href.startsWith('tg://') ? href : 'https://' + href;\n        let handled = false;\n        if (isTelegramLink(href)) {\n            event && event.preventDefault();\n            try {\n                const url = new URL(href);\n                console.log('[SafeLink] url', url);\n\n                switch (url.protocol) {\n                    case 'http:':\n                    case 'https:': {\n                        if (url.pathname.startsWith('/bg/')) {\n\n                        } else if (url.pathname.startsWith('/login/')) {\n\n                        } else if (url.pathname.startsWith('/joinchat/')) {\n\n                        } else if (url.pathname.startsWith('/addstickers/')) {\n                            const set = url.pathname.replace('/addstickers/', '');\n                            await this.handleAddStickersLink(set);\n                            handled = true;\n                        } else if (url.pathname.startsWith('/mgs/') || url.pathname.startsWith('/share/')) {\n\n                        } else if (url.pathname.startsWith('/confirmphone/')) {\n\n                        } else if (url.pathname.startsWith('/setlanguage/')) {\n\n                        } else if (url.pathname.startsWith('/addtheme/')) {\n\n                        } else if (url.pathname.startsWith('/c/')) {\n                            await this.handlePrivatePost(url);\n                            handled = true;\n                        } else if (url.pathname.length > 1) {\n                            const username = url.pathname[0] === '/' ? url.pathname.substr(1) : url.pathname;\n                            if (username) {\n                                if (url.searchParams.has('start')){\n                                    await this.handleBotStart(username, url.searchParams.get('start'), false);\n                                    handled = true;\n                                } else if (url.searchParams.has('startgroup')) {\n                                    await this.handleBotStart(username, url.searchParams.get('startgroup'), true);\n                                    handled = true;\n                                } else if (url.searchParams.has('game')) {\n                                    await this.handleOpenUsername(username);\n                                    handled = true;\n                                } else if (url.searchParams.has('post')) {\n\n                                } else if (url.searchParams.has('thread')) {\n\n                                } else if (url.searchParams.has('comment')) {\n\n                                }\n\n                                if (!handled) {\n                                    await this.handleOpenMessageLinkInfo(href);\n                                    handled = true;\n                                }\n                            }\n                        }\n\n                        break;\n                    }\n                    case 'tg:': {\n                        if (href.startsWith('tg:resolve') || href.startsWith('tg://resolve')) {\n                            const username = url.searchParams('domain');\n                            if (username) {\n                                if (username === 'telegrampassport') {\n\n                                } else {\n                                    if (url.searchParams.has('start')){\n                                        await this.handleBotStart(username, url.searchParams.get('start'), false);\n                                        handled = true;\n                                    } else if (url.searchParams.has('startgroup')) {\n                                        await this.handleBotStart(username, url.searchParams.get('startgroup'), true);\n                                        handled = true;\n                                    } else if (url.searchParams.has('game')) {\n                                        await this.handleOpenUsername(username);\n                                        handled = true;\n                                    } else if (url.searchParams.has('post')) {\n\n                                    } else if (url.searchParams.has('thread')) {\n\n                                    } else if (url.searchParams.has('comment')) {\n\n                                    }\n\n                                    if (!handled) {\n                                        await this.handleOpenMessageLinkInfo(href);\n                                        handled = true;\n                                    }\n                                }\n                            }\n                        } else if (href.startsWith('tg:privatepost') || href.startsWith('tg://privatepost')) {\n                            await this.handlePrivatePost(url)\n                            handled = true;\n                        } else if (href.startsWith('tg:bg') || href.startsWith('tg://bg')) {\n\n                        } else if (href.startsWith('tg:join') || href.startsWith('tg://join')) {\n\n                        } else if (href.startsWith('tg:addstickers') || href.startsWith('tg://addstickers')) {\n                            const set = url.searchParams.get('set');\n                            await this.handleAddStickersLink(set);\n                            handled = true;\n                        } else if (href.startsWith('tg:msg') || href.startsWith('tg://msg') || href.startsWith('tg:share') || href.startsWith('tg://share')) {\n\n                        } else if (href.startsWith('tg:confirmphone') || href.startsWith('tg://confirmphone')) {\n\n                        } else if (href.startsWith('tg:login') || href.startsWith('tg://login')) {\n\n                        } else if (href.startsWith('tg:openmessage') || href.startsWith('tg://openmessage')) {\n\n                        } else if (href.startsWith('tg:passport') || href.startsWith('tg://passport') || href.startsWith('tg:secureid') || href.startsWith('tg://secureid')) {\n\n                        } else if (href.startsWith('tg:setlanguage') || href.startsWith('tg://setlanguage')) {\n\n                        } else if (href.startsWith('tg:addtheme') || href.startsWith('tg://addtheme')) {\n\n                        } else if (href.startsWith('tg:settings') || href.startsWith('tg://settings')) {\n\n                        } else if (href.startsWith('tg:search') || href.startsWith('tg://search')) {\n\n                        } else if (href.startsWith('tg:calllog') || href.startsWith('tg://calllog')) {\n\n                        } else if (href.startsWith('tg:call') || href.startsWith('tg://call')) {\n\n                        } else if (href.startsWith('tg:scanqr') || href.startsWith('tg://scanqr')) {\n\n                        } else if (href.startsWith('tg:addcontact') || href.startsWith('tg://addcontact')) {\n\n                        } else if (href.startsWith('tg:bot_command') || href.startsWith('tg://bot_command')) {\n                            const command = url.searchParams.get('command');\n                            const bot = url.searchParams.get('bot');\n\n                            this.handleBotCommand(`/${command}` + (bot ? `@${bot}` : ''));\n                            handled = true;\n                        } else {\n                            await this.handleUnknownDeepLink(href);\n                            handled = true;\n                        }\n                        break;\n                    }\n                }\n            } catch (error) {\n                console.log('[safeLink] handleSafeLink error', error);\n                handled = false;\n            }\n        }\n\n        if (handled) {\n            return;\n        }\n\n        if (onClick) {\n            onClick(event);\n        } else {\n            event && event.preventDefault();\n\n            const newWindow = window.open();\n            newWindow.opener = null;\n            newWindow.location = href;\n        }\n    };\n\n    render() {\n        const { className, children, url } = this.props;\n        const { decodedUrl, href, safe } = this.state;\n\n        if (!url) return null;\n        if (!decodedUrl) return null;\n\n        return (\n            <>\n                {safe ? (\n                    <a\n                        className={className}\n                        href={href}\n                        title={decodedUrl}\n                        target='_blank'\n                        rel='noopener noreferrer'\n                        onClick={this.handleSafeClick}>\n                        {children || url}\n                    </a>\n                ) : (\n                    <a className={className} title={decodedUrl} onClick={this.handleClick}>\n                        {children || url}\n                    </a>\n                )}\n            </>\n        );\n    }\n}\n\nSafeLink.propTypes = {\n    url: PropTypes.string.isRequired,\n    displayText: PropTypes.string,\n    mail: PropTypes.bool,\n    onClick: PropTypes.func\n};\n\nexport default SafeLink;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport './HeaderProgress.css';\n\nclass HeaderProgress extends React.Component {\n    render() {\n        return (\n            <>\n                <span className='header-progress'>.</span>\n                <span className='header-progress'>.</span>\n                <span className='header-progress'>.</span>\n            </>\n        );\n    }\n}\n\nexport default HeaderProgress;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport punycode from './Punycode';\nimport OptionStore from '../Stores/OptionStore';\n\nlet tMeUrl = null;\n\nconst telegramUrls = [\n    't.me/',\n    'telegram.org/',\n    'telegram.dog/',\n    tMeUrl\n];\n\nfunction getTelegramUrls() {\n    if (!tMeUrl) {\n        tMeUrl = OptionStore.get('t_me_url');\n        if (tMeUrl) {\n            const url = tMeUrl.value\n                .toLowerCase()\n                .replace('https://', '')\n                .replace('http://', '')\n            telegramUrls.push(url);\n        }\n    }\n\n    return telegramUrls;\n}\n\nexport function isTelegramLink(href) {\n    if (!href) return false;\n\n    const lowerCaseUrl = href\n        .toLowerCase()\n        .replace('https://', '')\n        .replace('http://', '');\n\n    if (lowerCaseUrl.startsWith('tg://')) {\n        return true;\n    }\n\n    return getTelegramUrls().some(x => lowerCaseUrl.startsWith(x));\n}\n\nexport function getHref(url, mail) {\n    if (!url) return null;\n\n    if (mail) return url.startsWith('mailto:') ? url : 'mailto:' + url;\n\n    if (url.startsWith('tg:')) return url;\n\n    return url.startsWith('http') ? url : 'http://' + url;\n}\n\nexport function isUrlSafe(displayText, url) {\n    if (displayText && displayText !== url) {\n        return false;\n    }\n\n    if (hasRTLOSymbol(url)) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function getDecodedUrl(url, mail) {\n    if (!url) return null;\n\n    const href = getHref(url, mail);\n\n    try {\n        let decodedHref = decodeURI(href);\n\n        const domain = decodedHref.match(/^(https?|tg):\\/\\/([^\\/:?#]+)(?:[\\/:?#]|$)/i)[1];\n        decodedHref = decodedHref.replace(domain, punycode.ToUnicode(domain));\n\n        return decodedHref;\n    } catch (error) {\n        console.log('SafeLink.getDecodedUrl error ', url, error);\n    }\n\n    return null;\n}\n\nconst regExpRTLO = /\\u202e/;\n\nexport function hasRTLOSymbol(url) {\n    if (!url) return false;\n\n    return regExpRTLO.test(url);\n}\n\nconst regExpDomainExplicit = new RegExp(\n    '(?:([a-zA-Z]+):\\\\/\\\\/)((?:[A-Za-z' +\n        '\\xD0\\x90-\\xD0\\xAF\\xD0\\x81' +\n        '\\xD0\\xB0-\\xD1\\x8F\\xD1\\x91' +\n        '0-9\\\\-\\\\_]+\\\\.){0,10}([A-Za-z' +\n        '\\xD1\\x80\\xD1\\x84' +\n        '\\\\-\\\\d]{2,22})(\\\\:\\\\d+)?)'\n);\nconst regExpDomain = new RegExp(\n    '(?:([a-zA-Z]+):\\\\/\\\\/)?((?:[A-Za-z' +\n        '\\xD0\\x90-\\xD0\\xAF\\xD0\\x81' +\n        '\\xD0\\xB0-\\xD1\\x8F\\xD1\\x91' +\n        '0-9\\\\-\\\\_]+\\\\.){1,10}([A-Za-z' +\n        '\\xD1\\x80\\xD1\\x84' +\n        '\\\\-\\\\d]{2,22})(\\\\:\\\\d+)?)'\n);\nconst regExpProtocol = new RegExp('^([a-zA-Z]+):\\\\/\\\\/');\n\n// https://github.com/telegramdesktop/tdesktop/blob/4e80d54be130eca76129f2c4995fe685d1014442/Telegram/SourceFiles/base/qthelp_url.cpp#L105\nexport function validateUrl(value) {\n    // value = punycode.ToASCII(value);\n\n    const trimmed = value.trim();\n    if (!trimmed) {\n        return null;\n    }\n\n    const match = trimmed.match(regExpDomainExplicit);\n    if (!match) {\n        const domainMatch = trimmed.match(regExpDomain);\n        if (!domainMatch || domainMatch.index !== 0) {\n            return null;\n        }\n\n        return 'http://' + trimmed;\n    } else if (match.index !== 0) {\n        return null;\n    }\n\n    const protocolMatch = trimmed.match(regExpProtocol);\n    return protocolMatch && isGoodProtocol(protocolMatch[0]) ? trimmed : null;\n}\n\nfunction isGoodProtocol(value) {\n    return ['http', 'https', 'tg'].some(x => value.toLowerCase().indexOf(x) === 0);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport DeletedAccountIcon from '../../Assets/Icons/DeletedAccount';\nimport { getUserLetters, isDeletedUser } from '../../Utils/User';\nimport { getSrc, loadUserContent } from '../../Utils/File';\nimport FileStore from '../../Stores/FileStore';\nimport UserStore from '../../Stores/UserStore';\nimport './UserTile.css';\n\nclass UserTile extends Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { userId, firstName, lastName, t } = props;\n\n        if (state.prevUserId !== userId || state.prevFirstName !== firstName || state.prevLastName !== lastName) {\n            const user = UserStore.get(userId);\n            const file = user && user.profile_photo ? user.profile_photo.small : null;\n\n            const fileId = file ? file.id : -1;\n            const src = getSrc(file);\n            const loaded = state.src === src && src !== '' || fileId === -1;\n            const letters = getUserLetters(userId, firstName, lastName, t);\n\n            return {\n                prevUserId: userId,\n                prevFirstName: firstName,\n                prevLastName: lastName,\n\n                fileId,\n                src,\n                loaded,\n                letters\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { userId } = this.props;\n        const { fileId, src, loaded, letters } = this.state;\n\n        if (nextProps.userId !== userId) {\n            return true;\n        }\n\n        if (nextState.fileId !== fileId) {\n            return true;\n        }\n\n        if (nextState.src !== src) {\n            return true;\n        }\n\n        if (nextState.loaded !== loaded) {\n            return true;\n        }\n\n        if (nextState.letters !== letters) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        UserStore.on('updateUser', this.onUpdateUser);\n        FileStore.on('clientUpdateUserBlob', this.onClientUpdateUserBlob);\n    }\n\n    componentWillUnmount() {\n        UserStore.off('updateUser', this.onUpdateUser);\n        FileStore.off('clientUpdateUserBlob', this.onClientUpdateUserBlob);\n    }\n\n    onClientUpdateUserBlob = update => {\n        const { userId } = this.props;\n        const { fileId, loaded } = this.state;\n\n        if (userId !== update.userId) return;\n        if (fileId !== update.fileId) return;\n\n        if (!loaded) {\n            const user = UserStore.get(userId);\n            if (!user) {\n                return null;\n            }\n\n            const file = user && user.profile_photo ? user.profile_photo.small : null;\n            const src = getSrc(file);\n\n            this.setState({ src });\n        }\n    };\n\n    onUpdateUser = update => {\n        const { userId, firstName, lastName, t } = this.props;\n        const { user } = update;\n\n        if (!user) return;\n        if (userId !== user.id) return;\n\n        const file = user && user.profile_photo ? user.profile_photo.small : null;\n\n        const fileId = file ? file.id : -1;\n        const src = getSrc(file);\n        const loaded = this.state.src === src && src !== '' || fileId === -1;\n        const letters = getUserLetters(userId, firstName, lastName, t);\n\n        this.setState({\n            src,\n            fileId,\n            loaded,\n            letters\n        });\n\n        if (file) {\n            const store = FileStore.getStore();\n            loadUserContent(store, userId);\n        }\n    };\n\n    handleSelect = event => {\n        const { userId, onSelect } = this.props;\n        if (!onSelect) return;\n\n        event.stopPropagation();\n        onSelect(userId);\n    };\n\n    handleLoad = () => {\n        this.setState({ loaded: true });\n    };\n\n    render() {\n        const { className, userId, firstName, lastName, onSelect, small, dialog, poll } = this.props;\n        const { fileId, src, loaded, letters } = this.state;\n\n        const user = UserStore.get(userId);\n        if (!user && !(firstName || lastName)) return null;\n\n        if (isDeletedUser(userId)) {\n            return (\n                <div\n                    className={classNames(\n                        className,\n                        'user-tile',\n                        'tile_color_0',\n                        { pointer: onSelect },\n                        { 'tile-dialog': dialog },\n                        { 'tile-small': small },\n                        { 'tile-poll': poll }\n                    )}\n                    onClick={this.handleSelect}>\n                    <div className='tile-photo'>\n                        <div className='tile-saved-messages'>\n                            <DeletedAccountIcon fontSize='default' />\n                        </div>\n                    </div>\n                </div>\n            );\n        }\n\n        const tileLoaded = src && loaded;\n        const tileColor = `tile_color_${(Math.abs(userId || letters.charCodeAt(0)) % 7) + 1}`;\n\n        return (\n            <div\n                className={classNames(\n                    className,\n                    'user-tile',\n                    { [tileColor]: !tileLoaded },\n                    { pointer: onSelect },\n                    { 'tile-dialog': dialog },\n                    { 'tile-small': small },\n                    { 'tile-poll': poll }\n                )}\n                onClick={this.handleSelect}>\n                {!tileLoaded && (\n                    <div className='tile-photo'>\n                        <span className='tile-text'>{letters}</span>\n                    </div>\n                )}\n                {src && <img className='tile-photo' src={src} onLoad={this.handleLoad} draggable={false} alt='' />}\n            </div>\n        );\n    }\n}\n\nUserTile.propTypes = {\n    userId: PropTypes.number,\n    firstName: PropTypes.string,\n    lastName: PropTypes.string,\n    onSelect: PropTypes.func,\n    small: PropTypes.bool\n};\n\nexport default withTranslation()(UserTile);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass StickerStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.stickerSet = null;\n        this.hint = null;\n        this.animationData = new WeakMap();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateInstalledStickerSets': {\n                const { sticker_set_ids } = update;\n                if (this.stickerSet) {\n                    const { id, is_installed } = this.stickerSet;\n                    if (is_installed !== sticker_set_ids.some(x => x === id)) {\n                        this.stickerSet = Object.assign({}, this.stickerSet, { is_installed: !is_installed });\n                    }\n                }\n\n                this.emit('updateInstalledStickerSets', update);\n                break;\n            }\n            case 'updateRecentStickers': {\n                this.emit('updateRecentStickers', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateStickerSend': {\n                this.emit('clientUpdateStickerSend', update);\n                break;\n            }\n            case 'clientUpdateLocalStickersHint': {\n                const { hint } = update;\n\n                this.hint = hint;\n\n                this.emit('clientUpdateLocalStickersHint', update);\n                break;\n            }\n            case 'clientUpdateRemoteStickersHint': {\n                const { hint } = update;\n\n                if (this.hint && this.hint.timestamp === hint.timestamp) {\n                    this.hint = Object.assign({}, this.hint, { foundStickers: hint.stickers });\n                }\n\n                this.emit('clientUpdateRemoteStickersHint', update);\n                break;\n            }\n            case 'clientUpdateStickerSet': {\n                const { stickerSet } = update;\n\n                this.stickerSet = stickerSet;\n\n                this.emit('clientUpdateStickerSet', update);\n                break;\n            }\n            case 'clientUpdateStickerSetPosition': {\n                this.emit('clientUpdateStickerSetPosition', update);\n                break;\n            }\n            case 'clientUpdateStickerPreview': {\n                this.emit('clientUpdateStickerPreview', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    getAnimationData(key) {\n        return this.animationData.get(key);\n    }\n\n    setAnimationData(key, data) {\n        this.animationData.set(key, data);\n    }\n}\n\nconst store = new StickerStore();\nwindow.sticker = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nimport { arrayBufferToBase64, isAuthorizationReady } from './Utils/Common';\nimport { showAlert } from './Actions/Client';\nimport {\n    OPTIMIZATIONS_FIRST_START,\n    PLAYER_STREAMING_PRIORITY,\n    STORAGE_REGISTER_KEY,\n    STORAGE_REGISTER_TEST_KEY\n} from './Constants';\nimport AppStore from './Stores/ApplicationStore';\nimport FileStore from './Stores/FileStore';\nimport LStore from './Stores/LocalizationStore';\nimport NotificationStore from './Stores/NotificationStore';\nimport TdLibController from './Controllers/TdLibController';\n\nconst isLocalhost =\n    //false;\n    Boolean(\n        window.location.hostname === 'localhost' ||\n            // [::1] is the IPv6 localhost address.\n            window.location.hostname === '[::1]' ||\n            // 127.0.0.1/8 is considered localhost for IPv4.\n            window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n    );\n\nexport default async function register() {\n    console.log('[SW] Register');\n\n    if (OPTIMIZATIONS_FIRST_START) {\n        const { useTestDC } = TdLibController.parameters;\n        const registerKey = useTestDC ? STORAGE_REGISTER_TEST_KEY : STORAGE_REGISTER_KEY;\n        localStorage.setItem(registerKey, 'true');\n    }\n\n    if ('serviceWorker' in navigator) {\n        // The URL constructor is available in all browsers that support SW.\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n        if (publicUrl.origin !== window.location.origin) {\n            // Our service worker won't work if PUBLIC_URL is on a different origin\n            // from what our page is served on. This might happen if a CDN is used to\n            // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n            return;\n        }\n\n        const serviceWorkerName =\n            process.env.NODE_ENV === 'production' ? 'service-worker.js' : 'custom-service-worker.js';\n        const swUrl = `${process.env.PUBLIC_URL}/${serviceWorkerName}`;\n        console.log(`[SW] Service worker url: ${swUrl}`);\n\n        if (!isLocalhost) {\n            // Is not local host. Just register service worker\n            await registerValidSW(swUrl);\n        } else {\n            // This is running on localhost. Lets check if a service worker still exists or not.\n            await checkValidServiceWorker(swUrl);\n        }\n    }\n}\n\nasync function registerValidSW(swUrl) {\n    console.log('[SW] register');\n    try {\n        const registration = await navigator.serviceWorker.register(swUrl);\n        registration.onupdatefound = () => {\n            const installingWorker = registration.installing;\n            installingWorker.onstatechange = () => {\n                if (installingWorker.state === 'installed') {\n                    if (navigator.serviceWorker.controller) {\n                        // At this point, the old content will have been purged and\n                        // the fresh content will have been added to the cache.\n                        // It's the perfect time to display a \"New content is\n                        // available; please refresh.\" message in your web app.\n                        console.log('[SW] New content is available; please refresh.');\n\n                        TdLibController.clientUpdate({ '@type': 'clientUpdateNewContentAvailable' });\n                        showAlert({\n                            title: LStore.getString('NewVersionTitle'),\n                            message: LStore.getString('NewVersionText'),\n                            ok: LStore.getString('OK'),\n                            onResult: async () => {\n                                window.location.reload();\n                            }\n                        });\n                    } else {\n                        // At this point, everything has been precached.\n                        // It's the perfect time to display a\n                        // \"Content is cached for offline use.\" message.\n                        console.log('[SW] Content is cached for offline use.');\n                    }\n                }\n            };\n        };\n    } catch (error) {\n        console.error('[SW] Error during service worker registration: ', error);\n    }\n    console.log('[SW] register complete', navigator.serviceWorker, navigator.serviceWorker.controller);\n}\n\nexport async function subscribeNotifications() {\n    try {\n        const registration = await navigator.serviceWorker.ready;\n\n        let pushSubscription = await registration.pushManager.getSubscription();\n        if (pushSubscription) await pushSubscription.unsubscribe();\n\n        pushSubscription = await registration.pushManager.subscribe({ userVisibleOnly: true });\n        console.log('[SW] Received push subscription: ', JSON.stringify(pushSubscription));\n\n        const { endpoint } = pushSubscription;\n        const p256dh_base64url = arrayBufferToBase64(pushSubscription.getKey('p256dh'));\n        const auth_base64url = arrayBufferToBase64(pushSubscription.getKey('auth'));\n\n        if (endpoint && p256dh_base64url && auth_base64url) {\n            const { authorizationState } = AppStore;\n            if (isAuthorizationReady(authorizationState)) {\n                const deviceToken = {\n                    '@type': 'deviceTokenWebPush',\n                    endpoint,\n                    p256dh_base64url,\n                    auth_base64url\n                };\n                console.log('[SW] registerDevice', deviceToken);\n                const result = await TdLibController.send({\n                    '@type': 'registerDevice',\n                    device_token: deviceToken,\n                    other_user_ids: []\n                });\n                console.log('[SW] registerDevice result', result);\n            }\n        }\n    } catch (error) {\n        console.error('[SW] Error during service worker push subscription: ', error);\n        NotificationStore.enableSound = true;\n    }\n}\n\nasync function checkValidServiceWorker(swUrl) {\n    console.log('[SW] checkValid');\n    // Check if the service worker can be found. If it can't reload the page.\n    try {\n        const response = await fetch(swUrl);\n\n        // Ensure service worker exists, and that we really are getting a JS file.\n        if (response.status === 404 || response.headers.get('content-type').indexOf('javascript') === -1) {\n            console.log('[SW] unregister');\n            // No service worker found. Probably a different app. Reload the page.\n            const registration = await navigator.serviceWorker.ready;\n            await registration.unregister();\n\n            window.location.reload();\n        } else {\n            // Service worker found. Proceed as normal.\n            await registerValidSW(swUrl);\n        }\n    } catch (error) {\n        console.log('[SW] No internet connection found. App is running in offline mode.');\n    }\n}\n\nexport async function unregister() {\n    if ('serviceWorker' in navigator) {\n        const registration = await navigator.serviceWorker.ready;\n\n        await registration.unregister();\n    }\n}\n\nexport async function update() {\n    if ('serviceWorker' in navigator) {\n        const registration = await navigator.serviceWorker.ready;\n\n        await registration.update();\n    }\n}\n\nconst requests = [];\nwindow.requests = requests;\n\nasync function processRequest(request) {\n    const { fileId, offset, limit, resolve, reject } = request;\n\n    const file = FileStore.get(fileId);\n    try {\n        let filePart = null;\n        try {\n            if (file) {\n                const { local } = file;\n                if (local) {\n                    const { download_offset, downloaded_prefix_size } = local;\n                    // console.log('[cache] checkFile', fileId, [offset, limit], [download_offset, downloaded_prefix_size]);\n                    if (download_offset <= offset && offset + limit <= download_offset + downloaded_prefix_size) {\n\n                        // console.log('[cache] readExistingFile', fileId);\n                        filePart = await TdLibController.send({\n                            '@type': 'readFilePart',\n                            file_id: fileId,\n                            offset,\n                            count: limit\n                        });\n                    }\n                }\n            }\n        } catch (e) {\n            \n        }\n\n        if (!filePart) {\n            // console.log('[cache] downloadFile', fileId, [offset, limit]);\n            await TdLibController.send({\n                '@type': 'downloadFile',\n                file_id: fileId,\n                priority: PLAYER_STREAMING_PRIORITY,\n                offset,\n                limit,\n                synchronous: true\n            });\n\n            // console.log('[cache] readFilePart', fileId, [offset, limit]);\n            filePart = await TdLibController.send({\n                '@type': 'readFilePart',\n                file_id: fileId,\n                offset,\n                count: limit\n            });\n        }\n\n        const { data } = filePart;\n\n        resolve(data);\n    } catch (error) {\n        reject(error)\n    }\n}\n\nasync function getFilePart(fileId, offset, limit) {\n    const promise = new Promise(async (resolve, reject) => {\n\n        requests.push({\n            fileId,\n            offset,\n            limit,\n            resolve,\n            reject\n        });\n\n        if (requests.length > 1) {\n            return;\n        }\n\n        while (requests.length > 0) {\n            const request = requests[requests.length - 1];\n\n            await processRequest(request);\n\n            const index = requests.indexOf(request);\n            requests.splice(index, 1);\n        }\n    });\n\n    return await promise;\n}\n\nif ('serviceWorker' in navigator) {\n    navigator.serviceWorker.onmessage = async (e) => {\n        // console.log('[stream] client.onmessage', e.data);\n\n        switch (e.data['@type']) {\n            case 'getFile': {\n                const { fileId, offset, limit, start, end } = e.data;\n\n                try {\n                    const data = await getFilePart(fileId, offset, limit);\n\n                    navigator.serviceWorker.controller.postMessage({\n                        '@type': 'getFileResult',\n                        fileId,\n                        offset,\n                        limit,\n                        data\n                    });\n                } catch (error) {\n\n                    navigator.serviceWorker.controller.postMessage({\n                        '@type': 'getFileError',\n                        fileId,\n                        offset,\n                        limit,\n                        error\n                    });\n                }\n                break;\n            }\n        }\n    };\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { isWebpSupported } from '../Utils/Common';\nimport FileStore from './FileStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nlet canvas = null;\n\nfunction createPng(width, height, result) {\n    canvas = canvas || document.createElement('canvas');\n\n    return new Promise(resolve => {\n        const img = new ImageData(result, width, height);\n\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        ctx.putImageData(img, 0, 0);\n\n        canvas.toBlob(blob => { resolve(blob); }, 'image/png', 1);\n    });\n}\n\nclass WebpManager {\n\n    constructor() {\n        this.worker = null;\n        this.isSupported = false;\n    }\n\n    isWebpSupported() {\n        return this.isSupported;\n    }\n\n    decode = async (fileId, thumbnail = false) => {\n        this.isSupported = await isWebpSupported()\n        if (this.isSupported) {\n            return;\n        }\n\n        // console.log('[sticker] convertWebpToPng', [fileId]);\n        const blob = FileStore.getBlob(fileId);\n        if (!blob) return;\n\n        this.init();\n\n        this.decodeInternal(fileId, blob, thumbnail);\n    }\n\n    init = async () => {\n        this.isSupported = await isWebpSupported()\n        if (this.isSupported) {\n            return;\n        }\n\n        let { worker } = this;\n        if (!worker) {\n            const w = new Worker('libwebp/webp_wasm.worker.js');\n            w.wasmReady = false;\n            w.wasmRequests = [];\n            w.onmessage = this.onLibWebpMessage;\n\n            this.worker = w;\n        }\n    };\n\n    onLibWebpMessage = event => {\n        const { worker } = this;\n\n        const { id } = event.data;\n        switch (event.data['@type']) {\n            case 'ready': {\n                if (worker.wasmRequests) {\n                    worker.wasmReady = true;\n                    worker.wasmRequests.forEach(request => {\n                        this.decodeInternal(request.fileId, request.blob, request.thumbnail);\n                    });\n                    worker.wasmRequests = [];\n                }\n                break;\n            }\n            case 'result': {\n                if (worker.requests.has(id)) {\n                    const resolve = worker.requests.get(id);\n\n                    worker.requests.delete(id);\n                    resolve(event.data);\n                }\n                break;\n            }\n        }\n    };\n\n    getDecodePromise = (fileId, blob) => {\n        const { worker } = this;\n\n        return new Promise(resolve => {\n            const id = fileId;\n\n            worker.requests = worker.requests || new Map();\n            worker.requests.set(id, resolve);\n            worker.postMessage({ id, blob });\n        });\n    };\n\n    decodeInternal = async (fileId, webp, thumbnail) => {\n        const { worker } = this;\n        if (!worker.wasmReady) {\n            worker.wasmRequests.push({ fileId, blob: webp, thumbnail });\n            return;\n        }\n\n        // console.log('[sticker] decodeFile', fileId, thumbnail);\n        const { result, width, height } = await this.getDecodePromise(fileId, webp);\n        if (!width || !height) {\n            // console.log('[sticker] decodeFile png', fileId, [width, height, null]);\n            return;\n        }\n\n        // console.log('[sticker]', result);\n        const blob = await createPng(width, height, result);\n\n        // console.log('[sticker] decodeFile png', fileId, [width, height, blob]);\n        TdLibController.clientUpdate({\n            '@type': thumbnail ? 'clientUpdateStickerThumbnailPngBlob' : 'clientUpdateStickerPngBlob',\n            fileId,\n            blob\n        });\n    };\n}\n\nconst manager = new WebpManager();\nwindow.webpManager = manager;\nexport default manager;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport { compose, withRestoreRef, withSaveRef } from '../../../Utils/HOC';\nimport FileProgress from '../../Viewer/FileProgress';\nimport { getFitSize, getPhotoSize } from '../../../Utils/Common';\nimport { isBlurredThumbnail } from '../../../Utils/Media';\nimport { getFileSize, getSrc, isGifMimeType } from '../../../Utils/File';\nimport { PHOTO_DISPLAY_SIZE } from '../../../Constants';\nimport AnimationStore from '../../../Stores/AnimationStore';\nimport AppStore from '../../../Stores/ApplicationStore';\nimport FileStore from '../../../Stores/FileStore';\nimport InstantViewStore from '../../../Stores/InstantViewStore';\nimport MessageStore from '../../../Stores/MessageStore';\nimport './Animation.css';\n\nclass Animation extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = { };\n        this.videoRef = React.createRef();\n\n        this.setPlayerParams();\n    }\n\n    setPlayerParams() {\n        this.windowFocused = window.hasFocus;\n\n        this.inView = false;\n        this.openMediaViewer = Boolean(AppStore.mediaViewerContent);\n        this.openProfileMediaViewer = Boolean(AppStore.profileMediaViewerContent);\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n\n        this.ivInView = false;\n        this.openIVMedia = Boolean(InstantViewStore.viewerContent);\n        this.playing = false;\n\n        const player = this.videoRef.current;\n        if (player) {\n            player.load();\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevProps.animation !== this.props.animation) {\n            this.setPlayerParams();\n        }\n    }\n\n    componentDidMount() {\n        AnimationStore.on('clientUpdateAnimationsInView', this.onClientUpdateAnimationsInView);\n        AppStore.on('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.on('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        AppStore.on('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        FileStore.on('clientUpdateAnimationThumbnailBlob', this.onClientUpdateAnimationThumbnailBlob);\n        FileStore.on('clientUpdateAnimationBlob', this.onClientUpdateAnimationBlob);\n        MessageStore.on('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n        InstantViewStore.on('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n        InstantViewStore.on('clientUpdateInstantViewViewerContent', this.onClientUpdateInstantViewViewerContent);\n        InstantViewStore.on('clientUpdateBlocksInView', this.onClientUpdateBlocksInView);\n    }\n\n    componentWillUnmount() {\n        AnimationStore.off('clientUpdateAnimationsInView', this.onClientUpdateAnimationsInView);\n        AppStore.off('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.off('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        AppStore.off('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        FileStore.off('clientUpdateAnimationThumbnailBlob', this.onClientUpdateAnimationThumbnailBlob);\n        FileStore.off('clientUpdateAnimationBlob', this.onClientUpdateAnimationBlob);\n        MessageStore.off('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n        InstantViewStore.off('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n        InstantViewStore.off('clientUpdateInstantViewViewerContent', this.onClientUpdateInstantViewViewerContent);\n        InstantViewStore.off('clientUpdateBlocksInView', this.onClientUpdateBlocksInView);\n    }\n\n    startStopPlayer = () => {\n        const player = this.videoRef.current;\n        if (!player) return;\n\n        if (\n            this.windowFocused &&\n            ((this.inView && !this.openMediaViewer && !this.openProfileMediaViewer && !this.openIV) ||\n                (this.ivInView && !this.openIVMedia) ||\n                this.pickerInView)\n        ) {\n            player.play();\n        } else {\n            player.pause();\n        }\n    };\n\n    onClientUpdateInstantViewContent = update => {\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateProfileMediaViewerContent = update => {\n        this.openProfileMediaViewer = Boolean(AppStore.profileMediaViewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMediaViewerContent = update => {\n        this.openMediaViewer = Boolean(AppStore.mediaViewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateInstantViewViewerContent = update => {\n        this.openIVMedia = Boolean(InstantViewStore.viewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateFocusWindow = update => {\n        this.windowFocused = update.focused;\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMessagesInView = update => {\n        const { chatId, messageId } = this.props;\n        const key = `${chatId}_${messageId}`;\n\n        this.inView = update.messages.has(key);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateBlocksInView = update => {\n        const { pageBlock } = this.props;\n        if (!pageBlock) return;\n\n        this.ivInView = update.blocks.has(pageBlock);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateAnimationsInView = update => {\n        const { animation } = this.props;\n        if (!animation) return;\n\n        this.pickerInView = update.animations.has(animation);\n\n        this.startStopPlayer();\n    }\n\n    onClientUpdateAnimationBlob = update => {\n        const { animation } = this.props.animation;\n        const { fileId } = update;\n\n        if (!animation) return;\n\n        if (animation.id === fileId) {\n            this.forceUpdate(() => {\n                this.startStopPlayer();\n            });\n        }\n    };\n\n    onClientUpdateAnimationThumbnailBlob = update => {\n        const { thumbnail } = this.props.animation;\n        if (!thumbnail) return;\n\n        const { fileId } = update;\n\n        const { file } = thumbnail;\n        if (file && file.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    handlePlay = () => {\n        // setTimeout(() => {\n        //     this.playing = true;\n        //     this.forceUpdate();\n        // }, 300);\n    };\n\n    handleTimeUpdate = () => {\n        if (!this.playing) {\n            this.playing = true;\n            this.forceUpdate();\n        }\n    }\n\n    render() {\n        const { displaySize, stretch, openMedia, t, title, caption, type, style, showProgress } = this.props;\n        const { minithumbnail, thumbnail, animation, mime_type, width, height } = this.props.animation;\n        const { playing } = this;\n\n        const sizes = [...(thumbnail ? [thumbnail] : []), { width, height }];\n        const photoSize = getPhotoSize(sizes, displaySize);\n        const fitPhotoSize = getFitSize(photoSize, displaySize, stretch);\n        if (!fitPhotoSize) return null;\n\n        const animationStyle = {\n            // background: 'black',\n            minWidth: stretch ? fitPhotoSize.width : null,\n            width: !stretch ? fitPhotoSize.width : null,\n            height: fitPhotoSize.height,\n            ...style\n        };\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const isVideoThumbnail = thumbnail && thumbnail.format['@type'] === 'thumbnailFormatMpeg4';\n        const isBlurred = isBlurredThumbnail(thumbnail, displaySize);\n\n        const src = getSrc(animation);\n        const isGif = isGifMimeType(mime_type);\n        const source = src ? <source src={src} type={mime_type}/> : null;\n\n        return (\n            <div\n                className={classNames('animation', {\n                    'animation-message': type === 'message',\n                    'animation-picker': type === 'picker',\n                    'animation-iv': type === 'iv',\n                    'animation-title': title,\n                    'media-title': title,\n                    'animation-caption': caption,\n                    pointer: openMedia\n                })}\n                style={animationStyle}\n                onClick={openMedia}>\n                    {miniSrc && (\n                        <img\n                            className={classNames('video-preview', 'media-mini-blurred')}\n                            src={miniSrc}\n                            alt=''\n                        />\n                    )}\n                    {src && (\n                        isGif ? (\n                            <img className='animation-preview' src={src} alt='' />\n                        ) : (\n                            <video\n                                ref={this.videoRef}\n                                className='animation-player'\n                                muted\n                                autoPlay={type !== 'picker'}\n                                loop\n                                playsInline\n                                width={animationStyle.width}\n                                height={animationStyle.height}\n                                onPlay={this.handlePlay}\n                                onTimeUpdate={this.handleTimeUpdate}\n                            >\n                                {source}\n                            </video>\n                        )\n                    )}\n                    { !playing && (\n                        <>\n                            { thumbnailSrc && (\n                                <>\n                                    { isVideoThumbnail ? (\n                                        <video\n                                            className={classNames('animation-thumbnail', { 'media-blurred': isBlurred })}\n                                            autoPlay={false}\n                                        >\n                                            <source src={thumbnailSrc} type='video/mp4'/>\n                                        </video>\n                                    ) : (\n                                        <img\n                                            className={classNames('animation-thumbnail', { 'media-blurred': isBlurred })}\n                                            src={thumbnailSrc}\n                                            alt=''\n                                        />\n                                    ) }\n                                </>\n                            )}\n                            {type !== 'picker' && type !== 'preview' && <div className='animation-meta'>{getFileSize(animation)}</div>}\n                        </>\n                    )}\n                {showProgress && (\n                    <FileProgress\n                        file={animation}\n                        download\n                        upload\n                        cancelButton\n                        icon={<div className='animation-play'>{t('AttachGif')}</div>}\n                    />\n                )}\n            </div>\n        );\n    }\n}\n\nAnimation.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    pageBlock: PropTypes.object,\n    animation: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    displaySize: PropTypes.number,\n    stretch: PropTypes.bool,\n    type: PropTypes.oneOf(['message', 'picker', 'iv', 'preview']),\n    showProgress: PropTypes.bool\n};\n\nAnimation.defaultProps = {\n    displaySize: PHOTO_DISPLAY_SIZE,\n    stretch: false,\n    showProgress: true\n};\n\nconst enhance = compose(\n    withSaveRef(),\n    withTranslation(),\n    withRestoreRef()\n);\n\nexport default enhance(Animation);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path\n        transform='translate(-15.000000, -15.000000)'\n        d='M23,16 C23.5522847,16 24,16.4477153 24,17 L24,37 C24,37.5522847 23.5522847,38 23,38 L18,38 C17.4477153,38 17,37.5522847 17,37 L17,17 C17,16.4477153 17.4477153,16 18,16 L23,16 Z M36,16 C36.5522847,16 37,16.4477153 37,17 L37,37 C37,37.5522847 36.5522847,38 36,38 L31,38 C30.4477153,38 30,37.5522847 30,37 L30,17 C30,16.4477153 30.4477153,16 31,16 L36,16 Z'\n    />,\n    'Pause'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport ChatStore from '../Stores/ChatStore';\nimport NotificationStore from '../Stores/NotificationStore';\nimport SupergroupStore from '../Stores/SupergroupStore';\n\nfunction isChatMuted(chatId) {\n    return getChatMuteFor(chatId) > 0;\n}\n\nfunction getChatMuteFor(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return 0;\n\n    const { notification_settings } = chat;\n    if (!notification_settings) return 0;\n\n    const { use_default_mute_for, mute_for } = notification_settings;\n\n    if (use_default_mute_for) {\n        const settings = getScopeNotificationSettings(chatId);\n\n        return settings ? settings.mute_for : false;\n    }\n\n    return mute_for;\n}\n\nfunction isChannelChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n\n            return supergroup && supergroup.is_channel;\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction getScopeNotificationSettings(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return NotificationStore.settings.get('notificationSettingsScopePrivateChats');\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            let settings = null;\n            if (isChannelChat(chatId)) {\n                settings = NotificationStore.settings.get('notificationSettingsScopeChannelChats');\n            } else {\n                settings = NotificationStore.settings.get('notificationSettingsScopeGroupChats');\n            }\n            return settings;\n        }\n    }\n\n    return null;\n}\n\nfunction getChatDisablePinnedMessageNotifications(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { notification_settings } = chat;\n    if (!chat) return false;\n\n    const {\n        use_default_disable_pinned_message_notifications,\n        disable_pinned_message_notifications\n    } = notification_settings;\n    if (use_default_disable_pinned_message_notifications) {\n        const settings = getScopeNotificationSettings(chatId);\n\n        return settings ? settings.disable_pinned_message_notifications : false;\n    }\n\n    return disable_pinned_message_notifications;\n}\n\nfunction getChatDisableMentionNotifications(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { notification_settings } = chat;\n    if (!notification_settings) return false;\n\n    const { use_default_disable_mention_notifications, disable_mention_notifications } = notification_settings;\n    if (use_default_disable_mention_notifications) {\n        const settings = getScopeNotificationSettings(chatId);\n\n        return settings ? settings.disable_mention_notifications : false;\n    }\n\n    return disable_mention_notifications;\n}\n\nfunction hasMention(message) {\n    return message && message.contains_unread_mention;\n}\n\nfunction hasPinnedMessage(message) {\n    return message && message.content['@type'] === 'messagePinMessage';\n}\n\nexport function isMessageMuted(message) {\n    const { chat_id } = message;\n\n    if (hasMention(message)) {\n        return getChatDisableMentionNotifications(chat_id);\n    }\n    if (hasPinnedMessage(message)) {\n        return getChatDisablePinnedMessageNotifications(chat_id);\n    }\n\n    return isChatMuted(chat_id);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { isMessageMuted } from '../Utils/Store';\nimport { APP_NAME, NOTIFICATION_AUDIO_DELAY_MS } from '../Constants';\nimport AppStore from './ApplicationStore';\nimport ChatStore from './ChatStore';\nimport MessageStore from './MessageStore';\nimport TdLibController from '../Controllers/TdLibController';\nimport { isChatMember, isMeChat } from '../Utils/Chat';\n\nclass NotificationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        // depends on ChatStore and MessageStore updates\n        this.chatStore = ChatStore;\n        this.messageStore = MessageStore;\n\n        this.appInactive = false;\n        this.newMessages = new Map();\n        this.settings = new Map();\n        this.windowFocused = true;\n        this.timerHandler = null;\n        this.nextSoundAt = new Date();\n        this.enableSound = false;\n    };\n\n    getUnreadCount() {\n        let unreadCount = 0;\n        this.newMessages.forEach(chat => {\n            chat.forEach(m => {\n                if (!m.is_outgoing && !isMessageMuted(m)) {\n                    unreadCount++;\n                }\n            });\n        });\n\n        return unreadCount;\n    }\n\n    updateTimer() {\n        const unreadCount = this.getUnreadCount();\n        // console.log('[ns] updateTimer', unreadCount, this.newMessages);\n\n        if (unreadCount > 0) {\n            if (!this.timerHandler) {\n                // console.log('[ns] setInterval');\n\n                this.onTimer();\n                this.timerHandler = setInterval(this.onTimer, 1000);\n            }\n        } else {\n            if (this.timerHandler) {\n                // console.log('[ns] clearInterval');\n\n                clearInterval(this.timerHandler);\n                this.timerHandler = null;\n                this.onTimer();\n            }\n        }\n    }\n\n    onTimer = () => {\n        // console.log('[ns] onTimer');\n\n        const unreadCount = this.getUnreadCount();\n        const showBadge = document.title === APP_NAME && unreadCount > 0;\n\n        if (showBadge) {\n            let title = '+99 notifications';\n            if (unreadCount === 1) {\n                title = '1 notification';\n            } else if (unreadCount < 99) {\n                title = `${unreadCount} notifications`;\n            }\n            document.title = title;\n            document.getElementById('favicon').href = 'favicon_unread.ico';\n        } else {\n            document.title = APP_NAME + (this.appInactive ? ': Zzz' : '');\n            document.getElementById('favicon').href = 'favicon.ico';\n        }\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateChatReadInbox': {\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    const { chat_id, last_read_inbox_message_id } = update;\n\n                    const chatMap = this.newMessages.get(chat_id);\n                    if (chatMap) {\n                        const newChatMap = new Map([...chatMap].filter(([id, m]) => m.id > last_read_inbox_message_id));\n                        if (newChatMap.size < chatMap.size) {\n                            this.newMessages.set(chat_id, newChatMap);\n                            this.updateTimer();\n                        }\n                    }\n                }\n\n                break;\n            }\n            case 'updateChatNotificationSettings': {\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    this.updateTimer();\n                }\n\n                break;\n            }\n            case 'updateDeleteMessages': {\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    const { chat_id, message_ids, is_permanent } = update;\n                    if (is_permanent && message_ids.length > 0) {\n                        const chatMap = this.newMessages.get(chat_id);\n                        if (chatMap) {\n                            const filterMap = new Map(message_ids.map(id => [id, id]));\n\n                            const newChatMap = new Map([...chatMap].filter(([id, m]) => !filterMap.has(id)));\n                            if (newChatMap.size < chatMap.size) {\n                                this.newMessages.set(chat_id, newChatMap);\n                                this.updateTimer();\n                            }\n                        }\n                    }\n                }\n\n                break;\n            }\n            case 'updateNewMessage': {\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    const { message } = update;\n                    const { chat_id, id } = message;\n\n                    // dismiss notifications for last visited public channels and groups\n                    if (!isChatMember(chat_id)) {\n                        break;\n                    }\n\n                    // dismiss notifications for me chat\n                    if (isMeChat(chat_id)) {\n                        break;\n                    }\n\n                    const chatMap = this.newMessages.get(chat_id) || new Map();\n                    chatMap.set(id, message);\n                    this.newMessages.set(chat_id, chatMap);\n                    this.updateTimer();\n\n                    if (!message.is_outgoing && !isMessageMuted(message) && this.enableSound) {\n                        const now = new Date();\n                        if (now > this.nextSoundAt) {\n                            try {\n                                const audio = new Audio('sounds/sound_a.mp3');\n                                audio.play();\n                            } catch { }\n\n                            const nextSoundAt = new Date();\n                            nextSoundAt.setMilliseconds(nextSoundAt.getMilliseconds() + NOTIFICATION_AUDIO_DELAY_MS);\n                            this.nextSoundAt = nextSoundAt;\n                        }\n                    }\n                }\n\n                break;\n            }\n            case 'updateScopeNotificationSettings': {\n                const { scope, notification_settings } = update;\n\n                this.settings.set(scope['@type'], notification_settings);\n\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    this.updateTimer();\n                }\n\n                this.emit('updateScopeNotificationSettings', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateAppInactive': {\n                this.appInactive = true;\n                this.newMessages = new Map();\n                this.updateTimer();\n                break;\n            }\n            case 'clientUpdateFocusWindow': {\n                const { focused } = update;\n                // console.log('[ns] clientUpdateFocusWindow', update);\n\n                this.windowFocused = focused;\n                if (focused) {\n                    this.newMessages = new Map();\n                    this.updateTimer();\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n}\n\nconst store = new NotificationStore();\nwindow.notifications = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport FileProgress from '../../Components/Viewer/FileProgress';\nimport { getSrc } from '../../Utils/File';\nimport FileStore from '../../Stores/FileStore';\nimport './DocumentTile.css';\n\nclass DocumentTile extends React.Component {\n    state = {\n        loaded: false\n    };\n\n    componentDidMount() {\n        FileStore.on('clientUpdateDocumentThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n        FileStore.on('clientUpdateAudioThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateDocumentThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n        FileStore.off('clientUpdateAudioThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n    }\n\n    onClientUpdateDocumentThumbnailBlob = update => {\n        const { thumbnail } = this.props;\n\n        if (!thumbnail) return;\n\n        const { file } = thumbnail;\n        if (!file) return;\n\n        const { fileId } = update;\n\n        if (file.id !== fileId) {\n            return;\n        }\n\n        this.forceUpdate();\n    };\n\n    handleLoad = () => {\n        this.setState({ loaded: true });\n    };\n\n    render() {\n        const { minithumbnail, thumbnail, file, icon, completeIcon, openMedia, streaming } = this.props;\n        const { loaded } = this.state;\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const tileLoaded = thumbnailSrc && loaded;\n        const src = thumbnailSrc || miniSrc;\n\n        return (\n            <div\n                className={classNames('document-tile', { 'document-tile-image': !src }, { pointer: openMedia })}\n                onClick={openMedia}>\n                {file && (\n                    <FileProgress\n                        file={file}\n                        thumbnailSrc={src}\n                        download={!streaming}\n                        upload\n                        cancelButton\n                        zIndex={1}\n                        icon={icon}\n                        completeIcon={typeof completeIcon === 'function' ? completeIcon(src) : completeIcon}\n                    />\n                )}\n                {miniSrc && <img className='tile-photo' src={miniSrc} draggable={false} alt=''/>}\n                {thumbnailSrc && <img className='tile-photo' src={thumbnailSrc} onLoad={this.handleLoad} draggable={false} alt='' />}\n                {!miniSrc && !tileLoaded && <div className='document-tile-background' />}\n            </div>\n        );\n    }\n}\n\nDocumentTile.defaultProps = {\n    streaming: false\n};\n\nDocumentTile.propTypes = {\n    minithumbnail: PropTypes.object,\n    thumbnail: PropTypes.object,\n    file: PropTypes.object,\n    openMedia: PropTypes.func,\n    icon: PropTypes.node,\n    completeIcon: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n};\n\nexport default DocumentTile;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport RoomIcon from '@material-ui/icons/Room';\nimport { getLocationId } from '../../../Utils/Message';\nimport { getSrc } from '../../../Utils/File';\nimport { LOCATION_HEIGHT, LOCATION_SCALE, LOCATION_WIDTH, LOCATION_ZOOM } from '../../../Constants';\nimport FileStore from '../../../Stores/FileStore';\nimport './Location.css';\n\nclass Location extends React.Component {\n    componentDidMount() {\n        FileStore.on('clientUpdateLocationBlob', this.onClientUpdateLocationBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateLocationBlob', this.onClientUpdateLocationBlob);\n    }\n\n    onClientUpdateLocationBlob = update => {\n        const { fileId } = update;\n        const { location, width, height, zoom, scale } = this.props;\n\n        const locationId = getLocationId(location, width, height, zoom, scale);\n        const file = FileStore.getLocationFile(locationId);\n        if (!file) return;\n\n        if (file.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    handleClick = event => {\n        event.stopPropagation();\n    };\n\n    render() {\n        const { location, width, height, zoom, scale, type, style, title, caption } = this.props;\n        if (!location) return null;\n\n        const locationId = getLocationId(location, width, height, zoom, scale);\n        const file = FileStore.getLocationFile(locationId);\n        const src = getSrc(file);\n\n        const { longitude, latitude } = location;\n        const source = `https://maps.google.com/?q=${latitude},${longitude}`;\n\n        const locationStyle = {\n            width,\n            height,\n            ...style\n        };\n\n        return (\n            <div\n                className={classNames('location', {\n                    'location-message': type === 'message',\n                    'location-venue': type === 'venue',\n                    'location-title': title,\n                    'location-caption': caption\n                })}\n                style={locationStyle}>\n                <a href={source} target='_blank' rel='noopener noreferrer' onClick={this.handleClick}>\n                    <div className='location-wrapper'>\n                        <img className='location-image' draggable={false} alt={source} src={src} />\n                        <div className='location-icon'>\n                            <RoomIcon fontSize='large' color='primary' />\n                        </div>\n                    </div>\n                </a>\n            </div>\n        );\n    }\n}\n\nLocation.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    location: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n\n    width: PropTypes.number,\n    height: PropTypes.number,\n    zoom: PropTypes.number,\n    scale: PropTypes.number\n};\n\nLocation.defaultProps = {\n    width: LOCATION_WIDTH,\n    height: LOCATION_HEIGHT,\n    zoom: LOCATION_ZOOM,\n    scale: LOCATION_SCALE\n};\n\nexport default Location;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { isContentOpened } from '../../../Utils/Message';\nimport MessageStore from '../../../Stores/MessageStore';\n\nclass MediaStatus extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { chatId, messageId } = this.props;\n\n        this.state = {\n            isOpened: isContentOpened(chatId, messageId)\n        };\n    }\n\n    componentDidMount() {\n        MessageStore.on('updateMessageContentOpened', this.onUpdateMessageContentOpened);\n    }\n\n    componentWillUnmount() {\n        MessageStore.off('updateMessageContentOpened', this.onUpdateMessageContentOpened);\n    }\n\n    onUpdateMessageContentOpened = update => {\n        const { chatId, messageId } = this.props;\n\n        if (chatId === update.chat_id && messageId === update.message_id) {\n            this.setState({ isOpened: isContentOpened(chatId, messageId) });\n        }\n    };\n\n    render() {\n        const { icon, openedIcon } = this.props;\n        const { isOpened } = this.state;\n\n        return isOpened ? openedIcon : icon;\n    }\n}\n\nMediaStatus.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    icon: PropTypes.node,\n    openedIcon: PropTypes.node\n};\n\nMediaStatus.defaultProps = {\n    icon: null,\n    openedIcon: null\n};\n\nexport default MediaStatus;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path d='M5.29289322,5.29289322 C5.68341751,4.90236893 6.31658249,4.90236893 6.70710678,5.29289322 L6.70710678,5.29289322 L12,10.585 L17.2928932,5.29289322 C17.6834175,4.90236893 18.3165825,4.90236893 18.7071068,5.29289322 C19.0976311,5.68341751 19.0976311,6.31658249 18.7071068,6.70710678 L13.415,12 L18.7071068,17.2928932 C19.0675907,17.6533772 19.0953203,18.2206082 18.7902954,18.6128994 L18.7071068,18.7071068 C18.3165825,19.0976311 17.6834175,19.0976311 17.2928932,18.7071068 L17.2928932,18.7071068 L12,13.415 L6.70710678,18.7071068 C6.31658249,19.0976311 5.68341751,19.0976311 5.29289322,18.7071068 C4.90236893,18.3165825 4.90236893,17.6834175 5.29289322,17.2928932 L10.585,12 L5.29289322,6.70710678 C4.93240926,6.34662282 4.90467972,5.77939176 5.20970461,5.38710056 Z' />,\n    'Close'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nexport class KeyboardHandler {\n    constructor(onKeyDown) {\n        this.onKeyDown = onKeyDown;\n    }\n}\n\nclass KeyboardManager {\n    constructor() {\n        this.handlers = [];\n\n        document.addEventListener('keydown', this.handleKeyDown);\n    }\n\n    handleKeyDown = event => {\n        // console.log('[keydown] KeyboardManager.handleKeyDown', this.handlers, event.key);\n\n        const { handlers } = this;\n        if (!handlers.length) return;\n\n        const handler = handlers[handlers.length - 1];\n        if (handler) {\n            const { onKeyDown } = handler;\n            if (onKeyDown) {\n                onKeyDown(event);\n            }\n        }\n    };\n\n    add(handler) {\n        // console.log('[keydown] KeyboardManager.add', handler);\n        this.handlers.push(handler);\n    }\n\n    remove(handler) {\n        // console.log('[keydown] KeyboardManager.remove', handler);\n        const index = this.handlers.indexOf(handler);\n        if (index === -1) return;\n\n        this.handlers.splice(index, 1);\n    }\n}\n\nconst manager = new KeyboardManager();\nexport default manager;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport DownloadIcon from '../../../Assets/Icons/Download';\nimport PlayArrowIcon from '../../../Assets/Icons/PlayArrow';\nimport PauseIcon from '../../../Assets/Icons/Pause';\nimport DocumentTile from '../../Tile/DocumentTile';\nimport AudioAction from './AudioAction';\nimport VoiceNoteSlider from './VoiceNoteSlider';\nimport { getAudioShortTitle, getAudioSubtitle } from '../../../Utils/Media';\nimport { supportsStreaming } from '../../../Utils/File';\nimport { isCurrentSource } from '../../../Utils/Player';\nimport PlayerStore from '../../../Stores/PlayerStore';\nimport './Audio.css';\n\nclass Audio extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { chatId, messageId, block } = props;\n\n        const { message, block: playerBlock, playing } = PlayerStore;\n        const active = message && message.chat_id === chatId && message.id === messageId || block === playerBlock;\n\n        this.state = {\n            active,\n            playing: active ? playing : false\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        const { active, playing } = this.state;\n\n        if (nextState.active !== active) {\n            return true;\n        }\n\n        if (nextState.playing !== playing) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaPlay', this.onClientUpdateMediaPlay);\n        PlayerStore.on('clientUpdateMediaPause', this.onClientUpdateMediaPause);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaPlay', this.onClientUpdateMediaPlay);\n        PlayerStore.off('clientUpdateMediaPause', this.onClientUpdateMediaPause);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            active: false,\n            playing: false\n        });\n    };\n\n    onClientUpdateMediaPlay = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        this.setState({ playing: isCurrentSource(chatId, messageId, block, source) });\n    };\n\n    onClientUpdateMediaPause = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({ playing: false });\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        const isCurrentAudio = isCurrentSource(chatId, messageId, block, source);\n\n        this.setState({\n            active: isCurrentAudio,\n            playing: isCurrentAudio\n        });\n    };\n\n    render() {\n        const { chatId, messageId, block, audio, openMedia, title, meta, caption, date } = this.props;\n        const { playing, active } = this.state;\n        if (!audio) return null;\n\n        const { album_cover_thumbnail, duration, audio: file } = audio;\n\n        const audioTitle = getAudioSubtitle(audio);\n        const audioSubtitle = getAudioShortTitle(audio);\n        const completeIcon = playing ? <PauseIcon /> : <PlayArrowIcon />;\n\n        return (\n            <div className={classNames('audio', 'document', { 'media-title': title })}>\n                <DocumentTile\n                    thumbnail={album_cover_thumbnail}\n                    file={file}\n                    openMedia={openMedia}\n                    streaming={supportsStreaming()}\n                    icon={supportsStreaming() ? completeIcon : <DownloadIcon />}\n                    completeIcon={completeIcon}\n                />\n                <div className='audio-content'>\n                    <div className='document-title'>\n                        <a className='document-name' onClick={openMedia} title={audioTitle}>\n                            {audioTitle}\n                        </a>\n                    </div>\n                    <div className='audio-action' style={{ opacity: active ? 0 : 1 }}><span>{audioSubtitle}</span></div>\n                    <VoiceNoteSlider audio className='audio-slider' chatId={chatId} messageId={messageId} block={block} duration={duration} style={{ opacity: active ? 1 : 0 }}/>\n                    <AudioAction\n                        chatId={chatId}\n                        messageId={messageId}\n                        block={block}\n                        duration={duration}\n                        file={file}\n                        meta={caption ? null : meta}\n                        streaming={supportsStreaming()}\n                        date={date}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n\nAudio.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n    audio: PropTypes.object,\n    openMedia: PropTypes.func,\n    date: PropTypes.string\n};\n\nexport default Audio;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport PlayArrowIcon from '../../../Assets/Icons/PlayArrow';\nimport { getFitSize, getDurationString, getPhotoSize } from '../../../Utils/Common';\nimport { getFileSize, getSrc } from '../../../Utils/File';\nimport { isBlurredThumbnail } from '../../../Utils/Media';\nimport { PHOTO_DISPLAY_SIZE, PHOTO_SIZE } from '../../../Constants';\nimport FileStore from '../../../Stores/FileStore';\nimport './Video.css';\n\nclass Video extends React.Component {\n    componentDidMount() {\n        FileStore.on('clientUpdateVideoThumbnailBlob', this.onClientUpdateVideoThumbnailBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateVideoThumbnailBlob', this.onClientUpdateVideoThumbnailBlob);\n    }\n\n    onClientUpdateVideoThumbnailBlob = update => {\n        const { thumbnail } = this.props.video;\n        const { fileId } = update;\n\n        if (!thumbnail) return;\n\n        const { file } = thumbnail;\n        if (file && file.id !== fileId) return;\n\n        this.forceUpdate();\n    };\n\n    render() {\n        const { displaySize, stretch, openMedia, title, caption, type, style } = this.props;\n        const { minithumbnail, thumbnail, video, width, height, duration } = this.props.video;\n\n        const sizes = [...(thumbnail ? [thumbnail] : []), { width, height }];\n        const photoSize = getPhotoSize(sizes, displaySize);\n        const fitPhotoSize = getFitSize(photoSize, displaySize, stretch);\n        if (!fitPhotoSize) return null;\n\n        const videoStyle = {\n            background: 'black',\n            minWidth: stretch ? fitPhotoSize.width : null,\n            width: !stretch ? fitPhotoSize.width : null,\n            height: fitPhotoSize.height,\n            ...style\n        };\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const isBlurred = isBlurredThumbnail(thumbnail, displaySize);\n\n        return (\n            <div\n                className={classNames('video', {\n                    'video-big': type === 'message',\n                    'video-title': title,\n                    'video-caption': caption,\n                    pointer: openMedia\n                })}\n                style={videoStyle}\n                onClick={openMedia}>\n                {miniSrc && (\n                    <img\n                        className={classNames('video-preview', 'media-mini-blurred')}\n                        src={miniSrc}\n                        alt=''\n                    />\n                )}\n                {thumbnailSrc && (\n                    <img\n                        className={classNames('video-thumbnail', { 'media-blurred': isBlurred })}\n                        src={thumbnailSrc}\n                        alt=''\n                    />\n                )}\n                <div className='video-play'>\n                    <PlayArrowIcon />\n                </div>\n                <div className='media-top-meta'>{getDurationString(duration) + ' ' + getFileSize(video)}</div>\n            </div>\n        );\n    }\n}\n\nVideo.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    video: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    size: PropTypes.number,\n    displaySize: PropTypes.number,\n    stretch: PropTypes.bool\n};\n\nVideo.defaultProps = {\n    size: PHOTO_SIZE,\n    displaySize: PHOTO_DISPLAY_SIZE,\n    stretch: false\n};\n\nexport default Video;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport AudioAction from './AudioAction';\nimport VoiceNoteTile from '../../Tile/VoiceNoteTile';\nimport MediaStatus from './MediaStatus';\nimport VoiceNoteSlider from './VoiceNoteSlider';\nimport { isMeChat } from '../../../Utils/Chat';\nimport './VoiceNote.css';\n\nclass VoiceNote extends React.Component {\n    render() {\n        const { chatId, messageId, block, voiceNote, openMedia, title, meta, caption } = this.props;\n        if (!voiceNote) return null;\n\n        const { duration, voice: file, waveform } = voiceNote;\n\n        return (\n            <div className={classNames('voice-note', 'document', { 'media-title': title })}>\n                <VoiceNoteTile chatId={chatId} messageId={messageId} block={block} file={file} openMedia={openMedia} />\n                <div className='voice-note-content'>\n                    <VoiceNoteSlider chatId={chatId} messageId={messageId} block={block} duration={duration} waveform={waveform} />\n                    <div className='voice-note-meta'>\n                        <AudioAction chatId={chatId} messageId={messageId} block={block} duration={duration} file={file} />\n                        {!isMeChat(chatId) && <MediaStatus chatId={chatId} messageId={messageId} icon={<div className='voice-note-meta-unread'/>} />}\n                        {!caption && meta}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nVoiceNote.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    voiceNote: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default VoiceNote;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getDownloadedSize, getUploadedSize, getFileSize } from '../../../Utils/File';\nimport { getDurationString } from '../../../Utils/Common';\nimport FileStore from '../../../Stores/FileStore';\nimport PlayerStore from '../../../Stores/PlayerStore';\nimport './AudioAction.css';\nimport { isCurrentSource } from '../../../Utils/Player';\n\nclass AudioAction extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { chatId, messageId, block, duration, file, streaming } = this.props;\n        const { message, block: playerBlock, time } = PlayerStore;\n\n        const active = message && message.chat_id === chatId && message.id === messageId || block === playerBlock;\n        const currentTime = active && time ? time.currentTime : 0;\n        const audioDuration = active && time && time.duration ? time.duration : duration;\n        const currentFile = FileStore.get(file.id) || file;\n\n        this.state = {\n            active,\n            currentTime,\n            seekProgress: 0,\n            duration: audioDuration,\n            timeString: AudioAction.getTimeString(currentTime, duration, active, currentFile, streaming),\n\n            prevFile: null,\n            file: currentFile\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { active, timeString, file, prevFile } = this.state;\n\n        if (nextState.timeString !== timeString) {\n            return true;\n        }\n\n        if (nextState.active !== active) {\n            return true;\n        }\n\n        if (nextState.file !== file) {\n            return true;\n        }\n\n        if (nextState.prevFile !== prevFile) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        FileStore.on('updateFile', this.onUpdateFile);\n\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n        PlayerStore.on('clientUpdateMediaSeeking', this.onClientUpdateMediaSeeking);\n        PlayerStore.on('clientUpdateMediaSeek', this.onClientUpdateMediaSeek);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('updateFile', this.onUpdateFile);\n\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n        PlayerStore.off('clientUpdateMediaSeeking', this.onClientUpdateMediaSeeking);\n        PlayerStore.off('clientUpdateMediaSeek', this.onClientUpdateMediaSeek);\n    }\n\n    onClientUpdateMediaSeeking = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { duration: playerDuration, active, file } = this.state;\n        const { source, value } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const d = playerDuration || duration;\n\n        this.setState({\n            seekProgress: value,\n            seeking: true,\n            timeString: AudioAction.getTimeString(d * value, d, active, file, streaming)\n        });\n    };\n\n    onClientUpdateMediaSeek = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { duration: playerDuration, active, file } = this.state;\n        const { source, value } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const d = playerDuration || duration;\n\n        this.setState({\n            seekProgress: 0,\n            seeking: false,\n            timeString: AudioAction.getTimeString(d * value, d, active, file, streaming)\n        });\n    };\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { active, file } = this.state;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const playerDuration = update.duration >= 0 && update.duration < Infinity ? update.duration : duration;\n        this.setState({\n            active: false,\n            currentTime: 0,\n            timeString: AudioAction.getTimeString(0, playerDuration, false, file, streaming)\n        });\n    };\n\n    onClientUpdateMediaTime = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { active, file, seekProgress, seeking } = this.state;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const playerDuration = update.duration >= 0 && update.duration < Infinity ? update.duration : duration;\n        const time = seeking ? seekProgress * playerDuration : update.currentTime;\n\n        this.setState({\n            currentTime: update.currentTime,\n            duration: playerDuration,\n            timeString: AudioAction.getTimeString(time, playerDuration, active, file, streaming)\n        });\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { active, currentTime, file } = this.state;\n        const { source } = update;\n\n        if (isCurrentSource(chatId, messageId, block, source)) {\n            this.setState({\n                active: true,\n                currentTime: active ? currentTime : 0,\n                timeString: active ? this.state.timeString : AudioAction.getTimeString(0, duration, true, file, streaming)\n            });\n        } else if (active) {\n            this.setState({\n                active: false,\n                currentTime: 0,\n                timeString: AudioAction.getTimeString(0, duration, false, file, streaming)\n            });\n        }\n    };\n\n    onUpdateFile = update => {\n        const currentFile = this.state.file;\n        const nextFile = update.file;\n\n        if (currentFile && currentFile.id === nextFile.id) {\n            this.setState({ file: nextFile, prevFile: currentFile });\n        }\n    };\n\n    static getTimeString(currentTime, duration, active, file, streaming) {\n        const isDownloadingCompleted = file.local && file.local.is_downloading_completed || streaming;\n        const isUploadingCompleted = file.remote && file.remote.is_uploading_completed;\n\n        const durationString = getDurationString(Math.floor(duration || 0));\n        const currentTimeString = getDurationString(Math.floor(currentTime || 0));\n\n        return active && isDownloadingCompleted ? `${currentTimeString} / ${durationString}` : `${durationString}`;\n    }\n\n    render() {\n        const { date, meta, streaming } = this.props;\n        const { active, file, timeString } = this.state;\n        if (!file) return null;\n\n        const isDownloadingActive = file.local && file.local.is_downloading_active;\n        const isUploadingActive = file.remote && file.remote.is_uploading_active;\n        const isDownloadingCompleted = file.local && file.local.is_downloading_completed;\n        const isUploadingCompleted = file.remote && file.remote.is_uploading_completed;\n\n        const size = getFileSize(file);\n        let progressSize = null;\n        if (isDownloadingActive) {\n            progressSize = getDownloadedSize(file);\n        } else if (isUploadingActive) {\n            progressSize = getUploadedSize(file);\n        }\n\n        const strings = [];\n        if (streaming) {\n            const sizeString = `${size}`;\n            if (!isDownloadingCompleted && !active) {\n                strings.push(sizeString);\n            }\n            strings.push(timeString);\n        } else {\n            const sizeString = progressSize ? `${progressSize}` : `${size}`;\n            if (!isDownloadingCompleted) {\n                strings.push(sizeString);\n            }\n            if (!isDownloadingActive) {\n                strings.push(timeString);\n            }\n        }\n\n        return (\n            <div className='audio-action'>\n                <span>\n                    {strings.join(', ')}\n                    {!active && date && (`  ${date}`)}\n                    {meta}\n                </span>\n            </div>\n        );\n    }\n}\n\nAudioAction.defaultProps = {\n    streaming: false\n}\n\nAudioAction.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    duration: PropTypes.number.isRequired,\n    file: PropTypes.object.isRequired,\n\n    date: PropTypes.string,\n    streaming: PropTypes.bool\n};\n\nexport default AudioAction;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <g transform='translate(3.000000, 0.600000)'>\n        <path\n            d='M9,0 C13.9705627,-9.13077564e-16 18,4.02943725 18,9 L18,23 L18,23 L15,20 L12,23 L9,20 L6,23 L3,20 L0,23 L0,9 C-6.08718376e-16,4.02943725 4.02943725,9.13077564e-16 9,0 Z'\n            stroke='currentColor'\n            strokeWidth='1.5'\n            strokeLinejoin='round'\n            fill='none'\n        />\n        <circle cx='5' cy='9' r='2' />\n        <circle cx='13' cy='9' r='2' />\n    </g>,\n    'DeletedAccount'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getNormalizedWaveform } from '../../../Utils/Media';\nimport './Waveform.css';\n\nconst defaultData = 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\n\nclass Waveform extends React.Component {\n    render() {\n        const { id, value, dragging } = this.props;\n        let { data } = this.props;\n        if (!data) {\n            data = defaultData;\n        }\n\n        const waveform = getNormalizedWaveform(data);\n\n        const transition = dragging ? null : 'width 0.25s'\n        const waveformMaxHeight = 23;\n\n        const d = waveform.filter((x, index) => index % 2 === 1).map((x, index) => {\n            const height = Math.min(Math.max(2, x * waveformMaxHeight), waveformMaxHeight);\n            const y = waveformMaxHeight - Math.floor(height);\n            return `M${1 + 4 * index + 1},${y + 1}v${Math.floor(height) - 2}Z`\n        }).join('');\n\n        const svg = (\n            <svg className='waveform-bars' viewBox='0 0 202 32'>\n                <path d={d}/>\n            </svg>\n        );\n\n        return (\n            <div className='waveform'>\n                <div className='waveform-content'>\n                    <div className='waveform-background'>\n                        {svg}\n                    </div>\n                    <div className='waveform-progress' style={{ transition, width: value * 100 + '%'}}>\n                        {svg}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n}\n\nWaveform.propTypes = {\n    data: PropTypes.string\n};\n\nexport default Waveform;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport Slider from '@material-ui/core/Slider';\nimport Player from '../../Player/Player';\nimport Waveform from './Waveform';\nimport { isCurrentSource } from '../../../Utils/Player';\nimport { PLAYER_PROGRESS_TIMEOUT_MS } from '../../../Constants';\nimport MessageStore from '../../../Stores/MessageStore';\nimport PlayerStore from '../../../Stores/PlayerStore';\nimport TdLibController from '../../../Controllers/TdLibController';\nimport './VoiceNoteSlider.css';\n\nclass VoiceNoteSlider extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { chatId, messageId, block, duration, waveform } = props;\n\n        if (state.prevChatId !== chatId || state.prevMessageId !== messageId || state.prevBlock !== block) {\n\n            const { message, block: currentBlock, time } = PlayerStore;\n\n            const active = message && message.chat_id === chatId && message.id === messageId || block === currentBlock;\n            const currentTime = active && time ? time.currentTime : 0;\n            const audioDuration = active && time && time.duration ? time.duration : duration;\n            const buffered = active && time ? time.buffered : null;\n            const value = VoiceNoteSlider.getValue(currentTime, audioDuration, active, waveform, false);\n\n            return {\n                prevChatId: chatId,\n                prevMessageId: messageId,\n                prevBlock: block,\n                active,\n                currentTime,\n                duration: audioDuration,\n                value,\n                buffered\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { style } = this.props;\n        const { active, value, buffered } = this.state;\n\n        if (nextState.value !== value) {\n            return true;\n        }\n\n        if (nextState.active !== active) {\n            return true;\n        }\n\n        if (nextState.buffered !== buffered) {\n            return true;\n        }\n\n        if (nextProps.style !== style) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaLoadedMetadata', this.onClientUpdateMediaLoadedMetadata);\n        PlayerStore.on('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.on('clientUpdateMediaProgress', this.onClientUpdateMediaProgress);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaLoadedMetadata', this.onClientUpdateMediaLoadedMetadata);\n        PlayerStore.off('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.off('clientUpdateMediaProgress', this.onClientUpdateMediaProgress);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    reset() {\n        const { waveform } = this.props;\n        const { value, duration, dragging } = this.state;\n\n        if (value === 1) {\n            this.setState({\n                active: false,\n                currentTime: 0,\n                buffered: null\n            });\n\n            setTimeout(() => {\n                const { currentTime } = this.state;\n                if (!currentTime) {\n                    this.setState({\n                        value: VoiceNoteSlider.getValue(0, duration, false, waveform, dragging)\n                    });\n                }\n            }, PLAYER_PROGRESS_TIMEOUT_MS);\n        } else {\n            this.setState({\n                active: false,\n                currentTime: 0,\n                buffered: null,\n                value: VoiceNoteSlider.getValue(0, duration, false, waveform, dragging)\n            });\n        }\n    }\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.reset();\n    };\n\n    onClientUpdateMediaLoadedMetadata = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source, duration, buffered } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            duration,\n            buffered\n        });\n    };\n\n    onClientUpdateMediaProgress = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source, buffered } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            buffered\n        });\n    };\n\n    onClientUpdateMediaTime = update => {\n        const { chatId, messageId, block, waveform } = this.props;\n        const { active, duration, dragging, value } = this.state;\n        const { source, currentTime, buffered } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            currentTime,\n            buffered,\n            value: dragging ? value : VoiceNoteSlider.getValue(currentTime, duration, active, waveform, dragging)\n        });\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block, waveform } = this.props;\n        const { active, currentTime, duration, dragging } = this.state;\n        const { source, currentTime: prevCurrentTime } = update;\n\n        if (isCurrentSource(chatId, messageId, block, source)) {\n            let { value } = this.state;\n            if (!dragging) {\n                value = VoiceNoteSlider.getValue(active ? currentTime : prevCurrentTime, duration, true, waveform, dragging);\n            }\n\n            this.setState({\n                active: true,\n                currentTime: active ? currentTime : prevCurrentTime,\n                value\n            });\n        } else if (active) {\n            this.reset();\n        }\n    };\n\n    static getValue(currentTime, duration, active, waveform, dragging) {\n        // if (waveform && !dragging) {\n        //     currentTime += 0.25;\n        // }\n\n        return active ? currentTime / duration : 0;\n    }\n\n    handleMouseDown = event => {\n        event.stopPropagation();\n\n        this.setState({\n            dragging: true\n        });\n    };\n\n    handleChange = (event, value) => {\n        const { chatId, messageId, block } = this.props;\n        const { active, dragging } = this.state;\n        if (!active) return;\n\n        const source = MessageStore.get(chatId, messageId) || { '@type': 'instantViewSource', block};\n\n        if (dragging) {\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateMediaSeeking',\n                source,\n                value\n            });\n        }\n\n        this.setState({\n            value\n        });\n    };\n\n    handleChangeCommitted = () => {\n        const { chatId, messageId, block, duration } = this.props;\n        const { value } = this.state;\n\n        const source = MessageStore.get(chatId, messageId) || { '@type': 'instantViewSource', block};\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaSeek',\n            source,\n            value,\n            duration\n        });\n\n        this.setState({\n            dragging: false\n        });\n    };\n\n    handleClick = event => {\n        event.stopPropagation();\n        event.preventDefault();\n    };\n\n    render() {\n        const { chatId, messageId, audio, waveform, className, style } = this.props;\n        const { duration, value, dragging, buffered } = this.state;\n\n        const time = value * duration;\n        const bufferedTime = Player.getBufferedTime(time, buffered);\n        const bufferedValue = duration > 0 ? bufferedTime / duration : 0;\n\n        // const ranges = [];\n        // for (let i = 0; buffered && i < buffered.length; i++) {\n        //     ranges.push({ start: buffered.start(i), end: buffered.end(i)})\n        // }\n        //\n\n        return (\n            <div className={classNames('voice-note-slider', className)} style={style}>\n                {!audio && <Waveform id={`waveform_${chatId}_${messageId}`} dragging={dragging} data={waveform} value={value}/>}\n                {audio && <div className='voice-note-slider-buffered' style={{ width: `${bufferedValue*100}%`}}/>}\n                <Slider\n                    className={classNames('voice-note-slider-component', { 'voice-note-slider-component-hidden': !audio })}\n                    classes={{\n                        track: 'voice-note-slider-track',\n                        thumb: 'voice-note-slider-thumb',\n                        active: 'voice-note-slider-active',\n                        rail: 'voice-note-slider-rail'\n                    }}\n                    min={0}\n                    max={1}\n                    step={0.01}\n                    value={value}\n                    onChange={this.handleChange}\n                    onChangeCommitted={this.handleChangeCommitted}\n                    onMouseDown={this.handleMouseDown}\n                    onClick={this.handleClick}\n                />\n            </div>\n        );\n    }\n}\n\nVoiceNoteSlider.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    audio: PropTypes.bool,\n    duration: PropTypes.number.isRequired,\n    waveform: PropTypes.string\n};\n\nexport default VoiceNoteSlider;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport TdLibController from '../Controllers/TdLibController';\nimport { isChatMuted, isChatPinned } from '../Utils/Chat';\nimport { openUser } from './Client';\nimport { MUTED_VALUE_MAX, MUTED_VALUE_MIN } from '../Constants';\nimport ChatStore from '../Stores/ChatStore';\n\nexport function openReportChat(chatId, messageIds) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateReportChat',\n        chatId,\n        messageIds\n    });\n}\n\nexport async function openSupportChat() {\n    const user = await TdLibController.send({ '@type': 'getSupportUser' });\n    if (!user) return;\n\n    openUser(user.id);\n}\n\nexport function openChatList(chatList) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateChatList',\n        chatList\n    });\n}\n\nexport function reportChat(chatId, reason, messageids = []) {\n    TdLibController.send({\n        '@type': 'reportChat',\n        chat_id: chatId,\n        reason,\n        message_ids: messageids\n    });\n}\n\nexport function clearHistory(chatId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateRequestClearHistory',\n        chatId\n    });\n}\n\nexport function leaveChat(chatId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateRequestLeaveChat',\n        chatId\n    });\n}\n\nexport function changeChatDetailsVisibility(visibility) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateChatDetailsVisibility',\n        visibility\n    });\n}\n\nexport async function openPinnedChat(index) {\n    const chats = await TdLibController.send({\n        '@type': 'getChats',\n        chat_list: { '@type': 'chatListMain' },\n        offset_order: '9223372036854775807',\n        offset_chat_id: 0,\n        limit: 10\n    });\n\n    if (chats) {\n        let pinnedIndex = -1;\n        for (let i = 0; i < chats.chat_ids.length; i++) {\n            const chat = ChatStore.get(chats.chat_ids[i]);\n            if (chat && isChatPinned(chat.id, { '@type': 'chatListMain' })) {\n                pinnedIndex++;\n            }\n\n            if (pinnedIndex === index) {\n                TdLibController.setChatId(chat.id);\n                return;\n            }\n        }\n    }\n}\n\nexport async function getChat(chatId) {\n    const chat = TdLibController.send({\n        '@type': 'getChat',\n        chat_id: chatId\n    });\n    ChatStore.set(chat);\n\n    return chat;\n}\n\nexport function addChatToList(chatId, chatList) {\n    TdLibController.send({\n        '@type': 'addChatToList',\n        chat_id: chatId,\n        chat_list: chatList\n    });\n}\n\nexport function toggleChatIsPinned(chatId, chatList, isPinned) {\n    TdLibController.send({\n        '@type': 'toggleChatIsPinned',\n        chat_id: chatId,\n        chat_list: chatList,\n        is_pinned: isPinned\n    });\n}\n\nexport function toggleChatIsMarkedAsUnread(chatId, isMarkedAsUnread) {\n    TdLibController.send({\n        '@type': 'toggleChatIsMarkedAsUnread',\n        chat_id: chatId,\n        is_marked_as_unread: isMarkedAsUnread\n    });\n}\n\nexport function toggleChatNotificationSettings(chatId, isMuted) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const { notification_settings } = chat;\n    if (!notification_settings) return;\n\n    const isMutedPrev = isChatMuted(chatId);\n    if (isMutedPrev === isMuted) {\n        return;\n    }\n\n    const muteFor = isMuted ? MUTED_VALUE_MAX : MUTED_VALUE_MIN;\n    const newNotificationSettings = {\n        ...chat.notification_settings,\n        use_default_mute_for: false,\n        mute_for: muteFor\n    };\n\n    TdLibController.send({\n        '@type': 'setChatNotificationSettings',\n        chat_id: chatId,\n        notification_settings: newNotificationSettings\n    });\n}\n\nexport async function getChatCounters(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const promises = [];\n\n    const photoCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterPhoto' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(photoCounter);\n\n    const videoCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterVideo' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(videoCounter);\n\n    const documentCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterDocument' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(documentCounter);\n\n    const audioCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterAudio' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(audioCounter);\n\n    const urlCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterUrl' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(urlCounter);\n\n    const voiceAndVideoNoteCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterVoiceNote' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(voiceAndVideoNoteCounter);\n\n    return await Promise.all(promises);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { isBlurredThumbnail, isValidAnimatedSticker } from '../../../Utils/Media';\nimport { getFitSize, isWebpSupported } from '../../../Utils/Common';\nimport { getBlob, getPngSrc, getSrc } from '../../../Utils/File';\nimport { STICKER_DISPLAY_SIZE } from '../../../Constants';\nimport WebpManager from '../../../Stores/WebpManager';\nimport AppStore from '../../../Stores/ApplicationStore';\nimport FileStore from '../../../Stores/FileStore';\nimport InstantViewStore from '../../../Stores/InstantViewStore';\nimport MessageStore from '../../../Stores/MessageStore';\nimport StickerStore from '../../../Stores/StickerStore';\nimport './Sticker.css';\n\nconst RLottie = React.lazy(() => import('../../Viewer/RLottie'));\n\nexport const StickerSourceEnum = Object.freeze({\n    HINTS: 'HINTS',\n    MESSAGE: 'MESSAGE',\n    PICKER_HEADER: 'PICKER_HEADER',\n    PICKER: 'PICKER',\n    PREVIEW: 'PREVIEW',\n    STICKER_SET: 'STICKER_SET',\n    UNKNOWN: 'UNKNOWN'\n});\n\nclass Sticker extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.lottieRef = React.createRef();\n        this.windowFocused = window.hasFocus;\n        this.messageInView = true;\n        this.stickerPreviewOpened = Boolean(StickerStore.stickerPreview);\n        this.mediaViewerOpened = Boolean(AppStore.mediaViewerContent);\n        this.profileMediaViewerOpened = Boolean(AppStore.profileMediaViewerContent);\n        this.ivOpened = Boolean(InstantViewStore.getCurrent());\n        this.chatPopupOpened = Boolean(AppStore.dialogChatId);\n        this.stickerSetOpened = Boolean(StickerStore.stickerSet);\n\n        this.state = {\n            animationData: null,\n            loaded: false,\n            hasError: false\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const { sticker } = props;\n        const { prevSticker } = state;\n\n        if (prevSticker && sticker && prevSticker !== sticker && prevSticker.sticker.id !== sticker.sticker.id) {\n            return {\n                prevSticker: sticker,\n                loaded: false,\n            };\n        }\n\n        return null;\n    }\n\n    static getDerivedStateFromError(error) {\n        return { hasError: true };\n    }\n\n    componentDidCatch(error, errorInfo) {\n        console.log('[Sticker] render error', error, errorInfo);\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        const { chatId, messageId, sticker, blur, displaySize } = this.props;\n        const { animationData, loaded, pngUrl } = this.state;\n\n        if (animationData !== nextState.animationData) {\n            return true;\n        }\n\n        if (loaded !== nextState.loaded) {\n            return true;\n        }\n\n        if (chatId !== nextProps.chatId) {\n            return true;\n        }\n\n        if (messageId !== nextProps.messageId) {\n            return true;\n        }\n\n        if (sticker !== nextProps.sticker) {\n            return true;\n        }\n\n        if (blur !== nextProps.blur) {\n            return true;\n        }\n\n        if (displaySize !== nextProps.displaySize) {\n            return true;\n        }\n\n        if (pngUrl !== nextState.pngUrl) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevProps.sticker !== this.props.sticker) {\n            this.loadContent();\n        }\n    }\n\n    componentDidMount() {\n        this.loadContent();\n\n        AppStore.on('clientUpdateDialogChatId', this.onClientUpdateDialogChatId);\n        AppStore.on('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.on('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        AppStore.on('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        InstantViewStore.on('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n        FileStore.on('clientUpdateStickerThumbnailBlob', this.onClientUpdateStickerThumbnailBlob);\n        FileStore.on('clientUpdateStickerThumbnailPngBlob', this.onClientUpdateStickerThumbnailPngBlob);\n        FileStore.on('clientUpdateStickerBlob', this.onClientUpdateStickerBlob);\n        FileStore.on('clientUpdateStickerPngBlob', this.onClientUpdateStickerPngBlob);\n        MessageStore.on('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n        StickerStore.on('clientUpdateStickerPreview', this.onClientUpdateStickerPreview);\n        StickerStore.on('clientUpdateStickerSet', this.onClientUpdateStickerSet);\n    }\n\n    componentWillUnmount() {\n        this.removeContent();\n\n        AppStore.off('clientUpdateDialogChatId', this.onClientUpdateDialogChatId);\n        AppStore.off('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.off('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        AppStore.off('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        InstantViewStore.off('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n        FileStore.off('clientUpdateStickerThumbnailBlob', this.onClientUpdateStickerThumbnailBlob);\n        FileStore.off('clientUpdateStickerThumbnailPngBlob', this.onClientUpdateStickerThumbnailPngBlob);\n        FileStore.off('clientUpdateStickerBlob', this.onClientUpdateStickerBlob);\n        FileStore.off('clientUpdateStickerPngBlob', this.onClientUpdateStickerPngBlob);\n        MessageStore.off('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n        StickerStore.off('clientUpdateStickerPreview', this.onClientUpdateStickerPreview);\n        StickerStore.off('clientUpdateStickerSet', this.onClientUpdateStickerSet);\n    }\n\n    onClientUpdateInstantViewContent = update => {\n        this.ivOpened = Boolean(InstantViewStore.getCurrent());\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateDialogChatId = update => {\n        this.chatPopupOpened = Boolean(AppStore.dialogChatId);\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateMediaViewerContent = update => {\n        this.mediaViewerOpened = Boolean(AppStore.mediaViewerContent);\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateProfileMediaViewerContent = update => {\n        this.profileMediaViewerOpened = Boolean(AppStore.profileMediaViewerContent);\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateStickerPreview = update => {\n        this.stickerPreviewOpened = Boolean(update.sticker);\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateMessagesInView = update => {\n        const { chatId, messageId } = this.props;\n        const key = `${chatId}_${messageId}`;\n\n        this.messageInView = update.messages.has(key);\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateStickerSet = update => {\n        this.stickerSetOpened = Boolean(update.stickerSet);\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateFocusWindow = update => {\n        const { focused } = update;\n        const { chatId, messageId, sticker } = this.props;\n\n        const isAnimated = isValidAnimatedSticker(sticker, chatId, messageId);\n        if (!isAnimated) return;\n\n        this.windowFocused = focused;\n        this.startStopAnimation();\n    };\n\n    startStopAnimation() {\n        const { autoplay, source } = this.props;\n\n        const player = this.lottieRef.current;\n        if (!player) return;\n\n        const {\n            windowFocused,\n            chatPopupOpened,\n            mediaViewerOpened,\n            profileMediaViewerOpened,\n            ivOpened,\n            stickerPreviewOpened,\n            stickerSetOpened,\n            messageInView,\n            mouseEntered,\n            completeLoop\n        } = this;\n\n        if (!windowFocused) {\n            // console.log('[sticker] stop focused', [source, autoplay]);\n            player.pause();\n            return;\n        }\n\n        if (chatPopupOpened) {\n            // console.log('[sticker] stop chatPopupOpened', [source, autoplay]);\n            player.pause();\n            return;\n        }\n\n        if (mediaViewerOpened) {\n            // console.log('[sticker] stop mediaViewerOpened', [source, autoplay]);\n            player.pause();\n            return;\n        }\n\n        if (profileMediaViewerOpened) {\n            // console.log('[sticker] stop profileMediaViewerOpened', [source, autoplay]);\n            player.pause();\n            return;\n        }\n\n        if (ivOpened) {\n            // console.log('[sticker] stop ivOpened', [source, autoplay]);\n            player.pause();\n            return;\n        }\n\n        if (!autoplay && !mouseEntered && !completeLoop) {\n            // console.log('[sticker] stop !autoplay && !mouseEntered', [source, autoplay]);\n            player.pause();\n            return;\n        }\n\n        switch (source) {\n            case StickerSourceEnum.HINTS: {\n                const playing = !stickerSetOpened && !stickerPreviewOpened;\n\n                if (playing) {\n                    player.play();\n                    return;\n                }\n                break;\n            }\n            case StickerSourceEnum.MESSAGE: {\n                const playing = !stickerSetOpened && messageInView && !stickerPreviewOpened;\n\n                if (playing) {\n                    player.play();\n                    return;\n                }\n                break;\n            }\n            case StickerSourceEnum.PICKER: {\n                const playing = !stickerSetOpened && !stickerPreviewOpened;\n\n                if (playing) {\n                    player.play();\n                    return;\n                }\n                break;\n            }\n            case StickerSourceEnum.PICKER_HEADER: {\n                const playing = !stickerSetOpened && !stickerPreviewOpened;\n\n                if (playing) {\n                    player.play();\n                    return;\n                }\n                break;\n            }\n            case StickerSourceEnum.PREVIEW: {\n                const playing = true;\n\n                if (playing) {\n                    player.play();\n                    return;\n                }\n                break;\n            }\n            case StickerSourceEnum.STICKER_SET: {\n                const playing = stickerSetOpened && !stickerPreviewOpened;\n\n                if (playing) {\n                    player.play();\n                    return;\n                }\n                break;\n            }\n            case StickerSourceEnum.UNKNOWN: {\n                break;\n            }\n        }\n\n        // console.log('[sticker] stop', [source, autoplay]);\n        player.pause();\n    }\n\n    onClientUpdateStickerBlob = async update => {\n        const { sticker, is_animated } = this.props.sticker;\n        const { fileId } = update;\n\n        if (!sticker) return;\n        if (sticker.id !== fileId) return;\n\n        if (is_animated) {\n            this.loadContent();\n        } else {\n            if (!await isWebpSupported()) return;\n\n            this.forceUpdate();\n            // FileStore.convertWebpToPng(fileId);\n        }\n    };\n\n    onClientUpdateStickerPngBlob = update => {\n        const { sticker, is_animated } = this.props.sticker;\n        const { fileId } = update;\n\n        if (!sticker) return;\n        if (sticker.id !== fileId) return;\n        if (is_animated) return;\n\n        this.forceUpdate();\n    }\n\n    onClientUpdateStickerThumbnailBlob = async update => {\n        const { thumbnail } = this.props.sticker;\n        if (!thumbnail) return;\n\n        const { fileId } = update;\n\n        const { file } = thumbnail;\n        if (!file) return;\n        if (file.id !== fileId) return;\n        if (!await isWebpSupported()) return;\n\n        this.forceUpdate();\n    };\n\n    onClientUpdateStickerThumbnailPngBlob = update => {\n        const { thumbnail } = this.props.sticker;\n        if (!thumbnail) return;\n\n        const { fileId } = update;\n\n        const { file } = thumbnail;\n        if (!file) return;\n        if (file.id !== fileId) return;\n\n        this.forceUpdate();\n    };\n\n    loadContent = async () => {\n        const { chatId, messageId, sticker: source, autoplay, play } = this.props;\n        const { is_animated, sticker } = source;\n        const isAnimated = isValidAnimatedSticker(source, chatId, messageId);\n\n        if (!is_animated) return;\n        if (!isAnimated) return;\n        if (!play) return;\n\n        const blob = getBlob(sticker);\n        if (!blob) return;\n\n        const animationData = blob;\n        if (!animationData) return;\n\n        if (autoplay) {\n            this.setState({ fileId: sticker.id, animationData });\n        } else {\n            this.fileId = sticker.id;\n            this.animationData = animationData;\n        }\n    };\n\n    removeContent = () => {\n        const { animationData } = this.state;\n        if (!animationData) return;\n\n        this.setState({\n            animationData: null\n        });\n    };\n\n    handleMouseEnter = () => {\n        const { autoplay } = this.props;\n        if (autoplay) return;\n\n        const { animationData, fileId } = this;\n        if (!animationData) return;\n\n        this.setState({ animationData, fileId }, () => {\n            this.handleAnimationMouseEnter();\n        });\n    };\n\n    handleAnimationMouseEnter = () => {\n        const { autoplay } = this.props;\n        if (autoplay) return;\n\n        const player = this.lottieRef.current;\n        if (!player) return;\n\n        this.loopCount = 0;\n        this.mouseEntered = true;\n        this.completeLoop = false;\n\n        this.startStopAnimation();\n    };\n\n    handleAnimationLoopComplete = () => {\n        const { autoplay } = this.props;\n        if (autoplay) return;\n\n        const player = this.lottieRef.current;\n        if (!player) return;\n\n        if (!this.mouseEntered) this.loopCount += 1;\n        if (this.loopCount > 0) {\n            this.completeLoop = false;\n\n            const { animationData } = this.state;\n            if (animationData) {\n                this.setState({ loaded: false, animationData: null });\n            }\n        }\n    };\n\n    handleMouseOut = () => {\n        const { autoplay } = this.props;\n        if (autoplay) return;\n\n        this.mouseEntered = false;\n        this.completeLoop = true;\n    };\n\n    handleLoad = () => {\n        this.setState({ loaded: true });\n    };\n\n    render() {\n        const {\n            chatId,\n            messageId,\n            autoplay,\n            className,\n            displaySize,\n            sticker: source,\n            style,\n            openMedia,\n            preview,\n            inViewportFunc,\n            meta\n        } = this.props;\n        const { thumbnail, sticker, width, height } = source;\n        const { fileId, animationData, loaded, hasError } = this.state;\n\n        const isAnimated = isValidAnimatedSticker(source, chatId, messageId);\n\n        const thumbnailSrc =\n            WebpManager.isWebpSupported()\n                ? getSrc(thumbnail ? thumbnail.file : null)\n                : getPngSrc(thumbnail ? thumbnail.file : null);\n        const src =\n            WebpManager.isWebpSupported() || isAnimated\n                ? getSrc(sticker)\n                : getPngSrc(sticker);\n        const isBlurred = isBlurredThumbnail(thumbnail, displaySize) || !preview;\n\n        if (hasError) {\n            const style = {\n                width: displaySize,\n                height: displaySize\n            };\n\n            if (process.env.NODE_ENV !== 'production') {\n                style.background = '#ff000066';\n            }\n\n            return (\n                <div className={classNames('sticker', className)} style={style} onClick={openMedia}>\n                    { thumbnailSrc && (\n                        <img\n                            className={classNames('sticker-image', { 'media-blurred': isBlurred })}\n                            draggable={false}\n                            src={thumbnailSrc}\n                            alt=''\n                        />\n                    )}\n                </div>\n            );\n        }\n\n        let content = null;\n        const fitSize = getFitSize({ width, height }, displaySize);\n        if (fitSize) {\n            content = isAnimated ? (\n                <>\n                    {animationData && (\n                        <React.Suspense fallback={null}>\n                            <RLottie\n                                ref={this.lottieRef}\n                                options={{\n                                    width: displaySize,\n                                    height: displaySize,\n                                    autoplay,\n                                    loop: true,\n                                    fileId,\n                                    animationData,\n                                    inViewportFunc\n                                }}\n                                eventListeners={[\n                                    {\n                                        eventName: 'loopComplete',\n                                        callback: this.handleAnimationLoopComplete\n                                    },\n                                    {\n                                        eventName: 'firstFrame',\n                                        callback: this.handleLoad\n                                    }\n                                ]}\n                            />\n                        </React.Suspense>\n                    )}\n                </>\n            ) : (\n                <>\n                    { src && !preview && <img key={sticker.id} className='sticker-image' src={src} draggable={false} alt='' onLoad={this.handleLoad} /> }\n                </>\n            );\n        }\n\n        const stickerStyle = {\n            width: fitSize ? fitSize.width : 0,\n            height: fitSize ? fitSize.height : 0,\n            ...style\n        };\n\n        return (\n            <div\n                className={classNames('sticker', className)}\n                style={stickerStyle}\n                onClick={openMedia}\n                onMouseEnter={this.handleMouseEnter}\n                onMouseOut={this.handleMouseOut}>\n                { thumbnailSrc && (\n                    <img\n                        className={classNames('sticker-image', { 'media-blurred': isBlurred, 'media-loaded': loaded })}\n                        draggable={false}\n                        src={thumbnailSrc}\n                        alt=''\n                    />\n                )}\n                {content}\n                {meta}\n            </div>\n        );\n    }\n}\n\nSticker.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    sticker: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n\n    autoplay: PropTypes.bool,\n    play: PropTypes.bool,\n    displaySize: PropTypes.number,\n    preview: PropTypes.bool,\n    source: PropTypes.string\n};\n\nSticker.defaultProps = {\n    chatId: 0,\n    messageId: 0,\n    openMedia: () => {},\n\n    autoplay: true,\n    play: true,\n    displaySize: STICKER_DISPLAY_SIZE,\n    preview: false,\n    source: StickerSourceEnum.UNKNOWN\n};\n\nexport default Sticker;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass AnimationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.savedAnimations = null;\n        this.animationsInView = null;\n    };\n\n    onUpdate = async update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateSavedAnimations': {\n                this.savedAnimations = await TdLibController.send({\n                    '@type': 'getSavedAnimations'\n                })\n\n                this.emit('updateSavedAnimations', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateAnimationSend': {\n                this.emit('clientUpdateAnimationSend', update);\n                break;\n            }\n            case 'clientUpdateAnimationsInView': {\n                this.animationsInView = update.animations;\n                this.emit('clientUpdateAnimationsInView', update);\n                break;\n            }\n            case 'clientUpdateAnimationPreview': {\n                this.emit('clientUpdateAnimationPreview', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n}\n\nconst store = new AnimationStore();\nwindow.animation = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { POLL_OPTION_LENGTH, POLL_QUESTION_LENGTH } from '../Constants';\n\nexport function isValidPoll(poll) {\n    if (!poll) return false;\n\n    const { question, options } = poll;\n    if (!isValidQuestion(question)) return false;\n\n    const noneEmptyOptions = options.filter(x => Boolean(x.text));\n    if (noneEmptyOptions.length <= 1) return false;\n\n    return noneEmptyOptions.every(isValidOption);\n}\n\nfunction isValidQuestion(question) {\n    if (!question) return false;\n\n    return question.length <= POLL_QUESTION_LENGTH;\n}\n\nfunction isValidOption(option) {\n    if (!option) return false;\n    if (!option.text) return false;\n\n    return option.text.length <= POLL_OPTION_LENGTH;\n}\n\nexport function hasPollData(poll) {\n    if (!poll) return false;\n\n    const { question, options } = poll;\n    if (question) return true;\n\n    return options.some(x => Boolean(x.text));\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function setPollAnswer(chatId, messageId, optionIds) {\n    TdLibController.send({\n        '@type': 'setPollAnswer',\n        chat_id: chatId,\n        message_id: messageId,\n        option_ids: optionIds\n    });\n}\n\nexport function cancelPollAnswer(chatId, messageId) {\n    TdLibController.send({\n        '@type': 'setPollAnswer',\n        chat_id: chatId,\n        message_id: messageId,\n        option_ids: []\n    });\n}\n\nexport function stopPoll(chatId, messageId) {\n    TdLibController.send({\n        '@type': 'stopPoll',\n        chat_id: chatId,\n        message_id: messageId,\n        reply_markup: null\n    });\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { getUserStatus, isUserOnline } from '../../Utils/User';\nimport UserStore from '../../Stores/UserStore';\nimport './UserStatus.css';\n\nclass UserStatus extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.userId !== state.prevUserId) {\n            const { userId } = props;\n            const user = UserStore.get(userId);\n\n            return {\n                prevUserId: userId,\n                status: getUserStatus(user),\n                isAccent: isUserOnline(user)\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { userId } = this.props;\n        const { status, isAccent } = this.state;\n\n        if (nextProps.userId !== userId) {\n            return true;\n        }\n\n        if (nextState.status !== status) {\n            return true;\n        }\n\n        if (nextState.isAccent !== isAccent) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        UserStore.on('updateUserStatus', this.onUpdateUserStatus);\n    }\n\n    componentWillUnmount() {\n        UserStore.off('updateUserStatus', this.onUpdateUserStatus);\n    }\n\n    onUpdateUserStatus = update => {\n        const { userId } = this.props;\n        if (userId !== update.user_id) return;\n\n        const user = UserStore.get(userId);\n        this.setState({ status: getUserStatus(user), isAccent: isUserOnline(user) });\n    };\n\n    render() {\n        const { status, isAccent } = this.state;\n\n        return (\n            <div className={classNames('user-content', 'dialog-content', { 'user-status-accent': isAccent })}>\n                {status}\n            </div>\n        );\n    }\n}\n\nUserStatus.propTypes = {\n    userId: PropTypes.number.isRequired\n};\n\nexport default UserStatus;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\nimport { isValidPoll } from '../Utils/Poll';\n\nclass PollStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.poll = null;\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateClosePollResults': {\n                this.emit('clientUpdateClosePollResults', update);\n                break;\n            }\n            case 'clientUpdateNewPoll': {\n                this.set({\n                    type: {\n                        '@type': 'pollTypeRegular',\n                        allow_multiple_answers: false\n                    },\n                    id: Date.now(),\n                    question: '',\n                    options: [],\n                    is_anonymous: true\n                });\n\n                this.emit('clientUpdateNewPoll', update);\n                break;\n            }\n            case 'clientUpdatePollChangeAnonymous': {\n                const { poll } = this;\n                const isAnonymous = poll && poll.is_anonymous;\n\n                this.assign(this.poll, { is_anonymous: !isAnonymous });\n\n                this.emit('clientUpdatePollChangeAnonymous', update);\n                break;\n            }\n            case 'clientUpdatePollChangeAllowMultipleAnswers': {\n                const { poll } = this;\n                const { type } = poll;\n                if (type['@type'] === 'pollTypeRegular') {\n                    const allowMultipleAnswers = poll && poll.type.allow_multiple_answers;\n\n                    const newType = { ...type, allow_multiple_answers: !allowMultipleAnswers };\n\n                    this.assign(this.poll, { type: newType });\n                }\n\n                this.emit('clientUpdatePollChangeAllowMultipleAnswers', update);\n                break;\n            }\n            case 'clientUpdatePollChangeType': {\n                const { poll } = this;\n                const { type } = poll;\n                if (type['@type'] === 'pollTypeRegular') {\n                    const newType = { '@type': 'pollTypeQuiz', correct_option_id: -1 };\n\n                    this.assign(this.poll, { type: newType });\n                } else {\n                    const newType = { '@type': 'pollTypeRegular', allow_multiple_answers: false };\n\n                    this.assign(this.poll, { type: newType });\n                }\n\n                this.emit('clientUpdatePollChangeType', update);\n                break;\n            }\n            case 'clientUpdatePollChooseOption': {\n                const { id } = update;\n                const { options } = this.poll;\n\n                this.assign(this.poll, {\n                    options: options.map(x => (x.id === id ? { ...x, is_chosen: true } : { ...x, is_chosen: false }))\n                });\n\n                this.emit('clientUpdatePollChooseOption', update);\n                break;\n            }\n            case 'clientUpdatePollQuestion': {\n                const { question } = update;\n\n                this.assign(this.poll, { question });\n\n                this.emit('clientUpdatePollQuestion', update);\n                break;\n            }\n            case 'clientUpdatePollOption': {\n                const { id, text } = update;\n                const { options } = this.poll;\n\n                this.assign(this.poll, { options: options.map(x => (x.id === id ? { ...x, text } : { ...x })) });\n\n                this.emit('clientUpdatePollOption', update);\n                break;\n            }\n            case 'clientUpdateNewPollOption': {\n                const { option } = update;\n                const { options } = this.poll;\n\n                this.assign(this.poll, { options: [...options, option] });\n                this.emit('clientUpdateNewPollOption', update);\n                break;\n            }\n            case 'clientUpdateDeletePollOption': {\n                const { id } = update;\n                const { options } = this.poll;\n\n                this.assign(this.poll, { options: options.filter(x => x.id !== id) });\n                this.emit('clientUpdateDeletePollOption', update);\n                break;\n            }\n            case 'clientUpdateDeletePoll': {\n                this.set(null);\n\n                this.emit('clientUpdateDeletePoll', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    assign(source1, source2) {\n        this.set(Object.assign({}, source1, source2));\n    }\n\n    set(poll) {\n        this.poll = poll;\n    }\n\n    getInputMessagePoll() {\n        if (!this.poll) return null;\n        if (!isValidPoll(this.poll)) return null;\n        const { question, options, type, is_anonymous } = this.poll;\n\n        if (type['@type'] === 'pollTypeQuiz') {\n            type.correct_option_id = options.findIndex(x => x.is_chosen);\n\n            if (type.correct_option_id === -1) {\n                return null;\n            }\n        }\n\n        return {\n            '@type': 'inputMessagePoll',\n            question,\n            options: options.filter(x => Boolean(x.text)).map(x => x.text),\n            is_anonymous,\n            type,\n            is_closed: false\n        };\n    }\n}\n\nconst store = new PollStore();\nwindow.poll = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Draws a rounded rectangle using the current state of the canvas.\n * If you omit the last three params, it will draw a rectangle\n * outline with a 5 pixel border radius\n * @param {CanvasRenderingContext2D} ctx\n * @param {Number} x The top left x coordinate\n * @param {Number} y The top left y coordinate\n * @param {Number} width The width of the rectangle\n * @param {Number} height The height of the rectangle\n * @param {Number} [radius = 5] The corner radius; It can also be an object\n *                 to specify different radii for corners\n * @param {Number} [radius.tl = 0] Top left\n * @param {Number} [radius.tr = 0] Top right\n * @param {Number} [radius.br = 0] Bottom right\n * @param {Number} [radius.bl = 0] Bottom left\n * @param {Boolean} [fill = false] Whether to fill the rectangle.\n * @param {Boolean} [stroke = true] Whether to stroke the rectangle.\n */\nfunction roundRect(ctx, x, y, width, height, radius, fill, stroke) {\n    if (typeof stroke === 'undefined') {\n        stroke = true;\n    }\n    if (typeof radius === 'undefined') {\n        radius = 5;\n    }\n    if (typeof radius === 'number') {\n        radius = { tl: radius, tr: radius, br: radius, bl: radius };\n    } else {\n        var defaultRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\n        for (var side in defaultRadius) {\n            radius[side] = radius[side] || defaultRadius[side];\n        }\n    }\n    ctx.beginPath();\n    ctx.moveTo(x + radius.tl, y);\n    ctx.lineTo(x + width - radius.tr, y);\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);\n    ctx.lineTo(x + width, y + height - radius.br);\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radius.br, y + height);\n    ctx.lineTo(x + radius.bl, y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);\n    ctx.lineTo(x, y + radius.tl);\n    ctx.quadraticCurveTo(x, y, x + radius.tl, y);\n    ctx.closePath();\n    if (fill) {\n        ctx.fill();\n    }\n    if (stroke) {\n        ctx.stroke();\n    }\n}\n\nclass Particle {\n    constructor(fireworks) {\n        this.fireworks = fireworks;\n        this.type = 0;\n        this.colorType = 0;\n        this.side = 0;\n        this.typeSize = 4;\n        this.xFinished = false;\n        this.finishedStart = false;\n\n        this.x = 0;\n        this.y = 0;\n        this.rotation = 0;\n        this.moveX = 0;\n        this.moveY = 0;\n    }\n\n    draw(ctx) {\n        ctx.fillStyle = this.colorType;\n\n        if (this.type === 0) {\n            ctx.beginPath();\n            ctx.arc(this.x, this.y, this.typeSize, 0, Math.PI * 2, false);\n            ctx.fill();\n        } else {\n            ctx.save();\n            ctx.translate(this.x, this.y);\n            ctx.rotate((this.rotation * Math.PI) / 180);\n            roundRect(ctx, -this.typeSize, -2, this.typeSize * 2, 4, 2, true, false);\n            ctx.restore();\n        }\n    }\n\n    update(dt) {\n        const moveCoef = dt / 16.0;\n        this.x += this.moveX * moveCoef;\n        this.y += this.moveY * moveCoef;\n        if (this.xFinished !== 0) {\n            const dp = 0.5;\n            if (this.xFinished === 1) {\n                this.moveX += dp * moveCoef * 0.05;\n                if (this.moveX >= dp) {\n                    this.xFinished = 2;\n                }\n            } else {\n                this.moveX -= dp * moveCoef * 0.05;\n                if (this.moveX <= -dp) {\n                    this.xFinished = 1;\n                }\n            }\n        } else {\n            if (this.side === 0) {\n                if (this.moveX > 0) {\n                    this.moveX -= moveCoef * 0.05;\n                    if (this.moveX <= 0) {\n                        this.moveX = 0;\n                        this.xFinished = this.finishedStart;\n                    }\n                }\n            } else {\n                if (this.moveX < 0) {\n                    this.moveX += moveCoef * 0.05;\n                    if (this.moveX >= 0) {\n                        this.moveX = 0;\n                        this.xFinished = this.finishedStart;\n                    }\n                }\n            }\n        }\n        let yEdge = -0.5;\n        const wasNegative = this.moveY < yEdge;\n        if (this.moveY > yEdge) {\n            this.moveY += (1.0 / 3.0) * moveCoef * this.fireworks.speedCoef;\n        } else {\n            this.moveY += (1.0 / 3.0) * moveCoef;\n        }\n        if (wasNegative && this.moveY > yEdge) {\n            this.fireworks.fallingDownCount++;\n        }\n        if (this.type === 1) {\n            this.rotation += moveCoef * 10;\n            if (this.rotation > 360) {\n                this.rotation -= 360;\n            }\n        }\n\n        return this.y >= this.fireworks.getMeasuredHeight();\n    }\n}\n\nfunction getRandomInt(min, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random() * (max - min)) + min;\n}\n\nclass Fireworks {\n    static colors = ['#E8BC2C', '#D0049E', '#02CBFE', '#5723FD', '#FE8C27', '#6CB859'];\n\n    constructor(context) {\n        this.context = context;\n        this.particlesCount = 60;\n        this.fallParticlesCount = 30;\n        this.particles = [];\n        this.speedCoef = 1.0;\n        this.fallingDownCount = 0;\n    }\n\n    getMeasuredHeight() {\n        return this.context.canvas.clientHeight;\n    }\n\n    getMeasuredWidth() {\n        return this.context.canvas.clientWidth;\n    }\n\n    createParticle(fall) {\n        const particle = new Particle(this);\n        particle.colorType = Fireworks.colors[getRandomInt(0, Fireworks.colors.length)];\n        particle.type = getRandomInt(0, 2);\n        particle.side = getRandomInt(0, 2);\n        particle.finishedStart = 1 + getRandomInt(0, 2);\n        if (particle.type === 0) {\n            particle.typeSize = 4 + Math.random() * 2;\n        } else {\n            particle.typeSize = 4 + Math.random() * 4;\n        }\n        if (fall) {\n            particle.y = -Math.random() * this.getMeasuredHeight() * 1.2;\n            particle.x = 5 + getRandomInt(0, this.getMeasuredWidth() - 10);\n            particle.xFinished = particle.finishedStart;\n        } else {\n            const xOffset = 4 + getRandomInt(0, 10);\n            const yOffset = this.getMeasuredHeight() / 4;\n            if (particle.side === 0) {\n                particle.x = -xOffset;\n            } else {\n                particle.x = this.getMeasuredWidth() + xOffset;\n            }\n            particle.rotation = Math.random() * 360;\n            particle.moveX = (particle.side === 0 ? 1 : -1) * (1.2 + Math.random() * 4);\n            particle.moveY = -(4 + Math.random() * 4);\n            particle.y = yOffset / 2 + getRandomInt(0, yOffset * 2);\n        }\n        // console.log(`particle side=${particle.side} x=${particle.x} y=${particle.y} moveX=${particle.moveX} moveY=${particle.moveY}`);\n        return particle;\n    }\n\n    start() {\n        if (this.started) {\n            return;\n        }\n\n        this.particles = [];\n        this.started = true;\n        this.startedFall = false;\n        this.fallingDownCount = 0;\n        this.speedCoef = 1.0;\n        this.lastUpdateTime = 0;\n        for (let a = 0; a < this.particlesCount; a++) {\n            this.particles.push(this.createParticle(false));\n        }\n\n        this.draw();\n    }\n\n    startFall() {\n        if (this.startedFall) {\n            return;\n        }\n        this.startedFall = true;\n        for (let a = 0; a < this.fallParticlesCount; a++) {\n            this.particles.push(this.createParticle(true));\n        }\n    }\n\n    draw() {\n        const newTime = Date.now();\n        let dt = newTime - this.lastUpdateTime;\n        this.lastUpdateTime = newTime;\n        if (dt > 18) {\n            dt = 16;\n        }\n        // console.log('draw dt', dt);\n        this.context.clearRect(0, 0, this.getMeasuredWidth(), this.getMeasuredHeight());\n        for (let a = 0, N = this.particles.length; a < N; a++) {\n            const p = this.particles[a];\n            p.draw(this.context);\n            if (p.update(dt)) {\n                this.particles.splice(a, 1);\n                a--;\n                N--;\n            }\n        }\n        if (this.fallingDownCount >= this.particlesCount / 2 && this.speedCoef > 0.2) {\n            this.startFall();\n            this.speedCoef -= (dt / 16.0) * 0.15;\n            if (this.speedCoef < 0.2) {\n                this.speedCoef = 0.2;\n            }\n        }\n        if (this.particles.length) {\n            window.requestAnimationFrame(() => this.draw());\n        } else {\n            this.started = false;\n            this.context.clearRect(0, 0, this.getMeasuredWidth(), this.getMeasuredHeight());\n        }\n    }\n}\n\nclass FireworksComponent extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.canvasRef = React.createRef();\n    }\n\n    componentDidMount() {\n        this.attachToParent();\n    }\n\n    componentWillUnmount() {\n        this.detachFromParent();\n    }\n\n    attachToParent() {\n        const canvas = this.canvasRef.current;\n        if (!canvas) return;\n\n        const parentNode = canvas.parentNode;\n        if (!parentNode) return;\n\n        this.parentNode = parentNode;\n        canvas.setAttribute('width', this.parentNode.clientWidth + 18);\n        canvas.setAttribute('height', this.parentNode.clientHeight + 12);\n        window.addEventListener('resize', this.onResize);\n    }\n\n    detachFromParent() {\n        const canvas = this.canvasRef.current;\n        if (!canvas) return;\n\n        const parentNode = canvas.parentNode;\n        if (!parentNode) return;\n\n        this.parentNode = null;\n        window.removeEventListener('resize', this.onResize);\n    }\n\n    onResize = () => {\n        const canvas = this.canvasRef.current;\n        if (!canvas) return;\n\n        canvas.setAttribute('width', this.parentNode.clientWidth + 18);\n        canvas.setAttribute('height', this.parentNode.clientHeight + 12);\n    };\n\n    start() {\n        const ctx = this.canvasRef.current.getContext('2d');\n\n        const fireworks = new Fireworks(ctx);\n        fireworks.start();\n    }\n\n    render() {\n        return (\n            <canvas\n                ref={this.canvasRef}\n                style={{\n                    zIndex: 2,\n                    position: 'absolute',\n                    left: 0,\n                    top: 0,\n                    width: '100%',\n                    height: '100%',\n                    pointerEvents: 'none'\n                }}\n            />\n        );\n    }\n}\n\nFireworksComponent.propTypes = {};\n\nexport default FireworksComponent;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport Radio from '@material-ui/core/Radio';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport './PollRadio.css';\n\nclass PollRadio extends React.Component {\n    render() {\n        const { chosen, beingChosen, hidden, onChange } = this.props;\n\n        return (\n            <div className={classNames('poll-radio', { 'poll-radio-hidden': hidden })}>\n                <Radio\n                    color='primary'\n                    classes={{\n                        root: 'poll-radio-root',\n                        colorPrimary: 'message-control',\n                        disabled: 'message-control-disabled'\n                    }}\n                    TouchRippleProps={{ classes: { child: 'touch-ripple-current-color' } }}\n                    checked={chosen || beingChosen}\n                    onChange={onChange}\n                    checkedIcon={<RadioButtonCheckedIcon classes={{ root: beingChosen ? 'poll-radio-icon' : null }} />}\n                />\n                {beingChosen && (\n                    <CircularProgress\n                        size={20}\n                        thickness={4.4}\n                        classes={{ root: 'poll-radio-progress-root', colorPrimary: 'message-control' }}\n                    />\n                )}\n            </div>\n        );\n    }\n}\n\nPollRadio.propTypes = {\n    chosen: PropTypes.bool,\n    beingChosen: PropTypes.bool,\n    hidden: PropTypes.bool\n};\n\nexport default PollRadio;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { ANIMATION_DURATION_200MS } from './../../../Constants';\nimport './PollPercentage.css';\n\nclass PollPercentage extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.handle = null;\n\n        const { value } = props;\n\n        this.state = {\n            from: value,\n            to: value,\n            animated: value,\n\n            prevPropsValue: value\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        const { closed, theme, value } = this.props;\n        const { animated } = this.state;\n\n        if (closed !== nextProps.closed) {\n            return true;\n        }\n\n        if (theme !== nextProps.theme) {\n            return true;\n        }\n\n        if (value !== nextProps.value) {\n            return true;\n        }\n\n        if (animated !== nextState.animated) {\n            return true;\n        }\n\n        return false;\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.value !== state.prevPropsValue) {\n            return {\n                startTime: Date.now(),\n                from: state.animated,\n                to: props.value,\n\n                prevPropsValue: props.value\n            };\n        }\n\n        return null;\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevProps.value !== this.props.value) {\n            this.updateAnimation();\n        }\n    }\n\n    componentWillUnmount() {\n        this.stopAnimation();\n    }\n\n    updateAnimation = () => {\n        this.stopAnimation();\n\n        this.handle = requestAnimationFrame(this.onAnimationFrame);\n    };\n\n    stopAnimation = () => {\n        if (!this.handle) return;\n\n        cancelAnimationFrame(this.handle);\n        this.handle = null;\n    };\n\n    onAnimationFrame = () => {\n        const { startTime, from, to } = this.state;\n\n        const timePassed = Date.now() - startTime;\n\n        if (timePassed >= ANIMATION_DURATION_200MS) {\n            this.setState({ animated: to });\n            this.stopAnimation();\n        } else {\n            const animated = from + Math.floor(((to - from) * timePassed) / ANIMATION_DURATION_200MS);\n            this.setState({ animated });\n            this.handle = requestAnimationFrame(this.onAnimationFrame);\n        }\n    };\n\n    render() {\n        const { chosen, closed, onClick } = this.props;\n        const { animated } = this.state;\n\n        return (\n            <div className='poll-percentage'>\n                {/*{!closed && chosen ? (*/}\n                {/*    <a className='poll-percentage-action' onClick={onClick}>*/}\n                {/*        {animated + '%'}*/}\n                {/*    </a>*/}\n                {/*) : (*/}\n                {/*    <>{animated + '%'}</>*/}\n                {/*)}*/}\n                <>{animated + '%'}</>\n            </div>\n        );\n    }\n}\n\nPollPercentage.propTypes = {\n    value: PropTypes.number.isRequired,\n    chosen: PropTypes.bool,\n    closed: PropTypes.bool,\n    onClick: PropTypes.func\n};\n\nexport default PollPercentage;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport CheckIcon from '../../../Assets/Icons/Check';\nimport CloseIcon from '../../../Assets/Icons/Close';\nimport PollRadio from './PollRadio';\nimport PollPercentage from './PollPercentage';\nimport './PollOption.css';\n\nclass PollOption extends React.Component {\n    getTitleString = (count, t = key => key) => {\n        const { canBeSelected } = this.props;\n        if (canBeSelected) return null;\n\n        if (!count) return t('NoVotes').toLowerCase();\n        if (count === 1) return '1 vote';\n\n        return count + ' votes';\n    };\n\n    handleClick = event => {\n        const { canBeSelected, onVote } = this.props;\n        if (!canBeSelected) return;\n\n        event.stopPropagation();\n\n        onVote();\n    };\n\n    render() {\n        const { option, onChange, canBeSelected, closed, maxVoterCount, t, type, isCorrect } = this.props;\n        if (!option) return null;\n\n        const { text, voter_count, vote_percentage, is_chosen, isMultiChoosen, is_being_chosen } = option;\n\n        let value = 1.5;\n        if (voter_count) {\n            value = (voter_count / maxVoterCount) * 100;\n        }\n\n        return (\n            <div className='poll-option' onClick={this.handleClick}>\n                <div\n                    className={classNames(\n                        'poll-option-wrapper',\n                        canBeSelected ? 'poll-option-unselected' : 'poll-option-selected'\n                    )}>\n                    <div className='poll-option-text-wrapper' title={this.getTitleString(voter_count, t)}>\n                        <PollPercentage value={vote_percentage} chosen={is_chosen} closed={closed} />\n                        <PollRadio\n                            hidden={!canBeSelected}\n                            chosen={is_chosen || isMultiChoosen}\n                            beingChosen={is_being_chosen}\n                            onChange={onChange}\n                        />\n                        {(is_chosen || isCorrect) && (\n                            <div\n                                className={classNames(\n                                    'poll-option-mark',\n                                    { 'poll-option-mark-correct': type === 'correct' },\n                                    { 'poll-option-mark-incorrect': type === 'incorrect' }\n                                )}>\n                                {type === 'incorrect' ? (\n                                    <CloseIcon className='poll-option-mark-icon' />\n                                ) : (\n                                    <CheckIcon className='poll-option-mark-icon' />\n                                )}\n                            </div>\n                        )}\n                        <div className='poll-option-text'>{text}</div>\n                    </div>\n                </div>\n                <LinearProgress\n                    classes={{\n                        root: 'poll-option-progress-root',\n                        bar: classNames(\n                            'poll-option-progress-bar',\n                            { 'poll-option-progress-bar-correct': type === 'correct' },\n                            { 'poll-option-progress-bar-incorrect': type === 'incorrect' }\n                        )\n                    }}\n                    color='primary'\n                    variant='determinate'\n                    value={canBeSelected ? 0 : Math.max(1.5, value)}\n                />\n            </div>\n        );\n    }\n}\n\nPollOption.propTypes = {\n    type: PropTypes.oneOf(['regular', 'correct', 'incorrect']).isRequired,\n    option: PropTypes.object.isRequired,\n    onVote: PropTypes.func.isRequired,\n    canBeSelected: PropTypes.bool,\n    closed: PropTypes.bool,\n    maxVoterCount: PropTypes.number\n};\n\nexport default withTranslation()(PollOption);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './UserPlaceholder.css';\nimport UserStatus from './UserStatus';\n\nclass UserPlaceholder extends React.Component {\n    render() {\n        const { index, showStatus } = this.props;\n\n        const titleWidth = `${20 + Math.sin(index) * 10}%`;\n        const contentWidth = `${30 + Math.cos(index) * 10}%`;\n\n        return (\n            <div className='user-placeholder'>\n                <div className='user-wrapper'>\n                    <div className='user-placeholder-tile' />\n                    <div className='user-placeholder-inner-wrapper'>\n                        <div className='tile-first-row'>\n                            <div className='dialog-placeholder-title' style={{ width: titleWidth }} />\n                            <div className='dialog-placeholder-title' style={{ width: contentWidth, marginLeft: 8 }} />\n                        </div>\n                        {showStatus && (\n                            <div className='tile-second-row'>\n                                <div className='dialog-placeholder-content' style={{ width: contentWidth }} />\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nUserPlaceholder.propTypes = {\n    index: PropTypes.number.isRequired,\n    showStatus: PropTypes.bool\n};\n\nUserPlaceholder.defaultProps = {\n    showStatus: true\n};\n\nexport default UserPlaceholder;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ListItem from '@material-ui/core/ListItem';\nimport User from '../Tile/User';\nimport UserPlaceholder from '../Tile/UserPlaceholder';\nimport { openUser } from '../../Actions/Client';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './PollOptionResult.css';\n\nclass PollOptionResult extends React.Component {\n    onClick = () => {\n        const { userId } = this.props;\n        if (!userId) return;\n\n        openUser(userId, true);\n\n        setTimeout(() => {\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateClosePollResults'\n            });\n        }, 0);\n    };\n\n    render() {\n        const { index, userId } = this.props;\n\n        const content = userId ? (\n            <User userId={userId} showStatus={false} />\n        ) : (\n            <UserPlaceholder index={index} showStatus={false} />\n        );\n\n        return (\n            <ListItem button className='user-list-item' onClick={this.onClick}>\n                {content}\n            </ListItem>\n        );\n    }\n}\n\nPollOptionResult.propTypes = {\n    index: PropTypes.number.isRequired,\n    userId: PropTypes.number\n};\n\nexport default PollOptionResult;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport PollOptionResult from './PollOptionResult';\nimport { loadUsersContent } from '../../Utils/File';\nimport { POLL_RESULTS_FIRST_SLICE_LENGTH, POLL_RESULTS_LEAVE_LENGTH, POLL_RESULTS_SLICE_LENGTH } from '../../Constants';\nimport FileStore from '../../Stores/FileStore';\nimport UserStore from '../../Stores/UserStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './PollOptionResults.css';\n\nclass PollOptionResults extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { option } = this.props;\n\n        const count =\n            option && option.voter_count <= POLL_RESULTS_FIRST_SLICE_LENGTH\n                ? option.voter_count\n                : POLL_RESULTS_FIRST_SLICE_LENGTH - POLL_RESULTS_LEAVE_LENGTH;\n\n        this.state = {\n            voters: [],\n            offset: 0,\n            count\n        };\n    }\n\n    async updateVoters(offset, count, loadMore) {\n        const { chatId, messageId, optionId, option } = this.props;\n        const { voters } = this.state;\n        if (count <= 0) return;\n\n        const limit = count - offset;\n        // console.log(`[poll] getPollVoters start option_id=${optionId} offset=${offset} limit=${limit}`);\n        const result = await TdLibController.send({\n            '@type': 'getPollVoters',\n            chat_id: chatId,\n            message_id: messageId,\n            option_id: optionId,\n            offset,\n            limit\n        });\n        // console.log(`[poll] getPollVoters end option_id=${optionId} offset=${offset} limit=${limit}`, result, result.user_ids.map(x => UserStore.get(x)));\n\n        if (this.props.option !== option) {\n            return;\n        }\n\n        const store = FileStore.getStore();\n        loadUsersContent(store, result.user_ids);\n\n        this.setState(\n            {\n                voters: [...voters, ...result.user_ids]\n            },\n            async () => {\n                if (result.user_ids.length < limit && loadMore) {\n                    const offset2 = offset + result.user_ids.length;\n\n                    this.updateVoters(offset2, count, false);\n                }\n            }\n        );\n    }\n\n    componentDidMount() {\n        const { offset, count } = this.state;\n\n        this.updateVoters(offset, count, true);\n    }\n\n    handleShowMore = () => {\n        const { option } = this.props;\n        const { count } = this.state;\n\n        const newOffset = count;\n        const newCount = Math.min(option.voter_count, count + POLL_RESULTS_SLICE_LENGTH);\n\n        this.setState(\n            {\n                offset: newOffset,\n                count: newCount\n            },\n            () => {\n                this.updateVoters(newOffset, newCount, true);\n            }\n        );\n    };\n\n    handleCollapse = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { option } = this.props;\n\n        const count =\n            option && option.voter_count <= POLL_RESULTS_FIRST_SLICE_LENGTH\n                ? option.voter_count\n                : POLL_RESULTS_FIRST_SLICE_LENGTH - POLL_RESULTS_LEAVE_LENGTH;\n\n        this.setState({\n            voters: this.state.voters.slice(0, count),\n            offset: 0,\n            count\n        });\n    };\n\n    render() {\n        const { option, isQuiz, t } = this.props;\n        const { voters, count } = this.state;\n\n        const { text, voter_count, vote_percentage } = option;\n        if (voter_count === 0) {\n            return null;\n        }\n\n        const results = [];\n        for (let i = 0; i < count; i++) {\n            const userId = i < voters.length ? voters[i] : null;\n            results.push(<PollOptionResult key={`${i}_userId=${userId}`} index={i} userId={userId} />);\n        }\n\n        const voterCount = isQuiz\n            ? voter_count !== 1\n                ? `${voter_count} answers`\n                : `${voter_count} answer`\n            : voter_count !== 1\n            ? `${voter_count} votes`\n            : `${voter_count} vote`;\n\n        let showMoreButton = null;\n        const showMoreCount = voter_count - count;\n        if (showMoreCount > 0) {\n            const showMore = isQuiz\n                ? showMoreCount !== 1\n                    ? `${showMoreCount} answers`\n                    : `${showMoreCount} answer`\n                : showMoreCount !== 1\n                ? `${showMoreCount} votes`\n                : `${showMoreCount} vote`;\n\n            showMoreButton = (\n                <Button\n                    classes={{ root: 'poll-option-results-button' }}\n                    color='primary'\n                    fullWidth\n                    onClick={this.handleShowMore}>\n                    {t('ShowVotesOT').replace('%1$d', showMore)}\n                </Button>\n            );\n        }\n        const showCollapse =\n            count > POLL_RESULTS_FIRST_SLICE_LENGTH - POLL_RESULTS_LEAVE_LENGTH &&\n            voter_count > POLL_RESULTS_FIRST_SLICE_LENGTH;\n\n        return (\n            <>\n                <div className='poll-option-results-caption'>\n                    <div className='poll-option-results-answer'>{`${text}  ${vote_percentage}%`}</div>\n                    {showCollapse ? (\n                        <a onClick={this.handleCollapse}>{t('PollCollapse')}</a>\n                    ) : (\n                        <div className='poll-option-results-count'>{voterCount}</div>\n                    )}\n                </div>\n                {results}\n                {showMoreButton}\n            </>\n        );\n    }\n}\n\nPollOptionResults.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    optionId: PropTypes.number.isRequired,\n    option: PropTypes.object.isRequired,\n    isQuiz: PropTypes.bool.isRequired\n};\n\nexport default withTranslation()(PollOptionResults);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport PollOptionResults from './PollOptionResults';\nimport PollStore from '../../Stores/PollStore';\nimport { modalManager } from '../../Utils/Modal';\nimport './PollResultsDialog.css';\n\nclass PollResultsDialog extends React.Component {\n    componentDidMount() {\n        PollStore.on('clientUpdateClosePollResults', this.onClientUpdateClosePollResults);\n    }\n\n    componentWillUnmount() {\n        PollStore.off('clientUpdateClosePollResults', this.onClientUpdateClosePollResults);\n    }\n\n    onClientUpdateClosePollResults = update => {\n        const { onClose } = this.props;\n        onClose();\n    };\n\n    handleClose = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { onClose } = this.props;\n        onClose();\n    };\n\n    handleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    handleContextMenu = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    render() {\n        const { chatId, messageId, poll, t } = this.props;\n        if (!poll) return;\n\n        const { options, type, question } = poll;\n        const isQuiz = type && type['@type'] === 'pollTypeQuiz';\n\n        return (\n            <Dialog\n                classes={{\n                    root: 'chat-info-dialog-root',\n                    container: 'chat-info-dialog-container',\n                    paper: 'chat-info-dialog-paper'\n                }}\n                manager={modalManager}\n                transitionDuration={0}\n                open={true}\n                onClick={this.handleClick}\n                onContextMenu={this.handleContextMenu}\n                onClose={this.handleClose}\n                aria-labelledby='poll-results-title'>\n                <DialogTitle id='poll-results-title'>{isQuiz ? t('QuizAnswers') : t('PollResults')}</DialogTitle>\n                <DialogContent classes={{ root: 'poll-results-content' }}>\n                    <div className='poll-results-question'>{question}</div>\n                    {options.map((x, i) => (\n                        <PollOptionResults\n                            key={i}\n                            isQuiz={isQuiz}\n                            chatId={chatId}\n                            messageId={messageId}\n                            optionId={i}\n                            option={x}\n                        />\n                    ))}\n                </DialogContent>\n            </Dialog>\n        );\n    }\n}\n\nPollResultsDialog.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    poll: PropTypes.object.isRequired\n};\n\nexport default withTranslation()(PollResultsDialog);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport FireworksComponent from './FireworksControl';\nimport PollOption from './PollOption';\nimport UserTile from '../../Tile/UserTile';\nimport { setPollAnswer } from '../../../Actions/Poll';\nimport MessageStore from './../../../Stores/MessageStore';\nimport TdLibController from './../../../Controllers/TdLibController';\nimport './Poll.css';\nimport PollResultsDialog from '../../Popup/PollResultsDialog';\n\nclass Poll extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.fireworksRef = React.createRef();\n        this.state = {};\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        const { chatId, messageId, poll } = this.props;\n\n        if (poll && poll.type['@type'] === 'pollTypeQuiz') {\n            const { poll: prevPoll } = prevProps;\n            if (prevPoll.type.correct_option_id === -1 && poll.type.correct_option_id !== -1) {\n                const fireworks = this.fireworksRef.current;\n                if (!fireworks) return;\n\n                if (poll.options[poll.type.correct_option_id].is_chosen) {\n                    fireworks.start();\n                } else {\n                    TdLibController.clientUpdate({\n                        '@type': 'clientUpdateMessageShake',\n                        chatId,\n                        messageId\n                    });\n                }\n            }\n        }\n    }\n\n    getTotalVoterCountString = (count, t = key => key) => {\n        if (!count) return t('NoVotes');\n        if (count === 1) return '1 answer';\n\n        return count + ' answers';\n    };\n\n    handleSubmit = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { chatId, messageId, poll } = this.props;\n        if (!poll) return;\n\n        const { type } = poll;\n        if (!type) return;\n\n        if (this.viewResults(poll)) {\n            return;\n        }\n\n        if (!type.allow_multiple_answers) {\n            return;\n        }\n\n        const optionIds = [];\n        poll.options.forEach((x, index) => {\n            if (x.isMultiChoosen) {\n                optionIds.push(index);\n            }\n        });\n\n        if (!optionIds.length) {\n            return;\n        }\n\n        setPollAnswer(chatId, messageId, optionIds);\n    };\n\n    handleVote = index => {\n        const { chatId, messageId, poll } = this.props;\n        if (!poll) return;\n\n        const { type } = poll;\n        if (!type) return;\n\n        if (type['@type'] === 'pollTypeRegular' && type.allow_multiple_answers) {\n            poll.options[index].isMultiChoosen = !poll.options[index].isMultiChoosen;\n            this.forceUpdate();\n        } else {\n            setPollAnswer(chatId, messageId, [index]);\n        }\n    };\n\n    viewResults(poll) {\n        if (!poll) return false;\n\n        const { options, is_closed, is_anonymous } = poll;\n        if (is_anonymous) {\n            return false;\n        }\n\n        return is_closed || options.some(x => x.is_chosen);\n    }\n\n    getOptionType(index, poll) {\n        const types = ['regular', 'correct', 'incorrect'];\n        const defaultTypeId = 0;\n        const correctTypeId = 1;\n        const incorrectTypeId = 2;\n        if (!poll) return types[defaultTypeId];\n\n        const option = poll.options[index];\n        if (!option) return types[defaultTypeId];\n        if (!option.is_chosen) return types[defaultTypeId];\n\n        const { type } = poll;\n        if (!type) return types[defaultTypeId];\n        if (type['@type'] !== 'pollTypeQuiz') return types[defaultTypeId];\n\n        const { correct_option_id } = type;\n        if (correct_option_id === -1) return types[defaultTypeId];\n\n        return correct_option_id === index ? types[correctTypeId] : types[incorrectTypeId];\n    }\n\n    getOptionIsCorrect(index, poll) {\n        if (!poll) return false;\n\n        const option = poll.options[index];\n        if (!option) return false;\n\n        const { type } = poll;\n        if (!type) return false;\n        if (type['@type'] !== 'pollTypeQuiz') return false;\n\n        const { correct_option_id } = type;\n        if (correct_option_id === -1) return false;\n\n        return correct_option_id === index;\n    }\n\n    handleOpenResults = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { poll } = this.props;\n\n        this.setState({\n            viewResultsPoll: poll\n        });\n    };\n\n    handleCloseResults = () => {\n        this.setState({\n            viewResultsPoll: null\n        });\n    };\n\n    render() {\n        const { chatId, messageId, poll, t, meta } = this.props;\n        const { viewResultsPoll } = this.state;\n        const { question, options, total_voter_count, type, is_closed, is_anonymous, recent_voter_user_ids } = poll;\n\n        let subtitle = t('FinalResults');\n        if (!is_closed) {\n            switch (type['@type']) {\n                case 'pollTypeRegular': {\n                    subtitle = is_anonymous ? t('AnonymousPoll') : t('PublicPoll');\n                    break;\n                }\n                case 'pollTypeQuiz': {\n                    subtitle = is_anonymous ? t('AnonymousQuizPoll') : t('QuizPoll');\n                    break;\n                }\n            }\n        }\n\n        const message = MessageStore.get(chatId, messageId);\n        if (!message) return null;\n\n        const isQuiz = type && type['@type'] === 'pollTypeQuiz';\n        const canBeSelected = !is_closed && options.every(x => !x.is_chosen);\n        const isSelected = !is_closed && options.some(x => x.is_chosen);\n        const maxVoterCount = Math.max(...options.map(x => x.voter_count));\n        const showViewResults = this.viewResults(poll);\n        const showButton = (type.allow_multiple_answers && !isSelected) || showViewResults;\n        const buttonEnabled = showViewResults || options.some(x => x.isMultiChoosen);\n        let recentVoters = [];\n        if (recent_voter_user_ids) {\n            recentVoters = recent_voter_user_ids.map(id => <UserTile key={id} poll userId={id} />);\n        }\n\n        return (\n            <div className='poll'>\n                {isQuiz && <FireworksComponent ref={this.fireworksRef} />}\n                <div className='poll-question'>\n                    <div className='poll-question-title'>{question}</div>\n                    <div className='poll-question-subtitle'>\n                        <span style={{ marginRight: 6 }}>{subtitle}</span>\n                        {recentVoters}\n                    </div>\n                </div>\n                <div className='poll-options'>\n                    {options.map((x, index) => (\n                        <PollOption\n                            key={index}\n                            type={this.getOptionType(index, poll)}\n                            isCorrect={this.getOptionIsCorrect(index, poll)}\n                            option={x}\n                            canBeSelected={canBeSelected}\n                            closed={is_closed}\n                            maxVoterCount={maxVoterCount}\n                            onVote={() => this.handleVote(index)}\n                        />\n                    ))}\n                </div>\n                {showButton ? (\n                    <Button\n                        fullWidth\n                        color='primary'\n                        classes={{\n                            root: 'poll-button',\n                            textPrimary: 'message-control',\n                            disabled: 'message-control-disabled'\n                        }}\n                        TouchRippleProps={{ classes: { child: 'touch-ripple-current-color' } }}\n                        disabled={!buttonEnabled}\n                        onClick={showViewResults ? this.handleOpenResults : this.handleSubmit}>\n                        {showViewResults ? t('PollViewResults') : t('PollSubmitVotes')}\n                    </Button>\n                ) : (\n                    <div className='poll-total-count'>\n                        {this.getTotalVoterCountString(total_voter_count, t)}\n                        {meta}\n                    </div>\n                )}\n                {Boolean(viewResultsPoll) && (\n                    <PollResultsDialog\n                        chatId={chatId}\n                        messageId={messageId}\n                        poll={viewResultsPoll}\n                        onClose={this.handleCloseResults}\n                    />\n                )}\n            </div>\n        );\n    }\n}\n\nPoll.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    poll: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default withTranslation()(Poll);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport AppStore from '../Stores/ApplicationStore';\nimport { clearOpenChatOptions } from './Client';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport async function sendBotStartMessage(chatId, botUserId, parameter) {\n    clearOpenChatOptions();\n\n    await AppStore.invokeScheduledAction(`clientUpdateClearHistory chatId=${chatId}`);\n    return TdLibController.send({\n        '@type': 'sendBotStartMessage',\n        bot_user_id: botUserId,\n        chat_id: chatId,\n        parameter\n    });\n}\n\nexport function requestBlockSender(sender) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateRequestBlockSender',\n        sender\n    });\n}\n\nexport function blockSender(sender) {\n    toggleMessageSenderIsBlocked(sender, true);\n}\n\nexport function unblockSender(sender) {\n    toggleMessageSenderIsBlocked(sender, false);\n}\n\nfunction toggleMessageSenderIsBlocked(sender, isBlocked) {\n    TdLibController.send({\n        '@type': 'toggleMessageSenderIsBlocked',\n        sender,\n        is_blocked: isBlocked\n    });\n}\n\nexport function openChatSelect(options) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateChatSelect',\n        options\n    });\n}\n\nexport function closeChatSelect() {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateChatSelect',\n        options: null\n    });\n}\n\nexport function startMessageEditing(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateStartMessageEditing',\n        chatId,\n        messageId\n    });\n}\n\nexport function stopMessageEditing(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateStopMessageEditing',\n        chatId,\n        messageId\n    });\n}\n\nexport function viewMessages(chatId, messageIds, forceRead) {\n    TdLibController.send({\n        '@type': 'viewMessages',\n        chat_id: chatId,\n        message_ids: messageIds,\n        force_read: forceRead\n    });\n}\n\nexport function pinMessage(chatId, messageId, disableNotification = false, onlyForSelf = false) {\n    TdLibController.send({\n        '@type': 'pinChatMessage',\n        chat_id: chatId,\n        message_id: messageId,\n        disable_notification: disableNotification,\n        only_for_self: onlyForSelf\n    });\n}\n\nexport function unpinMessage(chatId, messageId) {\n    return TdLibController.send({\n        '@type': 'unpinChatMessage',\n        chat_id: chatId,\n        message_id: messageId,\n    });\n}\n\nexport function unpinAllMessages(chatId) {\n    return TdLibController.send({\n        '@type': 'unpinAllChatMessages',\n        chat_id: chatId\n    });\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport { getUserFullName } from '../../Utils/User';\nimport UserStore from '../../Stores/UserStore';\nimport './UserTitle.css';\n\nclass UserTitle extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.userId !== state.prevUserId) {\n            const { userId, t } = props;\n\n            return {\n                prevUserId: userId,\n                fullName: getUserFullName(userId, null, t)\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { userId } = this.props;\n        const { fullName } = this.state;\n\n        if (nextProps.userId !== userId) {\n            return true;\n        }\n\n        if (nextState.fullName !== fullName) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        UserStore.on('updateUser', this.onUpdateUser);\n    }\n\n    componentWillUnmount() {\n        UserStore.off('updateUser', this.onUpdateUser);\n    }\n\n    onUpdateUser = update => {\n        const { userId, t } = this.props;\n        if (userId !== update.user.id) return;\n\n        this.setState({ fullName: getUserFullName(userId, null, t) });\n    };\n\n    render() {\n        const { fullName } = this.state;\n\n        return (\n            <div className='user-title'>{fullName}</div>\n        );\n    }\n}\n\nUserTitle.propTypes = {\n    userId: PropTypes.number.isRequired\n};\n\nexport default withTranslation()(UserTitle);","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport UserStatus from './UserStatus';\nimport UserTile from './UserTile';\nimport UserTitle from './UserTitle';\nimport UserStore from './../../Stores/UserStore';\nimport './User.css';\n\nclass User extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            user: UserStore.get(props.userId)\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        return nextProps.userId !== this.props.userId;\n    }\n\n    handleClick = () => {\n        const { userId, onSelect } = this.props;\n        if (!onSelect) return;\n\n        onSelect(userId);\n    };\n\n    render() {\n        const { userId, showStatus, showUsername } = this.props;\n\n        const user = UserStore.get(userId);\n        if (!user) {\n            console.error('[user] can\\'t find', userId);\n            return null;\n        }\n\n        const { username } = user;\n\n        return (\n            <div className='user' onClick={this.handleClick}>\n                <div className='user-wrapper'>\n                    <UserTile userId={userId} />\n                    <div className='user-inner-wrapper'>\n                        <div className='tile-first-row'>\n                            <UserTitle userId={userId}/>\n                        </div>\n                        {showStatus && (\n                            <div className='tile-second-row'>\n                                {username && showUsername ? <div className='user-content dialog-content'>{'@' + username}</div> : <UserStatus userId={userId} /> }\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nUser.propTypes = {\n    userId: PropTypes.number.isRequired,\n    onSelect: PropTypes.func,\n    showStatus: PropTypes.bool,\n    showUsername: PropTypes.bool\n};\n\nUser.defaultProps = {\n    showStatus: true,\n    showUsername: false\n};\n\nexport default User;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function openGroupCallPanel() {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateGroupCallPanel',\n        opened: true\n    });\n}\n\nexport function closeGroupCallPanel() {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateGroupCallPanel',\n        opened: false\n    });\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\nimport { isValidPoll } from '../Utils/Poll';\n\nclass FilterStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.chatList = { '@type': 'chatListMain' };\n        this.filters = null;\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateChatFilters': {\n                const { chat_filters } = update;\n\n                this.filters = chat_filters;\n                this.emit('updateChatFilters', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateChatList': {\n                const { chatList } = update;\n\n                this.chatList = chatList;\n\n                this.emit('clientUpdateChatList', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n}\n\nconst store = new FilterStore();\nwindow.filter = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport Slider from '@material-ui/core/Slider';\nimport VolumeMuteIcon from '@material-ui/icons/VolumeMute';\nimport VolumeDownIcon from '@material-ui/icons/VolumeDown';\nimport VolumeUpIcon from '@material-ui/icons/VolumeUp';\nimport VolumeOffIcon from '@material-ui/icons/VolumeOff';\nimport PictureInPictureIcon from '@material-ui/icons/PictureInPicture';\nimport FullScreen from '../../Assets/Icons/FullScreen';\nimport PlayIcon from '../../Assets/Icons/PlayArrow';\nimport PauseIcon from '../../Assets/Icons/Pause';\nimport Hint from './Hint';\nimport Progress from './Progress';\nimport { clamp, getDurationString } from '../../Utils/Common';\nimport {\n    PLAYER_LOOP_MAX_DURATION,\n    PLAYER_PLAYBACKRATE_MAX,\n    PLAYER_PLAYBACKRATE_MIN,\n    PLAYER_PLAYBACKRATE_STEP,\n    PLAYER_SEEK_STEP_BIG,\n    PLAYER_SEEK_STEP_SMALL,\n    PLAYER_VOLUME_MAX,\n    PLAYER_VOLUME_MIN,\n    PLAYER_VOLUME_STEP\n} from '../../Constants';\nimport FileStore from '../../Stores/FileStore';\nimport PlayerStore from '../../Stores/PlayerStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './Player.css';\n\nclass Player extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.rootRef = React.createRef();\n        this.contentRef = React.createRef();\n        this.videoRef = React.createRef();\n\n        const { currentTime, duration } = this.getCurrentTime();\n\n        this.state = {\n            noPoster: currentTime > 0 && duration > 0,\n            duration,\n            currentTime,\n            volume: PlayerStore.volume,\n            play: true,\n            dragging: false,\n            buffered: null,\n            waiting: true,\n            hidden: false\n        };\n    }\n\n    onKeyDown = event => {\n        const { key, code, altKey, ctrlKey, metaKey, shiftKey } = event;\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        let handled = false;\n        switch (code) {\n            case 'ArrowLeft': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.currentTime - PLAYER_SEEK_STEP_SMALL);\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyJ': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.currentTime - PLAYER_SEEK_STEP_BIG);\n                    handled = true;\n                }\n                break;\n            }\n            case 'ArrowRight': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.currentTime + PLAYER_SEEK_STEP_SMALL);\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyL': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.currentTime + PLAYER_SEEK_STEP_BIG);\n                    handled = true;\n                }\n                break;\n            }\n            case 'ArrowUp': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleVolume(video.volume + PLAYER_VOLUME_STEP);\n                    handled = true;\n                }\n                break;\n            }\n            case 'ArrowDown': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleVolume(video.volume - PLAYER_VOLUME_STEP);\n                    handled = true;\n                }\n                break;\n            }\n            case 'Space':\n            case 'KeyK': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleClick();\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyM': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleMute();\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyF': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleFullScreen();\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyI': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handlePictureInPicture();\n                    handled = true;\n                }\n                break;\n            }\n            case 'Digit0':\n            case 'Digit1':\n            case 'Digit2':\n            case 'Digit3':\n            case 'Digit4':\n            case 'Digit5':\n            case 'Digit6':\n            case 'Digit7':\n            case 'Digit8':\n            case 'Digit9': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    const progress = new Number(key.replace('Digit', '')) / 10.0;\n                    this.handleSeekProgress(progress);\n                    handled = true;\n                }\n                break;\n            }\n            case 'Home': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(0);\n                    handled = true;\n                }\n                break;\n            }\n            case 'End': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.duration - 1.0);\n                    handled = true;\n                }\n                break;\n            }\n            case 'Comma': {\n                if (!altKey && !ctrlKey && !metaKey && shiftKey) {\n                    this.handlePlaybackRate(video.playbackRate - PLAYER_PLAYBACKRATE_STEP);\n                    handled = true;\n                }\n                break;\n            }\n            case 'Period': {\n                if (!altKey && !ctrlKey && !metaKey && shiftKey) {\n                    this.handlePlaybackRate(video.playbackRate + PLAYER_PLAYBACKRATE_STEP);\n                    handled = true;\n                }\n                break;\n            }\n        }\n\n        if (handled) {\n            event.stopPropagation();\n            event.preventDefault();\n        }\n    };\n\n    handleVolume = volume => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        volume = clamp(volume, PLAYER_VOLUME_MIN, PLAYER_VOLUME_MAX);\n\n        video.volume = volume;\n        this.showMediaHint(`${Math.round(video.volume * 100)}%`);\n    };\n\n    handlePlaybackRate = rate => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        rate = clamp(rate, PLAYER_PLAYBACKRATE_MIN, PLAYER_PLAYBACKRATE_MAX)\n\n        video.playbackRate = rate;\n        this.showMediaHint(`${rate}x`);\n    };\n\n    handleSeekProgress = progress => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        this.handleSeek(progress * video.duration);\n    };\n\n    handleSeek = currentTime => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        currentTime = clamp(currentTime, 0, video.duration || 0);\n\n        video.currentTime = currentTime;\n        this.setState({ currentTime });\n    };\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaShortcut', this.onClientUpdateMediaShortcut);\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { volume } = this.state;\n\n        video.volume = volume;\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaShortcut', this.onClientUpdateMediaShortcut);\n    }\n\n    onClientUpdateMediaShortcut = update => {\n        const { event } = update;\n        if (!event) return;\n\n        this.onKeyDown(event);\n    };\n\n    load() {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        video.load();\n\n        this.setState({\n            duration: 0,\n            currentTime: 0,\n            play: true,\n            dragging: false,\n            buffered: null,\n            waiting: true\n        });\n    }\n\n    handleClick = () => {\n        this.startStopPlayer();\n    };\n\n    startStopPlayer = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { waiting } = this.state;\n        if (waiting) {\n            this.setState({\n                play: !this.state.play,\n                hidden: false\n            });\n        } else {\n            if (video.paused) {\n                video.play()\n            } else {\n                video.pause();\n            }\n        }\n    };\n\n    handlePlay = event => {\n        const { onPlay } = this.props;\n\n        this.setState({\n            play: true,\n            hidden: true\n        });\n\n        TdLibController.clientUpdate({ '@type': 'clientUpdateMediaViewerPlay' });\n        onPlay && onPlay(event);\n    };\n\n    handlePause = event => {\n        const { onPause } = this.props;\n\n        this.setState({\n            play: false,\n            hidden: false\n        });\n\n        TdLibController.clientUpdate({ '@type': 'clientUpdateMediaViewerPause' });\n        onPause && onPause(event);\n    };\n\n    handleEnded = event => {\n        const { onEnded } = this.props;\n\n        TdLibController.clientUpdate({ '@type': 'clientUpdateMediaViewerEnded' });\n        onEnded && onEnded(event);\n\n        const video = this.videoRef.current;\n        this.setCurrentTime({ currentTime: 0, duration: video.duration });\n    };\n\n    handleTimeUpdate = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { fileId } = this.props;\n        const { currentTime, duration, volume, buffered } = video;\n\n        this.setState({\n            duration,\n            currentTime,\n            volume,\n            buffered\n        });\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaViewerTimeUpdate',\n            fileId,\n            currentTime,\n            duration,\n            volume,\n            buffered\n        });\n\n        this.setCurrentTime({ currentTime, duration });\n    };\n\n    handleLoadedData = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n    };\n\n    handleLoadedMetadata = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { currentTime } = this.state;\n        const { duration, volume, buffered } = video;\n\n        this.setState({\n            duration,\n            volume,\n            waiting: true,\n            buffered\n        }, () => {\n            if (!currentTime) return;\n\n            video.currentTime = currentTime;\n        });\n    };\n\n    handleMouseDown = event => {\n        event.stopPropagation();\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        this.setState({\n            dragging: true,\n            draggingTime: video.currentTime\n        });\n    };\n\n    handleChange = (event, value) => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        this.setState({\n            draggingTime: value * video.duration\n        });\n    };\n\n    handleChangeCommitted = () => {\n        const { dragging, draggingTime } = this.state;\n        if (!dragging) return;\n\n        this.setState({\n            dragging: false,\n            currentTime: draggingTime,\n            draggingTime: 0\n        }, () => {\n            const video = this.videoRef.current;\n            if (!video) return;\n\n            if (Number.isFinite(draggingTime)) {\n                video.currentTime = draggingTime;\n            }\n        });\n    };\n\n    handleFullScreen = event => {\n        event && event.stopPropagation();\n\n        const root = this.contentRef.current;\n        if (!root) return;\n\n        const fullscreenElement = document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement;\n        if (fullscreenElement) {\n            this.exitFullscreen();\n            return;\n        }\n\n        this.requestFullscreen(root);\n    };\n\n    requestFullscreen(element) {\n        const method = element.requestFullscreen || element.mozRequestFullScreen || element.webkitRequestFullscreen;\n\n        method && method.call(element);\n    }\n\n    exitFullscreen() {\n        const method = document.exitFullscreen || document.mozCancelFullScreen || document.webkitExitFullscreen;\n\n        method && method.call(document);\n    }\n\n    handleClickRoot = event => {\n        event.stopPropagation();\n\n        const { mouseDownRoot } = this;\n        if (!mouseDownRoot) return;\n\n        this.mouseDownRoot = false;\n        this.startStopPlayer();\n    }\n\n    handleMouseDownRoot = event => {\n        this.mouseDownRoot = true;\n        event.stopPropagation();\n    }\n\n    static getVolumeIcon = value => {\n        if (value === 0) {\n            return <VolumeOffIcon fontSize='small' />;\n        }\n\n        if (value < 0.25) {\n            return <VolumeMuteIcon fontSize='small' />;\n        }\n\n        if (value < 0.5) {\n            return <VolumeDownIcon fontSize='small' />;\n        }\n\n        return <VolumeUpIcon fontSize='small' />;\n    };\n\n    handleVolumeChange = event => {\n        const { onVolumeChange } = this.props;\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { volume } = video;\n\n        this.setState({\n            volume\n        });\n\n        TdLibController.clientUpdate({ '@type' : 'clientUpdateMediaVolume', volume });\n        onVolumeChange && onVolumeChange(event);\n    };\n\n    handleVolumeSliderChange = (event, volume) => {\n        if (volume === this.state.volume) return;\n\n        this.setState({\n            volume\n        }, () => {\n            const video = this.videoRef.current;\n            if (!video) return;\n\n            video.volume = volume;\n        });\n    };\n\n    handleVolumeSliderChangeCommitted = event => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        document.activeElement.blur();\n    };\n\n    showMediaHint(text) {\n        const { fileId } = this.props;\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaHint',\n            fileId,\n            text\n        });\n    }\n\n    handleMute = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        if (video.volume === 0) {\n            video.volume = this.prevVolume || 0.5;\n        } else {\n            this.prevVolume = video.volume;\n            video.volume = 0;\n        }\n    }\n\n    handleProgress = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { fileId } = this.props;\n\n        const { buffered } = video;\n\n        this.setState({\n            buffered\n        });\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaViewerProgress',\n            fileId,\n            buffered\n        });\n    };\n\n    static getBufferedTime = (time, buffered) => {\n        if (!buffered || !buffered.length) {\n            return 0;\n        }\n\n        for (let i = 0; i < buffered.length; i++) {\n            const start = buffered.start(i);\n            const end = buffered.end(i);\n            if (start <= time && time < end) {\n                return end;\n            }\n        }\n\n        return 0;\n    }\n\n    handleWaiting = () => {\n        this.setState({ waiting: true });\n    };\n\n    handleCanPlay = event => {\n        const { target: video } = event;\n\n        this.setState({\n            waiting: false\n        }, () => {\n            if (!video) return;\n\n            const { play } = this.state;\n            if (play) {\n                video.play();\n            } else {\n                video.pause();\n            }\n        });\n    };\n\n    handlePictureInPicture = async () => {\n        const { fileId } = this.props;\n        const { duration, currentTime, volume, play, buffered, waiting } = this.state;\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdatePictureInPicture',\n            videoInfo: {\n                fileId,\n                video,\n                duration,\n                currentTime,\n                volume,\n                play,\n                buffered,\n                waiting\n            }\n        });\n\n        return;\n\n        if (!video.duration) return;\n\n        const pictureInPictureElement = document.pictureInPictureElement || document.mozPictureInPictureElement || document.webkitPictureInPictureElement;\n        if (pictureInPictureElement) {\n            this.exitPictureInPicture();\n            return;\n        }\n\n        try {\n            const pipWindow = await this.requestPictureInPicture(video);\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateMediaViewerContent',\n                content: null\n            });\n            video.onpause = event => {\n                event.target.play();\n                event.target.onpause = null;\n            };\n            video.addEventListener('leavepictureinpicture', this.handleLeavePictureInPicture);\n        } catch (error) { }\n    };\n\n    handleLeavePictureInPicture = event => {\n        const video = this.videoRef.current;\n\n        if (!video) event.target.src = null;\n        event.target.removeEventListener('leavepictureinpicture', this.handleLeavePictureInPicture);\n    };\n\n    async requestPictureInPicture(element) {\n        const method = element.requestPictureInPicture || element.mozRequestPictureInPicture || element.webkitRequestPictureInPicture;\n        if (!method) return null;\n\n        return method.call(element);\n    }\n\n    exitPictureInPicture() {\n        const method = document.exitPictureInPicture || document.mozExitPictureInPicture || document.webkitExitPictureInPicture;\n\n        method && method.call(document);\n    }\n\n    handleDoubleClick = event => {\n        this.handleFullScreen(event);\n    };\n\n    handleVideoKeyDown = event => {\n        event.preventDefault();\n    };\n\n    handlePanelDoubleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    handlePanelEnter = () => {\n        this.panelEnter = true;\n    };\n\n    handlePanelLeave = () => {\n        this.panelEnter = false;\n    };\n\n    handleMouseOver = event => {\n        const { hidden } = this.state;\n\n        if (hidden) {\n            this.setState({\n                hidden: false\n            });\n        }\n\n        clearTimeout(this.mouseOverTimeout);\n        this.mouseOverTimeout = setTimeout(() => {\n            if (this.panelEnter) return;\n            if (!this.state.play) return;\n\n            this.setState({\n                hidden: true\n            });\n        }, 1000);\n    };\n\n    getCurrentTime = () => {\n        const { fileId } = this.props;\n\n        const file = FileStore.get(fileId);\n        if (!file) return { currentTime: 0, duration: 0 };\n\n        const { remote } = file;\n        if (!remote) return { currentTime: 0, duration: 0 };\n\n        const { unique_id } = remote;\n        if (!unique_id) return { currentTime: 0, duration: 0 };\n\n        return PlayerStore.getCurrentTime(unique_id);\n    };\n\n    setCurrentTime = currentTime => {\n        const { fileId } = this.props;\n\n        const file = FileStore.get(fileId);\n        if (!file) return;\n\n        const { remote } = file;\n        if (!remote) return;\n\n        const { unique_id } = remote;\n        if (!unique_id) return;\n\n        if (!currentTime) {\n            PlayerStore.clearCurrentTime(unique_id);\n        } else {\n            PlayerStore.setCurrentTime(unique_id, currentTime);\n        }\n    };\n\n    render() {\n        const { children, src, className, style, width, height, poster, fileId } = this.props;\n        const { waiting, volume, duration, currentTime, play, dragging, draggingTime, buffered, hidden, noPoster } = this.state;\n\n        const time = dragging ? draggingTime : currentTime;\n        const value = duration > 0 ? time / duration : 0;\n        const bufferedTime = Player.getBufferedTime(time, buffered);\n        const bufferedValue = duration > 0 ? bufferedTime / duration : 0;\n\n        const timeString = getDurationString(Math.floor(time) || 0);\n        const durationString = getDurationString(Math.floor(duration) || 0);\n        const rootStyle = {\n            ...style,\n            width,\n            height\n        }\n\n        const fullscreenEnabled = document.fullscreenEnabled || document.mozFullScreenEnabled || document.webkitFullscreenEnabled;\n        const pictureInPictureEnabled = true;//document.pictureInPictureEnabled || document.mozPictureInPictureEnabled || document.webkitPictureInPictureEnabled;\n\n        return (\n            <div\n                ref={this.rootRef}\n                className={classNames('player', className)}\n                onMouseDown={this.handleMouseDownRoot}\n                onClick={this.handleClickRoot}\n                onDoubleClick={this.handleDoubleClick}\n                style={rootStyle}>\n                <div ref={this.contentRef} className={classNames('player-content', { 'player-content-hidden': hidden })} onMouseMove={this.handleMouseOver}>\n                    <video\n                        className='player-video'\n                        ref={this.videoRef}\n                        autoPlay={false}\n                        controls={false}\n                        playsInline={true}\n                        src={src}\n                        poster={noPoster ? null : poster}\n                        loop={duration <= PLAYER_LOOP_MAX_DURATION}\n                        onLoadedMetadata={this.handleLoadedMetadata}\n                        onLoadedData={this.handleLoadedData}\n                        onCanPlay={this.handleCanPlay}\n                        onPlay={this.handlePlay}\n                        onPause={this.handlePause}\n                        onEnded={this.handleEnded}\n                        onTimeUpdate={this.handleTimeUpdate}\n                        onVolumeChange={this.handleVolumeChange}\n                        onProgress={this.handleProgress}\n                        onWaiting={this.handleWaiting}\n                        onKeyDown={this.handleVideoKeyDown}\n                    >\n                        {children}\n                    </video>\n                    <Hint fileId={fileId}/>\n                    <div\n                        className={classNames('player-panel', { 'player-panel-hidden': hidden })}\n                        onClick={e => e.stopPropagation()}\n                        onMouseDown={e => e.stopPropagation()}\n                        onDoubleClick={this.handlePanelDoubleClick}\n                        onMouseEnter={this.handlePanelEnter}\n                        onMouseLeave={this.handlePanelLeave}>\n                        <div className='player-slider'>\n                            <span className='player-slider-buffer-track' style={{ width: bufferedValue * 100 + '%'}}/>\n                            <Slider\n                                value={value}\n                                min={0}\n                                max={1}\n                                step={0.001}\n                                classes={{\n                                    root: 'player-slider-root',\n                                    rail: 'player-slider-rail',\n                                    track: 'player-slider-track',\n                                    thumb: 'player-slider-thumb',\n                                    active: 'player-slider-active'\n                                }}\n                                onChange={this.handleChange}\n                                onChangeCommitted={this.handleChangeCommitted}\n                                onMouseDown={this.handleMouseDown}\n                            />\n                        </div>\n                        <div className='player-controls'>\n                            <button className='player-button' onClick={this.handleClick}>\n                                {play ? <PauseIcon/> : <PlayIcon/>}\n                            </button>\n                            <div className='player-time'>\n                                {`${timeString} / ${durationString}`}\n                            </div>\n                            <div className='player-volume'>\n                                <Slider\n                                    value={volume}\n                                    min={0}\n                                    max={1}\n                                    step={0.001}\n                                    classes={{\n                                        root: 'player-volume-root',\n                                        rail: 'player-volume-rail',\n                                        track: 'player-volume-track',\n                                        thumb: 'player-volume-thumb',\n                                        active: 'player-volume-active'\n                                    }}\n                                    onChange={this.handleVolumeSliderChange}\n                                    onChangeCommitted={this.handleVolumeSliderChangeCommitted}\n                                />\n                            </div>\n                            <button className='player-button' onClick={this.handleMute}>\n                                {Player.getVolumeIcon(volume)}\n                            </button>\n                            <button className='player-button' disabled={!pictureInPictureEnabled} onClick={this.handlePictureInPicture}>\n                                <PictureInPictureIcon/>\n                            </button>\n                            <button className='player-button' disabled={!fullscreenEnabled} onClick={this.handleFullScreen}>\n                                <FullScreen/>\n                            </button>\n                        </div>\n                    </div>\n                    <Progress waiting={waiting}/>\n                </div>\n            </div>\n        );\n    }\n}\n\nPlayer.propTypes = {\n    fileId: PropTypes.number\n};\n\n//export default React.forwardRef((props, ref) => (<Player forwardedRef={ref} {...props}/>));\n\nexport default Player;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <g fillRule='evenodd'>\n        <path d='M6,0 L33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,48 C54,51.3137085 51.3137085,54 48,54 L6,54 C2.6862915,54 4.05812251e-16,51.3137085 0,48 L0,6 C-4.05812251e-16,2.6862915 2.6862915,6.08718376e-16 6,0 Z' />\n        <path\n            d='M33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,22 C54,19.790861 52.209139,18 50,18 L40,18 C37.790861,18 36,16.209139 36,14 L36,4 C36,1.790861 34.209139,-3.88578059e-16 32,0 L33.5147186,0 Z'\n            fill='#000000'\n            style={{ mixBlendMode: 'normal' }}\n            opacity='0.15'\n        />\n    </g>,\n    'Document'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getDownloadedSize, getUploadedSize, getFileSize } from '../../../Utils/File';\nimport FileStore from '../../../Stores/FileStore';\nimport './DocumentAction.css';\n\nclass DocumentAction extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { file } = this.props;\n        this.state = {\n            prevPropsFile: file,\n            prevFile: null,\n            file: FileStore.get(file.id) || file\n        };\n    }\n\n    componentDidMount() {\n        FileStore.on('updateFile', this.onUpdateFile);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('updateFile', this.onUpdateFile);\n    }\n\n    onUpdateFile = update => {\n        const currentFile = this.state.file;\n        const nextFile = update.file;\n\n        if (currentFile && currentFile.id === nextFile.id) {\n            this.setState({ file: nextFile, prevFile: currentFile });\n        }\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        const { file } = props;\n        const { prevPropsFile } = state;\n\n        if (file && prevPropsFile && file.id !== prevPropsFile.id) {\n            return {\n                prevPropsFile: file,\n                prevFile: null,\n                file: FileStore.get(file.id) || file\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { theme } = this.props;\n        const { file, prevFile } = this.state;\n\n        if (nextProps.theme !== theme) {\n            return true;\n        }\n\n        if (nextState.file !== file) {\n            return true;\n        }\n\n        if (nextState.prevFile !== prevFile) {\n            return true;\n        }\n\n        return false;\n    }\n\n    render() {\n        const { date, meta } = this.props;\n        const { file } = this.state;\n        if (!file) return null;\n\n        const isDownloadingActive = file.local && file.local.is_downloading_active;\n        const isUploadingActive = file.remote && file.remote.is_uploading_active;\n\n        const size = getFileSize(file);\n        let progressSize = null;\n        if (isDownloadingActive) {\n            progressSize = getDownloadedSize(file);\n        } else if (isUploadingActive) {\n            progressSize = getUploadedSize(file);\n        }\n\n        const sizeString = progressSize ? `${progressSize}/${size}` : `${size}`;\n\n        return (\n            <div className='document-action'>\n                <span>\n                    {sizeString}\n                    {date && `  ${date}`}\n                </span>\n                {meta}\n            </div>\n        );\n    }\n}\n\nDocumentAction.propTypes = {\n    file: PropTypes.object.isRequired,\n    date: PropTypes.string\n};\n\nexport default DocumentAction;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport DownloadIcon from '../../../Assets/Icons/Download';\nimport DocumentIcon from '../../../Assets/Icons/Document';\nimport DocumentTile from '../../Tile/DocumentTile';\nimport DocumentAction from './DocumentAction';\nimport { getExtension } from '../../../Utils/File';\nimport './Document.css';\n\nclass Document extends React.Component {\n    render() {\n        const { document, openMedia, width, height, meta, title, caption, date } = this.props;\n        if (!document) return null;\n\n        const { minithumbnail, thumbnail, file_name } = document;\n        const file = document.document;\n\n        const style = width && height ? { width, height } : null;\n        const completeIconFunc = thumb =>\n            thumb ? null : (\n                <div className='document-tile-complete-icon'>\n                    <DocumentIcon className='document-tile-icon-fill' viewBox='0 0 54 54' />\n                    <div className='document-tile-file-ext'>{getExtension(file_name)}</div>\n                </div>\n            );\n\n        return (\n            <div className={classNames('document', { 'media-title': title })} style={style}>\n                <DocumentTile\n                    minithumbnail={minithumbnail}\n                    thumbnail={thumbnail}\n                    file={file}\n                    openMedia={openMedia}\n                    icon={<DownloadIcon />}\n                    completeIcon={completeIconFunc}\n                />\n                <div className='document-content'>\n                    <div className='document-title'>\n                        <a\n                            className='document-name'\n                            onClick={openMedia}\n                            title={file_name}\n                            data-name={file_name}\n                            data-ext={'.' + getExtension(file_name)}>\n                            {file_name}\n                        </a>\n                    </div>\n                    <DocumentAction file={file} meta={caption ? null : meta} date={date} />\n                </div>\n            </div>\n        );\n    }\n}\n\nDocument.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    document: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    width: PropTypes.number,\n    height: PropTypes.number,\n    date: PropTypes.string\n};\n\nexport default Document;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport { I18nextProvider } from 'react-i18next';\nimport { getDisplayName } from './Utils/HOC';\nimport LocalizationStore from './Stores/LocalizationStore';\n\nfunction withLanguage(WrappedComponent) {\n    class LanguageWrapper extends React.Component {\n        render() {\n            const i18n = LocalizationStore.i18n;\n\n            return (\n                <I18nextProvider i18n={i18n}>\n                    <WrappedComponent {...this.props} />\n                </I18nextProvider>\n            );\n        }\n    }\n    LanguageWrapper.displayName = `WithLanguage(${getDisplayName(WrappedComponent)})`;\n\n    return LanguageWrapper;\n}\n\nexport default withLanguage;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { getSupergroupId } from './Chat';\nimport ChatStore from '../Stores/ChatStore';\nimport SupergroupStore from '../Stores/SupergroupStore';\nimport LStore from '../Stores/LocalizationStore';\n\nexport function getSupergroupStatus(supergroup, chatId) {\n    if (!supergroup) return null;\n\n    let { status, member_count: count, username, has_location } = supergroup;\n\n    if (status) {\n        if (status['@type'] === 'chatMemberStatusBanned') {\n            return LStore.getString('YouWereKicked');\n        } else if (status['@type'] === 'chatMemberStatusLeft') {\n            // return LStore.getString('YouLeft');\n        } else if (status['@type'] === 'chatMemberStatusCreator' && !status.is_member) {\n            // return LStore.getString('YouLeft');\n        }\n    }\n\n    if (!count) {\n        const fullInfo = SupergroupStore.getFullInfo(supergroup.id);\n        if (fullInfo) {\n            count = fullInfo.member_count;\n        }\n    }\n\n    if (count <= 0) {\n        if (has_location){\n            return LStore.getString('MegaLocation').toLowerCase();\n        }\n\n        return username\n            ? LStore.getString('MegaPublic').toLowerCase()\n            : LStore.getString('MegaPrivate').toLowerCase();\n    }\n\n    if (count <= 1) {\n        return LStore.formatPluralString('Members', count);\n    }\n\n    const onlineCount = ChatStore.getOnlineMemberCount(chatId);\n    if (onlineCount > 1) {\n        return `${LStore.formatPluralString('Members', count)}, ${LStore.formatPluralString('OnlineCount', onlineCount)}`;\n    }\n\n    return LStore.formatPluralString('Members', count);\n}\n\nexport function isPublicSupergroup(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const supergroupId = getSupergroupId(chatId);\n    if (!supergroupId) return false;\n\n    const supergroup = SupergroupStore.get(supergroupId);\n    if (!supergroup) return false;\n\n    const { username } = supergroup;\n\n    return Boolean(username);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path d='M17,2 C19.209139,2 21,3.790861 21,6 L21,20.2543508 C21,21.3589203 20.1045695,22.2543871 19,22.2543871 C18.5225775,22.2543871 18.0609035,22.0835665 17.6984173,21.772864 L12,16.8885064 L6.30158275,21.772864 C5.46293106,22.4917083 4.2003311,22.3945852 3.4814868,21.5559335 C3.17078432,21.1934473 3,20.7317733 3,20.2543508 L3,6 C3,3.790861 4.790861,2 7,2 L17,2 Z M17,4 L7,4 C5.8954305,4 5,4.8954305 5,6 L5,20.2543508 L10.6984173,15.3699931 C11.4473967,14.7280108 12.5526033,14.7280108 13.3015827,15.3699931 L19,20.2543508 L19,6 C19,4.8954305 18.1045695,4 17,4 Z' />,\n    'Saved'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path d='M4.70710678,12.2928932 C4.31658249,11.9023689 3.68341751,11.9023689 3.29289322,12.2928932 C2.90236893,12.6834175 2.90236893,13.3165825 3.29289322,13.7071068 L8.29289322,18.7071068 C8.68341751,19.0976311 9.31658249,19.0976311 9.70710678,18.7071068 L20.7071068,7.70710678 C21.0976311,7.31658249 21.0976311,6.68341751 20.7071068,6.29289322 C20.3165825,5.90236893 19.6834175,5.90236893 19.2928932,6.29289322 L9,16.5857864 L4.70710678,12.2928932 Z' />,\n    'Check'\n);\n","//https://stackoverflow.com/questions/183485/converting-punycode-with-dash-character-to-unicode\n//Javascript Punycode converter derived from example in RFC3492.\n//This implementation is created by some@domain.name and released into public domain\nfunction Punycode() {\n    // This object converts to and from puny-code used in IDN\n    //\n    // punycode.ToASCII ( domain )\n    //\n    // Returns a puny coded representation of \"domain\".\n    // It only converts the part of the domain name that\n    // has non ASCII characters. I.e. it dosent matter if\n    // you call it with a domain that already is in ASCII.\n    //\n    // punycode.ToUnicode (domain)\n    //\n    // Converts a puny-coded domain name to unicode.\n    // It only converts the puny-coded parts of the domain name.\n    // I.e. it dosent matter if you call it on a string\n    // that already has been converted to unicode.\n    //\n    //\n    this.utf16 = {\n        // The utf16-class is necessary to convert from javascripts internal character representation to unicode and back.\n        decode: function(input) {\n            var output = [],\n                i = 0,\n                len = input.length,\n                value,\n                extra;\n            while (i < len) {\n                value = input.charCodeAt(i++);\n                if ((value & 0xf800) === 0xd800) {\n                    extra = input.charCodeAt(i++);\n                    if ((value & 0xfc00) !== 0xd800 || (extra & 0xfc00) !== 0xdc00) {\n                        throw new RangeError('UTF-16(decode): Illegal UTF-16 sequence');\n                    }\n                    value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;\n                }\n                output.push(value);\n            }\n            return output;\n        },\n        encode: function(input) {\n            var output = [],\n                i = 0,\n                len = input.length,\n                value;\n            while (i < len) {\n                value = input[i++];\n                if ((value & 0xf800) === 0xd800) {\n                    throw new RangeError('UTF-16(encode): Illegal UTF-16 value');\n                }\n                if (value > 0xffff) {\n                    value -= 0x10000;\n                    output.push(String.fromCharCode(((value >>> 10) & 0x3ff) | 0xd800));\n                    value = 0xdc00 | (value & 0x3ff);\n                }\n                output.push(String.fromCharCode(value));\n            }\n            return output.join('');\n        }\n    };\n\n    //Default parameters\n    var initial_n = 0x80;\n    var initial_bias = 72;\n    var delimiter = '\\x2D';\n    var base = 36;\n    var damp = 700;\n    var tmin = 1;\n    var tmax = 26;\n    var skew = 38;\n    var maxint = 0x7fffffff;\n\n    // decode_digit(cp) returns the numeric value of a basic code\n    // point (for use in representing integers) in the range 0 to\n    // base-1, or base if cp is does not represent a value.\n\n    function decode_digit(cp) {\n        return cp - 48 < 10 ? cp - 22 : cp - 65 < 26 ? cp - 65 : cp - 97 < 26 ? cp - 97 : base;\n    }\n\n    // encode_digit(d,flag) returns the basic code point whose value\n    // (when used for representing integers) is d, which needs to be in\n    // the range 0 to base-1. The lowercase form is used unless flag is\n    // nonzero, in which case the uppercase form is used. The behavior\n    // is undefined if flag is nonzero and digit d has no uppercase form.\n\n    function encode_digit(d, flag) {\n        return d + 22 + 75 * (d < 26) - ((flag != 0) << 5);\n        //  0..25 map to ASCII a..z or A..Z\n        // 26..35 map to ASCII 0..9\n    }\n    //** Bias adaptation function **\n    function adapt(delta, numpoints, firsttime) {\n        var k;\n        delta = firsttime ? Math.floor(delta / damp) : delta >> 1;\n        delta += Math.floor(delta / numpoints);\n\n        for (k = 0; delta > ((base - tmin) * tmax) >> 1; k += base) {\n            delta = Math.floor(delta / (base - tmin));\n        }\n        return Math.floor(k + ((base - tmin + 1) * delta) / (delta + skew));\n    }\n\n    // encode_basic(bcp,flag) forces a basic code point to lowercase if flag is zero,\n    // uppercase if flag is nonzero, and returns the resulting code point.\n    // The code point is unchanged if it is caseless.\n    // The behavior is undefined if bcp is not a basic code point.\n\n    function encode_basic(bcp, flag) {\n        bcp -= (bcp - 97 < 26) << 5;\n        return bcp + ((!flag && bcp - 65 < 26) << 5);\n    }\n\n    // Main decode\n    this.decode = function(input, preserveCase) {\n        // Dont use utf16\n        var output = [];\n        var case_flags = [];\n        var input_length = input.length;\n\n        var n, out, i, bias, basic, j, ic, oldi, w, k, digit, t, len;\n\n        // Initialize the state:\n\n        n = initial_n;\n        i = 0;\n        bias = initial_bias;\n\n        // Handle the basic code points: Let basic be the number of input code\n        // points before the last delimiter, or 0 if there is none, then\n        // copy the first basic code points to the output.\n\n        basic = input.lastIndexOf(delimiter);\n        if (basic < 0) basic = 0;\n\n        for (j = 0; j < basic; ++j) {\n            if (preserveCase) case_flags[output.length] = input.charCodeAt(j) - 65 < 26;\n            if (input.charCodeAt(j) >= 0x80) {\n                throw new RangeError('Illegal input >= 0x80');\n            }\n            output.push(input.charCodeAt(j));\n        }\n\n        // Main decoding loop: Start just after the last delimiter if any\n        // basic code points were copied; start at the beginning otherwise.\n\n        for (ic = basic > 0 ? basic + 1 : 0; ic < input_length; ) {\n            // ic is the index of the next character to be consumed,\n\n            // Decode a generalized variable-length integer into delta,\n            // which gets added to i. The overflow checking is easier\n            // if we increase i as we go, then subtract off its starting\n            // value at the end to obtain delta.\n            for (oldi = i, w = 1, k = base; ; k += base) {\n                if (ic >= input_length) {\n                    throw RangeError('punycode_bad_input(1)');\n                }\n                digit = decode_digit(input.charCodeAt(ic++));\n\n                if (digit >= base) {\n                    throw RangeError('punycode_bad_input(2)');\n                }\n                if (digit > Math.floor((maxint - i) / w)) {\n                    throw RangeError('punycode_overflow(1)');\n                }\n                i += digit * w;\n                t = k <= bias ? tmin : k >= bias + tmax ? tmax : k - bias;\n                if (digit < t) {\n                    break;\n                }\n                if (w > Math.floor(maxint / (base - t))) {\n                    throw RangeError('punycode_overflow(2)');\n                }\n                w *= base - t;\n            }\n\n            out = output.length + 1;\n            bias = adapt(i - oldi, out, oldi === 0);\n\n            // i was supposed to wrap around from out to 0,\n            // incrementing n each time, so we'll fix that now:\n            if (Math.floor(i / out) > maxint - n) {\n                throw RangeError('punycode_overflow(3)');\n            }\n            n += Math.floor(i / out);\n            i %= out;\n\n            // Insert n at position i of the output:\n            // Case of last character determines uppercase flag:\n            if (preserveCase) {\n                case_flags.splice(i, 0, input.charCodeAt(ic - 1) - 65 < 26);\n            }\n\n            output.splice(i, 0, n);\n            i++;\n        }\n        if (preserveCase) {\n            for (i = 0, len = output.length; i < len; i++) {\n                if (case_flags[i]) {\n                    output[i] = String.fromCharCode(output[i])\n                        .toUpperCase()\n                        .charCodeAt(0);\n                }\n            }\n        }\n        return this.utf16.encode(output);\n    };\n\n    //** Main encode function **\n\n    this.encode = function(input, preserveCase) {\n        //** Bias adaptation function **\n\n        var n, delta, h, b, bias, j, m, q, k, t, ijv, case_flags;\n\n        if (preserveCase) {\n            // Preserve case, step1 of 2: Get a list of the unaltered string\n            case_flags = this.utf16.decode(input);\n        }\n        // Converts the input in UTF-16 to Unicode\n        input = this.utf16.decode(input.toLowerCase());\n\n        var input_length = input.length; // Cache the length\n\n        if (preserveCase) {\n            // Preserve case, step2 of 2: Modify the list to true/false\n            for (j = 0; j < input_length; j++) {\n                case_flags[j] = input[j] != case_flags[j];\n            }\n        }\n\n        var output = [];\n\n        // Initialize the state:\n        n = initial_n;\n        delta = 0;\n        bias = initial_bias;\n\n        // Handle the basic code points:\n        for (j = 0; j < input_length; ++j) {\n            if (input[j] < 0x80) {\n                output.push(String.fromCharCode(case_flags ? encode_basic(input[j], case_flags[j]) : input[j]));\n            }\n        }\n\n        h = b = output.length;\n\n        // h is the number of code points that have been handled, b is the\n        // number of basic code points\n\n        if (b > 0) output.push(delimiter);\n\n        // Main encoding loop:\n        //\n        while (h < input_length) {\n            // All non-basic code points < n have been\n            // handled already. Find the next larger one:\n\n            for (m = maxint, j = 0; j < input_length; ++j) {\n                ijv = input[j];\n                if (ijv >= n && ijv < m) m = ijv;\n            }\n\n            // Increase delta enough to advance the decoder's\n            // <n,i> state to <m,0>, but guard against overflow:\n\n            if (m - n > Math.floor((maxint - delta) / (h + 1))) {\n                throw RangeError('punycode_overflow (1)');\n            }\n            delta += (m - n) * (h + 1);\n            n = m;\n\n            for (j = 0; j < input_length; ++j) {\n                ijv = input[j];\n\n                if (ijv < n) {\n                    if (++delta > maxint) return Error('punycode_overflow(2)');\n                }\n\n                if (ijv == n) {\n                    // Represent delta as a generalized variable-length integer:\n                    for (q = delta, k = base; ; k += base) {\n                        t = k <= bias ? tmin : k >= bias + tmax ? tmax : k - bias;\n                        if (q < t) break;\n                        output.push(String.fromCharCode(encode_digit(t + ((q - t) % (base - t)), 0)));\n                        q = Math.floor((q - t) / (base - t));\n                    }\n                    output.push(String.fromCharCode(encode_digit(q, preserveCase && case_flags[j] ? 1 : 0)));\n                    bias = adapt(delta, h + 1, h == b);\n                    delta = 0;\n                    ++h;\n                }\n            }\n\n            ++delta;\n            ++n;\n        }\n        return output.join('');\n    };\n\n    this.ToASCII = function(domain) {\n        var domain_array = domain.split('.');\n        var out = [];\n        for (var i = 0; i < domain_array.length; ++i) {\n            var s = domain_array[i];\n            out.push(s.match(/[^A-Za-z0-9-]/) ? 'xn--' + punycode.encode(s) : s);\n        }\n        return out.join('.');\n    };\n    this.ToUnicode = function(domain) {\n        var domain_array = domain.split('.');\n        var out = [];\n        for (var i = 0; i < domain_array.length; ++i) {\n            var s = domain_array[i];\n            out.push(s.match(/^xn--/) ? punycode.decode(s.slice(4)) : s);\n        }\n        return out.join('.');\n    };\n}\n\nconst punycode = new Punycode();\nexport default punycode;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport DownloadIcon from '../../Assets/Icons/Download';\nimport PlayArrowIcon from '../../Assets/Icons/PlayArrow';\nimport PauseIcon from '../../Assets/Icons/Pause';\nimport DocumentTile from './DocumentTile';\nimport PlayerStore from '../../Stores/PlayerStore';\nimport './VoiceNoteTile.css';\nimport { isCurrentSource } from '../../Utils/Player';\n\nclass VoiceNoteTile extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { chatId, messageId } = props;\n\n        const { time, message, playing } = PlayerStore;\n        const active = message && message.chat_id === chatId && message.id === messageId;\n\n        this.state = {\n            active: active,\n            playing: active ? playing : false,\n            currentTime: active && time ? time.currentTime : 0,\n            duration: active && time ? time.duration : 0\n        };\n    }\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaPlay', this.onClientUpdateMediaPlay);\n        PlayerStore.on('clientUpdateMediaPause', this.onClientUpdateMediaPause);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaPlay', this.onClientUpdateMediaPlay);\n        PlayerStore.off('clientUpdateMediaPause', this.onClientUpdateMediaPause);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            active: false,\n            playing: false,\n            currentTime: 0\n        });\n    };\n\n    onClientUpdateMediaPlay = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        this.setState({ playing: isCurrentSource(chatId, messageId, block, source) });\n    };\n\n    onClientUpdateMediaPause = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({ playing: false });\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (isCurrentSource(chatId, messageId, block, source)) {\n            if (!this.state.active) {\n                this.setState({\n                    active: true,\n                    currentTime: 0,\n                    playing: true\n                });\n            }\n        } else if (this.state.active) {\n            this.setState({\n                active: false,\n                currentTime: 0,\n                playing: false\n            });\n        }\n    };\n\n    render() {\n        const { file, openMedia } = this.props;\n        const { playing } = this.state;\n\n        return (\n            <DocumentTile\n                thumbnail={null}\n                file={file}\n                openMedia={openMedia}\n                icon={<DownloadIcon />}\n                completeIcon={playing ? <PauseIcon /> : <PlayArrowIcon />}\n            />\n        );\n    }\n}\n\nVoiceNoteTile.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    file: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default VoiceNoteTile;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path\n        d='M5,14 C5.55228475,14 6,14.4477153 6,15 L6,18 L9,18 C9.55228475,18 10,18.4477153 10,19 C10,19.5522847 9.55228475,20 9,20 L5,20 C4.44771525,20 4,19.5522847 4,19 L4,15 C4,14.4477153 4.44771525,14 5,14 Z M19,14 C19.5522847,14 20,14.4477153 20,15 L20,15 L20,19 C20,19.5522847 19.5522847,20 19,20 L19,20 L15,20 C14.4477153,20 14,19.5522847 14,19 C14,18.4477153 14.4477153,18 15,18 L15,18 L18,18 L18,15 C18,14.4477153 18.4477153,14 19,14 Z M9,4 C9.55228475,4 10,4.44771525 10,5 C10,5.55228475 9.55228475,6 9,6 L9,6 L6,6 L6,9 C6,9.55228475 5.55228475,10 5,10 C4.44771525,10 4,9.55228475 4,9 L4,9 L4,5 C4,4.44771525 4.44771525,4 5,4 L5,4 Z M19,4 C19.5522847,4 20,4.44771525 20,5 L20,9 C20,9.55228475 19.5522847,10 19,10 C18.4477153,10 18,9.55228475 18,9 L18,6 L15,6 C14.4477153,6 14,5.55228475 14,5 C14,4.44771525 14.4477153,4 15,4 L19,4 Z'\n    />,\n    'FullScreen'\n);","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport PlayerStore from '../../Stores/PlayerStore';\nimport './Hint.css';\n\nclass Hint extends React.Component {\n    state = { text: null };\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaHint', this.onClientUpdateMediaHint);\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaHint', this.onClientUpdateMediaHint);\n    }\n\n    onClientUpdateMediaHint = update => {\n        const { fileId, text } = update;\n        if (fileId !== this.props.fileId) return;\n\n        const { animated } = this.state;\n\n        clearTimeout(this.checkTimeout);\n        this.setState({\n            text,\n            animated: false\n        }, () => {\n            this.checkTimeout = setTimeout(() => {\n                if (this.state.text !== text) return;\n\n                this.setState({\n                    animated: true\n                })\n            }, 250);\n        });\n    };\n\n    handleAnimationEnd = event => {\n        this.setState({\n            text: null,\n            animated: false\n        })\n    }\n\n    render() {\n        const { animated, text } = this.state;\n        if (!text) return null;\n\n        return (\n            <div className={classNames('player-hint', { 'player-hint-animated': animated })} onAnimationEnd={this.handleAnimationEnd}>\n                <span>{text}</span>\n            </div>\n        );\n    }\n}\n\nHint.propTypes = {\n    fileId: PropTypes.number\n};\n\nexport default Hint;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './Progress.css';\n\nclass Progress extends React.Component {\n    state = {\n        waiting: false\n    };\n\n    componentDidMount() {\n        this.handleWaiting();\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevProps.waiting !== this.props.waiting) {\n            this.handleWaiting();\n        }\n    }\n\n    handleWaiting = () => {\n        const { waiting } = this.props;\n        if (!waiting) {\n            if (this.state.waiting) {\n                this.setState({\n                    waiting: false\n                });\n            }\n            return;\n        }\n\n        setTimeout(() => {\n            if (!this.props.waiting) return;\n\n            this.setState({\n                waiting: true\n            })\n        }, 250);\n    };\n\n    render() {\n        const { waiting } = this.state;\n\n        if (!waiting) return null;\n\n        return (\n            <div className='player-progress'>\n                <svg viewBox='0 0 54 54' height='54' width='54'>\n                    <circle stroke='white' fill='transparent' strokeWidth='3' strokeDasharray='120 100' strokeDashoffset='25' strokeLinecap='round' r='21' cx='27' cy='27'/>\n                </svg>\n            </div>\n        );\n    }\n\n}\n\nProgress.propTypes = {\n    waiting: PropTypes.bool\n};\n\nexport default Progress;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport VolumeOffIcon from '@material-ui/icons/VolumeOff';\nimport DownloadIcon from '../../../Assets/Icons/Download';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport FileProgress from '../../Viewer/FileProgress';\nimport MediaStatus from './MediaStatus';\nimport { getFileSize, getSrc } from '../../../Utils/File';\nimport { isBlurredThumbnail } from '../../../Utils/Media';\nimport { clamp, getDurationString } from '../../../Utils/Common';\nimport { isCurrentSource } from '../../../Utils/Player';\nimport { PHOTO_DISPLAY_SIZE, PHOTO_SIZE } from '../../../Constants';\nimport ApplicationStore from '../../../Stores/ApplicationStore';\nimport FileStore from '../../../Stores/FileStore';\nimport InstantViewStore from '../../../Stores/InstantViewStore';\nimport PlayerStore from '../../../Stores/PlayerStore';\nimport MessageStore from '../../../Stores/MessageStore';\nimport './VideoNote.css';\n\nconst circleStyle = {\n    circle: 'video-note-progress-circle'\n};\n\nclass VideoNote extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.videoRef = React.createRef();\n        this.sourceRef = React.createRef();\n\n        const { chatId, messageId } = props;\n        const { video } = props.videoNote;\n\n        const { time, message, videoStream } = PlayerStore;\n        const active = message && message.chat_id === chatId && message.id === messageId;\n\n        this.state = {\n            active: active,\n            srcObject: active ? videoStream : null,\n            src: getSrc(video),\n            currentTime: active && time ? time.currentTime : 0.0,\n            videoDuration: active && time ? time.duration : 0.0\n        };\n\n        this.windowFocused = window.hasFocus;\n        this.inView = false;\n        this.openMediaViewer = Boolean(ApplicationStore.mediaViewerContent);\n        this.openProfileMediaViewer = Boolean(ApplicationStore.profileMediaViewerContent);\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n    }\n\n    updateVideoSrc() {\n        const { srcObject, src } = this.state;\n\n        const player = this.videoRef.current;\n        if (!player) return;\n\n        if (srcObject) {\n            //player.scr = null;\n            player.srcObject = srcObject;\n            return;\n        }\n\n        const stream = player.srcObject;\n        if (stream) {\n            //console.log('clientUpdate release srcObject');\n            const tracks = stream.getTracks();\n\n            tracks.forEach(track => {\n                //console.log('clientUpdate release track');\n                track.stop();\n            });\n        }\n\n        if (player.srcObject) {\n            //console.log('clientUpdate release video.srcObject');\n            player.srcObject = null;\n        }\n\n        const source = this.sourceRef.current;\n        if (!source) return;\n\n        if (source.src !== src) {\n            source.src = src;\n            player.load();\n        }\n    }\n\n    componentDidMount() {\n        this.updateVideoSrc();\n\n        FileStore.on('clientUpdateVideoNoteThumbnailBlob', this.onClientUpdateVideoNoteThumbnailBlob);\n        FileStore.on('clientUpdateVideoNoteBlob', this.onClientUpdateVideoNoteBlob);\n\n        MessageStore.on('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n\n        ApplicationStore.on('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        ApplicationStore.on('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        ApplicationStore.on('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        InstantViewStore.on('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaCaptureStream', this.onClientUpdateMediaCaptureStream);\n        PlayerStore.on('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateVideoNoteThumbnailBlob', this.onClientUpdateVideoNoteThumbnailBlob);\n        FileStore.off('clientUpdateVideoNoteBlob', this.onClientUpdateVideoNoteBlob);\n\n        MessageStore.off('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n\n        ApplicationStore.off('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        ApplicationStore.off('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        ApplicationStore.off('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        InstantViewStore.off('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaCaptureStream', this.onClientUpdateMediaCaptureStream);\n        PlayerStore.off('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    startStopPlayer = () => {\n        const player = this.videoRef.current;\n        if (player) {\n            if (\n                this.inView &&\n                this.windowFocused &&\n                !this.openMediaViewer &&\n                !this.openProfileMediaViewer &&\n                !this.openIV\n            ) {\n                player.play();\n            } else {\n                if (this.state.active) {\n                    return;\n                }\n\n                player.pause();\n            }\n        }\n    };\n\n    onClientUpdateInstantViewContent = update => {\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateProfileMediaViewerContent = update => {\n        this.openProfileMediaViewer = Boolean(ApplicationStore.profileMediaViewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMediaViewerContent = update => {\n        this.openMediaViewer = Boolean(ApplicationStore.mediaViewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateFocusWindow = update => {\n        this.windowFocused = update.focused;\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMessagesInView = update => {\n        const { chatId, messageId } = this.props;\n        const key = `${chatId}_${messageId}`;\n\n        this.inView = update.messages.has(key);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMediaCaptureStream = update => {\n        const { chatId, messageId } = this.props;\n        if (chatId === update.chatId && messageId === update.messageId) {\n            const player = this.videoRef.current;\n            if (player) {\n                this.setState({ srcObject: update.stream }, () => {\n                    this.updateVideoSrc();\n                });\n            }\n        }\n    };\n\n    onClientUpdateMediaTime = update => {\n        const { chatId, messageId, block } = this.props;\n        const { currentTime, duration: videoDuration, source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const player = this.videoRef.current;\n        if (!player) return;\n\n        this.setState({\n            currentTime,\n            videoDuration\n        });\n    };\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState(\n            {\n                active: false,\n                srcObject: null,\n                currentTime: 0\n            },\n            () => {\n                const player = this.videoRef.current;\n                if (!player) return;\n\n                this.updateVideoSrc();\n\n                if (!window.hasFocus) {\n                    player.pause();\n                }\n            }\n        );\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (isCurrentSource(chatId, messageId, block, source)) {\n            if (this.state.active) {\n            } else {\n                this.setState({\n                    active: true,\n                    currentTime: null\n                });\n            }\n        } else if (this.state.active) {\n            this.setState(\n                {\n                    active: false,\n                    srcObject: null,\n                    currentTime: 0\n                },\n                () => {\n                    const player = this.videoRef.current;\n                    if (!player) return;\n\n                    this.updateVideoSrc();\n\n                    if (!window.hasFocus) {\n                        player.pause();\n                    }\n                }\n            );\n        }\n    };\n\n    onClientUpdateVideoNoteBlob = update => {\n        const { video } = this.props.videoNote;\n        const { fileId } = update;\n\n        if (!video) return;\n\n        if (video.id === fileId) {\n            this.setState(\n                {\n                    src: getSrc(video)\n                },\n                () => {\n                    this.updateVideoSrc();\n                }\n            );\n        }\n    };\n\n    onClientUpdateVideoNoteThumbnailBlob = update => {\n        const { thumbnail } = this.props.videoNote;\n        if (!thumbnail) return;\n\n        const { fileId } = update;\n\n        const { file } = thumbnail;\n        if (file && file.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    handleCanPlay = () => {\n        // const player = this.videoRef.current;\n        // if (player){\n        //     if (this.state.active){\n        //         player.muted = false;\n        //     }\n        //     else{\n        //         player.muted = true;\n        //     }\n        // }\n    };\n\n    render() {\n        const { displaySize, chatId, messageId, openMedia, meta } = this.props;\n        const { active, currentTime, videoDuration } = this.state;\n        const { minithumbnail, thumbnail, video, duration } = this.props.videoNote;\n\n        const message = MessageStore.get(chatId, messageId);\n        if (!message) return null;\n\n        const style = { width: 200, height: 200 };\n        if (!style) return null;\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const isBlurred = isBlurredThumbnail(thumbnail, displaySize);\n\n        const src = getSrc(video);\n        let progress = 0;\n        if (videoDuration && currentTime) {\n            const progressTime = currentTime + 0.25;\n            progress = clamp(progressTime / videoDuration * 100, 0, 100);\n        }\n\n        return (\n            <div\n                className={classNames('video-note', { 'video-note-playing': active })}\n                style={style}\n                onClick={openMedia}>\n                <div className='video-note-round'>\n                    {miniSrc && (\n                        <img\n                            className={classNames('video-preview', 'media-mini-blurred')}\n                            src={miniSrc}\n                            alt=''\n                        />\n                    )}\n                    { thumbnailSrc && (\n                        <img\n                            className={classNames('animation-thumbnail', { 'media-blurred': isBlurred })}\n                            src={thumbnailSrc}\n                            alt=''\n                        />\n                    )}\n                </div>\n                {src ? (\n                    <>\n                        <video\n                            ref={this.videoRef}\n                            className={classNames('media-viewer-content-image', 'video-note-video')}\n                            muted\n                            autoPlay\n                            loop\n                            playsInline\n                            width={style.width}\n                            height={style.height}\n                            onCanPlay={this.handleCanPlay}\n                        >\n                            <source ref={this.sourceRef} src={null} type='video/mp4'/>\n                        </video>\n                        <div className='video-note-player'>\n                            <div className='video-note-progress'>\n                                <CircularProgress\n                                    classes={circleStyle}\n                                    variant='static'\n                                    value={progress}\n                                    size={200}\n                                    thickness={1}\n                                />\n                            </div>\n                            <div className='animation-meta'>\n                                {getDurationString(active ? Math.floor(currentTime) : duration)}\n                                <MediaStatus chatId={chatId} messageId={messageId} icon={'\\u00A0'} />\n                            </div>\n                            <div className='video-note-muted'>\n                                <VolumeOffIcon />\n                            </div>\n                        </div>\n                    </>\n                ) : (\n                    <>\n                        <div className='animation-meta'>\n                            {getDurationString(duration) + ' ' + getFileSize(video)}\n                            <MediaStatus chatId={chatId} messageId={messageId} icon={'\\u00A0'} />\n                        </div>\n                        <div className='video-note-muted'>\n                            <VolumeOffIcon />\n                        </div>\n                    </>\n                )}\n                <FileProgress file={video} download upload cancelButton icon={<DownloadIcon />} />\n                {meta}\n            </div>\n        );\n    }\n}\n\nVideoNote.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    videoNote: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    size: PropTypes.number,\n    displaySize: PropTypes.number\n};\n\nVideoNote.defaultProps = {\n    size: PHOTO_SIZE,\n    displaySize: PHOTO_DISPLAY_SIZE\n};\n\nexport default VideoNote;\n","(function webpackUniversalModuleDefinition(root, factory) {\n  if (typeof exports === 'object' && typeof module === 'object') module.exports = factory();else if (typeof define === 'function' && define.amd) define(\"tdweb\", [], factory);else if (typeof exports === 'object') exports[\"tdweb\"] = factory();else root[\"tdweb\"] = factory();\n})(this, function () {\n  return (\n    /******/\n    function (modules) {\n      // webpackBootstrap\n\n      /******/\n      // The module cache\n\n      /******/\n      var installedModules = {};\n      /******/\n\n      /******/\n      // The require function\n\n      /******/\n\n      function __webpack_require__(moduleId) {\n        /******/\n\n        /******/\n        // Check if module is in cache\n\n        /******/\n        if (installedModules[moduleId]) {\n          /******/\n          return installedModules[moduleId].exports;\n          /******/\n        }\n        /******/\n        // Create a new module (and put it into the cache)\n\n        /******/\n\n\n        var module = installedModules[moduleId] = {\n          /******/\n          i: moduleId,\n\n          /******/\n          l: false,\n\n          /******/\n          exports: {}\n          /******/\n\n        };\n        /******/\n\n        /******/\n        // Execute the module function\n\n        /******/\n\n        modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n        /******/\n\n        /******/\n        // Flag the module as loaded\n\n        /******/\n\n        module.l = true;\n        /******/\n\n        /******/\n        // Return the exports of the module\n\n        /******/\n\n        return module.exports;\n        /******/\n      }\n      /******/\n\n      /******/\n\n      /******/\n      // expose the modules object (__webpack_modules__)\n\n      /******/\n\n\n      __webpack_require__.m = modules;\n      /******/\n\n      /******/\n      // expose the module cache\n\n      /******/\n\n      __webpack_require__.c = installedModules;\n      /******/\n\n      /******/\n      // define getter function for harmony exports\n\n      /******/\n\n      __webpack_require__.d = function (exports, name, getter) {\n        /******/\n        if (!__webpack_require__.o(exports, name)) {\n          /******/\n          Object.defineProperty(exports, name, {\n            enumerable: true,\n            get: getter\n          });\n          /******/\n        }\n        /******/\n\n      };\n      /******/\n\n      /******/\n      // define __esModule on exports\n\n      /******/\n\n\n      __webpack_require__.r = function (exports) {\n        /******/\n        if (typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n          /******/\n          Object.defineProperty(exports, Symbol.toStringTag, {\n            value: 'Module'\n          });\n          /******/\n        }\n        /******/\n\n\n        Object.defineProperty(exports, '__esModule', {\n          value: true\n        });\n        /******/\n      };\n      /******/\n\n      /******/\n      // create a fake namespace object\n\n      /******/\n      // mode & 1: value is a module id, require it\n\n      /******/\n      // mode & 2: merge all properties of value into the ns\n\n      /******/\n      // mode & 4: return value when already ns object\n\n      /******/\n      // mode & 8|1: behave like require\n\n      /******/\n\n\n      __webpack_require__.t = function (value, mode) {\n        /******/\n        if (mode & 1) value = __webpack_require__(value);\n        /******/\n\n        if (mode & 8) return value;\n        /******/\n\n        if (mode & 4 && typeof value === 'object' && value && value.__esModule) return value;\n        /******/\n\n        var ns = Object.create(null);\n        /******/\n\n        __webpack_require__.r(ns);\n        /******/\n\n\n        Object.defineProperty(ns, 'default', {\n          enumerable: true,\n          value: value\n        });\n        /******/\n\n        if (mode & 2 && typeof value != 'string') for (var key in value) {\n          __webpack_require__.d(ns, key, function (key) {\n            return value[key];\n          }.bind(null, key));\n        }\n        /******/\n\n        return ns;\n        /******/\n      };\n      /******/\n\n      /******/\n      // getDefaultExport function for compatibility with non-harmony modules\n\n      /******/\n\n\n      __webpack_require__.n = function (module) {\n        /******/\n        var getter = module && module.__esModule ?\n        /******/\n        function getDefault() {\n          return module['default'];\n        } :\n        /******/\n        function getModuleExports() {\n          return module;\n        };\n        /******/\n\n        __webpack_require__.d(getter, 'a', getter);\n        /******/\n\n\n        return getter;\n        /******/\n      };\n      /******/\n\n      /******/\n      // Object.prototype.hasOwnProperty.call\n\n      /******/\n\n\n      __webpack_require__.o = function (object, property) {\n        return Object.prototype.hasOwnProperty.call(object, property);\n      };\n      /******/\n\n      /******/\n      // __webpack_public_path__\n\n      /******/\n\n\n      __webpack_require__.p = \"\";\n      /******/\n\n      /******/\n\n      /******/\n      // Load entry module and return exports\n\n      /******/\n\n      return __webpack_require__(__webpack_require__.s = 9);\n      /******/\n    }(\n    /************************************************************************/\n\n    /******/\n    [\n    /* 0 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      module.exports = __webpack_require__(13);\n      /***/\n    },\n    /* 1 */\n\n    /***/\n    function (module, exports) {\n      module.exports = false;\n      /***/\n    },\n    /* 2 */\n\n    /***/\n    function (module, exports) {\n      function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n        try {\n          var info = gen[key](arg);\n          var value = info.value;\n        } catch (error) {\n          reject(error);\n          return;\n        }\n\n        if (info.done) {\n          resolve(value);\n        } else {\n          Promise.resolve(value).then(_next, _throw);\n        }\n      }\n\n      function _asyncToGenerator(fn) {\n        return function () {\n          var self = this,\n              args = arguments;\n          return new Promise(function (resolve, reject) {\n            var gen = fn.apply(self, args);\n\n            function _next(value) {\n              asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n            }\n\n            function _throw(err) {\n              asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n            }\n\n            _next(undefined);\n          });\n        };\n      }\n\n      module.exports = _asyncToGenerator;\n      /***/\n    },\n    /* 3 */\n\n    /***/\n    function (module, exports) {\n      function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n          throw new TypeError(\"Cannot call a class as a function\");\n        }\n      }\n\n      module.exports = _classCallCheck;\n      /***/\n    },\n    /* 4 */\n\n    /***/\n    function (module, exports) {\n      function _defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n          var descriptor = props[i];\n          descriptor.enumerable = descriptor.enumerable || false;\n          descriptor.configurable = true;\n          if (\"value\" in descriptor) descriptor.writable = true;\n          Object.defineProperty(target, descriptor.key, descriptor);\n        }\n      }\n\n      function _createClass(Constructor, protoProps, staticProps) {\n        if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n        if (staticProps) _defineProperties(Constructor, staticProps);\n        return Constructor;\n      }\n\n      module.exports = _createClass;\n      /***/\n    },\n    /* 5 */\n\n    /***/\n    function (module, exports) {\n      function _typeof2(obj) {\n        if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n          _typeof2 = function _typeof2(obj) {\n            return typeof obj;\n          };\n        } else {\n          _typeof2 = function _typeof2(obj) {\n            return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          };\n        }\n\n        return _typeof2(obj);\n      }\n\n      function _typeof(obj) {\n        if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n          module.exports = _typeof = function _typeof(obj) {\n            return _typeof2(obj);\n          };\n        } else {\n          module.exports = _typeof = function _typeof(obj) {\n            return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n          };\n        }\n\n        return _typeof(obj);\n      }\n\n      module.exports = _typeof;\n      /***/\n    },\n    /* 6 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      var arrayWithHoles = __webpack_require__(10);\n\n      var iterableToArrayLimit = __webpack_require__(11);\n\n      var nonIterableRest = __webpack_require__(12);\n\n      function _slicedToArray(arr, i) {\n        return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n      }\n\n      module.exports = _slicedToArray;\n      /***/\n    },\n    /* 7 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      module.exports = function () {\n        return new Worker(__webpack_require__.p + \"dd331d19173342d7f496.worker.js\");\n      };\n      /***/\n\n    },\n    /* 8 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      var rng = __webpack_require__(15);\n\n      var bytesToUuid = __webpack_require__(16);\n\n      function v4(options, buf, offset) {\n        var i = buf && offset || 0;\n\n        if (typeof options == 'string') {\n          buf = options === 'binary' ? new Array(16) : null;\n          options = null;\n        }\n\n        options = options || {};\n        var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n        rnds[6] = rnds[6] & 0x0f | 0x40;\n        rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n        if (buf) {\n          for (var ii = 0; ii < 16; ++ii) {\n            buf[i + ii] = rnds[ii];\n          }\n        }\n\n        return buf || bytesToUuid(rnds);\n      }\n\n      module.exports = v4;\n      /***/\n    },\n    /* 9 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      module.exports = __webpack_require__(17);\n      /***/\n    },\n    /* 10 */\n\n    /***/\n    function (module, exports) {\n      function _arrayWithHoles(arr) {\n        if (Array.isArray(arr)) return arr;\n      }\n\n      module.exports = _arrayWithHoles;\n      /***/\n    },\n    /* 11 */\n\n    /***/\n    function (module, exports) {\n      function _iterableToArrayLimit(arr, i) {\n        var _arr = [];\n        var _n = true;\n        var _d = false;\n        var _e = undefined;\n\n        try {\n          for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n            _arr.push(_s.value);\n\n            if (i && _arr.length === i) break;\n          }\n        } catch (err) {\n          _d = true;\n          _e = err;\n        } finally {\n          try {\n            if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n          } finally {\n            if (_d) throw _e;\n          }\n        }\n\n        return _arr;\n      }\n\n      module.exports = _iterableToArrayLimit;\n      /***/\n    },\n    /* 12 */\n\n    /***/\n    function (module, exports) {\n      function _nonIterableRest() {\n        throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n      }\n\n      module.exports = _nonIterableRest;\n      /***/\n    },\n    /* 13 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      /**\n       * Copyright (c) 2014-present, Facebook, Inc.\n       *\n       * This source code is licensed under the MIT license found in the\n       * LICENSE file in the root directory of this source tree.\n       */\n      var runtime = function (exports) {\n        \"use strict\";\n\n        var Op = Object.prototype;\n        var hasOwn = Op.hasOwnProperty;\n        var undefined; // More compressible than void 0.\n\n        var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n        var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n        var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n        var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n        function wrap(innerFn, outerFn, self, tryLocsList) {\n          // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n          var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n          var generator = Object.create(protoGenerator.prototype);\n          var context = new Context(tryLocsList || []); // The ._invoke method unifies the implementations of the .next,\n          // .throw, and .return methods.\n\n          generator._invoke = makeInvokeMethod(innerFn, self, context);\n          return generator;\n        }\n\n        exports.wrap = wrap; // Try/catch helper to minimize deoptimizations. Returns a completion\n        // record like context.tryEntries[i].completion. This interface could\n        // have been (and was previously) designed to take a closure to be\n        // invoked without arguments, but in all the cases we care about we\n        // already have an existing method we want to call, so there's no need\n        // to create a new function object. We can even get away with assuming\n        // the method takes exactly one argument, since that happens to be true\n        // in every case, so we don't have to touch the arguments object. The\n        // only additional allocation required is the completion record, which\n        // has a stable shape and so hopefully should be cheap to allocate.\n\n        function tryCatch(fn, obj, arg) {\n          try {\n            return {\n              type: \"normal\",\n              arg: fn.call(obj, arg)\n            };\n          } catch (err) {\n            return {\n              type: \"throw\",\n              arg: err\n            };\n          }\n        }\n\n        var GenStateSuspendedStart = \"suspendedStart\";\n        var GenStateSuspendedYield = \"suspendedYield\";\n        var GenStateExecuting = \"executing\";\n        var GenStateCompleted = \"completed\"; // Returning this object from the innerFn has the same effect as\n        // breaking out of the dispatch switch statement.\n\n        var ContinueSentinel = {}; // Dummy constructor functions that we use as the .constructor and\n        // .constructor.prototype properties for functions that return Generator\n        // objects. For full spec compliance, you may wish to configure your\n        // minifier not to mangle the names of these two functions.\n\n        function Generator() {}\n\n        function GeneratorFunction() {}\n\n        function GeneratorFunctionPrototype() {} // This is a polyfill for %IteratorPrototype% for environments that\n        // don't natively support it.\n\n\n        var IteratorPrototype = {};\n\n        IteratorPrototype[iteratorSymbol] = function () {\n          return this;\n        };\n\n        var getProto = Object.getPrototypeOf;\n        var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n\n        if (NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n          // This environment has a native %IteratorPrototype%; use it instead\n          // of the polyfill.\n          IteratorPrototype = NativeIteratorPrototype;\n        }\n\n        var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n        GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n        GeneratorFunctionPrototype.constructor = GeneratorFunction;\n        GeneratorFunctionPrototype[toStringTagSymbol] = GeneratorFunction.displayName = \"GeneratorFunction\"; // Helper for defining the .next, .throw, and .return methods of the\n        // Iterator interface in terms of a single ._invoke method.\n\n        function defineIteratorMethods(prototype) {\n          [\"next\", \"throw\", \"return\"].forEach(function (method) {\n            prototype[method] = function (arg) {\n              return this._invoke(method, arg);\n            };\n          });\n        }\n\n        exports.isGeneratorFunction = function (genFun) {\n          var ctor = typeof genFun === \"function\" && genFun.constructor;\n          return ctor ? ctor === GeneratorFunction || // For the native GeneratorFunction constructor, the best we can\n          // do is to check its .name property.\n          (ctor.displayName || ctor.name) === \"GeneratorFunction\" : false;\n        };\n\n        exports.mark = function (genFun) {\n          if (Object.setPrototypeOf) {\n            Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n          } else {\n            genFun.__proto__ = GeneratorFunctionPrototype;\n\n            if (!(toStringTagSymbol in genFun)) {\n              genFun[toStringTagSymbol] = \"GeneratorFunction\";\n            }\n          }\n\n          genFun.prototype = Object.create(Gp);\n          return genFun;\n        }; // Within the body of any async function, `await x` is transformed to\n        // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n        // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n        // meant to be awaited.\n\n\n        exports.awrap = function (arg) {\n          return {\n            __await: arg\n          };\n        };\n\n        function AsyncIterator(generator) {\n          function invoke(method, arg, resolve, reject) {\n            var record = tryCatch(generator[method], generator, arg);\n\n            if (record.type === \"throw\") {\n              reject(record.arg);\n            } else {\n              var result = record.arg;\n              var value = result.value;\n\n              if (value && typeof value === \"object\" && hasOwn.call(value, \"__await\")) {\n                return Promise.resolve(value.__await).then(function (value) {\n                  invoke(\"next\", value, resolve, reject);\n                }, function (err) {\n                  invoke(\"throw\", err, resolve, reject);\n                });\n              }\n\n              return Promise.resolve(value).then(function (unwrapped) {\n                // When a yielded Promise is resolved, its final value becomes\n                // the .value of the Promise<{value,done}> result for the\n                // current iteration.\n                result.value = unwrapped;\n                resolve(result);\n              }, function (error) {\n                // If a rejected Promise was yielded, throw the rejection back\n                // into the async generator function so it can be handled there.\n                return invoke(\"throw\", error, resolve, reject);\n              });\n            }\n          }\n\n          var previousPromise;\n\n          function enqueue(method, arg) {\n            function callInvokeWithMethodAndArg() {\n              return new Promise(function (resolve, reject) {\n                invoke(method, arg, resolve, reject);\n              });\n            }\n\n            return previousPromise = // If enqueue has been called before, then we want to wait until\n            // all previous Promises have been resolved before calling invoke,\n            // so that results are always delivered in the correct order. If\n            // enqueue has not been called before, then it is important to\n            // call invoke immediately, without waiting on a callback to fire,\n            // so that the async generator function has the opportunity to do\n            // any necessary setup in a predictable way. This predictability\n            // is why the Promise constructor synchronously invokes its\n            // executor callback, and why async functions synchronously\n            // execute code before the first await. Since we implement simple\n            // async functions in terms of async generators, it is especially\n            // important to get this right, even though it requires care.\n            previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, // Avoid propagating failures to Promises returned by later\n            // invocations of the iterator.\n            callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n          } // Define the unified helper method that is used to implement .next,\n          // .throw, and .return (see defineIteratorMethods).\n\n\n          this._invoke = enqueue;\n        }\n\n        defineIteratorMethods(AsyncIterator.prototype);\n\n        AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n          return this;\n        };\n\n        exports.AsyncIterator = AsyncIterator; // Note that simple async functions are implemented on top of\n        // AsyncIterator objects; they just return a Promise for the value of\n        // the final result produced by the iterator.\n\n        exports.async = function (innerFn, outerFn, self, tryLocsList) {\n          var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList));\n          return exports.isGeneratorFunction(outerFn) ? iter // If outerFn is a generator, return the full iterator.\n          : iter.next().then(function (result) {\n            return result.done ? result.value : iter.next();\n          });\n        };\n\n        function makeInvokeMethod(innerFn, self, context) {\n          var state = GenStateSuspendedStart;\n          return function invoke(method, arg) {\n            if (state === GenStateExecuting) {\n              throw new Error(\"Generator is already running\");\n            }\n\n            if (state === GenStateCompleted) {\n              if (method === \"throw\") {\n                throw arg;\n              } // Be forgiving, per 25.3.3.3.3 of the spec:\n              // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n\n\n              return doneResult();\n            }\n\n            context.method = method;\n            context.arg = arg;\n\n            while (true) {\n              var delegate = context.delegate;\n\n              if (delegate) {\n                var delegateResult = maybeInvokeDelegate(delegate, context);\n\n                if (delegateResult) {\n                  if (delegateResult === ContinueSentinel) continue;\n                  return delegateResult;\n                }\n              }\n\n              if (context.method === \"next\") {\n                // Setting context._sent for legacy support of Babel's\n                // function.sent implementation.\n                context.sent = context._sent = context.arg;\n              } else if (context.method === \"throw\") {\n                if (state === GenStateSuspendedStart) {\n                  state = GenStateCompleted;\n                  throw context.arg;\n                }\n\n                context.dispatchException(context.arg);\n              } else if (context.method === \"return\") {\n                context.abrupt(\"return\", context.arg);\n              }\n\n              state = GenStateExecuting;\n              var record = tryCatch(innerFn, self, context);\n\n              if (record.type === \"normal\") {\n                // If an exception is thrown from innerFn, we leave state ===\n                // GenStateExecuting and loop back for another invocation.\n                state = context.done ? GenStateCompleted : GenStateSuspendedYield;\n\n                if (record.arg === ContinueSentinel) {\n                  continue;\n                }\n\n                return {\n                  value: record.arg,\n                  done: context.done\n                };\n              } else if (record.type === \"throw\") {\n                state = GenStateCompleted; // Dispatch the exception by looping back around to the\n                // context.dispatchException(context.arg) call above.\n\n                context.method = \"throw\";\n                context.arg = record.arg;\n              }\n            }\n          };\n        } // Call delegate.iterator[context.method](context.arg) and handle the\n        // result, either by returning a { value, done } result from the\n        // delegate iterator, or by modifying context.method and context.arg,\n        // setting context.delegate to null, and returning the ContinueSentinel.\n\n\n        function maybeInvokeDelegate(delegate, context) {\n          var method = delegate.iterator[context.method];\n\n          if (method === undefined) {\n            // A .throw or .return when the delegate iterator has no .throw\n            // method always terminates the yield* loop.\n            context.delegate = null;\n\n            if (context.method === \"throw\") {\n              // Note: [\"return\"] must be used for ES3 parsing compatibility.\n              if (delegate.iterator[\"return\"]) {\n                // If the delegate iterator has a return method, give it a\n                // chance to clean up.\n                context.method = \"return\";\n                context.arg = undefined;\n                maybeInvokeDelegate(delegate, context);\n\n                if (context.method === \"throw\") {\n                  // If maybeInvokeDelegate(context) changed context.method from\n                  // \"return\" to \"throw\", let that override the TypeError below.\n                  return ContinueSentinel;\n                }\n              }\n\n              context.method = \"throw\";\n              context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n            }\n\n            return ContinueSentinel;\n          }\n\n          var record = tryCatch(method, delegate.iterator, context.arg);\n\n          if (record.type === \"throw\") {\n            context.method = \"throw\";\n            context.arg = record.arg;\n            context.delegate = null;\n            return ContinueSentinel;\n          }\n\n          var info = record.arg;\n\n          if (!info) {\n            context.method = \"throw\";\n            context.arg = new TypeError(\"iterator result is not an object\");\n            context.delegate = null;\n            return ContinueSentinel;\n          }\n\n          if (info.done) {\n            // Assign the result of the finished delegate to the temporary\n            // variable specified by delegate.resultName (see delegateYield).\n            context[delegate.resultName] = info.value; // Resume execution at the desired location (see delegateYield).\n\n            context.next = delegate.nextLoc; // If context.method was \"throw\" but the delegate handled the\n            // exception, let the outer generator proceed normally. If\n            // context.method was \"next\", forget context.arg since it has been\n            // \"consumed\" by the delegate iterator. If context.method was\n            // \"return\", allow the original .return call to continue in the\n            // outer generator.\n\n            if (context.method !== \"return\") {\n              context.method = \"next\";\n              context.arg = undefined;\n            }\n          } else {\n            // Re-yield the result returned by the delegate method.\n            return info;\n          } // The delegate iterator is finished, so forget it and continue with\n          // the outer generator.\n\n\n          context.delegate = null;\n          return ContinueSentinel;\n        } // Define Generator.prototype.{next,throw,return} in terms of the\n        // unified ._invoke helper method.\n\n\n        defineIteratorMethods(Gp);\n        Gp[toStringTagSymbol] = \"Generator\"; // A Generator should always return itself as the iterator object when the\n        // @@iterator function is called on it. Some browsers' implementations of the\n        // iterator prototype chain incorrectly implement this, causing the Generator\n        // object to not be returned from this call. This ensures that doesn't happen.\n        // See https://github.com/facebook/regenerator/issues/274 for more details.\n\n        Gp[iteratorSymbol] = function () {\n          return this;\n        };\n\n        Gp.toString = function () {\n          return \"[object Generator]\";\n        };\n\n        function pushTryEntry(locs) {\n          var entry = {\n            tryLoc: locs[0]\n          };\n\n          if (1 in locs) {\n            entry.catchLoc = locs[1];\n          }\n\n          if (2 in locs) {\n            entry.finallyLoc = locs[2];\n            entry.afterLoc = locs[3];\n          }\n\n          this.tryEntries.push(entry);\n        }\n\n        function resetTryEntry(entry) {\n          var record = entry.completion || {};\n          record.type = \"normal\";\n          delete record.arg;\n          entry.completion = record;\n        }\n\n        function Context(tryLocsList) {\n          // The root entry object (effectively a try statement without a catch\n          // or a finally block) gives us a place to store values thrown from\n          // locations where there is no enclosing try statement.\n          this.tryEntries = [{\n            tryLoc: \"root\"\n          }];\n          tryLocsList.forEach(pushTryEntry, this);\n          this.reset(true);\n        }\n\n        exports.keys = function (object) {\n          var keys = [];\n\n          for (var key in object) {\n            keys.push(key);\n          }\n\n          keys.reverse(); // Rather than returning an object with a next method, we keep\n          // things simple and return the next function itself.\n\n          return function next() {\n            while (keys.length) {\n              var key = keys.pop();\n\n              if (key in object) {\n                next.value = key;\n                next.done = false;\n                return next;\n              }\n            } // To avoid creating an additional object, we just hang the .value\n            // and .done properties off the next function object itself. This\n            // also ensures that the minifier will not anonymize the function.\n\n\n            next.done = true;\n            return next;\n          };\n        };\n\n        function values(iterable) {\n          if (iterable) {\n            var iteratorMethod = iterable[iteratorSymbol];\n\n            if (iteratorMethod) {\n              return iteratorMethod.call(iterable);\n            }\n\n            if (typeof iterable.next === \"function\") {\n              return iterable;\n            }\n\n            if (!isNaN(iterable.length)) {\n              var i = -1,\n                  next = function next() {\n                while (++i < iterable.length) {\n                  if (hasOwn.call(iterable, i)) {\n                    next.value = iterable[i];\n                    next.done = false;\n                    return next;\n                  }\n                }\n\n                next.value = undefined;\n                next.done = true;\n                return next;\n              };\n\n              return next.next = next;\n            }\n          } // Return an iterator with no values.\n\n\n          return {\n            next: doneResult\n          };\n        }\n\n        exports.values = values;\n\n        function doneResult() {\n          return {\n            value: undefined,\n            done: true\n          };\n        }\n\n        Context.prototype = {\n          constructor: Context,\n          reset: function reset(skipTempReset) {\n            this.prev = 0;\n            this.next = 0; // Resetting context._sent for legacy support of Babel's\n            // function.sent implementation.\n\n            this.sent = this._sent = undefined;\n            this.done = false;\n            this.delegate = null;\n            this.method = \"next\";\n            this.arg = undefined;\n            this.tryEntries.forEach(resetTryEntry);\n\n            if (!skipTempReset) {\n              for (var name in this) {\n                // Not sure about the optimal order of these conditions:\n                if (name.charAt(0) === \"t\" && hasOwn.call(this, name) && !isNaN(+name.slice(1))) {\n                  this[name] = undefined;\n                }\n              }\n            }\n          },\n          stop: function stop() {\n            this.done = true;\n            var rootEntry = this.tryEntries[0];\n            var rootRecord = rootEntry.completion;\n\n            if (rootRecord.type === \"throw\") {\n              throw rootRecord.arg;\n            }\n\n            return this.rval;\n          },\n          dispatchException: function dispatchException(exception) {\n            if (this.done) {\n              throw exception;\n            }\n\n            var context = this;\n\n            function handle(loc, caught) {\n              record.type = \"throw\";\n              record.arg = exception;\n              context.next = loc;\n\n              if (caught) {\n                // If the dispatched exception was caught by a catch block,\n                // then let that catch block handle the exception normally.\n                context.method = \"next\";\n                context.arg = undefined;\n              }\n\n              return !!caught;\n            }\n\n            for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n              var entry = this.tryEntries[i];\n              var record = entry.completion;\n\n              if (entry.tryLoc === \"root\") {\n                // Exception thrown outside of any try block that could handle\n                // it, so set the completion value of the entire function to\n                // throw the exception.\n                return handle(\"end\");\n              }\n\n              if (entry.tryLoc <= this.prev) {\n                var hasCatch = hasOwn.call(entry, \"catchLoc\");\n                var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n                if (hasCatch && hasFinally) {\n                  if (this.prev < entry.catchLoc) {\n                    return handle(entry.catchLoc, true);\n                  } else if (this.prev < entry.finallyLoc) {\n                    return handle(entry.finallyLoc);\n                  }\n                } else if (hasCatch) {\n                  if (this.prev < entry.catchLoc) {\n                    return handle(entry.catchLoc, true);\n                  }\n                } else if (hasFinally) {\n                  if (this.prev < entry.finallyLoc) {\n                    return handle(entry.finallyLoc);\n                  }\n                } else {\n                  throw new Error(\"try statement without catch or finally\");\n                }\n              }\n            }\n          },\n          abrupt: function abrupt(type, arg) {\n            for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n              var entry = this.tryEntries[i];\n\n              if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n                var finallyEntry = entry;\n                break;\n              }\n            }\n\n            if (finallyEntry && (type === \"break\" || type === \"continue\") && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc) {\n              // Ignore the finally entry if control is not jumping to a\n              // location outside the try/catch block.\n              finallyEntry = null;\n            }\n\n            var record = finallyEntry ? finallyEntry.completion : {};\n            record.type = type;\n            record.arg = arg;\n\n            if (finallyEntry) {\n              this.method = \"next\";\n              this.next = finallyEntry.finallyLoc;\n              return ContinueSentinel;\n            }\n\n            return this.complete(record);\n          },\n          complete: function complete(record, afterLoc) {\n            if (record.type === \"throw\") {\n              throw record.arg;\n            }\n\n            if (record.type === \"break\" || record.type === \"continue\") {\n              this.next = record.arg;\n            } else if (record.type === \"return\") {\n              this.rval = this.arg = record.arg;\n              this.method = \"return\";\n              this.next = \"end\";\n            } else if (record.type === \"normal\" && afterLoc) {\n              this.next = afterLoc;\n            }\n\n            return ContinueSentinel;\n          },\n          finish: function finish(finallyLoc) {\n            for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n              var entry = this.tryEntries[i];\n\n              if (entry.finallyLoc === finallyLoc) {\n                this.complete(entry.completion, entry.afterLoc);\n                resetTryEntry(entry);\n                return ContinueSentinel;\n              }\n            }\n          },\n          \"catch\": function _catch(tryLoc) {\n            for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n              var entry = this.tryEntries[i];\n\n              if (entry.tryLoc === tryLoc) {\n                var record = entry.completion;\n\n                if (record.type === \"throw\") {\n                  var thrown = record.arg;\n                  resetTryEntry(entry);\n                }\n\n                return thrown;\n              }\n            } // The context.catch method must only be called with a location\n            // argument that corresponds to a known catch block.\n\n\n            throw new Error(\"illegal catch attempt\");\n          },\n          delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n            this.delegate = {\n              iterator: values(iterable),\n              resultName: resultName,\n              nextLoc: nextLoc\n            };\n\n            if (this.method === \"next\") {\n              // Deliberately forget the last sent value so that we don't\n              // accidentally pass it on to the delegate.\n              this.arg = undefined;\n            }\n\n            return ContinueSentinel;\n          }\n        }; // Regardless of whether this script is executing as a CommonJS module\n        // or not, return the runtime object so that we can declare the variable\n        // regeneratorRuntime in the outer scope, which allows this module to be\n        // injected easily by `bin/regenerator --include-runtime script.js`.\n\n        return exports;\n      }( // If this script is executing as a CommonJS module, use module.exports\n      // as the regeneratorRuntime namespace. Otherwise create a new empty\n      // object. Either way, the resulting object will be used to initialize\n      // the regeneratorRuntime variable at the top of this file.\n      true ? module.exports : undefined);\n\n      try {\n        regeneratorRuntime = runtime;\n      } catch (accidentalStrictMode) {\n        // This module should not be running in strict mode, so the above\n        // assignment should always work unless something is misconfigured. Just\n        // in case runtime.js accidentally runs in strict mode, we can escape\n        // strict mode using a global Function call. This could conceivably fail\n        // if a Content Security Policy forbids using Function, but in that case\n        // the proper solution is to fix the accidental strict mode problem. If\n        // you've misconfigured your bundler to force strict mode and applied a\n        // CSP to forbid Function, and you're not willing to fix either of those\n        // problems, please detail your unique predicament in a GitHub issue.\n        Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n      }\n      /***/\n\n    },\n    /* 14 */\n\n    /***/\n    function (module, exports) {\n      /* (ignored) */\n\n      /***/\n    },\n    /* 15 */\n\n    /***/\n    function (module, exports) {\n      // Unique ID creation requires a high quality random # generator.  In the\n      // browser this is a little complicated due to unknown quality of Math.random()\n      // and inconsistent support for the `crypto` API.  We do the best we can via\n      // feature-detection\n      // getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n      // implementation. Also, find the complete implementation of crypto on IE11.\n      var getRandomValues = typeof crypto != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n      if (getRandomValues) {\n        // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n        var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n        module.exports = function whatwgRNG() {\n          getRandomValues(rnds8);\n          return rnds8;\n        };\n      } else {\n        // Math.random()-based (RNG)\n        //\n        // If all else fails, use Math.random().  It's fast, but is of unspecified\n        // quality.\n        var rnds = new Array(16);\n\n        module.exports = function mathRNG() {\n          for (var i = 0, r; i < 16; i++) {\n            if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n            rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n          }\n\n          return rnds;\n        };\n      }\n      /***/\n\n    },\n    /* 16 */\n\n    /***/\n    function (module, exports) {\n      /**\n       * Convert array of 16 byte values to UUID string format of the form:\n       * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n       */\n      var byteToHex = [];\n\n      for (var i = 0; i < 256; ++i) {\n        byteToHex[i] = (i + 0x100).toString(16).substr(1);\n      }\n\n      function bytesToUuid(buf, offset) {\n        var i = offset || 0;\n        var bth = byteToHex; // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n\n        return [bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]]].join('');\n      }\n\n      module.exports = bytesToUuid;\n      /***/\n    },\n    /* 17 */\n\n    /***/\n    function (module, __webpack_exports__, __webpack_require__) {\n      \"use strict\"; // ESM COMPAT FLAG\n\n      __webpack_require__.r(__webpack_exports__); // EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/typeof.js\n\n\n      var helpers_typeof = __webpack_require__(5);\n\n      var typeof_default =\n      /*#__PURE__*/\n      __webpack_require__.n(helpers_typeof); // EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/slicedToArray.js\n\n\n      var slicedToArray = __webpack_require__(6);\n\n      var slicedToArray_default =\n      /*#__PURE__*/\n      __webpack_require__.n(slicedToArray); // EXTERNAL MODULE: ./node_modules/@babel/runtime/regenerator/index.js\n\n\n      var regenerator = __webpack_require__(0);\n\n      var regenerator_default =\n      /*#__PURE__*/\n      __webpack_require__.n(regenerator); // EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/asyncToGenerator.js\n\n\n      var asyncToGenerator = __webpack_require__(2);\n\n      var asyncToGenerator_default =\n      /*#__PURE__*/\n      __webpack_require__.n(asyncToGenerator); // EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/classCallCheck.js\n\n\n      var classCallCheck = __webpack_require__(3);\n\n      var classCallCheck_default =\n      /*#__PURE__*/\n      __webpack_require__.n(classCallCheck); // EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/createClass.js\n\n\n      var createClass = __webpack_require__(4);\n\n      var createClass_default =\n      /*#__PURE__*/\n      __webpack_require__.n(createClass); // EXTERNAL MODULE: ./src/worker.js\n\n\n      var worker = __webpack_require__(7);\n\n      var worker_default =\n      /*#__PURE__*/\n      __webpack_require__.n(worker); // CONCATENATED MODULE: ./node_modules/broadcast-channel/dist/es/util.js\n\n      /**\n       * returns true if the given object is a promise\n       */\n\n\n      function isPromise(obj) {\n        if (obj && typeof obj.then === 'function') {\n          return true;\n        } else {\n          return false;\n        }\n      }\n\n      function sleep(time) {\n        if (!time) time = 0;\n        return new Promise(function (res) {\n          return setTimeout(res, time);\n        });\n      }\n\n      function randomInt(min, max) {\n        return Math.floor(Math.random() * (max - min + 1) + min);\n      }\n      /**\n       * https://stackoverflow.com/a/1349426/3443137\n       */\n\n\n      function randomToken(length) {\n        if (!length) length = 5;\n        var text = '';\n        var possible = 'abcdefghijklmnopqrstuvwxzy0123456789';\n\n        for (var i = 0; i < length; i++) {\n          text += possible.charAt(Math.floor(Math.random() * possible.length));\n        }\n\n        return text;\n      }\n\n      var lastMs = 0;\n      var additional = 0;\n      /**\n       * returns the current time in micro-seconds,\n       * WARNING: This is a pseudo-function\n       * Performance.now is not reliable in webworkers, so we just make sure to never return the same time.\n       * This is enough in browsers, and this function will not be used in nodejs.\n       * The main reason for this hack is to ensure that BroadcastChannel behaves equal to production when it is used in fast-running unit tests.\n       */\n\n      function microSeconds() {\n        var ms = new Date().getTime();\n\n        if (ms === lastMs) {\n          additional++;\n          return ms * 1000 + additional;\n        } else {\n          lastMs = ms;\n          additional = 0;\n          return ms * 1000;\n        }\n      } // EXTERNAL MODULE: ./node_modules/detect-node/browser.js\n\n\n      var browser = __webpack_require__(1);\n\n      var browser_default =\n      /*#__PURE__*/\n      __webpack_require__.n(browser); // CONCATENATED MODULE: ./node_modules/broadcast-channel/dist/es/methods/native.js\n\n\n      var native_microSeconds = microSeconds;\n      var type = 'native';\n\n      function create(channelName) {\n        var state = {\n          messagesCallback: null,\n          bc: new BroadcastChannel(channelName),\n          subFns: [] // subscriberFunctions\n\n        };\n\n        state.bc.onmessage = function (msg) {\n          if (state.messagesCallback) {\n            state.messagesCallback(msg.data);\n          }\n        };\n\n        return state;\n      }\n\n      function native_close(channelState) {\n        channelState.bc.close();\n        channelState.subFns = [];\n      }\n\n      function postMessage(channelState, messageJson) {\n        channelState.bc.postMessage(messageJson, false);\n      }\n\n      function onMessage(channelState, fn, time) {\n        channelState.messagesCallbackTime = time;\n        channelState.messagesCallback = fn;\n      }\n\n      function canBeUsed() {\n        /**\n         * in the electron-renderer, isNode will be true even if we are in browser-context\n         * so we also check if window is undefined\n         */\n        if (browser_default.a && typeof window === 'undefined') return false;\n\n        if (typeof BroadcastChannel === 'function') {\n          if (BroadcastChannel._pubkey) {\n            throw new Error('BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill');\n          }\n\n          return true;\n        } else return false;\n      }\n\n      function averageResponseTime() {\n        return 100;\n      }\n      /* harmony default export */\n\n\n      var methods_native = {\n        create: create,\n        close: native_close,\n        onMessage: onMessage,\n        postMessage: postMessage,\n        canBeUsed: canBeUsed,\n        type: type,\n        averageResponseTime: averageResponseTime,\n        microSeconds: native_microSeconds\n      }; // CONCATENATED MODULE: ./node_modules/broadcast-channel/dist/es/oblivious-set.js\n\n      /**\n       *\n       *\n       */\n\n      var ObliviousSet = function ObliviousSet(ttl) {\n        this.ttl = ttl;\n        this.set = new Set();\n        this.timeMap = new Map();\n        this.has = this.set.has.bind(this.set);\n      };\n\n      ObliviousSet.prototype = {\n        add: function add(value) {\n          this.timeMap.set(value, oblivious_set_now());\n          this.set.add(value);\n\n          _removeTooOldValues(this);\n        },\n        clear: function clear() {\n          this.set.clear();\n          this.timeMap.clear();\n        }\n      };\n\n      function _removeTooOldValues(obliviousSet) {\n        var olderThen = oblivious_set_now() - obliviousSet.ttl;\n        var iterator = obliviousSet.set[Symbol.iterator]();\n\n        while (true) {\n          var value = iterator.next().value;\n          if (!value) return; // no more elements\n\n          var time = obliviousSet.timeMap.get(value);\n\n          if (time < olderThen) {\n            obliviousSet.timeMap[\"delete\"](value);\n            obliviousSet.set[\"delete\"](value);\n          } else {\n            // we reached a value that is not old enough\n            return;\n          }\n        }\n      }\n\n      function oblivious_set_now() {\n        return new Date().getTime();\n      }\n      /* harmony default export */\n\n\n      var oblivious_set = ObliviousSet; // CONCATENATED MODULE: ./node_modules/broadcast-channel/dist/es/options.js\n\n      function fillOptionsWithDefaults(options) {\n        if (!options) options = {};\n        options = JSON.parse(JSON.stringify(options)); // main\n\n        if (typeof options.webWorkerSupport === 'undefined') options.webWorkerSupport = true; // indexed-db\n\n        if (!options.idb) options.idb = {}; //  after this time the messages get deleted\n\n        if (!options.idb.ttl) options.idb.ttl = 1000 * 45;\n        if (!options.idb.fallbackInterval) options.idb.fallbackInterval = 150; // localstorage\n\n        if (!options.localstorage) options.localstorage = {};\n        if (!options.localstorage.removeTimeout) options.localstorage.removeTimeout = 1000 * 60; // node\n\n        if (!options.node) options.node = {};\n        if (!options.node.ttl) options.node.ttl = 1000 * 60 * 2; // 2 minutes;\n\n        if (typeof options.node.useFastPath === 'undefined') options.node.useFastPath = true;\n        return options;\n      } // CONCATENATED MODULE: ./node_modules/broadcast-channel/dist/es/methods/indexed-db.js\n\n      /**\n       * this method uses indexeddb to store the messages\n       * There is currently no observerAPI for idb\n       * @link https://github.com/w3c/IndexedDB/issues/51\n       */\n\n\n      var indexed_db_microSeconds = microSeconds;\n      var DB_PREFIX = 'pubkey.broadcast-channel-0-';\n      var OBJECT_STORE_ID = 'messages';\n      var indexed_db_type = 'idb';\n\n      function getIdb() {\n        if (typeof indexedDB !== 'undefined') return indexedDB;\n        if (typeof window.mozIndexedDB !== 'undefined') return window.mozIndexedDB;\n        if (typeof window.webkitIndexedDB !== 'undefined') return window.webkitIndexedDB;\n        if (typeof window.msIndexedDB !== 'undefined') return window.msIndexedDB;\n        return false;\n      }\n\n      function createDatabase(channelName) {\n        var IndexedDB = getIdb(); // create table\n\n        var dbName = DB_PREFIX + channelName;\n        var openRequest = IndexedDB.open(dbName, 1);\n\n        openRequest.onupgradeneeded = function (ev) {\n          var db = ev.target.result;\n          db.createObjectStore(OBJECT_STORE_ID, {\n            keyPath: 'id',\n            autoIncrement: true\n          });\n        };\n\n        var dbPromise = new Promise(function (res, rej) {\n          openRequest.onerror = function (ev) {\n            return rej(ev);\n          };\n\n          openRequest.onsuccess = function () {\n            res(openRequest.result);\n          };\n        });\n        return dbPromise;\n      }\n      /**\n       * writes the new message to the database\n       * so other readers can find it\n       */\n\n\n      function writeMessage(db, readerUuid, messageJson) {\n        var time = new Date().getTime();\n        var writeObject = {\n          uuid: readerUuid,\n          time: time,\n          data: messageJson\n        };\n        var transaction = db.transaction([OBJECT_STORE_ID], 'readwrite');\n        return new Promise(function (res, rej) {\n          transaction.oncomplete = function () {\n            return res();\n          };\n\n          transaction.onerror = function (ev) {\n            return rej(ev);\n          };\n\n          var objectStore = transaction.objectStore(OBJECT_STORE_ID);\n          objectStore.add(writeObject);\n        });\n      }\n\n      function getAllMessages(db) {\n        var objectStore = db.transaction(OBJECT_STORE_ID).objectStore(OBJECT_STORE_ID);\n        var ret = [];\n        return new Promise(function (res) {\n          objectStore.openCursor().onsuccess = function (ev) {\n            var cursor = ev.target.result;\n\n            if (cursor) {\n              ret.push(cursor.value); //alert(\"Name for SSN \" + cursor.key + \" is \" + cursor.value.name);\n\n              cursor[\"continue\"]();\n            } else {\n              res(ret);\n            }\n          };\n        });\n      }\n\n      function getMessagesHigherThen(db, lastCursorId) {\n        var objectStore = db.transaction(OBJECT_STORE_ID).objectStore(OBJECT_STORE_ID);\n        var ret = [];\n        var keyRangeValue = IDBKeyRange.bound(lastCursorId + 1, Infinity);\n        return new Promise(function (res) {\n          objectStore.openCursor(keyRangeValue).onsuccess = function (ev) {\n            var cursor = ev.target.result;\n\n            if (cursor) {\n              ret.push(cursor.value); //alert(\"Name for SSN \" + cursor.key + \" is \" + cursor.value.name);\n\n              cursor[\"continue\"]();\n            } else {\n              res(ret);\n            }\n          };\n        });\n      }\n\n      function removeMessageById(db, id) {\n        var request = db.transaction([OBJECT_STORE_ID], 'readwrite').objectStore(OBJECT_STORE_ID)[\"delete\"](id);\n        return new Promise(function (res) {\n          request.onsuccess = function () {\n            return res();\n          };\n        });\n      }\n\n      function getOldMessages(db, ttl) {\n        var olderThen = new Date().getTime() - ttl;\n        var objectStore = db.transaction(OBJECT_STORE_ID).objectStore(OBJECT_STORE_ID);\n        var ret = [];\n        return new Promise(function (res) {\n          objectStore.openCursor().onsuccess = function (ev) {\n            var cursor = ev.target.result;\n\n            if (cursor) {\n              var msgObk = cursor.value;\n\n              if (msgObk.time < olderThen) {\n                ret.push(msgObk); //alert(\"Name for SSN \" + cursor.key + \" is \" + cursor.value.name);\n\n                cursor[\"continue\"]();\n              } else {\n                // no more old messages,\n                res(ret);\n                return;\n              }\n            } else {\n              res(ret);\n            }\n          };\n        });\n      }\n\n      function cleanOldMessages(db, ttl) {\n        return getOldMessages(db, ttl).then(function (tooOld) {\n          return Promise.all(tooOld.map(function (msgObj) {\n            return removeMessageById(db, msgObj.id);\n          }));\n        });\n      }\n\n      function indexed_db_create(channelName, options) {\n        options = fillOptionsWithDefaults(options);\n        return createDatabase(channelName).then(function (db) {\n          var state = {\n            closed: false,\n            lastCursorId: 0,\n            channelName: channelName,\n            options: options,\n            uuid: randomToken(10),\n\n            /**\n             * emittedMessagesIds\n             * contains all messages that have been emitted before\n             * @type {ObliviousSet}\n             */\n            eMIs: new oblivious_set(options.idb.ttl * 2),\n            // ensures we do not read messages in parrallel\n            writeBlockPromise: Promise.resolve(),\n            messagesCallback: null,\n            readQueuePromises: [],\n            db: db\n          };\n          /**\n           * if service-workers are used,\n           * we have no 'storage'-event if they post a message,\n           * therefore we also have to set an interval\n           */\n\n          _readLoop(state);\n\n          return state;\n        });\n      }\n\n      function _readLoop(state) {\n        if (state.closed) return;\n        return readNewMessages(state).then(function () {\n          return sleep(state.options.idb.fallbackInterval);\n        }).then(function () {\n          return _readLoop(state);\n        });\n      }\n\n      function _filterMessage(msgObj, state) {\n        if (msgObj.uuid === state.uuid) return false; // send by own\n\n        if (state.eMIs.has(msgObj.id)) return false; // already emitted\n\n        if (msgObj.data.time < state.messagesCallbackTime) return false; // older then onMessageCallback\n\n        return true;\n      }\n      /**\n       * reads all new messages from the database and emits them\n       */\n\n\n      function readNewMessages(state) {\n        // channel already closed\n        if (state.closed) return Promise.resolve(); // if no one is listening, we do not need to scan for new messages\n\n        if (!state.messagesCallback) return Promise.resolve();\n        return getMessagesHigherThen(state.db, state.lastCursorId).then(function (newerMessages) {\n          var useMessages = newerMessages.map(function (msgObj) {\n            if (msgObj.id > state.lastCursorId) {\n              state.lastCursorId = msgObj.id;\n            }\n\n            return msgObj;\n          }).filter(function (msgObj) {\n            return _filterMessage(msgObj, state);\n          }).sort(function (msgObjA, msgObjB) {\n            return msgObjA.time - msgObjB.time;\n          }); // sort by time\n\n          useMessages.forEach(function (msgObj) {\n            if (state.messagesCallback) {\n              state.eMIs.add(msgObj.id);\n              state.messagesCallback(msgObj.data);\n            }\n          });\n          return Promise.resolve();\n        });\n      }\n\n      function indexed_db_close(channelState) {\n        channelState.closed = true;\n        channelState.db.close();\n      }\n\n      function indexed_db_postMessage(channelState, messageJson) {\n        channelState.writeBlockPromise = channelState.writeBlockPromise.then(function () {\n          return writeMessage(channelState.db, channelState.uuid, messageJson);\n        }).then(function () {\n          if (randomInt(0, 10) === 0) {\n            /* await (do not await) */\n            cleanOldMessages(channelState.db, channelState.options.idb.ttl);\n          }\n        });\n        return channelState.writeBlockPromise;\n      }\n\n      function indexed_db_onMessage(channelState, fn, time) {\n        channelState.messagesCallbackTime = time;\n        channelState.messagesCallback = fn;\n        readNewMessages(channelState);\n      }\n\n      function indexed_db_canBeUsed() {\n        if (browser_default.a) return false;\n        var idb = getIdb();\n        if (!idb) return false;\n        return true;\n      }\n\n      function indexed_db_averageResponseTime(options) {\n        return options.idb.fallbackInterval * 2;\n      }\n      /* harmony default export */\n\n\n      var indexed_db = {\n        create: indexed_db_create,\n        close: indexed_db_close,\n        onMessage: indexed_db_onMessage,\n        postMessage: indexed_db_postMessage,\n        canBeUsed: indexed_db_canBeUsed,\n        type: indexed_db_type,\n        averageResponseTime: indexed_db_averageResponseTime,\n        microSeconds: indexed_db_microSeconds\n      }; // CONCATENATED MODULE: ./node_modules/broadcast-channel/dist/es/methods/localstorage.js\n\n      /**\n       * A localStorage-only method which uses localstorage and its 'storage'-event\n       * This does not work inside of webworkers because they have no access to locastorage\n       * This is basically implemented to support IE9 or your grandmothers toaster.\n       * @link https://caniuse.com/#feat=namevalue-storage\n       * @link https://caniuse.com/#feat=indexeddb\n       */\n\n      var localstorage_microSeconds = microSeconds;\n      var KEY_PREFIX = 'pubkey.broadcastChannel-';\n      var localstorage_type = 'localstorage';\n      /**\n       * copied from crosstab\n       * @link https://github.com/tejacques/crosstab/blob/master/src/crosstab.js#L32\n       */\n\n      function getLocalStorage() {\n        var localStorage;\n        if (typeof window === 'undefined') return null;\n\n        try {\n          localStorage = window.localStorage;\n          localStorage = window['ie8-eventlistener/storage'] || window.localStorage;\n        } catch (e) {// New versions of Firefox throw a Security exception\n          // if cookies are disabled. See\n          // https://bugzilla.mozilla.org/show_bug.cgi?id=1028153\n        }\n\n        return localStorage;\n      }\n\n      function storageKey(channelName) {\n        return KEY_PREFIX + channelName;\n      }\n      /**\n      * writes the new message to the storage\n      * and fires the storage-event so other readers can find it\n      */\n\n\n      function localstorage_postMessage(channelState, messageJson) {\n        return new Promise(function (res) {\n          sleep().then(function () {\n            var key = storageKey(channelState.channelName);\n            var writeObj = {\n              token: randomToken(10),\n              time: new Date().getTime(),\n              data: messageJson,\n              uuid: channelState.uuid\n            };\n            var value = JSON.stringify(writeObj);\n            localStorage.setItem(key, value);\n            /**\n             * StorageEvent does not fire the 'storage' event\n             * in the window that changes the state of the local storage.\n             * So we fire it manually\n             */\n\n            var ev = document.createEvent('Event');\n            ev.initEvent('storage', true, true);\n            ev.key = key;\n            ev.newValue = value;\n            window.dispatchEvent(ev);\n            res();\n          });\n        });\n      }\n\n      function addStorageEventListener(channelName, fn) {\n        var key = storageKey(channelName);\n\n        var listener = function listener(ev) {\n          if (ev.key === key) {\n            fn(JSON.parse(ev.newValue));\n          }\n        };\n\n        window.addEventListener('storage', listener);\n        return listener;\n      }\n\n      function removeStorageEventListener(listener) {\n        window.removeEventListener('storage', listener);\n      }\n\n      function localstorage_create(channelName, options) {\n        options = fillOptionsWithDefaults(options);\n\n        if (!localstorage_canBeUsed()) {\n          throw new Error('BroadcastChannel: localstorage cannot be used');\n        }\n\n        var uuid = randomToken(10);\n        /**\n         * eMIs\n         * contains all messages that have been emitted before\n         * @type {ObliviousSet}\n         */\n\n        var eMIs = new oblivious_set(options.localstorage.removeTimeout);\n        var state = {\n          channelName: channelName,\n          uuid: uuid,\n          eMIs: eMIs // emittedMessagesIds\n\n        };\n        state.listener = addStorageEventListener(channelName, function (msgObj) {\n          if (!state.messagesCallback) return; // no listener\n\n          if (msgObj.uuid === uuid) return; // own message\n\n          if (!msgObj.token || eMIs.has(msgObj.token)) return; // already emitted\n\n          if (msgObj.data.time && msgObj.data.time < state.messagesCallbackTime) return; // too old\n\n          eMIs.add(msgObj.token);\n          state.messagesCallback(msgObj.data);\n        });\n        return state;\n      }\n\n      function localstorage_close(channelState) {\n        removeStorageEventListener(channelState.listener);\n      }\n\n      function localstorage_onMessage(channelState, fn, time) {\n        channelState.messagesCallbackTime = time;\n        channelState.messagesCallback = fn;\n      }\n\n      function localstorage_canBeUsed() {\n        if (browser_default.a) return false;\n        var ls = getLocalStorage();\n        if (!ls) return false;\n        return true;\n      }\n\n      function localstorage_averageResponseTime() {\n        return 120;\n      }\n      /* harmony default export */\n\n\n      var localstorage = {\n        create: localstorage_create,\n        close: localstorage_close,\n        onMessage: localstorage_onMessage,\n        postMessage: localstorage_postMessage,\n        canBeUsed: localstorage_canBeUsed,\n        type: localstorage_type,\n        averageResponseTime: localstorage_averageResponseTime,\n        microSeconds: localstorage_microSeconds\n      }; // CONCATENATED MODULE: ./node_modules/broadcast-channel/dist/es/method-chooser.js\n\n      var require; // order is important\n\n\n      var METHODS = [methods_native, // fastest\n      indexed_db, localstorage];\n      var REQUIRE_FUN = require;\n      /**\n       * The NodeMethod is loaded lazy\n       * so it will not get bundled in browser-builds\n       */\n\n      if (browser_default.a) {\n        /**\n         * we use the non-transpiled code for nodejs\n         * because it runs faster\n         */\n        var NodeMethod = __webpack_require__(14);\n        /**\n         * this will be false for webpackbuilds\n         * which will shim the node-method with an empty object {}\n         */\n\n\n        if (typeof NodeMethod.canBeUsed === 'function') {\n          METHODS.push(NodeMethod);\n        }\n      }\n\n      function chooseMethod(options) {\n        // directly chosen\n        if (options.type) {\n          var ret = METHODS.find(function (m) {\n            return m.type === options.type;\n          });\n          if (!ret) throw new Error('method-type ' + options.type + ' not found');else return ret;\n        }\n\n        var chooseMethods = METHODS;\n\n        if (!options.webWorkerSupport && !browser_default.a) {\n          // prefer localstorage over idb when no webworker-support needed\n          chooseMethods = METHODS.filter(function (m) {\n            return m.type !== 'idb';\n          });\n        }\n\n        var useMethod = chooseMethods.find(function (method) {\n          return method.canBeUsed();\n        });\n        if (!useMethod) throw new Error('No useable methode found:' + JSON.stringify(METHODS.map(function (m) {\n          return m.type;\n        })));else return useMethod;\n      } // CONCATENATED MODULE: ./node_modules/broadcast-channel/dist/es/index.js\n\n\n      var es_BroadcastChannel = function BroadcastChannel(name, options) {\n        this.name = name;\n        this.options = fillOptionsWithDefaults(options);\n        this.method = chooseMethod(this.options); // isListening\n\n        this._iL = false;\n        /**\n         * _onMessageListener\n         * setting onmessage twice,\n         * will overwrite the first listener\n         */\n\n        this._onML = null;\n        /**\n         * _addEventListeners\n         */\n\n        this._addEL = {\n          message: [],\n          internal: []\n        };\n        /**\n         * _beforeClose\n         * array of promises that will be awaited\n         * before the channel is closed\n         */\n\n        this._befC = [];\n        /**\n         * _preparePromise\n         */\n\n        this._prepP = null;\n\n        _prepareChannel(this);\n      }; // STATICS\n\n      /**\n       * used to identify if someone overwrites\n       * window.BroadcastChannel with this\n       * See methods/native.js\n       */\n\n\n      es_BroadcastChannel._pubkey = true;\n      /**\n       * clears the tmp-folder if is node\n       * @return {Promise<boolean>} true if has run, false if not node\n       */\n\n      es_BroadcastChannel.clearNodeFolder = function (options) {\n        options = fillOptionsWithDefaults(options);\n        var method = chooseMethod(options);\n\n        if (method.type === 'node') {\n          return method.clearNodeFolder().then(function () {\n            return true;\n          });\n        } else {\n          return Promise.resolve(false);\n        }\n      }; // PROTOTYPE\n\n\n      es_BroadcastChannel.prototype = {\n        postMessage: function postMessage(msg) {\n          if (this.closed) {\n            throw new Error('BroadcastChannel.postMessage(): ' + 'Cannot post message after channel has closed');\n          }\n\n          return _post(this, 'message', msg);\n        },\n        postInternal: function postInternal(msg) {\n          return _post(this, 'internal', msg);\n        },\n\n        set onmessage(fn) {\n          var time = this.method.microSeconds();\n          var listenObj = {\n            time: time,\n            fn: fn\n          };\n\n          _removeListenerObject(this, 'message', this._onML);\n\n          if (fn && typeof fn === 'function') {\n            this._onML = listenObj;\n\n            _addListenerObject(this, 'message', listenObj);\n          } else {\n            this._onML = null;\n          }\n        },\n\n        addEventListener: function addEventListener(type, fn) {\n          var time = this.method.microSeconds();\n          var listenObj = {\n            time: time,\n            fn: fn\n          };\n\n          _addListenerObject(this, type, listenObj);\n        },\n        removeEventListener: function removeEventListener(type, fn) {\n          var obj = this._addEL[type].find(function (obj) {\n            return obj.fn === fn;\n          });\n\n          _removeListenerObject(this, type, obj);\n        },\n        close: function close() {\n          var _this = this;\n\n          if (this.closed) return;\n          this.closed = true;\n          var awaitPrepare = this._prepP ? this._prepP : Promise.resolve();\n          this._onML = null;\n          this._addEL.message = [];\n          return awaitPrepare.then(function () {\n            return Promise.all(_this._befC.map(function (fn) {\n              return fn();\n            }));\n          }).then(function () {\n            return _this.method.close(_this._state);\n          });\n        },\n\n        get type() {\n          return this.method.type;\n        }\n\n      };\n\n      function _post(broadcastChannel, type, msg) {\n        var time = broadcastChannel.method.microSeconds();\n        var msgObj = {\n          time: time,\n          type: type,\n          data: msg\n        };\n        var awaitPrepare = broadcastChannel._prepP ? broadcastChannel._prepP : Promise.resolve();\n        return awaitPrepare.then(function () {\n          return broadcastChannel.method.postMessage(broadcastChannel._state, msgObj);\n        });\n      }\n\n      function _prepareChannel(channel) {\n        var maybePromise = channel.method.create(channel.name, channel.options);\n\n        if (isPromise(maybePromise)) {\n          channel._prepP = maybePromise;\n          maybePromise.then(function (s) {\n            // used in tests to simulate slow runtime\n\n            /*if (channel.options.prepareDelay) {\n                 await new Promise(res => setTimeout(res, this.options.prepareDelay));\n            }*/\n            channel._state = s;\n          });\n        } else {\n          channel._state = maybePromise;\n        }\n      }\n\n      function _hasMessageListeners(channel) {\n        if (channel._addEL.message.length > 0) return true;\n        if (channel._addEL.internal.length > 0) return true;\n        return false;\n      }\n\n      function _addListenerObject(channel, type, obj) {\n        channel._addEL[type].push(obj);\n\n        _startListening(channel);\n      }\n\n      function _removeListenerObject(channel, type, obj) {\n        channel._addEL[type] = channel._addEL[type].filter(function (o) {\n          return o !== obj;\n        });\n\n        _stopListening(channel);\n      }\n\n      function _startListening(channel) {\n        if (!channel._iL && _hasMessageListeners(channel)) {\n          // someone is listening, start subscribing\n          var listenerFn = function listenerFn(msgObj) {\n            channel._addEL[msgObj.type].forEach(function (obj) {\n              if (msgObj.time >= obj.time) {\n                obj.fn(msgObj.data);\n              }\n            });\n          };\n\n          var time = channel.method.microSeconds();\n\n          if (channel._prepP) {\n            channel._prepP.then(function () {\n              channel._iL = true;\n              channel.method.onMessage(channel._state, listenerFn, time);\n            });\n          } else {\n            channel._iL = true;\n            channel.method.onMessage(channel._state, listenerFn, time);\n          }\n        }\n      }\n\n      function _stopListening(channel) {\n        if (channel._iL && !_hasMessageListeners(channel)) {\n          // noone is listening, stop subscribing\n          channel._iL = false;\n          var time = channel.method.microSeconds();\n          channel.method.onMessage(channel._state, null, time);\n        }\n      }\n      /* harmony default export */\n\n\n      var es = es_BroadcastChannel; // EXTERNAL MODULE: ./node_modules/uuid/v4.js\n\n      var v4 = __webpack_require__(8);\n\n      var v4_default =\n      /*#__PURE__*/\n      __webpack_require__.n(v4); // CONCATENATED MODULE: ./src/logger.js\n\n\n      var logger_Logger =\n      /*#__PURE__*/\n      function () {\n        function Logger() {\n          classCallCheck_default()(this, Logger);\n          this.setVerbosity('WARNING');\n        }\n\n        createClass_default()(Logger, [{\n          key: \"debug\",\n          value: function debug() {\n            if (this.checkVerbosity(4)) {\n              var _console;\n\n              (_console = console).log.apply(_console, arguments);\n            }\n          }\n        }, {\n          key: \"log\",\n          value: function log() {\n            if (this.checkVerbosity(4)) {\n              var _console2;\n\n              (_console2 = console).log.apply(_console2, arguments);\n            }\n          }\n        }, {\n          key: \"info\",\n          value: function info() {\n            if (this.checkVerbosity(3)) {\n              var _console3;\n\n              (_console3 = console).info.apply(_console3, arguments);\n            }\n          }\n        }, {\n          key: \"warn\",\n          value: function warn() {\n            if (this.checkVerbosity(2)) {\n              var _console4;\n\n              (_console4 = console).warn.apply(_console4, arguments);\n            }\n          }\n        }, {\n          key: \"error\",\n          value: function error() {\n            if (this.checkVerbosity(1)) {\n              var _console5;\n\n              (_console5 = console).error.apply(_console5, arguments);\n            }\n          }\n        }, {\n          key: \"setVerbosity\",\n          value: function setVerbosity(level) {\n            var default_level = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';\n\n            if (level === undefined) {\n              level = default_level;\n            }\n\n            if (typeof level === 'string') {\n              level = {\n                ERROR: 1,\n                WARNING: 2,\n                INFO: 3,\n                LOG: 4,\n                DEBUG: 4\n              }[level.toUpperCase()] || 2;\n            }\n\n            this.level = level;\n          }\n        }, {\n          key: \"checkVerbosity\",\n          value: function checkVerbosity(level) {\n            return this.level >= level;\n          }\n        }]);\n        return Logger;\n      }();\n\n      var log = new logger_Logger();\n      /* harmony default export */\n\n      var logger = log; // CONCATENATED MODULE: ./src/index.js\n      //import localforage from 'localforage';\n\n      var src_sleep = function sleep(ms) {\n        return new Promise(function (res) {\n          return setTimeout(res, ms);\n        });\n      };\n      /**\n       * TDLib in a browser\n       *\n       * TDLib can be compiled to WebAssembly or asm.js using Emscripten compiler and used in a browser from JavaScript.\n       * This is a convenient wrapper for TDLib in a browser which controls TDLib instance creation, handles interaction\n       * with TDLib and manages a filesystem for persistent TDLib data.\n       * TDLib instance is created in a Web Worker to run it in a separate thread.\n       * TdClient just sends queries to the Web Worker and receives updates and results from it.\n       * <br>\n       * <br>\n       * Differences from the TDLib JSON API:<br>\n       * 1. Added the update <code>updateFatalError error:string = Update;</code> which is sent whenever TDLib encounters a fatal error.<br>\n       * 2. Added the method <code>setJsLogVerbosityLevel new_verbosity_level:string = Ok;</code>, which allows to change the verbosity level of tdweb logging.<br>\n       * 3. Added the possibility to use blobs as input files via the constructor <code>inputFileBlob data:<JavaScript blob> = InputFile;</code>.<br>\n       * 4. The class <code>filePart</code> contains data as a JavaScript blob instead of a base64-encoded string.<br>\n       * 5. The methods <code>getStorageStatistics</code>, <code>getStorageStatisticsFast</code>, <code>optimizeStorage</code>, <code>addProxy</code> and <code>getFileDownloadedPrefixSize</code> are not supported.<br>\n       * <br>\n       */\n\n\n      var src_TdClient =\n      /*#__PURE__*/\n      function () {\n        /**\n         * @callback TdClient~updateCallback\n         * @param {Object} update The update.\n         */\n\n        /**\n         * Create TdClient.\n         * @param {Object} options - Options for TDLib instance creation.\n         * @param {TdClient~updateCallback} options.onUpdate - Callback for all incoming updates.\n         * @param {string} [options.instanceName=tdlib] - Name of the TDLib instance. Currently only one instance of TdClient with a given name is allowed. All but one instances with the same name will be automatically closed. Usually, the newest non-background instance is kept alive. Files will be stored in an IndexedDb table with the same name.\n         * @param {boolean} [options.isBackground=false] - Pass true, if the instance is opened from the background.\n         * @param {string} [options.jsLogVerbosityLevel=info] - The initial verbosity level of the JavaScript part of the code (one of 'error', 'warning', 'info', 'log', 'debug').\n         * @param {number} [options.logVerbosityLevel=2] - The initial verbosity level for the TDLib internal logging (0-1023).\n         * @param {boolean} [options.useDatabase=true] - Pass false to use TDLib without database and secret chats. It will significantly improve loading time, but some functionality will be unavailable.\n         * @param {boolean} [options.readOnly=false] - For debug only. Pass true to open TDLib database in read-only mode\n         * @param {string} [options.mode=auto] - For debug only. The type of the TDLib build to use. 'asmjs' for asm.js and 'wasm' for WebAssembly. If mode == 'auto' WebAbassembly will be used if supported by browser, asm.js otherwise.\n         */\n        function TdClient(options) {\n          var _this = this;\n\n          classCallCheck_default()(this, TdClient);\n          logger.setVerbosity(options.jsLogVerbosityLevel);\n          this.worker = new worker_default.a();\n\n          this.worker.onmessage = function (e) {\n            _this.onResponse(e.data);\n          };\n\n          this.query_id = 0;\n          this.query_callbacks = new Map();\n\n          if ('onUpdate' in options) {\n            this.onUpdate = options.onUpdate;\n            delete options.onUpdate;\n          }\n\n          options.instanceName = options.instanceName || 'tdlib';\n          this.fileManager = new src_FileManager(options.instanceName, this);\n          this.worker.postMessage({\n            '@type': 'init',\n            options: options\n          });\n          this.closeOtherClients(options);\n        }\n        /**\n         * Send a query to TDLib.\n         *\n         * If the query contains the field '@extra', the same field will be added into the result.\n         *\n         * @param {Object} query - The query for TDLib. See the [td_api.tl]{@link https://github.com/tdlib/td/blob/master/td/generate/scheme/td_api.tl} scheme or\n         *                         the automatically generated [HTML documentation]{@link https://core.telegram.org/tdlib/docs/td__api_8h.html}\n         *                         for a list of all available TDLib [methods]{@link https://core.telegram.org/tdlib/docs/classtd_1_1td__api_1_1_function.html} and\n         *                         [classes]{@link https://core.telegram.org/tdlib/docs/classtd_1_1td__api_1_1_object.html}.\n         * @returns {Promise} Promise object represents the result of the query.\n         */\n\n\n        createClass_default()(TdClient, [{\n          key: \"send\",\n          value: function send(query) {\n            return this.doSend(query, true);\n          }\n          /** @private */\n\n        }, {\n          key: \"sendInternal\",\n          value: function sendInternal(query) {\n            return this.doSend(query, false);\n          }\n          /** @private */\n\n        }, {\n          key: \"doSend\",\n          value: function doSend(query, isExternal) {\n            var _this2 = this;\n\n            this.query_id++;\n\n            if (query['@extra']) {\n              query['@extra'] = {\n                '@old_extra': JSON.parse(JSON.stringify(query['@extra'])),\n                query_id: this.query_id\n              };\n            } else {\n              query['@extra'] = {\n                query_id: this.query_id\n              };\n            }\n\n            if (query['@type'] === 'setJsLogVerbosityLevel') {\n              logger.setVerbosity(query.new_verbosity_level);\n            }\n\n            logger.debug('send to worker: ', query);\n            var res = new Promise(function (resolve, reject) {\n              _this2.query_callbacks.set(_this2.query_id, [resolve, reject]);\n            });\n\n            if (isExternal) {\n              this.externalPostMessage(query);\n            } else {\n              this.worker.postMessage(query);\n            }\n\n            return res;\n          }\n          /** @private */\n\n        }, {\n          key: \"externalPostMessage\",\n          value: function externalPostMessage(query) {\n            var unsupportedMethods = ['getStorageStatistics', 'getStorageStatisticsFast', 'optimizeStorage', 'addProxy', 'init', 'start'];\n\n            if (unsupportedMethods.includes(query['@type'])) {\n              this.onResponse({\n                '@type': 'error',\n                '@extra': query['@extra'],\n                code: 400,\n                message: \"Method '\" + query['@type'] + \"' is not supported\"\n              });\n              return;\n            }\n\n            if (query['@type'] === 'readFile' || query['@type'] === 'readFilePart') {\n              this.readFile(query);\n              return;\n            }\n\n            if (query['@type'] === 'deleteFile') {\n              this.deleteFile(query);\n              return;\n            }\n\n            this.worker.postMessage(query);\n          }\n          /** @private */\n\n        }, {\n          key: \"readFile\",\n          value: function () {\n            var _readFile = asyncToGenerator_default()(\n            /*#__PURE__*/\n            regenerator_default.a.mark(function _callee(query) {\n              var response;\n              return regenerator_default.a.wrap(function _callee$(_context) {\n                while (1) {\n                  switch (_context.prev = _context.next) {\n                    case 0:\n                      _context.next = 2;\n                      return this.fileManager.readFile(query);\n\n                    case 2:\n                      response = _context.sent;\n                      this.onResponse(response);\n\n                    case 4:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }\n              }, _callee, this);\n            }));\n\n            function readFile(_x) {\n              return _readFile.apply(this, arguments);\n            }\n\n            return readFile;\n          }()\n          /** @private */\n\n        }, {\n          key: \"deleteFile\",\n          value: function () {\n            var _deleteFile = asyncToGenerator_default()(\n            /*#__PURE__*/\n            regenerator_default.a.mark(function _callee2(query) {\n              var response;\n              return regenerator_default.a.wrap(function _callee2$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      response = this.fileManager.deleteFile(query);\n                      _context2.prev = 1;\n\n                      if (!response.idb_key) {\n                        _context2.next = 6;\n                        break;\n                      }\n\n                      _context2.next = 5;\n                      return this.sendInternal({\n                        '@type': 'deleteIdbKey',\n                        idb_key: response.idb_key\n                      });\n\n                    case 5:\n                      delete response.idb_key;\n\n                    case 6:\n                      _context2.next = 8;\n                      return this.sendInternal({\n                        '@type': 'deleteFile',\n                        file_id: query.file_id\n                      });\n\n                    case 8:\n                      _context2.next = 12;\n                      break;\n\n                    case 10:\n                      _context2.prev = 10;\n                      _context2.t0 = _context2[\"catch\"](1);\n\n                    case 12:\n                      this.onResponse(response);\n\n                    case 13:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              }, _callee2, this, [[1, 10]]);\n            }));\n\n            function deleteFile(_x2) {\n              return _deleteFile.apply(this, arguments);\n            }\n\n            return deleteFile;\n          }()\n          /** @private */\n\n        }, {\n          key: \"onResponse\",\n          value: function onResponse(response) {\n            logger.debug('receive from worker: ', JSON.parse(JSON.stringify(response, function (key, value) {\n              if (key === 'arr' || key === 'data') {\n                return undefined;\n              }\n\n              return value;\n            }))); // for FileManager\n\n            response = this.prepareResponse(response);\n\n            if ('@extra' in response) {\n              var query_id = response['@extra'].query_id;\n\n              var _this$query_callbacks = this.query_callbacks.get(query_id),\n                  _this$query_callbacks2 = slicedToArray_default()(_this$query_callbacks, 2),\n                  resolve = _this$query_callbacks2[0],\n                  reject = _this$query_callbacks2[1];\n\n              this.query_callbacks[\"delete\"](query_id);\n\n              if ('@old_extra' in response['@extra']) {\n                response['@extra'] = response['@extra']['@old_extra'];\n              }\n\n              if (resolve) {\n                if (response['@type'] === 'error') {\n                  reject(response);\n                } else {\n                  resolve(response);\n                }\n              }\n            } else {\n              if (response['@type'] === 'inited') {\n                this.onInited();\n                return;\n              }\n\n              if (response['@type'] === 'fsInited') {\n                this.onFsInited();\n                return;\n              }\n\n              if (response['@type'] === 'updateAuthorizationState' && response.authorization_state['@type'] === 'authorizationStateClosed') {\n                this.onClosed();\n              }\n\n              this.onUpdate(response);\n            }\n          }\n          /** @private */\n\n        }, {\n          key: \"prepareFile\",\n          value: function prepareFile(file) {\n            return this.fileManager.registerFile(file);\n          }\n          /** @private */\n\n        }, {\n          key: \"prepareResponse\",\n          value: function prepareResponse(response) {\n            var _this3 = this;\n\n            if (response['@type'] === 'file') {\n              if (false) {}\n\n              return this.prepareFile(response);\n            }\n\n            for (var key in response) {\n              var field = response[key];\n\n              if (field && typeof_default()(field) === 'object' && key !== 'data' && key !== 'arr') {\n                response[key] = this.prepareResponse(field);\n              }\n            }\n\n            return response;\n          }\n          /** @private */\n\n        }, {\n          key: \"onBroadcastMessage\",\n          value: function onBroadcastMessage(e) {\n            //const message = e.data;\n            var message = e;\n\n            if (message.uid === this.uid) {\n              logger.info('ignore self broadcast message: ', message);\n              return;\n            }\n\n            logger.info('got broadcast message: ', message);\n\n            if (message.isBackground && !this.isBackground) {// continue\n            } else if (!message.isBackground && this.isBackground || message.timestamp > this.timestamp) {\n              this.close();\n              return;\n            }\n\n            if (message.state === 'closed') {\n              this.waitSet[\"delete\"](message.uid);\n\n              if (this.waitSet.size === 0) {\n                logger.info('onWaitSetEmpty');\n                this.onWaitSetEmpty();\n\n                this.onWaitSetEmpty = function () {};\n              }\n            } else {\n              this.waitSet.add(message.uid);\n\n              if (message.state !== 'closing') {\n                this.postState();\n              }\n            }\n          }\n          /** @private */\n\n        }, {\n          key: \"postState\",\n          value: function postState() {\n            var state = {\n              uid: this.uid,\n              state: this.state,\n              timestamp: this.timestamp,\n              isBackground: this.isBackground\n            };\n            logger.info('Post state: ', state);\n            this.channel.postMessage(state);\n          }\n          /** @private */\n\n        }, {\n          key: \"onWaitSetEmpty\",\n          value: function onWaitSetEmpty() {} // nop\n\n          /** @private */\n\n        }, {\n          key: \"onFsInited\",\n          value: function onFsInited() {\n            this.fileManager.init();\n          }\n          /** @private */\n\n        }, {\n          key: \"onInited\",\n          value: function onInited() {\n            this.isInited = true;\n            this.doSendStart();\n          }\n          /** @private */\n\n        }, {\n          key: \"sendStart\",\n          value: function sendStart() {\n            this.wantSendStart = true;\n            this.doSendStart();\n          }\n          /** @private */\n\n        }, {\n          key: \"doSendStart\",\n          value: function doSendStart() {\n            if (!this.isInited || !this.wantSendStart || this.state !== 'start') {\n              return;\n            }\n\n            this.wantSendStart = false;\n            this.state = 'active';\n            var query = {\n              '@type': 'start'\n            };\n            logger.info('send to worker: ', query);\n            this.worker.postMessage(query);\n          }\n          /** @private */\n\n        }, {\n          key: \"onClosed\",\n          value: function onClosed() {\n            this.isClosing = true;\n            this.worker.terminate();\n            logger.info('worker is terminated');\n            this.state = 'closed';\n            this.postState();\n          }\n          /** @private */\n\n        }, {\n          key: \"close\",\n          value: function close() {\n            if (this.isClosing) {\n              return;\n            }\n\n            this.isClosing = true;\n            logger.info('close state: ', this.state);\n\n            if (this.state === 'start') {\n              this.onClosed();\n              this.onUpdate({\n                '@type': 'updateAuthorizationState',\n                authorization_state: {\n                  '@type': 'authorizationStateClosed'\n                }\n              });\n              return;\n            }\n\n            var query = {\n              '@type': 'close'\n            };\n            logger.info('send to worker: ', query);\n            this.worker.postMessage(query);\n            this.state = 'closing';\n            this.postState();\n          }\n          /** @private */\n\n        }, {\n          key: \"closeOtherClients\",\n          value: function () {\n            var _closeOtherClients = asyncToGenerator_default()(\n            /*#__PURE__*/\n            regenerator_default.a.mark(function _callee4(options) {\n              var _this4 = this;\n\n              return regenerator_default.a.wrap(function _callee4$(_context4) {\n                while (1) {\n                  switch (_context4.prev = _context4.next) {\n                    case 0:\n                      this.uid = v4_default()();\n                      this.state = 'start';\n                      this.isBackground = !!options.isBackground;\n                      this.timestamp = Date.now();\n                      this.waitSet = new Set();\n                      logger.info('close other clients');\n                      this.channel = new es(options.instanceName, {\n                        webWorkerSupport: false\n                      });\n                      this.postState();\n\n                      this.channel.onmessage = function (message) {\n                        _this4.onBroadcastMessage(message);\n                      };\n\n                      _context4.next = 11;\n                      return src_sleep(300);\n\n                    case 11:\n                      if (!(this.waitSet.size !== 0)) {\n                        _context4.next = 14;\n                        break;\n                      }\n\n                      _context4.next = 14;\n                      return new Promise(function (resolve) {\n                        _this4.onWaitSetEmpty = resolve;\n                      });\n\n                    case 14:\n                      this.sendStart();\n\n                    case 15:\n                    case \"end\":\n                      return _context4.stop();\n                  }\n                }\n              }, _callee4, this);\n            }));\n\n            function closeOtherClients(_x3) {\n              return _closeOtherClients.apply(this, arguments);\n            }\n\n            return closeOtherClients;\n          }()\n          /** @private */\n\n        }, {\n          key: \"onUpdate\",\n          value: function onUpdate(update) {\n            logger.info('ignore onUpdate'); //nop\n          }\n        }]);\n        return TdClient;\n      }();\n      /** @private */\n\n\n      var src_ListNode =\n      /*#__PURE__*/\n      function () {\n        function ListNode(value) {\n          classCallCheck_default()(this, ListNode);\n          this.value = value;\n          this.clear();\n        }\n\n        createClass_default()(ListNode, [{\n          key: \"erase\",\n          value: function erase() {\n            this.prev.connect(this.next);\n            this.clear();\n          }\n        }, {\n          key: \"clear\",\n          value: function clear() {\n            this.prev = this;\n            this.next = this;\n          }\n        }, {\n          key: \"connect\",\n          value: function connect(other) {\n            this.next = other;\n            other.prev = this;\n          }\n        }, {\n          key: \"onUsed\",\n          value: function onUsed(other) {\n            other.usedAt = Date.now();\n            other.erase();\n            other.connect(this.next);\n            logger.debug('LRU: used file_id: ', other.value);\n            this.connect(other);\n          }\n        }, {\n          key: \"getLru\",\n          value: function getLru() {\n            if (this === this.next) {\n              throw new Error('popLru from empty list');\n            }\n\n            return this.prev;\n          }\n        }]);\n        return ListNode;\n      }();\n      /** @private */\n\n\n      var src_FileManager =\n      /*#__PURE__*/\n      function () {\n        function FileManager(instanceName, client) {\n          classCallCheck_default()(this, FileManager);\n          this.instanceName = instanceName;\n          this.cache = new Map();\n          this.pending = [];\n          this.transaction_id = 0;\n          this.totalSize = 0;\n          this.lru = new src_ListNode(-1);\n          this.client = client;\n        }\n\n        createClass_default()(FileManager, [{\n          key: \"init\",\n          value: function init() {\n            var _this5 = this;\n\n            this.idb = new Promise(function (resolve, reject) {\n              var request = indexedDB.open(_this5.instanceName);\n\n              request.onsuccess = function () {\n                return resolve(request.result);\n              };\n\n              request.onerror = function () {\n                return reject(request.error);\n              };\n            }); //this.store = localforage.createInstance({\n            //name: instanceName\n            //});\n\n            this.isInited = true;\n          }\n        }, {\n          key: \"unload\",\n          value: function unload(info) {\n            if (info.arr) {\n              logger.debug('LRU: delete file_id: ', info.node.value, ' with arr.length: ', info.arr.length);\n              this.totalSize -= info.arr.length;\n              delete info.arr;\n            }\n\n            if (info.node) {\n              info.node.erase();\n              delete info.node;\n            }\n          }\n        }, {\n          key: \"registerFile\",\n          value: function registerFile(file) {\n            if (file.idb_key || file.arr) {\n              file.local.is_downloading_completed = true;\n            } else {\n              file.local.is_downloading_completed = false;\n            }\n\n            var info = {};\n            var cached_info = this.cache.get(file.id);\n\n            if (cached_info) {\n              info = cached_info;\n            } else {\n              this.cache.set(file.id, info);\n            }\n\n            if (file.idb_key) {\n              info.idb_key = file.idb_key;\n              delete file.idb_key;\n            } else {\n              delete info.idb_key;\n            }\n\n            if (file.arr) {\n              var now = Date.now();\n\n              while (this.totalSize > 100000000) {\n                var node = this.lru.getLru(); // immunity for 60 seconds\n\n                if (node.usedAt + 60 * 1000 > now) {\n                  break;\n                }\n\n                var lru_info = this.cache.get(node.value);\n                this.unload(lru_info);\n              }\n\n              if (info.arr) {\n                logger.warn('Got file.arr at least twice for the same file');\n                this.totalSize -= info.arr.length;\n              }\n\n              info.arr = file.arr;\n              delete file.arr;\n              this.totalSize += info.arr.length;\n\n              if (!info.node) {\n                logger.debug('LRU: create file_id: ', file.id, ' with arr.length: ', info.arr.length);\n                info.node = new src_ListNode(file.id);\n              }\n\n              this.lru.onUsed(info.node);\n              logger.info('Total file.arr size: ', this.totalSize);\n            }\n\n            info.file = file;\n            return file;\n          }\n        }, {\n          key: \"flushLoad\",\n          value: function () {\n            var _flushLoad = asyncToGenerator_default()(\n            /*#__PURE__*/\n            regenerator_default.a.mark(function _callee5() {\n              var pending, idb, transaction_id, read, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _loop, _iterator, _step;\n\n              return regenerator_default.a.wrap(function _callee5$(_context5) {\n                while (1) {\n                  switch (_context5.prev = _context5.next) {\n                    case 0:\n                      pending = this.pending;\n                      this.pending = [];\n                      _context5.next = 4;\n                      return this.idb;\n\n                    case 4:\n                      idb = _context5.sent;\n                      transaction_id = this.transaction_id++;\n                      read = idb.transaction(['keyvaluepairs'], 'readonly').objectStore('keyvaluepairs');\n                      logger.debug('Load group of files from idb', pending.length);\n                      _iteratorNormalCompletion = true;\n                      _didIteratorError = false;\n                      _iteratorError = undefined;\n                      _context5.prev = 11;\n\n                      _loop = function _loop() {\n                        var query = _step.value;\n                        var request = read.get(query.key);\n\n                        request.onsuccess = function (event) {\n                          var blob = event.target.result;\n\n                          if (blob) {\n                            if (blob.size === 0) {\n                              logger.error('Got empty blob from db ', query.key);\n                            }\n\n                            query.resolve({\n                              data: blob,\n                              transaction_id: transaction_id\n                            });\n                          } else {\n                            query.reject();\n                          }\n                        };\n\n                        request.onerror = function () {\n                          return query.reject(request.error);\n                        };\n                      };\n\n                      for (_iterator = pending[Symbol.iterator](); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        _loop();\n                      }\n\n                      _context5.next = 20;\n                      break;\n\n                    case 16:\n                      _context5.prev = 16;\n                      _context5.t0 = _context5[\"catch\"](11);\n                      _didIteratorError = true;\n                      _iteratorError = _context5.t0;\n\n                    case 20:\n                      _context5.prev = 20;\n                      _context5.prev = 21;\n\n                      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n                        _iterator[\"return\"]();\n                      }\n\n                    case 23:\n                      _context5.prev = 23;\n\n                      if (!_didIteratorError) {\n                        _context5.next = 26;\n                        break;\n                      }\n\n                      throw _iteratorError;\n\n                    case 26:\n                      return _context5.finish(23);\n\n                    case 27:\n                      return _context5.finish(20);\n\n                    case 28:\n                    case \"end\":\n                      return _context5.stop();\n                  }\n                }\n              }, _callee5, this, [[11, 16, 20, 28], [21,, 23, 27]]);\n            }));\n\n            function flushLoad() {\n              return _flushLoad.apply(this, arguments);\n            }\n\n            return flushLoad;\n          }()\n        }, {\n          key: \"load\",\n          value: function load(key, resolve, reject) {\n            var _this6 = this;\n\n            if (this.pending.length === 0) {\n              setTimeout(function () {\n                _this6.flushLoad();\n              }, 1);\n            }\n\n            this.pending.push({\n              key: key,\n              resolve: resolve,\n              reject: reject\n            });\n          }\n        }, {\n          key: \"doLoadFull\",\n          value: function () {\n            var _doLoadFull = asyncToGenerator_default()(\n            /*#__PURE__*/\n            regenerator_default.a.mark(function _callee6(info) {\n              var _this7 = this;\n\n              var idb_key;\n              return regenerator_default.a.wrap(function _callee6$(_context6) {\n                while (1) {\n                  switch (_context6.prev = _context6.next) {\n                    case 0:\n                      if (!info.arr) {\n                        _context6.next = 2;\n                        break;\n                      }\n\n                      return _context6.abrupt(\"return\", {\n                        data: new Blob([info.arr]),\n                        transaction_id: -1\n                      });\n\n                    case 2:\n                      if (!info.idb_key) {\n                        _context6.next = 7;\n                        break;\n                      }\n\n                      idb_key = info.idb_key; //return this.store.getItem(idb_key);\n\n                      _context6.next = 6;\n                      return new Promise(function (resolve, reject) {\n                        _this7.load(idb_key, resolve, reject);\n                      });\n\n                    case 6:\n                      return _context6.abrupt(\"return\", _context6.sent);\n\n                    case 7:\n                      throw new Error('File is not loaded');\n\n                    case 8:\n                    case \"end\":\n                      return _context6.stop();\n                  }\n                }\n              }, _callee6);\n            }));\n\n            function doLoadFull(_x4) {\n              return _doLoadFull.apply(this, arguments);\n            }\n\n            return doLoadFull;\n          }()\n        }, {\n          key: \"doLoad\",\n          value: function () {\n            var _doLoad = asyncToGenerator_default()(\n            /*#__PURE__*/\n            regenerator_default.a.mark(function _callee7(info, offset, size) {\n              var count, _res, res, data_size;\n\n              return regenerator_default.a.wrap(function _callee7$(_context7) {\n                while (1) {\n                  switch (_context7.prev = _context7.next) {\n                    case 0:\n                      if (!(!info.arr && !info.idb_key && info.file.local.path)) {\n                        _context7.next = 22;\n                        break;\n                      }\n\n                      _context7.prev = 1;\n                      _context7.next = 4;\n                      return this.client.sendInternal({\n                        '@type': 'getFileDownloadedPrefixSize',\n                        file_id: info.file.id,\n                        offset: offset\n                      });\n\n                    case 4:\n                      count = _context7.sent;\n\n                      if (size) {\n                        _context7.next = 9;\n                        break;\n                      }\n\n                      size = count.count;\n                      _context7.next = 11;\n                      break;\n\n                    case 9:\n                      if (!(size > count.count)) {\n                        _context7.next = 11;\n                        break;\n                      }\n\n                      throw new Error('File not loaded yet');\n\n                    case 11:\n                      _context7.next = 13;\n                      return this.client.sendInternal({\n                        '@type': 'readFilePart',\n                        path: info.file.local.path,\n                        offset: offset,\n                        count: size\n                      });\n\n                    case 13:\n                      _res = _context7.sent;\n                      _res.data = new Blob([_res.data]);\n                      _res.transaction_id = -2; //log.error(res);\n\n                      return _context7.abrupt(\"return\", _res);\n\n                    case 19:\n                      _context7.prev = 19;\n                      _context7.t0 = _context7[\"catch\"](1);\n                      logger.info('readFilePart failed', info, offset, size, _context7.t0);\n\n                    case 22:\n                      _context7.next = 24;\n                      return this.doLoadFull(info);\n\n                    case 24:\n                      res = _context7.sent; // return slice(size, offset + size)\n\n                      data_size = res.data.size;\n\n                      if (!size) {\n                        size = data_size;\n                      }\n\n                      if (offset > data_size) {\n                        offset = data_size;\n                      }\n\n                      res.data = res.data.slice(offset, offset + size);\n                      return _context7.abrupt(\"return\", res);\n\n                    case 30:\n                    case \"end\":\n                      return _context7.stop();\n                  }\n                }\n              }, _callee7, this, [[1, 19]]);\n            }));\n\n            function doLoad(_x5, _x6, _x7) {\n              return _doLoad.apply(this, arguments);\n            }\n\n            return doLoad;\n          }()\n        }, {\n          key: \"doDelete\",\n          value: function doDelete(info) {\n            this.unload(info);\n            return info.idb_key;\n          }\n        }, {\n          key: \"readFile\",\n          value: function () {\n            var _readFile2 = asyncToGenerator_default()(\n            /*#__PURE__*/\n            regenerator_default.a.mark(function _callee8(query) {\n              var info, response;\n              return regenerator_default.a.wrap(function _callee8$(_context8) {\n                while (1) {\n                  switch (_context8.prev = _context8.next) {\n                    case 0:\n                      _context8.prev = 0;\n\n                      if (this.isInited) {\n                        _context8.next = 3;\n                        break;\n                      }\n\n                      throw new Error('FileManager is not inited');\n\n                    case 3:\n                      info = this.cache.get(query.file_id);\n\n                      if (info) {\n                        _context8.next = 6;\n                        break;\n                      }\n\n                      throw new Error('File is not loaded');\n\n                    case 6:\n                      if (info.node) {\n                        this.lru.onUsed(info.node);\n                      }\n\n                      query.offset = query.offset || 0;\n                      query.size = query.count || query.size || 0;\n                      _context8.next = 11;\n                      return this.doLoad(info, query.offset, query.size);\n\n                    case 11:\n                      response = _context8.sent;\n                      return _context8.abrupt(\"return\", {\n                        '@type': 'filePart',\n                        '@extra': query['@extra'],\n                        data: response.data,\n                        transaction_id: response.transaction_id\n                      });\n\n                    case 15:\n                      _context8.prev = 15;\n                      _context8.t0 = _context8[\"catch\"](0);\n                      return _context8.abrupt(\"return\", {\n                        '@type': 'error',\n                        '@extra': query['@extra'],\n                        code: 400,\n                        message: _context8.t0\n                      });\n\n                    case 18:\n                    case \"end\":\n                      return _context8.stop();\n                  }\n                }\n              }, _callee8, this, [[0, 15]]);\n            }));\n\n            function readFile(_x8) {\n              return _readFile2.apply(this, arguments);\n            }\n\n            return readFile;\n          }()\n        }, {\n          key: \"deleteFile\",\n          value: function deleteFile(query) {\n            var res = {\n              '@type': 'ok',\n              '@extra': query['@extra']\n            };\n\n            try {\n              if (!this.isInited) {\n                throw new Error('FileManager is not inited');\n              }\n\n              var info = this.cache.get(query.file_id);\n\n              if (!info) {\n                throw new Error('File is not loaded');\n              }\n\n              var idb_key = this.doDelete(info);\n\n              if (idb_key) {\n                res.idb_key = idb_key;\n              }\n            } catch (e) {}\n\n            return res;\n          }\n        }]);\n        return FileManager;\n      }();\n      /* harmony default export */\n\n\n      var src = __webpack_exports__[\"default\"] = src_TdClient;\n      /***/\n    }])\n  );\n});","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { isUserOnline } from '../../Utils/User';\nimport { getChatUserId } from '../../Utils/Chat';\nimport UserStore from './../../Stores/UserStore';\nimport './OnlineStatus.css';\n\nclass OnlineStatus extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const userId = getChatUserId(props.chatId);\n        const user = UserStore.get(userId);\n\n        this.state = {\n            userId,\n            online: isUserOnline(user)\n        };\n    }\n\n    componentDidMount() {\n        UserStore.on('updateUserStatus', this.onUpdateUserStatus);\n    }\n\n    componentWillUnmount() {\n        UserStore.off('updateUserStatus', this.onUpdateUserStatus);\n    }\n\n    onUpdateUserStatus = update => {\n        const { userId } = this.state;\n        const { user_id } = update;\n        if (user_id !== userId) return;\n\n        const user = UserStore.get(userId);\n        if (!user) return;\n\n        this.setState({ online: isUserOnline(user) });\n    };\n\n    render() {\n        const { size, borderSize } = this.props;\n        const { online } = this.state;\n        if (!online) return null;\n\n        return (\n            <div className='online-status' style={{ width: size, height: size }}>\n                <div className='online-status-icon' style={{ padding: borderSize }}>\n                    <div className='online-status-indicator' />\n                </div>\n            </div>\n        );\n    }\n}\n\nOnlineStatus.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    size: PropTypes.number,\n    borderSize: PropTypes.number\n};\n\nOnlineStatus.defaultProps = {\n    size: 14,\n    borderSize: 2\n};\n\nexport default OnlineStatus;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport ChatStore from '../../Stores/ChatStore';\nimport './GroupCallStatus.css';\n\nclass GroupCallStatus extends React.Component {\n    state = {\n        isEmpty: true,\n        hasGroupCall: false\n    };\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        const { hasGroupCall, isEmpty } = this.state;\n\n        if (nextState.hasGroupCall !== hasGroupCall) {\n            return true;\n        }\n\n        if (nextState.isEmpty !== isEmpty) {\n            return true;\n        }\n\n        return false;\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const { chatId } = props;\n        const { prevChatId } = state;\n\n        if (prevChatId !== chatId) {\n            let isEmpty = false;\n            let hasGroupCall = false;\n            const chat = ChatStore.get(chatId);\n            if (chat) {\n                const { is_voice_chat_empty, voice_chat_group_call_id } = chat;\n                isEmpty = is_voice_chat_empty;\n                hasGroupCall = Boolean(voice_chat_group_call_id);\n            }\n\n            return {\n                prevChatId: chatId,\n                isEmpty,\n                hasGroupCall\n            };\n        }\n\n        return null;\n    }\n\n    componentDidMount() {\n        ChatStore.on('updateChatVoiceChat', this.onUpdateChatVoiceChat);\n    }\n\n    componentWillUnmount() {\n        ChatStore.off('updateChatVoiceChat', this.onUpdateChatVoiceChat);\n    }\n\n    onUpdateChatVoiceChat = update => {\n        const { chatId } = this.props;\n        const { chat_id } = update;\n\n        if (chat_id !== chatId) return;\n\n        let isEmpty = false;\n        let hasGroupCall = false;\n        const chat = ChatStore.get(chatId);\n        if (chat) {\n            const { is_voice_chat_empty, voice_chat_group_call_id } = chat;\n            isEmpty = is_voice_chat_empty;\n            hasGroupCall = Boolean(voice_chat_group_call_id);\n        }\n\n        this.setState({ isEmpty, hasGroupCall });\n    };\n\n    render() {\n        const { isEmpty, hasGroupCall } = this.state;\n        if (!hasGroupCall) return null;\n\n        return (\n            <div className={classNames('group-call-status', { 'group-call-status-active': !isEmpty })}>\n                <div className='group-call-status-icon'>\n                    <div className='group-call-status-indicator' >\n                        <div className={classNames('group-call-status-bar', 'group-call-status-bar1')}/>\n                        <div className={classNames('group-call-status-bar', 'group-call-status-bar2')}/>\n                        <div className={classNames('group-call-status-bar', 'group-call-status-bar1')}/>\n\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nGroupCallStatus.propTypes = {\n    chatId: PropTypes.number\n};\n\nexport default GroupCallStatus;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport BookmarkBorderIcon from '../../Assets/Icons/Saved';\nimport DeletedAccountIcon from '../../Assets/Icons/DeletedAccount';\nimport OnlineStatus from './OnlineStatus';\nimport { getChatLetters, isMeChat, isPrivateChat, isDeletedPrivateChat, getChatTypeId } from '../../Utils/Chat';\nimport { getSrc, loadChatContent } from '../../Utils/File';\nimport ChatStore from '../../Stores/ChatStore';\nimport FileStore from '../../Stores/FileStore';\nimport './ChatTile.css';\nimport GroupCallStatus from '../Calls/GroupCallStatus';\n\nclass ChatTile extends Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { chatId, t } = props;\n\n        if (state.prevChatId !== chatId) {\n            const chat = ChatStore.get(chatId);\n            const file = chat && chat.photo? chat.photo.small : null;\n\n            const fileId = file ? file.id : -1;\n            const src = getSrc(file);\n            const loaded = state.src === src && src !== '' || fileId === -1;\n            const letters = getChatLetters(chatId, t);\n\n            return {\n                prevChatId: chatId,\n\n                fileId,\n                src,\n                loaded,\n                letters\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { chatId } = this.props;\n        const { fileId, src, loaded, letters } = this.state;\n\n        if (nextProps.chatId !== chatId) {\n            return true;\n        }\n\n        if (nextState.fileId !== fileId) {\n            return true;\n        }\n\n        if (nextState.src !== src) {\n            return true;\n        }\n\n        if (nextState.loaded !== loaded) {\n            return true;\n        }\n\n        if (nextState.letters !== letters) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        ChatStore.on('clientUpdateFastUpdatingComplete', this.onFastUpdatingComplete);\n        ChatStore.on('updateChatPhoto', this.onUpdateChatPhoto);\n        ChatStore.on('updateChatTitle', this.onUpdateChatTitle);\n        FileStore.on('clientUpdateChatBlob', this.onClientUpdateChatBlob);\n    }\n\n    componentWillUnmount() {\n        ChatStore.off('clientUpdateFastUpdatingComplete', this.onFastUpdatingComplete);\n        ChatStore.off('updateChatPhoto', this.onUpdateChatPhoto);\n        ChatStore.off('updateChatTitle', this.onUpdateChatTitle);\n        FileStore.off('clientUpdateChatBlob', this.onClientUpdateChatBlob);\n    }\n\n    onFastUpdatingComplete = update => {\n        this.forceUpdate();\n    };\n\n    onClientUpdateChatBlob = update => {\n        const { chatId } = this.props;\n        const { fileId, loaded } = this.state;\n\n        if (chatId !== update.chatId) return;\n        if (fileId !== update.fileId) return;\n\n        if (!loaded) {\n            const chat = ChatStore.get(chatId);\n            if (!chat) return null;\n\n            const { photo } = chat;\n            const src = getSrc(photo ? photo.small : null);\n\n            this.setState({\n                src\n            });\n        }\n    };\n\n    onUpdateChatPhoto = update => {\n        const { chatId } = this.props;\n        const { chat_id, photo } = update;\n\n        if (chat_id !== chatId) return;\n\n        const chat = ChatStore.get(chatId);\n        const file = chat && chat.photo? chat.photo.small : null;\n\n        const fileId = file ? file.id : -1;\n        const src = getSrc(file);\n        const loaded = this.state.src === src && src !== '' || fileId === -1;\n\n        this.setState({\n            fileId,\n            src,\n            loaded\n        });\n\n        if (photo) {\n            const store = FileStore.getStore();\n            loadChatContent(store, chatId);\n        }\n    };\n\n    onUpdateChatTitle = update => {\n        const { chatId, t } = this.props;\n        const { chat_id } = update;\n\n        if (chat_id !== chatId) return;\n\n        const letters = getChatLetters(chatId, t);\n\n        this.setState({ letters });\n    };\n\n    handleSelect = event => {\n        const { chatId, onSelect } = this.props;\n        if (!onSelect) return;\n\n        event.stopPropagation();\n        onSelect(chatId);\n    };\n\n    handleLoad = () => {\n        this.setState({ loaded: true });\n    };\n\n    render() {\n        const { chatId, showOnline, showGroupCall, showSavedMessages, onSelect, small, dialog, big, size } = this.props;\n        const { src, loaded, letters } = this.state;\n\n        let style = null;\n        if (size) {\n            style = {\n                width: size,\n                height: size\n            };\n        }\n\n        if (isDeletedPrivateChat(chatId)) {\n            return (\n                <div\n                    className={classNames(\n                        'chat-tile',\n                        { 'tile-small': small },\n                        { 'tile-dialog': dialog },\n                        { 'tile-big': big }\n                    )}\n                    style={style}\n                    onClick={this.handleSelect}>\n                    <div className={classNames('tile-photo', 'tile_color_0', { pointer: onSelect })}>\n                        <div className='tile-saved-messages'>\n                            <DeletedAccountIcon fontSize={big ? 'large' : 'default'} />\n                        </div>\n                    </div>\n                </div>\n            );\n        }\n\n        if (isMeChat(chatId) && showSavedMessages) {\n            return (\n                <div\n                    className={classNames(\n                        'chat-tile',\n                        { 'tile-small': small },\n                        { 'tile-dialog': dialog },\n                        { 'tile-big': big }\n                    )}\n                    style={style}\n                    onClick={this.handleSelect}>\n                    <div className={classNames('tile-photo', 'tile_color_6', { pointer: onSelect })}>\n                        <div className='tile-saved-messages'>\n                            <BookmarkBorderIcon fontSize={big ? 'large' : 'default'} />\n                        </div>\n                    </div>\n                </div>\n            );\n        }\n\n        const chat = ChatStore.get(chatId);\n        if (!chat) return null;\n\n        const tileLoaded = src && loaded;\n        const typeId = getChatTypeId(chatId);\n        const tileColor = `tile_color_${(Math.abs(typeId) % 7) + 1}`;\n\n        return (\n            <div\n                className={classNames(\n                    'chat-tile',\n                    { [tileColor]: !tileLoaded },\n                    { pointer: onSelect },\n                    { 'tile-dialog': dialog },\n                    { 'tile-small': small },\n                    { 'tile-big': big }\n                )}\n                style={style}\n                onClick={this.handleSelect}>\n                {!tileLoaded && (\n                    <div className='tile-photo'>\n                        <span className='tile-text'>{letters}</span>\n                    </div>\n                )}\n                {src && <img className='tile-photo' src={src} onLoad={this.handleLoad} draggable={false} alt='' />}\n                {showOnline && isPrivateChat(chatId) && <OnlineStatus chatId={chatId} />}\n                {showGroupCall && <GroupCallStatus chatId={chatId} />}\n            </div>\n        );\n    }\n}\n\nChatTile.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    onSelect: PropTypes.func,\n    showSavedMessages: PropTypes.bool,\n    showOnline: PropTypes.bool,\n    showGroupCall: PropTypes.bool,\n    size: PropTypes.number\n};\n\nChatTile.defaultProps = {\n    showSavedMessages: true,\n    showOnline: false,\n    showGroupCall: false\n};\n\nexport default withTranslation()(ChatTile);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nexport function getBadgeSelectedColor(rgb) {\n    const primaryHLS = RGBToHSL(rgb);\n    primaryHLS.l += 15;\n\n    return `hsl(${primaryHLS.h}, ${primaryHLS.s}%, ${primaryHLS.l}%)`;\n}\n\nexport function RGBToHSL(rgb) {\n    let r = 0, g = 0, b = 0;\n\n    // 3 digits\n    if (rgb.length === 4) {\n        r = Number.parseInt(rgb[1] + rgb[1], 16);\n        g = Number.parseInt(rgb[2] + rgb[2], 16);\n        b = Number.parseInt(rgb[3] + rgb[3], 16);\n\n        // 6 digits\n    } else if (rgb.length === 7) {\n        r = Number.parseInt(rgb[1] + rgb[2], 16);\n        g = Number.parseInt(rgb[3] + rgb[4], 16);\n        b = Number.parseInt(rgb[5] + rgb[6], 16);\n    }\n\n    // Make r, g, and b fractions of 1\n    r /= 255;\n    g /= 255;\n    b /= 255;\n\n    // Find greatest and smallest channel values\n    let cmin = Math.min(r,g,b),\n        cmax = Math.max(r,g,b),\n        delta = cmax - cmin,\n        h = 0,\n        s = 0,\n        l = 0;\n\n    // Calculate hue\n    // No difference\n    if (delta === 0)\n        h = 0;\n    // Red is max\n    else if (cmax === r)\n        h = ((g - b) / delta) % 6;\n    // Green is max\n    else if (cmax === g)\n        h = (b - r) / delta + 2;\n    // Blue is max\n    else\n        h = (r - g) / delta + 4;\n\n    h = Math.round(h * 60);\n\n    // Make negative hues positive behind 360\n    if (h < 0)\n        h += 360;\n\n    // Calculate lightness\n    l = (cmax + cmin) / 2;\n\n    // Calculate saturation\n    s = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));\n\n    // Multiply l and s by 100\n    s = +(s * 100).toFixed(1);\n    l = +(l * 100).toFixed(1);\n\n    //return \"hsl(\" + h + \",\" + s + \"%,\" + l + \"%)\";\n    return { h, s, l }\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport blue from '@material-ui/core/colors/blue';\nimport createMuiTheme from '@material-ui/core/styles/createMuiTheme';\nimport { ThemeProvider as MuiThemeProvider } from '@material-ui/core/styles';\nimport { StylesProvider } from '@material-ui/core/styles';\nimport { getBadgeSelectedColor } from './Utils/Color';\nimport { getDisplayName } from './Utils/HOC';\nimport AppStore from './Stores/ApplicationStore';\n\nfunction updateLightTheme(theme) {\n    // const root = document.querySelector(':root');\n    // const style = getComputedStyle(root);\n    const { style } = document.documentElement;\n\n    style.setProperty('--text-primary', '#000000');\n    style.setProperty('--text-secondary', '#707579');\n    style.setProperty('--text-disabled', 'rgba(0, 0, 0, 0.38)');\n\n    style.setProperty('--error', '#E53935');\n\n    style.setProperty('--tile-size', '54px');\n    style.setProperty('--tile-size-normal', '48px');\n    style.setProperty('--tile-size-extra-small', '16px');\n    style.setProperty('--tile-size-small', '33px');\n    style.setProperty('--tile-size-big', '120px');\n\n    style.setProperty('--z-index-modal', theme.zIndex.modal);\n\n    style.setProperty('--color-accent-main', theme.palette.primary.main);\n    style.setProperty('--color-accent-main44', theme.palette.primary.main + '44');\n    style.setProperty('--color-accent-main88', theme.palette.primary.main + '88');\n    style.setProperty('--color-accent-dark', theme.palette.primary.dark);\n    style.setProperty('--color-accent-light', theme.palette.primary.light);\n    style.setProperty('--color-grey700', theme.palette.grey[700]);\n    style.setProperty('--color-grey', '#9AA7B2');\n    style.setProperty('--color-hover', '#70757914');\n\n    style.setProperty('--search-input-background', '#f4f4f5');\n    style.setProperty('--search-input-icon', '#9aa7b2');\n\n    style.setProperty('--header-color', '#000000');\n    style.setProperty('--header-subtle-color', '#707579');\n\n    style.setProperty('--badge-unmuted', '#4DCD5E');\n    style.setProperty('--badge-muted', '#C4C9CC');\n    style.setProperty('--badge-item-selected', getBadgeSelectedColor(theme.palette.primary.main));\n\n    style.setProperty('--online-indicator', '#0AC630');\n\n    style.setProperty('--message-keyboard-button', '#00000033');\n    style.setProperty('--message-keyboard-button-hover', '#00000022');\n\n    style.setProperty('--message-service-color', '#FFFFFF');\n    style.setProperty('--message-service-background', '#00000033');\n\n    style.setProperty('--panel-background', '#ffffff');\n    style.setProperty('--border', '#DADCE0');\n    style.setProperty('--chat-background', '#e6ebee');\n    style.setProperty('--background', '#ffffff');\n    style.setProperty('--background-paper', theme.palette.background.paper);\n    style.setProperty('--shared-media-background', theme.palette.background.default);\n\n    style.setProperty('--dialog-color', '#000000');\n    style.setProperty('--dialog-subtle-color', '#707579');\n    style.setProperty('--dialog-meta-color', '#5F6369');\n    style.setProperty('--dialog-meta-read-color', '#4FAE4E');\n\n    style.setProperty('--media-in-tile-background', theme.palette.primary.main);\n    style.setProperty('--media-out-tile-background', '#4FAE4E');\n\n    style.setProperty('--message-in-link', theme.palette.primary.main);\n    style.setProperty('--message-in-author', theme.palette.primary.main);\n    style.setProperty('--message-in-background', '#FFFFFF');\n    style.setProperty('--message-in-color', '#000000');\n    style.setProperty('--message-in-subtle-color', '#707579');\n    style.setProperty('--message-in-meta-color', '#8D969C');\n    style.setProperty('--message-in-reply-title', theme.palette.primary.main);\n    style.setProperty('--message-in-reply-border', theme.palette.primary.main);\n    style.setProperty('--message-in-control', theme.palette.primary.main);\n    style.setProperty('--message-in-control-hover', theme.palette.primary.main + '22');\n    style.setProperty('--message-in-control-border', theme.palette.primary.main + '77');\n    style.setProperty('--message-in-control-border-hover', theme.palette.primary.main);\n\n    style.setProperty('--message-out-link', '#4FAE4E');\n    style.setProperty('--message-out-author', '#4FAE4E');\n    style.setProperty('--message-out-background', '#EEFFDE');\n    style.setProperty('--message-out-color', '#000000');\n    style.setProperty('--message-out-subtle-color', '#4FAE4E');\n    style.setProperty('--message-out-meta-color', '#4FAE4E');\n    style.setProperty('--message-out-reply-title', '#4FAE4E');\n    style.setProperty('--message-out-reply-border', '#4FAE4E');\n    style.setProperty('--message-out-control', '#4FAE4E');\n    style.setProperty('--message-out-control-hover', '#4FAE4E' + '22');\n    style.setProperty('--message-out-control-border', '#4FAE4E' + '77');\n    style.setProperty('--message-out-control-border-hover', '#4FAE4E');\n}\n\nfunction updateDarkTheme(theme) {\n    // const root = document.querySelector(':root');\n    // const style = getComputedStyle(root);\n    const { style } = document.documentElement;\n\n    style.setProperty('--text-primary', theme.palette.text.primary);\n    style.setProperty('--text-secondary', theme.palette.text.secondary);\n    style.setProperty('--text-disabled', theme.palette.text.disabled);\n\n    style.setProperty('--error', '#E53935');\n\n    style.setProperty('--tile-size', '54px');\n    style.setProperty('--tile-size-normal', '48px');\n    style.setProperty('--tile-size-extra-small', '16px');\n    style.setProperty('--tile-size-small', '33px');\n    style.setProperty('--tile-size-big', '120px');\n\n    style.setProperty('--z-index-modal', theme.zIndex.modal);\n\n    style.setProperty('--color-accent-main', theme.palette.primary.main);\n    style.setProperty('--color-accent-main44', theme.palette.primary.main + '44');\n    style.setProperty('--color-accent-main88', theme.palette.primary.main + '88');\n    style.setProperty('--color-accent-dark', theme.palette.primary.dark);\n    style.setProperty('--color-accent-light', theme.palette.primary.light);\n    style.setProperty('--color-grey700', theme.palette.grey[700]);\n    style.setProperty('--color-grey', '#9AA7B2');\n    style.setProperty('--color-hover', 'rgba(112, 117, 121, 0.15)');\n\n    style.setProperty('--search-input-background', '#424242');\n    style.setProperty('--search-input-icon', '#fff');\n\n    style.setProperty('--header-color', '#ffffff');\n    style.setProperty('--header-subtle-color', theme.palette.text.secondary);\n\n    style.setProperty('--badge-unmuted', '#4DCD5E');\n    style.setProperty('--badge-muted', '#979797');\n    style.setProperty('--badge-item-selected', getBadgeSelectedColor(theme.palette.primary.main));\n\n    style.setProperty('--online-indicator', '#0AC630');\n\n    style.setProperty('--message-keyboard-button', '#303030');\n    style.setProperty('--message-keyboard-button-hover', '#30303088');\n\n    style.setProperty('--message-service-color', '#FFFFFF');\n    style.setProperty('--message-service-background', '#303030');\n\n    style.setProperty('--panel-background', '#303030');\n    style.setProperty('--border', theme.palette.divider);\n    style.setProperty('--chat-background', theme.palette.grey[900]);\n    style.setProperty('--background', theme.palette.grey[900]);\n    style.setProperty('--background-paper', theme.palette.background.paper);\n    style.setProperty('--shared-media-background', theme.palette.background.paper);\n\n    style.setProperty('--dialog-color', '#ffffff');\n    style.setProperty('--dialog-subtle-color', theme.palette.text.secondary);\n    style.setProperty('--dialog-meta-color', theme.palette.text.secondary);\n    style.setProperty('--dialog-meta-read-color', '#4FAE4E');\n\n    style.setProperty('--media-in-tile-background', theme.palette.primary.main);\n    style.setProperty('--media-out-tile-background', theme.palette.primary.main);\n\n    style.setProperty('--message-in-link', theme.palette.primary.main);\n    style.setProperty('--message-in-author', theme.palette.primary.main);\n    style.setProperty('--message-in-background', '#303030'); // background.default\n    style.setProperty('--message-in-color', '#FFFFFF');\n    style.setProperty('--message-in-subtle-color', 'rgba(255, 255, 255, 0.7)');\n    style.setProperty('--message-in-meta-color', 'rgba(255, 255, 255, 0.7)');\n    style.setProperty('--message-in-reply-title', theme.palette.primary.main);\n    style.setProperty('--message-in-reply-border', theme.palette.primary.main);\n    style.setProperty('--message-in-control', theme.palette.primary.main);\n    style.setProperty('--message-in-control-hover', theme.palette.primary.main + '22');\n    style.setProperty('--message-in-control-border', theme.palette.primary.main + '77');\n    style.setProperty('--message-in-control-border-hover', theme.palette.primary.main);\n\n    style.setProperty('--message-out-link', theme.palette.primary.main);\n    style.setProperty('--message-out-author', theme.palette.primary.main);\n    style.setProperty('--message-out-background', '#303030'); // background.default\n    style.setProperty('--message-out-color', '#FFFFFF');\n    style.setProperty('--message-out-subtle-color', 'rgba(255, 255, 255, 0.7)');\n    style.setProperty('--message-out-meta-color', 'rgba(255, 255, 255, 0.7)'); // text.secondary\n    style.setProperty('--message-out-reply-title', theme.palette.primary.main);\n    style.setProperty('--message-out-reply-border', theme.palette.primary.main);\n    style.setProperty('--message-out-control', theme.palette.primary.main);\n    style.setProperty('--message-out-control-hover', theme.palette.primary.main + '22');\n    style.setProperty('--message-out-control-border', theme.palette.primary.main + '77');\n    style.setProperty('--message-out-control-border-hover', theme.palette.primary.main);\n}\n\nfunction getSystemThemeType() {\n    if (window.matchMedia) {\n        if(window.matchMedia('(prefers-color-scheme: dark)').matches){\n            return 'dark';\n        } else {\n            return 'light';\n        }\n    }\n    return 'light';\n}\n\nfunction createTheme(type, primary) {\n    if (type === 'default') {\n        type = getSystemThemeType();\n    }\n\n    let MuiTouchRipple = {};\n    let action = {};\n    if (type === 'light') {\n        MuiTouchRipple = {\n            child: {\n                color: type === 'dark' ? 'currentColor' : 'rgba(112, 117, 121)'\n            },\n            rippleVisible: {\n                opacity: 0.08 //type === 'dark' ? 0.15 : 1\n            },\n            '@keyframes enter': {\n                '0%': {\n                    transform: 'scale(0)',\n                    opacity: 0.03\n                },\n                '100%': {\n                    transform: 'scale(1)',\n                    opacity: 0.08 //type === 'dark' ? 0.15 : 1\n                }\n            }\n        };\n        action = {\n            hover: 'rgba(112, 117, 121, 0.08)',\n            hoverOpacity: 0.08\n        };\n    }\n\n    const theme = createMuiTheme({\n        palette: {\n            type: type,\n            primary: primary,\n            secondary: { main: '#E53935' },\n            action\n        },\n        typography: {\n            useNextVariants: true\n        },\n        shape: {\n            borderRadius: 10\n        },\n        overrides: {\n            MuiOutlinedInput: {\n                input: {\n                    padding: '17.5px 14px'\n                }\n            },\n            MuiAutocomplete: {\n                option: {\n                    paddingLeft: 0,\n                    paddingTop: 0,\n                    paddingRight: 0,\n                    paddingBottom: 0\n                },\n                paper: {\n                    '& > ul': {\n                        maxHeight: 56 * 5.5\n                    }\n                }\n            },\n            MuiButton: {\n                root: {\n                    padding: '12px 16px 11px',\n                    fontSize: 16,\n                    lineHeight: 'normal'\n                }\n            },\n            MuiMenuList: {\n                root: {\n                    minWidth: 150\n                }\n            },\n            MuiList: {\n                root: {\n                    minWidth: 150\n                }\n            },\n            MuiListItemIcon: {\n                root: {\n                    minWidth: 40\n                },\n                alignItemsFlexStart: {\n                    marginTop: 6\n                }\n            },\n            // MuiListItemText: {\n            //     root: {\n            //         marginTop: 0,\n            //         marginBottom: 0\n            //     }\n            // },\n            // MuiListItem: {\n            //     root: {\n            //         paddingTop: 10,\n            //         paddingBottom: 10\n            //     }\n            // },\n            MuiMenuItem: {\n                root: {\n                    paddingTop: 10,\n                    paddingBottom: 10\n                }\n            },\n            MuiTouchRipple,\n            MuiSnackbarContent: {\n                root: {\n                    flexWrap: 'nowrap',\n                    fontSize: 'inherit'\n                },\n                message: {\n                    maxWidth: 512\n                }\n            }\n        }\n    });\n\n    if (type === 'dark') {\n        updateDarkTheme(theme);\n    } else {\n        updateLightTheme(theme);\n    }\n\n    return theme;\n}\n\nfunction withTheme(WrappedComponent) {\n    class ThemeWrapper extends React.Component {\n        constructor(props) {\n            super(props);\n\n            let { type, primary } = { type: 'light', primary: { main: '#50A2E9' } };\n            try {\n                const themeOptions = JSON.parse(localStorage.getItem('themeOptions'));\n                if (themeOptions) {\n                    type = themeOptions.type;\n                    primary = themeOptions.primary;\n                }\n            } catch {}\n            const theme = createTheme(type, primary);\n\n            this.state = { theme };\n\n            if (window.matchMedia) {\n                const colorSchemeQuery = window.matchMedia('(prefers-color-scheme: dark)');\n                colorSchemeQuery.addEventListener('change', this.onSystemThemeChange);\n            }\n        }\n\n        onSystemThemeChange = () => {\n            let { type, primary } = { type: 'light', primary: { main: '#50A2E9' } };\n            try {\n                const themeOptions = JSON.parse(localStorage.getItem('themeOptions'));\n                if (themeOptions && themeOptions.type !== 'default') {\n                    return;\n                }\n                type = themeOptions.type;\n                primary = themeOptions.primary;\n            } catch {}\n\n            const theme = createTheme(type, primary);\n            this.setState({ theme }, () => AppStore.emit('clientUpdateThemeChange'));\n        };\n\n        componentDidMount() {\n            AppStore.on('clientUpdateThemeChanging', this.onClientUpdateThemeChanging);\n        }\n\n        componentWillUnmount() {\n            AppStore.off('clientUpdateThemeChanging', this.onClientUpdateThemeChanging);\n        }\n\n        onClientUpdateThemeChanging = update => {\n            const { type, primary } = update;\n\n            const theme = createTheme(type, primary);\n            localStorage.setItem('themeOptions', JSON.stringify({ type, primary }));\n\n            this.setState({ theme }, () => AppStore.emit('clientUpdateThemeChange'));\n        };\n\n        render() {\n            const { theme } = this.state;\n\n            return (\n                <StylesProvider injectFirst={true}>\n                    <MuiThemeProvider theme={theme}>\n                        <WrappedComponent {...this.props} />\n                    </MuiThemeProvider>\n                </StylesProvider>\n            );\n        }\n    }\n    ThemeWrapper.displayName = `WithTheme(${getDisplayName(WrappedComponent)})`;\n\n    return ThemeWrapper;\n}\n\nexport default withTheme;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { modalManager } from '../../Utils/Modal';\nimport TdLibController from '../../Controllers/TdLibController';\n\nclass AuthErrorDialog extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            open: false,\n            error: null\n        };\n\n        this.handleAuthError = this.handleAuthError.bind(this);\n        this.handleClose = this.handleClose.bind(this);\n        this.handleKeyDown = this.handleKeyDown.bind(this);\n    }\n\n    componentDidMount() {\n        TdLibController.on('tdlib_auth_error', this.handleAuthError);\n    }\n\n    componentWillUnmount() {\n        TdLibController.off('tdlib_auth_error', this.handleAuthError);\n    }\n\n    handleAuthError(error) {\n        this.setState({\n            open: true,\n            error: error\n        });\n    }\n\n    handleClose() {\n        this.setState({\n            open: false\n        });\n    }\n\n    handleKeyDown(e) {\n        if (e.key === 'Enter') {\n            e.preventDefault();\n            this.handleClose();\n        }\n    }\n\n    render() {\n        let errorString = null;\n        if (this.state.error && this.state.error['@type'] === 'error' && this.state.error.message) {\n            errorString = this.state.error.message;\n        } else {\n            errorString = JSON.stringify(this.state.error);\n        }\n\n        return (\n            <Dialog\n                manager={modalManager}\n                transitionDuration={0}\n                open={this.state.open}\n                onKeyDown={this.handleKeyDown}\n                onClose={this.handleClose}\n                aria-labelledby='form-dialog-title'>\n                <DialogTitle id='form-dialog-title'>Error</DialogTitle>\n                <DialogContent>\n                    <DialogContentText>{errorString}</DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={this.handleClose} color='primary'>\n                        Ok\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        );\n    }\n}\n\nexport default AuthErrorDialog;\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"g\", {\n  id: \"Login\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fillRule: \"evenodd\"\n}, React.createElement(\"g\", {\n  id: \"Login_5_Phone\",\n  transform: \"translate(-760.000000, -186.000000)\"\n}, React.createElement(\"path\", {\n  d: \"M840,346 C795.81722,346 760,310.18278 760,266 C760,221.81722 795.81722,186 840,186 C884.18278,186 920,221.81722 920,266 C920,310.18278 884.18278,346 840,346 Z M794.596303,264.66919 C790.659174,266.234556 788.596733,267.765936 788.408978,269.263329 C788.048509,272.138166 792.188142,273.033142 797.396667,274.725906 C801.643184,276.106018 807.355495,277.720609 810.325092,277.784753 C813.018799,277.842938 816.025284,276.732617 819.344546,274.453789 C841.998088,259.16492 853.691946,251.437186 854.426119,251.270588 C854.944065,251.153055 855.661811,251.005273 856.148118,251.437434 C856.634425,251.869594 856.586618,252.688022 856.535106,252.907586 C856.123224,254.663156 834.84286,274.015606 833.61816,275.287388 C828.938462,280.146996 823.615302,283.120543 831.826781,288.530755 C838.932147,293.212193 843.067503,296.19863 850.387542,300.996094 C855.065474,304.061953 858.733031,307.697601 863.562866,307.253237 C865.785287,307.048765 868.080902,304.959403 869.246762,298.727987 C872.002037,284.001293 877.417883,252.09303 878.669527,238.944397 C878.779187,237.792407 878.641237,236.318088 878.530455,235.670896 C878.419672,235.023705 878.188168,234.101592 877.346762,233.418979 C876.350285,232.610561 874.811937,232.440083 874.123923,232.4522 C870.995743,232.507295 866.196346,234.175802 843.099163,243.78089 C835.009657,247.144954 818.842037,254.107721 794.596303,264.66919 Z\"\n})));\n\nvar SvgTelegramLogo = function SvgTelegramLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    className: \"telegram-logo\",\n    width: \"160px\",\n    height: \"160px\",\n    viewBox: \"0 0 160 160\",\n    ref: svgRef\n  }, props), React.createElement(\"title\", null, title), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgTelegramLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/telegram-logo.ac1331a4.svg\";\nexport { ForwardRef as ReactComponent };","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { STORAGE_AUTH_KEY, STORAGE_AUTH_TEST_KEY } from '../Constants';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass AuthorizationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        const { useTestDC } = TdLibController.parameters;\n        this.authKey = useTestDC? STORAGE_AUTH_TEST_KEY : STORAGE_AUTH_KEY;\n\n        this.reset();\n        this.load();\n\n        this.addTdLibListener();\n    }\n\n    load() {\n        try {\n            const value = localStorage.getItem(this.authKey);\n            if (value) {\n                this.current = JSON.parse(value);\n            } else {\n                this.current = null;\n            }\n        } catch {}\n    }\n\n    save(state) {\n        if (state) {\n            localStorage.setItem(this.authKey, JSON.stringify(state));\n        } else {\n            localStorage.removeItem(this.authKey);\n        }\n    }\n\n    reset = () => {\n        this.current = null;\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n\n                this.current = authorization_state;\n                this.save(authorization_state);\n\n                if (authorization_state['@type'] !== 'authorizationStateReady') {\n                    this.setCountryCode();\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    setCountryCode = async () => {\n        const { code } = this;\n        if (code) return;\n\n        this.code = await TdLibController.send({ '@type': 'getCountryCode' });\n        TdLibController.clientUpdate({ '@type': 'clientUpdateCountryCode', code: this.code });\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateCountryCode': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMonkeyIdle': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMonkeyTracking': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMonkeyClose': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMonkeyPeek': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n}\n\nconst store = new AuthorizationStore();\nwindow.authorization = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport { ReactComponent as Logo } from '../../Assets/telegram-logo.svg';\nimport AuthStore from '../../Stores/AuthorizationStore';\nimport './Caption.css';\n\nconst RLottie = React.lazy(() => import('../Viewer/RLottie'));\n\nclass Caption extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            fileId: null,\n            data: null,\n            lastUpdate: null\n        };\n\n        this.lottieRef = React.createRef();\n    }\n\n    loadData = async () => {\n        const { closeData } = this.state;\n        if (closeData) return;\n\n        try {\n            const requests = [\n                fetch('data/TwoFactorSetupMonkeyClose.json'),\n                fetch('data/TwoFactorSetupMonkeyIdle.json'),\n                fetch('data/TwoFactorSetupMonkeyPeek.json'),\n                fetch('data/TwoFactorSetupMonkeyTracking.json')\n            ];\n\n            const results = await Promise.all(requests);\n\n            const [closeData, idleData, peekData, trackingData] = await Promise.all(results.map(x => x.text()));\n\n            this.setState(\n                {\n                    closeData,\n                    idleData,\n                    peekData,\n                    trackingData\n                },\n                () => {\n                    const { lastUpdate } = this.state;\n                    if (lastUpdate) {\n                        switch (lastUpdate['@type']) {\n                            case 'clientUpdateMonkeyIdle': {\n                                this.onClientUpdateMonkeyIdle(lastUpdate);\n                                break;\n                            }\n                            case 'clientUpdateMonkeyTracking': {\n                                this.onClientUpdateMonkeyTracking(lastUpdate);\n                                break;\n                            }\n                            case 'clientUpdateMonkeyClose': {\n                                this.onClientUpdateMonkeyClose(lastUpdate);\n                                break;\n                            }\n                            case 'clientUpdateMonkeyPeek': {\n                                this.onClientUpdateMonkeyPeek(lastUpdate);\n                                break;\n                            }\n                        }\n                    }\n                }\n            );\n        } catch (error) {\n            console.error(error);\n        }\n    };\n\n    async componentDidMount() {\n        setTimeout(this.loadData, 100);\n\n        AuthStore.on('clientUpdateMonkeyIdle', this.onClientUpdateMonkeyIdle);\n        AuthStore.on('clientUpdateMonkeyTracking', this.onClientUpdateMonkeyTracking);\n        AuthStore.on('clientUpdateMonkeyClose', this.onClientUpdateMonkeyClose);\n        AuthStore.on('clientUpdateMonkeyPeek', this.onClientUpdateMonkeyPeek);\n    }\n\n    componentWillUnmount() {\n        AuthStore.off('clientUpdateMonkeyIdle', this.onClientUpdateMonkeyIdle);\n        AuthStore.off('clientUpdateMonkeyTracking', this.onClientUpdateMonkeyTracking);\n        AuthStore.off('clientUpdateMonkeyClose', this.onClientUpdateMonkeyClose);\n        AuthStore.off('clientUpdateMonkeyPeek', this.onClientUpdateMonkeyPeek);\n    }\n\n    playSegments = (segments, forceFlag) => {\n        const { current } = this.lottieRef;\n        if (!current) {\n            setTimeout(() => {\n                const { current } = this.lottieRef;\n                if (!current) return;\n\n                current.playSegments(segments, forceFlag);\n            }, 100);\n            return;\n        }\n\n        current.playSegments(segments, forceFlag);\n    };\n\n    onClientUpdateMonkeyIdle = update => {\n        const { idleData } = this.state;\n\n        this.setState(\n            {\n                fileId: 'idle',\n                data: idleData,\n                lastUpdate: update\n            },\n            () => {\n                this.playSegments([0, 179], true);\n            }\n        );\n    };\n\n    getFrame = (length, paddingFrames, letterFrames, framesCount) => {\n        if (!length) {\n            return 0;\n        }\n\n        const lastAnimatedLetter = (framesCount - 2 * paddingFrames) / letterFrames;\n\n        let frames = paddingFrames + (length - 1) * letterFrames;\n        if (length > lastAnimatedLetter + 1) {\n            frames += paddingFrames;\n        }\n\n        return Math.min(frames, framesCount - 1);\n    };\n\n    onClientUpdateMonkeyTracking = update => {\n        const { code, prevCode } = update;\n        const { trackingData } = this.state;\n\n        const FRAMES_COUNT = 180;\n        const LETTER_FRAMES = 10;\n        const PADDING_FRAMES = 20;\n\n        const from = this.getFrame(prevCode.length, PADDING_FRAMES, LETTER_FRAMES, FRAMES_COUNT);\n        const to = this.getFrame(code.length, PADDING_FRAMES, LETTER_FRAMES, FRAMES_COUNT);\n\n        const isLastFrom = from === 0 || from === 179;\n        const isLastTo = to === 0 || to === 179;\n\n        if (isLastFrom && isLastTo) {\n            return;\n        }\n\n        this.setState(\n            {\n                fileId: 'tracking',\n                data: trackingData,\n                lastUpdate: update\n            },\n            () => {\n                this.playSegments([from, to], true);\n            }\n        );\n    };\n\n    onClientUpdateMonkeyClose = update => {\n        const { closeData } = this.state;\n\n        this.setState(\n            {\n                fileId: 'close',\n                data: closeData,\n                lastUpdate: update\n            },\n            () => {\n                this.playSegments([0, 49], true);\n            }\n        );\n    };\n\n    onClientUpdateMonkeyPeek = update => {\n        const { peek } = update;\n        const { peekData, lastUpdate } = this.state;\n\n        if (lastUpdate && lastUpdate['@type'] === 'clientUpdateMonkeyPeek' && lastUpdate.peek === peek) {\n            return;\n        }\n\n        this.setState(\n            {\n                fileId: 'peek',\n                data: peekData,\n                lastUpdate: update\n            },\n            () => {\n                if (peek) {\n                    this.playSegments([0, 15], true);\n                } else {\n                    this.playSegments([15, 0], true);\n                }\n            }\n        );\n    };\n\n    render() {\n        const { state } = this.props;\n        const { fileId, data, trackingData, closeData, peekData, idleData } = this.state;\n\n        let control = null;\n        switch (state['@type']) {\n            case 'authorizationStateWaitOtherDeviceConfirmation': {\n                break;\n            }\n            case 'authorizationStateWaitPhoneNumber':\n            case 'authorizationStateWaitRegistration':\n            case 'authorizationStateWaitEncryptionKey':\n            case 'authorizationStateWaitTdlibParameters':\n            case 'authorizationStateWaitTdlib': {\n                control = <Logo className='auth-caption-telegram-logo' />;\n                break;\n            }\n            case 'authorizationStateWaitCode':\n            case 'authorizationStateWaitPassword': {\n                control = (\n                    <div className='auth-caption-telegram-logo'>\n                        { data && (\n                            <React.Suspense fallback={null}>\n                                <RLottie\n                                    ref={this.lottieRef}\n                                    options={{\n                                        width: 160,\n                                        height: 160,\n                                        autoplay: false,\n                                        loop: false,\n                                        fileId,\n                                        stringData: data\n                                    }}\n                                />\n                                <RLottie\n                                    options={{\n                                        width: 160,\n                                        height: 160,\n                                        autoplay: false,\n                                        loop: false,\n                                        fileId: 'tracking',\n                                        stringData: trackingData,\n                                        queueLength: 1\n                                    }}\n                                    style={{ display: 'none' }}\n                                />\n                                <RLottie\n                                    options={{\n                                        width: 160,\n                                        height: 160,\n                                        autoplay: false,\n                                        loop: false,\n                                        fileId: 'close',\n                                        stringData: closeData,\n                                        queueLength: 1\n                                    }}\n                                    style={{ display: 'none' }}\n                                />\n                                <RLottie\n                                    options={{\n                                        width: 160,\n                                        height: 160,\n                                        autoplay: false,\n                                        loop: false,\n                                        fileId: 'peek',\n                                        stringData: peekData,\n                                        queueLength: 1\n                                    }}\n                                    style={{ display: 'none' }}\n                                />\n                                <RLottie\n                                    options={{\n                                        width: 160,\n                                        height: 160,\n                                        autoplay: false,\n                                        loop: false,\n                                        fileId: 'idle',\n                                        stringData: idleData,\n                                        queueLength: 1\n                                    }}\n                                    style={{ display: 'none' }}\n                                />\n                            </React.Suspense>\n                        )}\n                    </div>\n                );\n                break;\n            }\n            default:\n                control = <Logo className='auth-caption-telegram-logo' />;\n                break;\n        }\n\n        return <div className='auth-caption'>{control}</div>;\n    }\n}\n\nexport default Caption;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './Country.css';\n\nfunction Country({ emoji, name, phone }) {\n    return (\n        <div className='country'>\n            <span className='country-emoji'>{emoji}</span>\n            <span className='country-name'>{name}</span>\n            <span className='country-phone'>{phone}</span>\n        </div>\n    );\n}\n\nCountry.propTypes = {\n    emoji: PropTypes.string,\n    name: PropTypes.string,\n    phone: PropTypes.string\n};\n\nexport default Country;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport TextField from '@material-ui/core/TextField';\nimport Link from '@material-ui/core/Link';\nimport Typography from '@material-ui/core/Typography';\nimport Country from './Country';\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\nimport { KEY_SUGGESTED_LANGUAGE_PACK_ID } from '../../Constants';\nimport AppStore from '../../Stores/ApplicationStore';\nimport AuthStore from '../../Stores/AuthorizationStore';\nimport OptionStore from '../../Stores/OptionStore';\nimport LocalizationStore from '../../Stores/LocalizationStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './Phone.css';\n\nexport function cleanProgressStatus(status) {\n    if (!status) return status;\n\n    return status.replace('...', '').replace('', '');\n}\n\nexport function isConnecting(state) {\n    if (!state) return false;\n\n    switch (state['@type']) {\n        case 'connectionStateConnecting': {\n            return true;\n        }\n        case 'connectionStateConnectingToProxy': {\n            return true;\n        }\n        case 'connectionStateReady': {\n            return false;\n        }\n        case 'connectionStateUpdating': {\n            return false;\n        }\n        case 'connectionStateWaitingForNetwork': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction isValidPhoneNumber(phoneNumber) {\n    if (!phoneNumber) return false;\n\n    let isBad = !phoneNumber.match(/^[\\d\\-+\\s]+$/);\n    if (!isBad) {\n        phoneNumber = phoneNumber.replace(/\\D/g, '');\n        if (phoneNumber.length < 7) {\n            isBad = true;\n        }\n    }\n\n    return !isBad;\n}\n\nfunction formatByPattern(phone, pattern) {\n    phone = clearPhone(phone);\n\n    let result = '';\n    let index = 0;\n    for (let i = 0; i < pattern.length && index < phone.length; i++) {\n        if (pattern[i] >= '0' && pattern[i] <= '9') {\n            result += pattern[i];\n            if (phone[index] === pattern[i]) {\n                index++;\n            }\n        } else if (pattern[i] === ' ') {\n            result += pattern[i];\n        } else if (pattern[i] === 'X') {\n            result += phone[index++];\n        }\n    }\n\n    result += ' ' + phone.substring(index);\n\n    return '+' + result;\n}\n\nexport function formatPhoneNumber(phone) {\n    const { data } = AuthStore;\n    if (!data) return phone;\n\n    const country = getCountryFromPhone(phone, data);\n    if (!country) return phone;\n\n    return formatByPattern(phone, country.pattern);\n}\n\nfunction phoneEquals(phone1, phone2) {\n    return clearPhone(phone1) === clearPhone(phone2);\n}\n\nfunction isWhitelistKey(key) {\n    if (key >= '0' && key <= '9') return true;\n    if (key === ' ') return true;\n    if (key === '+') return true;\n\n    return false;\n}\n\nfunction clearPhone(phone) {\n    if (!phone) return phone;\n\n    return phone\n        .replace(/ /g, '')\n        .replace('+', '')\n        .toLowerCase();\n}\n\nfunction isPhoneWithOptionCode(phone, option) {\n    if (!phone) return false;\n    if (!option) return false;\n\n    phone = clearPhone(phone);\n    const code = clearPhone(option.phone);\n\n    return phone.startsWith(code);\n}\n\nfunction isValidOption(x, value) {\n    if (!x) return false;\n    if (!value) return true;\n\n    if (value.length > 0 && value[0] === '(') {\n        value = value.substring(1);\n    }\n\n    const names = x.name.toLowerCase().split(' ');\n    for (let i = 0; i < names.length; i++) {\n        if (names[i].length > 0 && names[i][0] === '(') {\n            names[i] = names[i].substring(1);\n        }\n    }\n    const phone = clearPhone(x.phone);\n\n    if (names.some(x => x.startsWith(value))) return true;\n    if (phone.startsWith(value) || value.startsWith(phone)) return true;\n\n    return false;\n}\n\nfunction getCountryFromPhone(phone, data) {\n    if (!data) return null;\n\n    const index = data.findIndex(x => isPhoneWithOptionCode(phone, x));\n\n    return index !== -1 ? data[index] : null;\n}\n\nfunction getCountryFromCode(code, data) {\n    if (!code) return null;\n    if (!data) return null;\n\n    const index = data.findIndex(x => x.code.toLowerCase() === code.toLowerCase());\n\n    return index !== -1 ? data[index] : null;\n}\n\nclass Phone extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { defaultPhone, data } = props;\n\n        let phone = defaultPhone || '';\n        let country = getCountryFromPhone(phone, data);\n        if (!phone && !country) {\n            const { code } = AuthStore;\n            if (code) {\n                const [p, c] = this.getPhoneCountry(code);\n                phone = p;\n                country = c;\n            }\n        }\n\n        this.state = {\n            connecting: isConnecting(AppStore.connectionState),\n            error: null,\n            loading: false,\n            suggestedLanguage: localStorage.getItem(KEY_SUGGESTED_LANGUAGE_PACK_ID),\n            keep: true,\n\n            phone,\n            country\n        };\n\n        this.phoneInputRef = React.createRef();\n    }\n\n    getPhoneCountry(code) {\n        if (!code) return [null, null];\n\n        const { data } = this.props;\n        if (!data) return [null, null];\n\n        let phone = null;\n        const country = getCountryFromCode(code.text, data);\n        if (country) {\n            phone = '+' + clearPhone(country.phone) + ' ';\n        }\n\n        return [phone, country];\n    }\n\n    onClientUpdateCountryCode = update => {\n        const { code } = AuthStore;\n        if (!code) return;\n\n        const [phone, country] = this.getPhoneCountry(code);\n        if (this.state.phone) {\n            return;\n        }\n\n        this.setState({ phone, country });\n    };\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        return true;\n    }\n\n    componentDidMount() {\n        this.setSuggestedLanguagePackId();\n\n        AuthStore.on('clientUpdateCountryCode', this.onClientUpdateCountryCode);\n        AppStore.on('clientUpdateSetPhoneCanceled', this.onClientUpdateSetPhoneCanceled);\n        AppStore.on('clientUpdateSetPhoneError', this.onClientUpdateSetPhoneError);\n        AppStore.on('clientUpdateSetPhoneResult', this.onClientUpdateSetPhoneResult);\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\n        OptionStore.on('updateOption', this.onUpdateOption);\n    }\n\n    componentWillUnmount() {\n        AuthStore.off('clientUpdateCountryCode', this.onClientUpdateCountryCode);\n        AppStore.off('clientUpdateSetPhoneCanceled', this.onClientUpdateSetPhoneCanceled);\n        AppStore.off('clientUpdateSetPhoneError', this.onClientUpdateSetPhoneError);\n        AppStore.off('clientUpdateSetPhoneResult', this.onClientUpdateSetPhoneResult);\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\n        OptionStore.off('updateOption', this.onUpdateOption);\n    }\n\n    onUpdateConnectionState = update => {\n        const { state } = update;\n\n        this.setState({ connecting: isConnecting(state) });\n    };\n\n    onClientUpdateSetPhoneCanceled = update => {\n        this.setState({ loading: false });\n    };\n\n    onClientUpdateSetPhoneError = update => {\n        const { error } = update;\n\n        let errorString = null;\n        if (error && error['@type'] === 'error' && error.message) {\n            if (error.message === 'PHONE_NUMBER_INVALID') {\n                this.setState({ error: { code: 'InvalidPhoneNumber' }, loading: false });\n                return;\n            } else {\n                errorString = error.message;\n            }\n        } else {\n            errorString = JSON.stringify(error);\n        }\n\n        this.setState({ error: { string: errorString }, loading: false });\n    };\n\n    onClientUpdateSetPhoneResult = update => {\n        this.setState({ loading: false });\n    };\n\n    onUpdateOption = update => {\n        const { name } = update;\n\n        if (name === 'suggested_language_pack_id') {\n            this.setSuggestedLanguagePackId();\n        }\n    };\n\n    async setSuggestedLanguagePackId() {\n        const { i18n } = this.props;\n        if (!i18n) return;\n\n        const languagePackId = OptionStore.get('suggested_language_pack_id');\n        if (!languagePackId) return;\n\n        const { value } = languagePackId;\n\n        await LocalizationStore.loadLanguage(value);\n\n        this.setState({ suggestedLanguage: value });\n    }\n\n    handleKeyPress = event => {\n        if (event.key === 'Enter') {\n            event.preventDefault();\n            this.handleDone();\n        } else if (!isWhitelistKey(event.key)) {\n            event.preventDefault();\n            event.stopPropagation();\n        }\n    };\n\n    handleDone = () => {\n        const { phone } = this.state;\n        if (!isValidPhoneNumber(phone)) {\n            this.setState({ error: { code: 'InvalidPhoneNumber' } });\n            return;\n        }\n\n        this.setState({ error: null, loading: true });\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateSetPhone',\n            phone\n        });\n    };\n\n    handleChangeLanguage = () => {\n        const { i18n } = this.props;\n        const { suggestedLanguage } = this.state;\n\n        if (!i18n) return;\n        if (!suggestedLanguage) return;\n\n        const nextLanguage = suggestedLanguage === i18n.language ? LocalizationStore.fallbackLng : suggestedLanguage;\n\n        TdLibController.clientUpdate({ '@type': 'clientUpdateLanguageChange', language: nextLanguage });\n    };\n\n    handleFilterOptions = (options, { inputValue }) => {\n        if (!options) return;\n\n        let value = inputValue.toLowerCase().replace(/ /g, '');\n        value = value.length > 0 && value[0] === '+' ? value.substring(1) : value;\n\n        return options.filter(x => isValidOption(x, value));\n    };\n\n    handleCountryChange = (event, nextCountry) => {\n        if (!nextCountry) return;\n\n        const { phone, country } = this.state;\n\n        const prevPhone = (country ? phone.replace(country.phone, '') : phone) || '';\n        const nextPhone = nextCountry.phone + ' ' + prevPhone.trimStart();\n\n        this.setState({ country: nextCountry, phone: nextPhone }, () => {\n            this.phoneInputRef.current.focus();\n        });\n    };\n\n    handleKeepChange = (event, value) => {\n        this.setState({ keep: !this.state.keep });\n    };\n\n    handlePhoneChange = event => {\n        let nextPhone = event.target.value;\n\n        const { data } = this.props;\n        let { country } = this.state;\n        if (country) {\n            if (!nextPhone.startsWith(country.phone)) {\n                country = null;\n            }\n        }\n\n        if (!country && data && nextPhone) {\n            country = getCountryFromPhone(nextPhone, data);\n            if (country && phoneEquals(nextPhone, country.phone)) {\n                nextPhone = '+' + clearPhone(nextPhone) + ' ';\n            }\n        }\n\n        this.setState({ phone: nextPhone, country });\n    };\n\n    handlePaste = event => {\n        const plainText = event.clipboardData.getData('text/plain');\n        if (plainText) {\n            event.preventDefault();\n            // const phoneRegExp = '/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\\s\\./0-9]*$/g';\n\n            let phone = '';\n            for (let ch of plainText) {\n                if (isWhitelistKey(ch)) {\n                    phone += ch;\n                }\n            }\n\n            document.execCommand('insertText', false, phone);\n        }\n    };\n\n    handleQRCode = () => {\n        const { onRequestQRCode } = this.props;\n\n        onRequestQRCode && onRequestQRCode();\n    };\n\n    render() {\n        const { data, i18n, t } = this.props;\n        const { connecting, loading, error, suggestedLanguage, keep, phone, country } = this.state;\n\n        let errorString = '';\n        if (error) {\n            const { code, string } = error;\n            if (code) {\n                errorString = t(code);\n            } else {\n                errorString = string;\n            }\n        }\n\n        const title = connecting ? cleanProgressStatus(t('Connecting')) : t('SignInToTelegram');\n        let nextLanguage = suggestedLanguage;\n        if (suggestedLanguage === i18n.language && i18n.language !== LocalizationStore.fallbackLng) {\n            nextLanguage = LocalizationStore.fallbackLng;\n        }\n\n        return (\n            <form className='auth-root' autoComplete='off'>\n                <Typography variant='body1' className='auth-title'>\n                    <span>{title}</span>\n                    {connecting && <HeaderProgress />}\n                </Typography>\n                <Typography variant='body1' className='auth-subtitle' style={{ width: 264 }}>\n                    {t('StartText')}\n                </Typography>\n                <Autocomplete\n                    debug={false}\n                    id='country-select'\n                    noOptionsText={t('NoResult')}\n                    options={data || []}\n                    disabled={loading}\n                    autoHighlight\n                    getOptionLabel={option => option.name}\n                    renderOption={option => <Country name={option.name} emoji={option.emoji} phone={option.phone} />}\n                    renderInput={params => (\n                        <TextField\n                            classes={{ root: 'auth-input' }}\n                            {...params}\n                            label={t('Country')}\n                            variant='outlined'\n                            inputProps={{\n                                ...params.inputProps\n                            }}\n                            fullWidth\n                            autoComplete='off'\n                        />\n                    )}\n                    filterOptions={this.handleFilterOptions}\n                    value={country}\n                    onChange={this.handleCountryChange}\n                />\n                <TextField\n                    id='phoneNumber'\n                    classes={{ root: 'auth-input' }}\n                    inputRef={this.phoneInputRef}\n                    variant='outlined'\n                    color='primary'\n                    label={t('PhoneNumber')}\n                    disabled={loading}\n                    error={Boolean(errorString)}\n                    helperText={errorString}\n                    fullWidth\n                    autoFocus\n                    autoComplete='off'\n                    value={phone}\n                    onChange={this.handlePhoneChange}\n                    onKeyPress={this.handleKeyPress}\n                    onPaste={this.handlePaste}\n                />\n                <div className='sign-in-keep'>\n                    <Checkbox color='primary' checked={keep} disabled={loading} onChange={this.handleKeepChange} />\n                    <Typography variant='body1'>{t('KeepMeSignedIn')}</Typography>\n                </div>\n                <Button\n                    classes={{ root: 'auth-button' }}\n                    variant='contained'\n                    disableElevation\n                    fullWidth\n                    color='primary'\n                    disabled={loading}\n                    onClick={this.handleDone}>\n                    {t('Next')}\n                </Button>\n                <Typography className='sign-in-continue-on'>\n                    <Link onClick={this.handleQRCode}>\n                        {t('LogInViaQR')}\n                    </Link>\n                </Typography>\n                { !!nextLanguage && (\n                    <Typography className='sign-in-continue-on'>\n                        <Link onClick={this.handleChangeLanguage}>\n                            {t('ContinueOnThisLanguage', { lng: nextLanguage })}\n                        </Link>\n                    </Typography>\n                )}\n            </form>\n        );\n    }\n}\n\nPhone.propTypes = {\n    defaultPhone: PropTypes.string\n};\n\nexport default withTranslation()(Phone);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport Typography from '@material-ui/core/Typography';\nimport IconButton from '@material-ui/core/IconButton';\nimport EditIcon from '@material-ui/icons/EditOutlined';\nimport TextField from '@material-ui/core/TextField';\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\nimport { cleanProgressStatus, formatPhoneNumber, isConnecting } from './Phone';\nimport AppStore from '../../Stores/ApplicationStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './Code.css';\n\nclass Code extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            connecting: isConnecting(AppStore.connectionState),\n            error: '',\n            loading: false\n        };\n\n        this.inputRef = React.createRef();\n    }\n\n    componentDidMount() {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMonkeyIdle'\n        });\n\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    componentWillUnmount() {\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    onUpdateConnectionState = update => {\n        const { state } = update;\n\n        this.setState({ connecting: isConnecting(state) });\n    };\n\n    handleNext = () => {\n        if (this.code && this.isValid(this.code)) {\n            this.setState({ error: '' });\n            this.handleDone();\n        } else {\n            this.setState({ error: 'Invalid code. Please try again.' });\n        }\n    };\n\n    handleDone = () => {\n        const { t } = this.props;\n        const code = this.code;\n\n        this.setState({ loading: true });\n        TdLibController.send({\n            '@type': 'checkAuthenticationCode',\n            code: code,\n            first_name: 'A',\n            last_name: 'B'\n        })\n            .then(result => {})\n            .catch(error => {\n                let errorString = null;\n                if (error && error['@type'] === 'error' && error.message) {\n                    if (error.message === 'PHONE_CODE_INVALID') {\n                        errorString = t('InvalidCode');\n                    } else {\n                        errorString = error.message;\n                    }\n                } else {\n                    errorString = JSON.stringify(error);\n                }\n\n                this.setState({ error: errorString }, () => {\n                    setTimeout(() => this.inputRef.current.focus(), 100);\n                });\n            })\n            .finally(() => {\n                this.setState({ loading: false });\n            });\n    };\n\n    handleBack = () => {\n        this.props.onChangePhone();\n    };\n\n    isValid(code) {\n        let isBad = !code.match(/^[\\d\\-+\\s]+$/);\n        if (!isBad) {\n            code = code.replace(/\\D/g, '');\n            if (code.length !== 5) {\n                isBad = true;\n            }\n        }\n\n        return !isBad;\n    }\n\n    handleChange = e => {\n        const prevCode = this.code || '';\n        this.code = e.target.value || '';\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMonkeyTracking',\n            prevCode,\n            code: this.code\n        });\n\n        if (this.code && this.codeLength > 0 && this.code.length === this.codeLength) {\n            this.handleNext();\n        }\n    };\n\n    handleKeyPress = e => {\n        if (e.key === 'Enter') {\n            e.preventDefault();\n            this.handleNext();\n        }\n    };\n\n    getPhoneNumber(codeInfo) {\n        if (!codeInfo) return null;\n        return codeInfo.phone_number;\n    }\n\n    getCodeLength(codeInfo) {\n        if (!codeInfo) return 0;\n        if (!codeInfo.type) return 0;\n\n        switch (codeInfo.type['@type']) {\n            case 'authenticationCodeTypeCall': {\n                return codeInfo.type.length;\n            }\n            case 'authenticationCodeTypeFlashCall': {\n                return 0;\n            }\n            case 'authenticationCodeTypeSms': {\n                return codeInfo.type.length;\n            }\n            case 'authenticationCodeTypeTelegramMessage': {\n                return codeInfo.type.length;\n            }\n        }\n\n        return 0;\n    }\n\n    getSubtitle(codeInfo, t = k => k) {\n        if (!codeInfo) return '';\n        if (!codeInfo.type) return '';\n\n        switch (codeInfo.type['@type']) {\n            case 'authenticationCodeTypeCall': {\n                return 'Telegram dialed your number';\n            }\n            case 'authenticationCodeTypeFlashCall': {\n                return 'Telegram dialed your number';\n            }\n            case 'authenticationCodeTypeSms': {\n                return 'We have sent you a message with activation code to your phone. Please enter it below.';\n            }\n            case 'authenticationCodeTypeTelegramMessage': {\n                return 'Please enter the code you\\'ve just received in your previous Telegram app.';\n            }\n        }\n\n        return '';\n    }\n\n    render() {\n        const { codeInfo, t } = this.props;\n        const { connecting, loading, error } = this.state;\n\n        this.phoneNumber = this.getPhoneNumber(codeInfo);\n        this.codeLength = this.getCodeLength(codeInfo);\n        const subtitle = this.getSubtitle(codeInfo);\n\n        let title = 'Title';\n        if (connecting) {\n            title = cleanProgressStatus(t('Connecting'));\n        } else if (this.phoneNumber) {\n            title = formatPhoneNumber(this.phoneNumber);\n        }\n\n        return (\n            <form className='auth-root' autoComplete='off'>\n                <div className={classNames('code-title', 'auth-title')}>\n                    <Typography variant='body1' className='auth-title-typography'>\n                        <span>{title}</span>\n                        {connecting && <HeaderProgress />}\n                    </Typography>\n                    <IconButton aria-label='edit' onClick={this.handleBack} disabled={loading}>\n                        <EditIcon fontSize='small' />\n                    </IconButton>\n                </div>\n                <Typography variant='body1' className='auth-subtitle' style={{ width: 300 }}>\n                    {subtitle}\n                </Typography>\n                <TextField\n                    classes={{ root: 'auth-input' }}\n                    inputRef={this.inputRef}\n                    variant='outlined'\n                    color='primary'\n                    disabled={loading}\n                    error={Boolean(error)}\n                    helperText={error}\n                    fullWidth\n                    autoFocus\n                    autoComplete='off'\n                    label={t('Code')}\n                    maxLength={this.codeLength > 0 ? this.codeLength : 256}\n                    onChange={this.handleChange}\n                    onKeyPress={this.handleKeyPress}\n                />\n            </form>\n        );\n    }\n}\n\nexport default withTranslation()(Code);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport packageJson from '../../package.json';\nimport './Footer.css';\n\nclass Footer extends React.PureComponent {\n    render() {\n        return (\n            <div className='footer-wrapper'>\n                <span>{packageJson.version}</span>\n            </div>\n        );\n    }\n}\n\nexport default Footer;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport QRCodeStyling from 'qr-code-styling';\nimport Link from '@material-ui/core/Link';\nimport Typography from '@material-ui/core/Typography';\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\nimport { ReactComponent as Logo } from '../../Assets/telegram-logo.svg';\nimport { cleanProgressStatus, isConnecting } from './Phone';\nimport AppStore from '../../Stores/ApplicationStore';\nimport './QRCode.css';\n\nclass QRCode extends React.Component {\n\n    state = {\n        connecting: false,\n        showConnecting: false\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        const { state } = this.props;\n        if (state !== prevProps.state) {\n            this.loadData();\n        }\n    }\n\n    componentDidMount() {\n        this.loadData();\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    componentWillUnmount() {\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    loadData() {\n        const { state } = this.props;\n\n        const qrCode = new QRCodeStyling({\n            width: 287,\n            height: 287,\n            data: state.link,\n            image: '',\n            dotsOptions: {\n                color: 'black',\n                type: 'rounded'\n            },\n            backgroundOptions: {\n                color: 'transparent',\n            }\n        });\n\n        const canvas = document.getElementById('qr-canvas');\n        canvas.innerHTML = null;\n        qrCode.append(canvas);\n    }\n\n    onUpdateConnectionState = update => {\n        const { state } = update;\n\n        const connecting = isConnecting(state);\n        if (this.state.connecting === connecting) return;\n\n        this.setState({ connecting, showConnecting: false });\n        if (connecting) {\n            setTimeout(() => {\n                if (this.state.connecting) {\n                    this.setState({ showConnecting: true });\n                }\n            }, 500);\n        }\n    };\n\n    handleBack = () => {\n        const { onChangePhone } = this.props;\n\n        onChangePhone && onChangePhone();\n    };\n\n    render() {\n        const { t } = this.props;\n        const { showConnecting: connecting } = this.state;\n\n        const title = connecting ? cleanProgressStatus(t('Connecting')) : t('AuthAnotherClient');\n\n        return (\n            <form className='auth-root'>\n                <Typography variant='body1' className='auth-title'>\n                    <span>{title}</span>\n                    {connecting && <HeaderProgress />}\n                </Typography>\n                <div className='qr-content'>\n                    <div id='qr-canvas'/>\n                    <div className='qr-telegram-logo'>\n                        <Logo className='telegram-logo'/>\n                    </div>\n                </div>\n                <Typography variant='body1' className='auth-qr-subtitle'>\n                    {t('QRHint')}\n                </Typography>\n                <Typography className='sign-in-continue-on'>\n                    <Link onClick={this.handleBack}>\n                        {t('LogInByPhone')}\n                    </Link>\n                </Typography>\n            </form>\n        );\n    }\n}\n\nQRCode.propTypes = {\n    state: PropTypes.object,\n    onChangePhone: PropTypes.func\n};\n\nexport default withTranslation()(QRCode);","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport IconButton from '@material-ui/core/IconButton';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport Typography from '@material-ui/core/Typography';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport Button from '@material-ui/core/Button';\nimport Visibility from '@material-ui/icons/Visibility';\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\nimport { cleanProgressStatus, isConnecting } from './Phone';\nimport AppStore from '../../Stores/ApplicationStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './Password.css';\n\nclass Password extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            connecting: isConnecting(AppStore.connectionState),\n            password: '',\n            showPassword: false,\n            error: ''\n        };\n\n        this.inputRef = React.createRef();\n    }\n\n    componentDidMount() {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMonkeyClose'\n        });\n\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    componentWillUnmount() {\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    onUpdateConnectionState = update => {\n        const { state } = update;\n\n        this.setState({ connecting: isConnecting(state) });\n    };\n\n    handleNext = () => {\n        if (this.password) {\n            this.setState({ error: '' });\n            this.handleDone();\n        } else {\n            this.setState({ error: 'Invalid password. Please try again.' });\n        }\n    };\n\n    handleBack = () => {\n        this.props.onChangePhone();\n    };\n\n    handleDone = () => {\n        const password = this.password;\n\n        this.setState({ loading: true });\n        TdLibController.send({\n            '@type': 'checkAuthenticationPassword',\n            password: password\n        })\n            .then(result => {})\n            .catch(error => {\n                let errorString = null;\n                if (error && error['@type'] === 'error' && error.message) {\n                    errorString = error.message;\n                } else {\n                    errorString = JSON.stringify(error);\n                }\n\n                this.setState({ error: errorString }, () => {\n                    setTimeout(() => this.inputRef.current.focus(), 100);\n                });\n            })\n            .finally(() => {\n                this.setState({ loading: false });\n            });\n    };\n\n    handleMouseDownPassword = event => {\n        event.preventDefault();\n    };\n\n    handleClickShowPassword = () => {\n        const { showPassword } = this.state;\n\n        this.setState({ showPassword: !showPassword });\n\n        this.sendMonkeyPeek(!showPassword);\n    };\n\n    sendMonkeyPeek(peek) {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMonkeyPeek',\n            peek\n        });\n    }\n\n    handleChange = e => {\n        this.password = e.target.value;\n    };\n\n    handleKeyPress = e => {\n        if (e.key === 'Enter') {\n            e.preventDefault();\n            this.handleNext();\n        }\n    };\n\n    render() {\n        const { passwordHint, t } = this.props;\n        const { connecting, loading, error, showPassword } = this.state;\n\n        let title = t('EnterPassword');\n        if (connecting) {\n            title = cleanProgressStatus(t('Connecting'));\n        }\n\n        return (\n            <form className='auth-root' autoComplete='off'>\n                <Typography variant='body1' className='auth-title'>\n                    <span>{title}</span>\n                    {connecting && <HeaderProgress />}\n                </Typography>\n                <Typography variant='body1' className='auth-subtitle' style={{ width: 235 }}>\n                    {t('YourAccountProtectedWithPassword')}\n                </Typography>\n                <FormControl className='auth-input' fullWidth variant='outlined'>\n                    <InputLabel htmlFor='adornment-password' error={Boolean(error)}>\n                        {t('LoginPassword')}\n                    </InputLabel>\n                    <OutlinedInput\n                        fullWidth\n                        autoFocus\n                        autoComplete='off'\n                        id='adornment-password'\n                        inputRef={this.inputRef}\n                        type={showPassword ? 'text' : 'password'}\n                        disabled={loading}\n                        error={Boolean(error)}\n                        onChange={this.handleChange}\n                        onKeyPress={this.handleKeyPress}\n                        endAdornment={\n                            <InputAdornment position='end'>\n                                <IconButton\n                                    aria-label='Toggle password visibility'\n                                    onClick={this.handleClickShowPassword}\n                                    onMouseDown={this.handleMouseDownPassword}\n                                    edge='end'>\n                                    {showPassword ? <Visibility /> : <VisibilityOff />}\n                                </IconButton>\n                            </InputAdornment>\n                        }\n                        labelWidth={70}\n                    />\n                    {passwordHint && <FormHelperText id='password-hint-text'>{passwordHint}</FormHelperText>}\n                    {error && (\n                        <FormHelperText id='password-error-text' error>\n                            {error}\n                        </FormHelperText>\n                    )}\n                </FormControl>\n                <Button\n                    classes={{ root: 'auth-button' }}\n                    fullWidth\n                    color='primary'\n                    variant='contained'\n                    disableElevation\n                    onClick={this.handleNext}\n                    disabled={loading}>\n                    {t('Next')}\n                </Button>\n            </form>\n        );\n    }\n}\n\nexport default withTranslation()(Password);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport AuthErrorDialog from './AuthErrorDialog';\nimport Caption from './Caption';\nimport Code from './Code';\nimport Footer from '../Footer';\nimport QRCode from './QRCode';\nimport Password from './Password';\nimport Phone from './Phone';\nimport { loadData } from '../../Utils/Phone';\nimport AppStore from '../../Stores/ApplicationStore';\nimport AuthStore from '../../Stores/AuthorizationStore';\nimport './AuthForm.css';\n\nclass AuthForm extends React.Component {\n    state = {\n        data: AuthStore.data\n    };\n\n    componentDidMount() {\n        setTimeout(this.loadContent, 100);\n    }\n\n    loadContent = async () => {\n        const { data } = this.state;\n        if (data) return;\n\n        try {\n            AuthStore.data = await loadData();\n\n            this.setState({ data: AuthStore.data });\n        } catch (error) {\n            console.error(error);\n        }\n    };\n\n    render() {\n        const { authorizationState: state, onChangePhone, onRequestQRCode } = this.props;\n        const { data } = this.state;\n        const { defaultPhone } = AppStore;\n\n        let control = null;\n        switch (state['@type']) {\n            case 'authorizationStateWaitOtherDeviceConfirmation': {\n                control = (\n                    <QRCode\n                        state={state}\n                        onChangePhone={onChangePhone}\n                    />);\n                break;\n            }\n            case 'authorizationStateWaitPhoneNumber':\n            case 'authorizationStateWaitRegistration':\n            case 'authorizationStateWaitEncryptionKey':\n            case 'authorizationStateWaitTdlibParameters':\n            case 'authorizationStateWaitTdlib': {\n                control = (\n                    <Phone\n                        defaultPhone={defaultPhone}\n                        data={data}\n                        onRequestQRCode={onRequestQRCode} />);\n                break;\n            }\n            case 'authorizationStateWaitCode': {\n                const { terms_of_service, code_info } = state;\n\n                control = (\n                    <Code\n                        termsOfService={terms_of_service}\n                        codeInfo={code_info}\n                        onChangePhone={onChangePhone}\n                        data={data}\n                    />\n                );\n                break;\n            }\n            case 'authorizationStateWaitPassword': {\n                const { password_hint, has_recovery_email_address, recovery_email_address_pattern } = state;\n\n                control = (\n                    <Password\n                        passwordHint={password_hint}\n                        hasRecoveryEmailAddress={has_recovery_email_address}\n                        recoveryEmailAddressPattern={recovery_email_address_pattern}\n                        onChangePhone={onChangePhone}\n                    />\n                );\n                break;\n            }\n            default:\n                break;\n        }\n\n        return (\n            <div className='authorization-form' onLoad={this.handleLoad}>\n                <div className='authorization-form-content'>\n                    <Caption state={state} />\n                    {control}\n                    <Footer/>\n                </div>\n                <AuthErrorDialog />\n            </div>\n        );\n    }\n}\nexport default AuthForm;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Button from '@material-ui/core/Button/Button';\nimport './AppInactive.css';\n\nclass AppInactive extends React.Component {\n    static handleReload() {\n        window.location.reload();\n    }\n\n    render() {\n        return (\n            <div className='app-inactive'>\n                <div className='app-inactive-wrapper'>\n                    <img\n                        className='app-inactive-image'\n                        src='Manytabs_2x.png'\n                        alt=''\n                        onClick={AppInactive.handleReload}\n                    />\n                    <h3 className='app-inactive-title'>Such error, many tabs</h3>\n                    <div className='app-inactive-description'>\n                        Telegram supports only one active tab with the app.\n                        <br />\n                        Please reload this page to continue using this tab or close it.\n                    </div>\n                    <div className='app-inactive-actions'>\n                        <Button color='primary' onClick={AppInactive.handleReload}>\n                            Reload app\n                        </Button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default AppInactive;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport AppInactive from './Additional/AppInactive';\nimport Footer from './Footer';\n\nclass InactivePage extends React.Component {\n    render() {\n        return (\n            <>\n                <div className='header-wrapper' />\n                <div className='page'>\n                    <AppInactive />\n                </div>\n                <Footer />\n            </>\n        );\n    }\n}\n\nexport default InactivePage;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Button from '@material-ui/core/Button';\nimport { isIOS, isWindowsPhone } from '../../Utils/Common';\nimport './NativeApp.css';\n\nclass NativeApp extends React.Component {\n    static handleInstall = () => {\n        if (isIOS()) {\n            window.location.href = 'https://telegram.org/dl/ios';\n        } else if (isWindowsPhone()) {\n            window.location.href = 'https://telegram.org/dl/wp';\n        } else {\n            window.location.href = 'https://telegram.org/dl/android';\n        }\n    };\n\n    render() {\n        let src = 'Android_2x.jpg';\n        if (isIOS()) {\n            src = 'iOS_2x.jpg';\n        } else if (isWindowsPhone()) {\n            src = 'WP_2x.jpg';\n        }\n\n        return (\n            <div className='app-inactive'>\n                <div className='app-inactive-wrapper'>\n                    <img src={src} alt='' className='app-inactive-image' onClick={NativeApp.handleInstall} />\n                    <h3 className='app-inactive-title'>Work is in progress!</h3>\n                    <div className='app-inactive-description'>\n                        This client has not been optimized for mobile devices yet.\n                        <br />\n                        Please consider using our native mobile app.\n                    </div>\n                    <div className='app-inactive-actions'>\n                        <Button color='primary' onClick={NativeApp.handleInstall}>\n                            Install app\n                        </Button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default NativeApp;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Footer from './Footer';\nimport NativeApp from './Additional/NativeApp';\n\nclass NativeAppPage extends React.Component {\n    render() {\n        return (\n            <>\n                <div className='header-wrapper' />\n                <div\n                    className='page'\n                    style={{\n                        background: '#FFFFFF',\n                        color: '#000000'\n                    }}>\n                    <NativeApp />\n                </div>\n                <Footer />\n            </>\n        );\n    }\n}\n\nexport default NativeAppPage;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { Component } from 'react';\nimport { compose } from './Utils/HOC';\nimport withLanguage from './Language';\nimport withTelegramTheme from './Theme';\nimport withTheme from '@material-ui/core/styles/withTheme';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport packageJson from '../package.json';\nimport AuthForm from './Components/Auth/AuthForm';\nimport InactivePage from './Components/InactivePage';\nimport NativeAppPage from './Components/NativeAppPage';\n// import StubPage from './Components/StubPage';\nimport registerServiceWorker from './registerServiceWorker';\nimport { isMobile } from './Utils/Common';\nimport { loadData } from './Utils/Phone';\nimport KeyboardManager, { KeyboardHandler } from './Components/Additional/KeyboardManager';\nimport { openChatList, openPinnedChat } from './Actions/Chat';\nimport { modalManager } from './Utils/Modal';\nimport { clearSelection, editMessage, replyMessage, searchChat } from './Actions/Client';\nimport { OPTIMIZATIONS_FIRST_START, STORAGE_REGISTER_KEY, STORAGE_REGISTER_TEST_KEY } from './Constants';\nimport UserStore from './Stores/UserStore';\nimport AppStore from './Stores/ApplicationStore';\nimport AuthorizationStore from './Stores/AuthorizationStore';\nimport FilterStore from './Stores/FilterStore';\nimport MessageStore from './Stores/MessageStore';\nimport TdLibController from './Controllers/TdLibController';\nimport './TelegramApp.css';\n\n// import MainPage from './Components/MainPage';\nconst MainPage = React.lazy(() => import('./Components/MainPage'));\n\nclass TelegramApp extends Component {\n    constructor(props) {\n        super(props);\n\n        console.log(`Start Telegram Web ${packageJson.version}`);\n        console.log('[auth] ctor', props.location);\n\n        this.state = {\n            prevAuthorizationState: AuthorizationStore.current,\n            authorizationState: null,\n            tdlibDatabaseExists: false,\n            inactive: false,\n            fatalError: false,\n            nativeMobile: false, //isMobile(),\n            isSmall: window.innerWidth < 800\n        };\n\n        this.replyMessageId = 0;\n        this.editMessageId = 0;\n        this.keyboardHandler = new KeyboardHandler(this.handleKeyDown);\n        this.keyMap = new Map();\n\n        document.addEventListener('keyup', event => {\n            this.keyMap.delete(event.key);\n        });\n    }\n\n    handleKeyDown = async event => {\n        const { altKey, ctrlKey, keyCode, key, metaKey, repeat, shiftKey, isComposing } = event;\n\n        this.keyMap.set(key, key);\n\n        const { chatList } = FilterStore;\n        const { authorizationState, chatId } = AppStore;\n        if (!authorizationState) return;\n        if (authorizationState['@type'] !== 'authorizationStateReady') return;\n        if (this.keyMap.size > 3) return;\n\n        if (modalManager.modals.length > 0) {\n            return;\n        }\n\n        if (event.isComposing) {\n            return;\n        }\n\n        switch (key) {\n            case 'Escape': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey && !repeat) {\n                    // console.log('[keydown] esc', this.editMessageId, this.replyMessageId);\n                    if (this.editMessageId) {\n                        editMessage(chatId, 0);\n                        return;\n                    } else if (this.replyMessageId) {\n                        replyMessage(chatId, 0);\n                        return;\n                    } else if (MessageStore.selectedItems.size > 0) {\n                        clearSelection();\n                        return;\n                    } else if (chatId) {\n                        TdLibController.setChatId(0);\n                        return;\n                    } else if (chatList && chatList['@type'] !== 'chatListMain') {\n                        openChatList({ '@type': 'chatListMain' });\n                        return;\n                    }\n\n                    // open search if no one dialog opened\n                    searchChat(0, null);\n\n                    event.preventDefault();\n                    event.stopPropagation();\n                }\n                break;\n            }\n            case '0': {\n                if (altKey && ctrlKey && !metaKey && !shiftKey && !repeat) {\n                    if (this.editMessageId) return;\n                    if (this.replyMessageId) return;\n\n                    const chat = await TdLibController.send({\n                        '@type': 'createPrivateChat',\n                        user_id: UserStore.getMyId(),\n                        force: true\n                    });\n\n                    if (!chat) return;\n\n                    TdLibController.setChatId(chat.id);\n                    event.preventDefault();\n                    event.stopPropagation();\n                }\n                break;\n            }\n            case '1':\n            case '2':\n            case '3':\n            case '4':\n            case '5': {\n                if (altKey && ctrlKey && !metaKey && !shiftKey && !repeat) {\n                    if (this.editMessageId) return;\n                    if (this.replyMessageId) return;\n\n                    openPinnedChat(Number(key) - 1);\n                    event.preventDefault();\n                    event.stopPropagation();\n                }\n                break;\n            }\n        }\n    };\n\n    componentWillMount() {\n        TdLibController.init();\n    }\n\n    componentDidMount() {\n        setTimeout(() => loadData(), 1500);\n        TdLibController.on('update', this.onUpdate);\n\n        AppStore.on('clientUpdateAppInactive', this.onClientUpdateAppInactive);\n        AppStore.on('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.on('clientUpdateTdLibDatabaseExists', this.onClientUpdateTdLibDatabaseExists);\n        AppStore.on('updateAuthorizationState', this.onUpdateAuthorizationState);\n        AppStore.on('updateFatalError', this.onUpdateFatalError);\n        MessageStore.on('clientUpdateEditMessage', this.onClientUpdateEditMessage);\n        MessageStore.on('clientUpdateReply', this.onClientUpdateReply);\n        KeyboardManager.add(this.keyboardHandler);\n    }\n\n    componentWillUnmount() {\n        TdLibController.off('update', this.onUpdate);\n\n        AppStore.off('clientUpdateAppInactive', this.onClientUpdateAppInactive);\n        AppStore.off('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.off('clientUpdateTdLibDatabaseExists', this.onClientUpdateTdLibDatabaseExists);\n        AppStore.off('updateAuthorizationState', this.onUpdateAuthorizationState);\n        AppStore.off('updateFatalError', this.onUpdateFatalError);\n        MessageStore.off('clientUpdateEditMessage', this.onClientUpdateEditMessage);\n        MessageStore.off('clientUpdateReply', this.onClientUpdateReply);\n        KeyboardManager.remove(this.keyboardHandler);\n    }\n\n    onClientUpdateEditMessage = update => {\n        const { messageId } = update;\n\n        this.editMessageId = messageId;\n    };\n\n    onClientUpdateReply = update => {\n        const { messageId } = update;\n\n        this.replyMessageId = messageId;\n    };\n\n    onClientUpdateFocusWindow = update => {\n        this.keyMap.clear();\n    };\n\n    onClientUpdateTdLibDatabaseExists = update => {\n        const { exists } = update;\n\n        if (!exists) {\n            this.setState({\n                authorizationState: {\n                    '@type': 'authorizationStateWaitTdlib'\n                },\n                tdlibDatabaseExists: exists\n            });\n        }\n    };\n\n    onUpdate = update => {\n        if (OPTIMIZATIONS_FIRST_START) {\n            if (!this.checkServiceWorker) {\n                this.checkServiceWorker = true;\n\n                const { useTestDC } = TdLibController.parameters;\n                const registerKey = useTestDC ? STORAGE_REGISTER_TEST_KEY : STORAGE_REGISTER_KEY;\n                const register = localStorage.getItem(registerKey);\n                if (!register) {\n                    registerServiceWorker();\n                }\n            }\n        }\n    };\n\n    onUpdateFatalError = update => {\n        this.setState({ fatalError: true });\n    };\n\n    onUpdateAuthorizationState = update => {\n        const { authorization_state: authorizationState } = update;\n        let { prevAuthorizationState } = this.state;\n\n        if (authorizationState && (\n            authorizationState['@type'] === 'authorizationStateLoggingOut' ||\n            authorizationState['@type'] === 'authorizationStateClosed')) {\n            prevAuthorizationState = null;\n        }\n\n        this.setState({\n            authorizationState,\n            prevAuthorizationState\n        });\n\n        if (!window.hasFocus) return;\n        if (!authorizationState) return;\n\n        TdLibController.send({\n            '@type': 'setOption',\n            name: 'online',\n            value: { '@type': 'optionValueBoolean', value: true }\n        });\n    };\n\n    onClientUpdateAppInactive = update => {\n        this.setState({ inactive: true });\n    };\n\n    handleChangePhone = () => {\n        this.setState({\n            changePhone: true\n        });\n    };\n\n    handleRequestQRCode = () => {\n        const { changePhone, authorizationState } = this.state;\n\n        if (changePhone\n            && authorizationState\n            && authorizationState['@type'] === 'authorizationStateWaitOtherDeviceConfirmation') {\n            this.setState({ changePhone: false });\n        } else {\n            TdLibController.send({\n                '@type': 'requestQrCodeAuthentication',\n                other_user_ids: []\n            });\n        }\n    };\n\n    handleDragOver = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    handleDrop = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    handleRefresh = () => {\n        this.setState({ fatalError: false });\n        window.location.reload();\n    };\n\n    handleDestroy = () => {\n        this.setState({ fatalError: false });\n        TdLibController.send({ '@type': 'destroy' });\n    };\n\n    render() {\n        const { t, theme } = this.props;\n        const { inactive, nativeMobile, fatalError } = this.state;\n        let { authorizationState: state, prevAuthorizationState, changePhone } = this.state;\n        if (changePhone) {\n            state = { '@type': 'authorizationStateWaitPhoneNumber' };\n        } else if (!state ||\n            state['@type'] === 'authorizationStateClosed' ||\n            state['@type'] === 'authorizationStateWaitEncryptionKey' ||\n            state['@type'] === 'authorizationStateWaitTdlibParameters'\n        ) {\n            if (prevAuthorizationState) {\n                state = prevAuthorizationState;\n            } else {\n                state = { '@type': 'authorizationStateWaitPhoneNumber' };\n            }\n        }\n\n        const loading = t('Loading').replace('...', '');\n        let page = ( //<MainPage />;\n            <React.Suspense fallback={null}>\n                <MainPage />\n            </React.Suspense>\n        );\n\n        if (nativeMobile) {\n            page = <NativeAppPage />;\n        } else if (inactive) {\n            page = <InactivePage />;\n        } else if (state) {\n            switch (state['@type']) {\n                case 'authorizationStateClosed':\n                case 'authorizationStateClosing':\n                case 'authorizationStateLoggingOut':\n                case 'authorizationStateReady': {\n                    break;\n                }\n                case 'authorizationStateWaitOtherDeviceConfirmation':\n                case 'authorizationStateWaitCode':\n                case 'authorizationStateWaitRegistration':\n                case 'authorizationStateWaitPassword':\n                case 'authorizationStateWaitPhoneNumber':\n                case 'authorizationStateWaitTdlib':\n                    page = <AuthForm authorizationState={state} onChangePhone={this.handleChangePhone} onRequestQRCode={this.handleRequestQRCode}/>;\n                    break;\n                case 'authorizationStateWaitEncryptionKey':\n                case 'authorizationStateWaitTdlibParameters': {\n                    break;\n                }\n            }\n        }\n\n        return (\n            <div\n                id='app'\n                className={theme.palette.type === 'dark' ? 'dark' : 'light'}\n                onDragOver={this.handleDragOver}\n                onDrop={this.handleDrop}\n                // onKeyDown={KeyboardManager.handleKeyDown} tabIndex={-1}\n            >\n                {page}\n                <Dialog\n                    manager={modalManager}\n                    transitionDuration={0}\n                    open={fatalError}\n                    onClose={this.handleRefresh}\n                    aria-labelledby='fatal-error-dialog-title'\n                    aria-describedby='fatal-error-dialog-description'>\n                    <DialogTitle id='fatal-error-dialog-title'>Telegram</DialogTitle>\n                    <DialogContent>\n                        <DialogContentText id='fatal-error-dialog-description'>\n                            Oops! Something went wrong. We need to refresh this page.\n                        </DialogContentText>\n                    </DialogContent>\n                    <DialogActions>\n                        <Button onClick={this.handleDestroy} color='primary'>\n                            Log out\n                        </Button>\n                        <Button onClick={this.handleRefresh} color='primary' autoFocus>\n                            Refresh\n                        </Button>\n                    </DialogActions>\n                </Dialog>\n            </div>\n        );\n    }\n}\n\nwindow.hasFocus = true;\n\n// set offline on page lost focus\n// console.log('[ns] window.onblur attach');\nwindow.onblur = function() {\n    window.hasFocus = false;\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateFocusWindow',\n        focused: false\n    });\n};\n\n// set online on page get focus\n// console.log('[ns] window.onfocus attach');\nwindow.onfocus = function() {\n    window.hasFocus = true;\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateFocusWindow',\n        focused: true\n    });\n};\n\n// disable back navigation\nwindow.history.pushState(null, null, window.location.href);\nwindow.onpopstate = function() {\n    window.history.go(1);\n};\n\nconst enhance = compose(\n    withLanguage,\n    withTranslation(),\n    withTelegramTheme,\n    withTheme\n);\n\nexport default enhance(TelegramApp);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport TelegramApp from './TelegramApp';\nimport registerServiceWorker from './registerServiceWorker';\nimport {\n    OPTIMIZATIONS_FIRST_START,\n    STORAGE_REGISTER_KEY,\n    STORAGE_REGISTER_TEST_KEY\n} from './Constants';\nimport TdLibController from './Controllers/TdLibController';\nimport './index.css';\n\nReactDOM.render(\n    <Router>\n        <Route path='' component={TelegramApp} />\n    </Router>,\n    document.getElementById('root')\n);\n\nif (OPTIMIZATIONS_FIRST_START) {\n    const registerKey = TdLibController.parameters.useTestDC ? STORAGE_REGISTER_TEST_KEY : STORAGE_REGISTER_KEY;\n    const register = localStorage.getItem(registerKey);\n    if (register) {\n        registerServiceWorker();\n    }\n} else {\n    registerServiceWorker();\n}"],"sourceRoot":""}